{"ast":null,"code":"/* xlsx.js (C) 2013-2015 SheetJS -- http://sheetjs.com */\n\n/* vim: set ts=2: */\n\n/*jshint -W041 */\n\n/*jshint funcscope:true, eqnull:true */\nvar XLSX = {};\n\n(function make_xlsx(XLSX) {\n  XLSX.version = '0.8.20';\n  var current_codepage = 1200,\n      current_cptable;\n\n  if (typeof module !== \"undefined\" && typeof require !== 'undefined') {\n    if (typeof cptable === 'undefined') cptable = require('./dist/cpexcel');\n    current_cptable = cptable[current_codepage];\n  }\n\n  function reset_cp() {\n    set_cp(1200);\n  }\n\n  var set_cp = function (cp) {\n    current_codepage = cp;\n  };\n\n  function char_codes(data) {\n    var o = [];\n\n    for (var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i);\n\n    return o;\n  }\n\n  var debom_xml = function (data) {\n    return data;\n  };\n\n  var _getchar = function _gc1(x) {\n    return String.fromCharCode(x);\n  };\n\n  if (typeof cptable !== 'undefined') {\n    set_cp = function (cp) {\n      current_codepage = cp;\n      current_cptable = cptable[cp];\n    };\n\n    debom_xml = function (data) {\n      if (data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) {\n        return cptable.utils.decode(1200, char_codes(data.substr(2)));\n      }\n\n      return data;\n    };\n\n    _getchar = function _gc2(x) {\n      if (current_codepage === 1200) return String.fromCharCode(x);\n      return cptable.utils.decode(current_codepage, [x & 255, x >> 8])[0];\n    };\n  }\n\n  var Base64 = function make_b64() {\n    var map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n    return {\n      encode: function (input, utf8) {\n        var o = \"\";\n        var c1, c2, c3, e1, e2, e3, e4;\n\n        for (var i = 0; i < input.length;) {\n          c1 = input.charCodeAt(i++);\n          c2 = input.charCodeAt(i++);\n          c3 = input.charCodeAt(i++);\n          e1 = c1 >> 2;\n          e2 = (c1 & 3) << 4 | c2 >> 4;\n          e3 = (c2 & 15) << 2 | c3 >> 6;\n          e4 = c3 & 63;\n\n          if (isNaN(c2)) {\n            e3 = e4 = 64;\n          } else if (isNaN(c3)) {\n            e4 = 64;\n          }\n\n          o += map.charAt(e1) + map.charAt(e2) + map.charAt(e3) + map.charAt(e4);\n        }\n\n        return o;\n      },\n      decode: function b64_decode(input, utf8) {\n        var o = \"\";\n        var c1, c2, c3;\n        var e1, e2, e3, e4;\n        input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\n        for (var i = 0; i < input.length;) {\n          e1 = map.indexOf(input.charAt(i++));\n          e2 = map.indexOf(input.charAt(i++));\n          e3 = map.indexOf(input.charAt(i++));\n          e4 = map.indexOf(input.charAt(i++));\n          c1 = e1 << 2 | e2 >> 4;\n          c2 = (e2 & 15) << 4 | e3 >> 2;\n          c3 = (e3 & 3) << 6 | e4;\n          o += String.fromCharCode(c1);\n\n          if (e3 != 64) {\n            o += String.fromCharCode(c2);\n          }\n\n          if (e4 != 64) {\n            o += String.fromCharCode(c3);\n          }\n        }\n\n        return o;\n      }\n    };\n  }();\n\n  var has_buf = typeof Buffer !== 'undefined';\n\n  function new_raw_buf(len) {\n    /* jshint -W056 */\n    return new (has_buf ? Buffer : Array)(len);\n    /* jshint +W056 */\n  }\n\n  function s2a(s) {\n    if (has_buf) return new Buffer(s, \"binary\");\n    return s.split(\"\").map(function (x) {\n      return x.charCodeAt(0) & 0xff;\n    });\n  }\n\n  var bconcat = function (bufs) {\n    return [].concat.apply([], bufs);\n  };\n\n  var chr0 = /\\u0000/g,\n      chr1 = /[\\u0001-\\u0006]/;\n  /* ssf.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\n\n  /*jshint -W041 */\n\n  var SSF = {};\n\n  var make_ssf = function make_ssf(SSF) {\n    SSF.version = '0.8.1';\n\n    function _strrev(x) {\n      var o = \"\",\n          i = x.length - 1;\n\n      while (i >= 0) o += x.charAt(i--);\n\n      return o;\n    }\n\n    function fill(c, l) {\n      var o = \"\";\n\n      while (o.length < l) o += c;\n\n      return o;\n    }\n\n    function pad0(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : fill('0', d - t.length) + t;\n    }\n\n    function pad_(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : fill(' ', d - t.length) + t;\n    }\n\n    function rpad_(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : t + fill(' ', d - t.length);\n    }\n\n    function pad0r1(v, d) {\n      var t = \"\" + Math.round(v);\n      return t.length >= d ? t : fill('0', d - t.length) + t;\n    }\n\n    function pad0r2(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : fill('0', d - t.length) + t;\n    }\n\n    var p2_32 = Math.pow(2, 32);\n\n    function pad0r(v, d) {\n      if (v > p2_32 || v < -p2_32) return pad0r1(v, d);\n      var i = Math.round(v);\n      return pad0r2(i, d);\n    }\n\n    function isgeneral(s, i) {\n      return s.length >= 7 + i && (s.charCodeAt(i) | 32) === 103 && (s.charCodeAt(i + 1) | 32) === 101 && (s.charCodeAt(i + 2) | 32) === 110 && (s.charCodeAt(i + 3) | 32) === 101 && (s.charCodeAt(i + 4) | 32) === 114 && (s.charCodeAt(i + 5) | 32) === 97 && (s.charCodeAt(i + 6) | 32) === 108;\n    }\n    /* Options */\n\n\n    var opts_fmt = [[\"date1904\", 0], [\"output\", \"\"], [\"WTF\", false]];\n\n    function fixopts(o) {\n      for (var y = 0; y != opts_fmt.length; ++y) if (o[opts_fmt[y][0]] === undefined) o[opts_fmt[y][0]] = opts_fmt[y][1];\n    }\n\n    SSF.opts = opts_fmt;\n    var table_fmt = {\n      0: 'General',\n      1: '0',\n      2: '0.00',\n      3: '#,##0',\n      4: '#,##0.00',\n      9: '0%',\n      10: '0.00%',\n      11: '0.00E+00',\n      12: '# ?/?',\n      13: '# ??/??',\n      14: 'm/d/yy',\n      15: 'd-mmm-yy',\n      16: 'd-mmm',\n      17: 'mmm-yy',\n      18: 'h:mm AM/PM',\n      19: 'h:mm:ss AM/PM',\n      20: 'h:mm',\n      21: 'h:mm:ss',\n      22: 'm/d/yy h:mm',\n      37: '#,##0 ;(#,##0)',\n      38: '#,##0 ;[Red](#,##0)',\n      39: '#,##0.00;(#,##0.00)',\n      40: '#,##0.00;[Red](#,##0.00)',\n      45: 'mm:ss',\n      46: '[h]:mm:ss',\n      47: 'mmss.0',\n      48: '##0.0E+0',\n      49: '@',\n      56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"',\n      65535: 'General'\n    };\n    var days = [['Sun', 'Sunday'], ['Mon', 'Monday'], ['Tue', 'Tuesday'], ['Wed', 'Wednesday'], ['Thu', 'Thursday'], ['Fri', 'Friday'], ['Sat', 'Saturday']];\n    var months = [['J', 'Jan', 'January'], ['F', 'Feb', 'February'], ['M', 'Mar', 'March'], ['A', 'Apr', 'April'], ['M', 'May', 'May'], ['J', 'Jun', 'June'], ['J', 'Jul', 'July'], ['A', 'Aug', 'August'], ['S', 'Sep', 'September'], ['O', 'Oct', 'October'], ['N', 'Nov', 'November'], ['D', 'Dec', 'December']];\n\n    function frac(x, D, mixed) {\n      var sgn = x < 0 ? -1 : 1;\n      var B = x * sgn;\n      var P_2 = 0,\n          P_1 = 1,\n          P = 0;\n      var Q_2 = 1,\n          Q_1 = 0,\n          Q = 0;\n      var A = Math.floor(B);\n\n      while (Q_1 < D) {\n        A = Math.floor(B);\n        P = A * P_1 + P_2;\n        Q = A * Q_1 + Q_2;\n        if (B - A < 0.0000000005) break;\n        B = 1 / (B - A);\n        P_2 = P_1;\n        P_1 = P;\n        Q_2 = Q_1;\n        Q_1 = Q;\n      }\n\n      if (Q > D) {\n        Q = Q_1;\n        P = P_1;\n      }\n\n      if (Q > D) {\n        Q = Q_2;\n        P = P_2;\n      }\n\n      if (!mixed) return [0, sgn * P, Q];\n      if (Q === 0) throw \"Unexpected state: \" + P + \" \" + P_1 + \" \" + P_2 + \" \" + Q + \" \" + Q_1 + \" \" + Q_2;\n      var q = Math.floor(sgn * P / Q);\n      return [q, sgn * P - q * Q, Q];\n    }\n\n    function general_fmt_int(v, opts) {\n      return \"\" + v;\n    }\n\n    SSF._general_int = general_fmt_int;\n\n    var general_fmt_num = function make_general_fmt_num() {\n      var gnr1 = /\\.(\\d*[1-9])0+$/,\n          gnr2 = /\\.0*$/,\n          gnr4 = /\\.(\\d*[1-9])0+/,\n          gnr5 = /\\.0*[Ee]/,\n          gnr6 = /(E[+-])(\\d)$/;\n\n      function gfn2(v) {\n        var w = v < 0 ? 12 : 11;\n        var o = gfn5(v.toFixed(12));\n        if (o.length <= w) return o;\n        o = v.toPrecision(10);\n        if (o.length <= w) return o;\n        return v.toExponential(5);\n      }\n\n      function gfn3(v) {\n        var o = v.toFixed(11).replace(gnr1, \".$1\");\n        if (o.length > (v < 0 ? 12 : 11)) o = v.toPrecision(6);\n        return o;\n      }\n\n      function gfn4(o) {\n        for (var i = 0; i != o.length; ++i) if ((o.charCodeAt(i) | 0x20) === 101) return o.replace(gnr4, \".$1\").replace(gnr5, \"E\").replace(\"e\", \"E\").replace(gnr6, \"$10$2\");\n\n        return o;\n      }\n\n      function gfn5(o) {\n        //for(var i = 0; i != o.length; ++i) if(o.charCodeAt(i) === 46) return o.replace(gnr2,\"\").replace(gnr1,\".$1\");\n        //return o;\n        return o.indexOf(\".\") > -1 ? o.replace(gnr2, \"\").replace(gnr1, \".$1\") : o;\n      }\n\n      return function general_fmt_num(v, opts) {\n        var V = Math.floor(Math.log(Math.abs(v)) * Math.LOG10E),\n            o;\n        if (V >= -4 && V <= -1) o = v.toPrecision(10 + V);else if (Math.abs(V) <= 9) o = gfn2(v);else if (V === 10) o = v.toFixed(10).substr(0, 12);else o = gfn3(v);\n        return gfn5(gfn4(o));\n      };\n    }();\n\n    SSF._general_num = general_fmt_num;\n\n    function general_fmt(v, opts) {\n      switch (typeof v) {\n        case 'string':\n          return v;\n\n        case 'boolean':\n          return v ? \"TRUE\" : \"FALSE\";\n\n        case 'number':\n          return (v | 0) === v ? general_fmt_int(v, opts) : general_fmt_num(v, opts);\n      }\n\n      throw new Error(\"unsupported value in General format: \" + v);\n    }\n\n    SSF._general = general_fmt;\n\n    function fix_hijri(date, o) {\n      return 0;\n    }\n\n    function parse_date_code(v, opts, b2) {\n      if (v > 2958465 || v < 0) return null;\n      var date = v | 0,\n          time = Math.floor(86400 * (v - date)),\n          dow = 0;\n      var dout = [];\n      var out = {\n        D: date,\n        T: time,\n        u: 86400 * (v - date) - time,\n        y: 0,\n        m: 0,\n        d: 0,\n        H: 0,\n        M: 0,\n        S: 0,\n        q: 0\n      };\n      if (Math.abs(out.u) < 1e-6) out.u = 0;\n      fixopts(opts != null ? opts : opts = []);\n      if (opts.date1904) date += 1462;\n\n      if (out.u > 0.999) {\n        out.u = 0;\n\n        if (++time == 86400) {\n          time = 0;\n          ++date;\n        }\n      }\n\n      if (date === 60) {\n        dout = b2 ? [1317, 10, 29] : [1900, 2, 29];\n        dow = 3;\n      } else if (date === 0) {\n        dout = b2 ? [1317, 8, 29] : [1900, 1, 0];\n        dow = 6;\n      } else {\n        if (date > 60) --date;\n        /* 1 = Jan 1 1900 */\n\n        var d = new Date(1900, 0, 1);\n        d.setDate(d.getDate() + date - 1);\n        dout = [d.getFullYear(), d.getMonth() + 1, d.getDate()];\n        dow = d.getDay();\n        if (date < 60) dow = (dow + 6) % 7;\n        if (b2) dow = fix_hijri(d, dout);\n      }\n\n      out.y = dout[0];\n      out.m = dout[1];\n      out.d = dout[2];\n      out.S = time % 60;\n      time = Math.floor(time / 60);\n      out.M = time % 60;\n      time = Math.floor(time / 60);\n      out.H = time;\n      out.q = dow;\n      return out;\n    }\n\n    SSF.parse_date_code = parse_date_code;\n    /*jshint -W086 */\n\n    function write_date(type, fmt, val, ss0) {\n      var o = \"\",\n          ss = 0,\n          tt = 0,\n          y = val.y,\n          out,\n          outl = 0;\n\n      switch (type) {\n        case 98:\n          /* 'b' buddhist year */\n          y = val.y + 543;\n\n        /* falls through */\n\n        case 121:\n          /* 'y' year */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = y % 100;\n              outl = 2;\n              break;\n\n            default:\n              out = y % 10000;\n              outl = 4;\n              break;\n          }\n\n          break;\n\n        case 109:\n          /* 'm' month */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.m;\n              outl = fmt.length;\n              break;\n\n            case 3:\n              return months[val.m - 1][1];\n\n            case 5:\n              return months[val.m - 1][0];\n\n            default:\n              return months[val.m - 1][2];\n          }\n\n          break;\n\n        case 100:\n          /* 'd' day */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.d;\n              outl = fmt.length;\n              break;\n\n            case 3:\n              return days[val.q][0];\n\n            default:\n              return days[val.q][1];\n          }\n\n          break;\n\n        case 104:\n          /* 'h' 12-hour */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = 1 + (val.H + 11) % 12;\n              outl = fmt.length;\n              break;\n\n            default:\n              throw 'bad hour format: ' + fmt;\n          }\n\n          break;\n\n        case 72:\n          /* 'H' 24-hour */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.H;\n              outl = fmt.length;\n              break;\n\n            default:\n              throw 'bad hour format: ' + fmt;\n          }\n\n          break;\n\n        case 77:\n          /* 'M' minutes */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.M;\n              outl = fmt.length;\n              break;\n\n            default:\n              throw 'bad minute format: ' + fmt;\n          }\n\n          break;\n\n        case 115:\n          /* 's' seconds */\n          if (val.u === 0) switch (fmt) {\n            case 's':\n            case 'ss':\n              return pad0(val.S, fmt.length);\n\n            case '.0':\n            case '.00':\n            case '.000':\n          }\n\n          switch (fmt) {\n            case 's':\n            case 'ss':\n            case '.0':\n            case '.00':\n            case '.000':\n              if (ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;else tt = ss0 === 1 ? 10 : 1;\n              ss = Math.round(tt * (val.S + val.u));\n              if (ss >= 60 * tt) ss = 0;\n              if (fmt === 's') return ss === 0 ? \"0\" : \"\" + ss / tt;\n              o = pad0(ss, 2 + ss0);\n              if (fmt === 'ss') return o.substr(0, 2);\n              return \".\" + o.substr(2, fmt.length - 1);\n\n            default:\n              throw 'bad second format: ' + fmt;\n          }\n\n        case 90:\n          /* 'Z' absolute time */\n          switch (fmt) {\n            case '[h]':\n            case '[hh]':\n              out = val.D * 24 + val.H;\n              break;\n\n            case '[m]':\n            case '[mm]':\n              out = (val.D * 24 + val.H) * 60 + val.M;\n              break;\n\n            case '[s]':\n            case '[ss]':\n              out = ((val.D * 24 + val.H) * 60 + val.M) * 60 + Math.round(val.S + val.u);\n              break;\n\n            default:\n              throw 'bad abstime format: ' + fmt;\n          }\n\n          outl = fmt.length === 3 ? 1 : 2;\n          break;\n\n        case 101:\n          /* 'e' era */\n          out = y;\n          outl = 1;\n      }\n\n      if (outl > 0) return pad0(out, outl);else return \"\";\n    }\n    /*jshint +W086 */\n\n\n    function commaify(s) {\n      if (s.length <= 3) return s;\n      var j = s.length % 3,\n          o = s.substr(0, j);\n\n      for (; j != s.length; j += 3) o += (o.length > 0 ? \",\" : \"\") + s.substr(j, 3);\n\n      return o;\n    }\n\n    var write_num = function make_write_num() {\n      var pct1 = /%/g;\n\n      function write_num_pct(type, fmt, val) {\n        var sfmt = fmt.replace(pct1, \"\"),\n            mul = fmt.length - sfmt.length;\n        return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n      }\n\n      function write_num_cm(type, fmt, val) {\n        var idx = fmt.length - 1;\n\n        while (fmt.charCodeAt(idx - 1) === 44) --idx;\n\n        return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n      }\n\n      function write_num_exp(fmt, val) {\n        var o;\n        var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\n        if (fmt.match(/^#+0.0E\\+0$/)) {\n          var period = fmt.indexOf(\".\");\n          if (period === -1) period = fmt.indexOf('E');\n          var ee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E) % period;\n          if (ee < 0) ee += period;\n          o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n\n          if (o.indexOf(\"e\") === -1) {\n            var fakee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E);\n            if (o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n\n            while (o.substr(0, 2) === \"0.\") {\n              o = o[0] + o.substr(2, period) + \".\" + o.substr(2 + period);\n              o = o.replace(/^0+([1-9])/, \"$1\").replace(/^0+\\./, \"0.\");\n            }\n\n            o = o.replace(/\\+-/, \"-\");\n          }\n\n          o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n            return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n          });\n        } else o = val.toExponential(idx);\n\n        if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o[o.length - 1];\n        if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n        return o.replace(\"e\", \"E\");\n      }\n\n      var frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\n\n      function write_num_f1(r, aval, sign) {\n        var den = parseInt(r[4]),\n            rr = Math.round(aval * den),\n            base = Math.floor(rr / den);\n        var myn = rr - base * den,\n            myd = den;\n        return sign + (base === 0 ? \"\" : \"\" + base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn, r[1].length) + r[2] + \"/\" + r[3] + pad0(myd, r[4].length));\n      }\n\n      function write_num_f2(r, aval, sign) {\n        return sign + (aval === 0 ? \"\" : \"\" + aval) + fill(\" \", r[1].length + 2 + r[4].length);\n      }\n\n      var dec1 = /^#*0*\\.(0+)/;\n      var closeparen = /\\).*[0#]/;\n      var phone = /\\(###\\) ###\\\\?-####/;\n\n      function hashq(str) {\n        var o = \"\",\n            cc;\n\n        for (var i = 0; i != str.length; ++i) switch (cc = str.charCodeAt(i)) {\n          case 35:\n            break;\n\n          case 63:\n            o += \" \";\n            break;\n\n          case 48:\n            o += \"0\";\n            break;\n\n          default:\n            o += String.fromCharCode(cc);\n        }\n\n        return o;\n      }\n\n      function rnd(val, d) {\n        var dd = Math.pow(10, d);\n        return \"\" + Math.round(val * dd) / dd;\n      }\n\n      function dec(val, d) {\n        return Math.round((val - Math.floor(val)) * Math.pow(10, d));\n      }\n\n      function flr(val) {\n        if (val < 2147483647 && val > -2147483648) return \"\" + (val >= 0 ? val | 0 : val - 1 | 0);\n        return \"\" + Math.floor(val);\n      }\n\n      function write_num_flt(type, fmt, val) {\n        if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n          var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n          if (val >= 0) return write_num_flt('n', ffmt, val);\n          return '(' + write_num_flt('n', ffmt, -val) + ')';\n        }\n\n        if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n        if (fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n        if (fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n        if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_flt(type, fmt.substr(fmt[1] == ' ' ? 2 : 1), val);\n        var o, oo;\n        var r,\n            ri,\n            ff,\n            aval = Math.abs(val),\n            sign = val < 0 ? \"-\" : \"\";\n        if (fmt.match(/^00+$/)) return sign + pad0r(aval, fmt.length);\n\n        if (fmt.match(/^[#?]+$/)) {\n          o = pad0r(val, 0);\n          if (o === \"0\") o = \"\";\n          return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n\n        if ((r = fmt.match(frac1)) !== null) return write_num_f1(r, aval, sign);\n        if (fmt.match(/^#+0+$/) !== null) return sign + pad0r(aval, fmt.length - fmt.indexOf(\"0\"));\n\n        if ((r = fmt.match(dec1)) !== null) {\n          o = rnd(val, r[1].length).replace(/^([^\\.]+)$/, \"$1.\" + r[1]).replace(/\\.$/, \".\" + r[1]).replace(/\\.(\\d*)$/, function ($$, $1) {\n            return \".\" + $1 + fill(\"0\", r[1].length - $1.length);\n          });\n          return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n        }\n\n        fmt = fmt.replace(/^#+([0.])/, \"$1\");\n\n        if ((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\n          return sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n        }\n\n        if ((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify(pad0r(aval, 0));\n\n        if ((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\n          return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\" + Math.floor(val)) + \".\" + pad0(dec(val, r[1].length), r[1].length);\n        }\n\n        if ((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_flt(type, fmt.replace(/^#,#*,/, \"\"), val);\n\n        if ((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\n          o = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n          ri = 0;\n          return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n            return ri < o.length ? o[ri++] : x === '0' ? '0' : \"\";\n          }));\n        }\n\n        if (fmt.match(phone) !== null) {\n          o = write_num_flt(type, \"##########\", val);\n          return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n        }\n\n        var oa = \"\";\n\n        if ((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(r[4].length, 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, false);\n          o = \"\" + sign;\n          oa = write_num(\"n\", r[1], ff[1]);\n          if (oa[oa.length - 1] == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n          o += oa + r[2] + \"/\" + r[3];\n          oa = rpad_(ff[2], ri);\n          if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n          o += oa;\n          return o;\n        }\n\n        if ((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, true);\n          return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n        }\n\n        if ((r = fmt.match(/^[#0?]+$/)) !== null) {\n          o = pad0r(val, 0);\n          if (fmt.length <= o.length) return o;\n          return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n\n        if ((r = fmt.match(/^([#0?]+)\\.([#0]+)$/)) !== null) {\n          o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n          ri = o.indexOf(\".\");\n          var lres = fmt.indexOf(\".\") - ri,\n              rres = fmt.length - o.length - lres;\n          return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n        }\n\n        if ((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\n          ri = dec(val, r[1].length);\n          return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n            return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n          }) + \".\" + pad0(ri, r[1].length);\n        }\n\n        switch (fmt) {\n          case \"#,###\":\n            var x = commaify(pad0r(aval, 0));\n            return x !== \"0\" ? sign + x : \"\";\n\n          default:\n        }\n\n        throw new Error(\"unsupported format |\" + fmt + \"|\");\n      }\n\n      function write_num_cm2(type, fmt, val) {\n        var idx = fmt.length - 1;\n\n        while (fmt.charCodeAt(idx - 1) === 44) --idx;\n\n        return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n      }\n\n      function write_num_pct2(type, fmt, val) {\n        var sfmt = fmt.replace(pct1, \"\"),\n            mul = fmt.length - sfmt.length;\n        return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n      }\n\n      function write_num_exp2(fmt, val) {\n        var o;\n        var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\n        if (fmt.match(/^#+0.0E\\+0$/)) {\n          var period = fmt.indexOf(\".\");\n          if (period === -1) period = fmt.indexOf('E');\n          var ee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E) % period;\n          if (ee < 0) ee += period;\n          o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n\n          if (!o.match(/[Ee]/)) {\n            var fakee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E);\n            if (o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n            o = o.replace(/\\+-/, \"-\");\n          }\n\n          o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n            return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n          });\n        } else o = val.toExponential(idx);\n\n        if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o[o.length - 1];\n        if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n        return o.replace(\"e\", \"E\");\n      }\n\n      function write_num_int(type, fmt, val) {\n        if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n          var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n          if (val >= 0) return write_num_int('n', ffmt, val);\n          return '(' + write_num_int('n', ffmt, -val) + ')';\n        }\n\n        if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n        if (fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n        if (fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n        if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_int(type, fmt.substr(fmt[1] == ' ' ? 2 : 1), val);\n        var o;\n        var r,\n            ri,\n            ff,\n            aval = Math.abs(val),\n            sign = val < 0 ? \"-\" : \"\";\n        if (fmt.match(/^00+$/)) return sign + pad0(aval, fmt.length);\n\n        if (fmt.match(/^[#?]+$/)) {\n          o = \"\" + val;\n          if (val === 0) o = \"\";\n          return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n\n        if ((r = fmt.match(frac1)) !== null) return write_num_f2(r, aval, sign);\n        if (fmt.match(/^#+0+$/) !== null) return sign + pad0(aval, fmt.length - fmt.indexOf(\"0\"));\n\n        if ((r = fmt.match(dec1)) !== null) {\n          o = (\"\" + val).replace(/^([^\\.]+)$/, \"$1.\" + r[1]).replace(/\\.$/, \".\" + r[1]).replace(/\\.(\\d*)$/, function ($$, $1) {\n            return \".\" + $1 + fill(\"0\", r[1].length - $1.length);\n          });\n          return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n        }\n\n        fmt = fmt.replace(/^#+([0.])/, \"$1\");\n\n        if ((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\n          return sign + (\"\" + aval).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n        }\n\n        if ((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify(\"\" + aval);\n\n        if ((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\n          return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val) + \".\" + fill('0', r[1].length);\n        }\n\n        if ((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_int(type, fmt.replace(/^#,#*,/, \"\"), val);\n\n        if ((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\n          o = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n          ri = 0;\n          return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n            return ri < o.length ? o[ri++] : x === '0' ? '0' : \"\";\n          }));\n        }\n\n        if (fmt.match(phone) !== null) {\n          o = write_num_int(type, \"##########\", val);\n          return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n        }\n\n        var oa = \"\";\n\n        if ((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(r[4].length, 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, false);\n          o = \"\" + sign;\n          oa = write_num(\"n\", r[1], ff[1]);\n          if (oa[oa.length - 1] == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n          o += oa + r[2] + \"/\" + r[3];\n          oa = rpad_(ff[2], ri);\n          if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n          o += oa;\n          return o;\n        }\n\n        if ((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, true);\n          return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n        }\n\n        if ((r = fmt.match(/^[#0?]+$/)) !== null) {\n          o = \"\" + val;\n          if (fmt.length <= o.length) return o;\n          return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n\n        if ((r = fmt.match(/^([#0]+)\\.([#0]+)$/)) !== null) {\n          o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n          ri = o.indexOf(\".\");\n          var lres = fmt.indexOf(\".\") - ri,\n              rres = fmt.length - o.length - lres;\n          return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n        }\n\n        if ((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\n          return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n            return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n          }) + \".\" + pad0(0, r[1].length);\n        }\n\n        switch (fmt) {\n          case \"#,###\":\n            var x = commaify(\"\" + aval);\n            return x !== \"0\" ? sign + x : \"\";\n\n          default:\n        }\n\n        throw new Error(\"unsupported format |\" + fmt + \"|\");\n      }\n\n      return function write_num(type, fmt, val) {\n        return (val | 0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n      };\n    }();\n\n    function split_fmt(fmt) {\n      var out = [];\n      var in_str = false,\n          cc;\n\n      for (var i = 0, j = 0; i < fmt.length; ++i) switch (cc = fmt.charCodeAt(i)) {\n        case 34:\n          /* '\"' */\n          in_str = !in_str;\n          break;\n\n        case 95:\n        case 42:\n        case 92:\n          /* '_' '*' '\\\\' */\n          ++i;\n          break;\n\n        case 59:\n          /* ';' */\n          out[out.length] = fmt.substr(j, i - j);\n          j = i + 1;\n      }\n\n      out[out.length] = fmt.substr(j);\n      if (in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n      return out;\n    }\n\n    SSF._split = split_fmt;\n    var abstime = /\\[[HhMmSs]*\\]/;\n\n    function eval_fmt(fmt, v, opts, flen) {\n      var out = [],\n          o = \"\",\n          i = 0,\n          c = \"\",\n          lst = 't',\n          q,\n          dt,\n          j,\n          cc;\n      var hr = 'H';\n      /* Tokenize */\n\n      while (i < fmt.length) {\n        switch (c = fmt[i]) {\n          case 'G':\n            /* General */\n            if (!isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n            out[out.length] = {\n              t: 'G',\n              v: 'General'\n            };\n            i += 7;\n            break;\n\n          case '\"':\n            /* Literal text */\n            for (o = \"\"; (cc = fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\n\n            out[out.length] = {\n              t: 't',\n              v: o\n            };\n            ++i;\n            break;\n\n          case '\\\\':\n            var w = fmt[++i],\n                t = w === \"(\" || w === \")\" ? w : 't';\n            out[out.length] = {\n              t: t,\n              v: w\n            };\n            ++i;\n            break;\n\n          case '_':\n            out[out.length] = {\n              t: 't',\n              v: \" \"\n            };\n            i += 2;\n            break;\n\n          case '@':\n            /* Text Placeholder */\n            out[out.length] = {\n              t: 'T',\n              v: v\n            };\n            ++i;\n            break;\n\n          case 'B':\n          case 'b':\n            if (fmt[i + 1] === \"1\" || fmt[i + 1] === \"2\") {\n              if (dt == null) {\n                dt = parse_date_code(v, opts, fmt[i + 1] === \"2\");\n                if (dt == null) return \"\";\n              }\n\n              out[out.length] = {\n                t: 'X',\n                v: fmt.substr(i, 2)\n              };\n              lst = c;\n              i += 2;\n              break;\n            }\n\n          /* falls through */\n\n          case 'M':\n          case 'D':\n          case 'Y':\n          case 'H':\n          case 'S':\n          case 'E':\n            c = c.toLowerCase();\n\n          /* falls through */\n\n          case 'm':\n          case 'd':\n          case 'y':\n          case 'h':\n          case 's':\n          case 'e':\n          case 'g':\n            if (v < 0) return \"\";\n\n            if (dt == null) {\n              dt = parse_date_code(v, opts);\n              if (dt == null) return \"\";\n            }\n\n            o = c;\n\n            while (++i < fmt.length && fmt[i].toLowerCase() === c) o += c;\n\n            if (c === 'm' && lst.toLowerCase() === 'h') c = 'M';\n            /* m = minute */\n\n            if (c === 'h') c = hr;\n            out[out.length] = {\n              t: c,\n              v: o\n            };\n            lst = c;\n            break;\n\n          case 'A':\n            q = {\n              t: c,\n              v: \"A\"\n            };\n            if (dt == null) dt = parse_date_code(v, opts);\n\n            if (fmt.substr(i, 3) === \"A/P\") {\n              if (dt != null) q.v = dt.H >= 12 ? \"P\" : \"A\";\n              q.t = 'T';\n              hr = 'h';\n              i += 3;\n            } else if (fmt.substr(i, 5) === \"AM/PM\") {\n              if (dt != null) q.v = dt.H >= 12 ? \"PM\" : \"AM\";\n              q.t = 'T';\n              i += 5;\n              hr = 'h';\n            } else {\n              q.t = \"t\";\n              ++i;\n            }\n\n            if (dt == null && q.t === 'T') return \"\";\n            out[out.length] = q;\n            lst = c;\n            break;\n\n          case '[':\n            o = c;\n\n            while (fmt[i++] !== ']' && i < fmt.length) o += fmt[i];\n\n            if (o.substr(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n\n            if (o.match(abstime)) {\n              if (dt == null) {\n                dt = parse_date_code(v, opts);\n                if (dt == null) return \"\";\n              }\n\n              out[out.length] = {\n                t: 'Z',\n                v: o.toLowerCase()\n              };\n            } else {\n              o = \"\";\n            }\n\n            break;\n\n          /* Numbers */\n\n          case '.':\n            if (dt != null) {\n              o = c;\n\n              while ((c = fmt[++i]) === \"0\") o += c;\n\n              out[out.length] = {\n                t: 's',\n                v: o\n              };\n              break;\n            }\n\n          /* falls through */\n\n          case '0':\n          case '#':\n            o = c;\n\n            while (\"0#?.,E+-%\".indexOf(c = fmt[++i]) > -1 || c == '\\\\' && fmt[i + 1] == \"-\" && \"0#\".indexOf(fmt[i + 2]) > -1) o += c;\n\n            out[out.length] = {\n              t: 'n',\n              v: o\n            };\n            break;\n\n          case '?':\n            o = c;\n\n            while (fmt[++i] === c) o += c;\n\n            q = {\n              t: c,\n              v: o\n            };\n            out[out.length] = q;\n            lst = c;\n            break;\n\n          case '*':\n            ++i;\n            if (fmt[i] == ' ' || fmt[i] == '*') ++i;\n            break;\n          // **\n\n          case '(':\n          case ')':\n            out[out.length] = {\n              t: flen === 1 ? 't' : c,\n              v: c\n            };\n            ++i;\n            break;\n\n          case '1':\n          case '2':\n          case '3':\n          case '4':\n          case '5':\n          case '6':\n          case '7':\n          case '8':\n          case '9':\n            o = c;\n\n            while (\"0123456789\".indexOf(fmt[++i]) > -1) o += fmt[i];\n\n            out[out.length] = {\n              t: 'D',\n              v: o\n            };\n            break;\n\n          case ' ':\n            out[out.length] = {\n              t: c,\n              v: c\n            };\n            ++i;\n            break;\n\n          default:\n            if (\",$-+/():!^&'~{}<>=€acfijklopqrtuvwxz\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n            out[out.length] = {\n              t: 't',\n              v: c\n            };\n            ++i;\n            break;\n        }\n      }\n\n      var bt = 0,\n          ss0 = 0,\n          ssm;\n\n      for (i = out.length - 1, lst = 't'; i >= 0; --i) {\n        switch (out[i].t) {\n          case 'h':\n          case 'H':\n            out[i].t = hr;\n            lst = 'h';\n            if (bt < 1) bt = 1;\n            break;\n\n          case 's':\n            if (ssm = out[i].v.match(/\\.0+$/)) ss0 = Math.max(ss0, ssm[0].length - 1);\n            if (bt < 3) bt = 3;\n\n          /* falls through */\n\n          case 'd':\n          case 'y':\n          case 'M':\n          case 'e':\n            lst = out[i].t;\n            break;\n\n          case 'm':\n            if (lst === 's') {\n              out[i].t = 'M';\n              if (bt < 2) bt = 2;\n            }\n\n            break;\n\n          case 'X':\n            if (out[i].v === \"B2\") ;\n            break;\n\n          case 'Z':\n            if (bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n            if (bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n            if (bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n        }\n      }\n\n      switch (bt) {\n        case 0:\n          break;\n\n        case 1:\n          if (dt.u >= 0.5) {\n            dt.u = 0;\n            ++dt.S;\n          }\n\n          if (dt.S >= 60) {\n            dt.S = 0;\n            ++dt.M;\n          }\n\n          if (dt.M >= 60) {\n            dt.M = 0;\n            ++dt.H;\n          }\n\n          break;\n\n        case 2:\n          if (dt.u >= 0.5) {\n            dt.u = 0;\n            ++dt.S;\n          }\n\n          if (dt.S >= 60) {\n            dt.S = 0;\n            ++dt.M;\n          }\n\n          break;\n      }\n      /* replace fields */\n\n\n      var nstr = \"\",\n          jj;\n\n      for (i = 0; i < out.length; ++i) {\n        switch (out[i].t) {\n          case 't':\n          case 'T':\n          case ' ':\n          case 'D':\n            break;\n\n          case 'X':\n            out[i] = undefined;\n            break;\n\n          case 'd':\n          case 'm':\n          case 'y':\n          case 'h':\n          case 'H':\n          case 'M':\n          case 's':\n          case 'e':\n          case 'b':\n          case 'Z':\n            out[i].v = write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n            out[i].t = 't';\n            break;\n\n          case 'n':\n          case '(':\n          case '?':\n            jj = i + 1;\n\n            while (out[jj] != null && ((c = out[jj].t) === \"?\" || c === \"D\" || (c === \" \" || c === \"t\") && out[jj + 1] != null && (out[jj + 1].t === '?' || out[jj + 1].t === \"t\" && out[jj + 1].v === '/') || out[i].t === '(' && (c === ' ' || c === 'n' || c === ')') || c === 't' && (out[jj].v === '/' || '$€'.indexOf(out[jj].v) > -1 || out[jj].v === ' ' && out[jj + 1] != null && out[jj + 1].t == '?'))) {\n              out[i].v += out[jj].v;\n              out[jj] = undefined;\n              ++jj;\n            }\n\n            nstr += out[i].v;\n            i = jj - 1;\n            break;\n\n          case 'G':\n            out[i].t = 't';\n            out[i].v = general_fmt(v, opts);\n            break;\n        }\n      }\n\n      var vv = \"\",\n          myv,\n          ostr;\n\n      if (nstr.length > 0) {\n        myv = v < 0 && nstr.charCodeAt(0) === 45 ? -v : v;\n        /* '-' */\n\n        ostr = write_num(nstr.charCodeAt(0) === 40 ? '(' : 'n', nstr, myv);\n        /* '(' */\n\n        jj = ostr.length - 1;\n        var decpt = out.length;\n\n        for (i = 0; i < out.length; ++i) if (out[i] != null && out[i].v.indexOf(\".\") > -1) {\n          decpt = i;\n          break;\n        }\n\n        var lasti = out.length;\n\n        if (decpt === out.length && ostr.indexOf(\"E\") === -1) {\n          for (i = out.length - 1; i >= 0; --i) {\n            if (out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\n\n            if (jj >= out[i].v.length - 1) {\n              jj -= out[i].v.length;\n              out[i].v = ostr.substr(jj + 1, out[i].v.length);\n            } else if (jj < 0) out[i].v = \"\";else {\n              out[i].v = ostr.substr(0, jj + 1);\n              jj = -1;\n            }\n\n            out[i].t = 't';\n            lasti = i;\n          }\n\n          if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n        } else if (decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n          jj = ostr.indexOf(\".\") - 1;\n\n          for (i = decpt; i >= 0; --i) {\n            if (out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\n            j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") - 1 : out[i].v.length - 1;\n            vv = out[i].v.substr(j + 1);\n\n            for (; j >= 0; --j) {\n              if (jj >= 0 && (out[i].v[j] === \"0\" || out[i].v[j] === \"#\")) vv = ostr[jj--] + vv;\n            }\n\n            out[i].v = vv;\n            out[i].t = 't';\n            lasti = i;\n          }\n\n          if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n          jj = ostr.indexOf(\".\") + 1;\n\n          for (i = decpt; i < out.length; ++i) {\n            if (out[i] == null || 'n?('.indexOf(out[i].t) === -1 && i !== decpt) continue;\n            j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") + 1 : 0;\n            vv = out[i].v.substr(0, j);\n\n            for (; j < out[i].v.length; ++j) {\n              if (jj < ostr.length) vv += ostr[jj++];\n            }\n\n            out[i].v = vv;\n            out[i].t = 't';\n            lasti = i;\n          }\n        }\n      }\n\n      for (i = 0; i < out.length; ++i) if (out[i] != null && 'n(?'.indexOf(out[i].t) > -1) {\n        myv = flen > 1 && v < 0 && i > 0 && out[i - 1].v === \"-\" ? -v : v;\n        out[i].v = write_num(out[i].t, out[i].v, myv);\n        out[i].t = 't';\n      }\n\n      var retval = \"\";\n\n      for (i = 0; i !== out.length; ++i) if (out[i] != null) retval += out[i].v;\n\n      return retval;\n    }\n\n    SSF._eval = eval_fmt;\n    var cfregex = /\\[[=<>]/;\n    var cfregex2 = /\\[([=<>]*)(-?\\d+\\.?\\d*)\\]/;\n\n    function chkcond(v, rr) {\n      if (rr == null) return false;\n      var thresh = parseFloat(rr[2]);\n\n      switch (rr[1]) {\n        case \"=\":\n          if (v == thresh) return true;\n          break;\n\n        case \">\":\n          if (v > thresh) return true;\n          break;\n\n        case \"<\":\n          if (v < thresh) return true;\n          break;\n\n        case \"<>\":\n          if (v != thresh) return true;\n          break;\n\n        case \">=\":\n          if (v >= thresh) return true;\n          break;\n\n        case \"<=\":\n          if (v <= thresh) return true;\n          break;\n      }\n\n      return false;\n    }\n\n    function choose_fmt(f, v) {\n      var fmt = split_fmt(f);\n      var l = fmt.length,\n          lat = fmt[l - 1].indexOf(\"@\");\n      if (l < 4 && lat > -1) --l;\n      if (fmt.length > 4) throw \"cannot find right format for |\" + fmt + \"|\";\n      if (typeof v !== \"number\") return [4, fmt.length === 4 || lat > -1 ? fmt[fmt.length - 1] : \"@\"];\n\n      switch (fmt.length) {\n        case 1:\n          fmt = lat > -1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"];\n          break;\n\n        case 2:\n          fmt = lat > -1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"];\n          break;\n\n        case 3:\n          fmt = lat > -1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"];\n          break;\n\n        case 4:\n          break;\n      }\n\n      var ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n      if (fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n\n      if (fmt[0].match(cfregex) != null || fmt[1].match(cfregex) != null) {\n        var m1 = fmt[0].match(cfregex2);\n        var m2 = fmt[1].match(cfregex2);\n        return chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n      }\n\n      return [l, ff];\n    }\n\n    function format(fmt, v, o) {\n      fixopts(o != null ? o : o = []);\n      var sfmt = \"\";\n\n      switch (typeof fmt) {\n        case \"string\":\n          sfmt = fmt;\n          break;\n\n        case \"number\":\n          sfmt = (o.table != null ? o.table : table_fmt)[fmt];\n          break;\n      }\n\n      if (isgeneral(sfmt, 0)) return general_fmt(v, o);\n      var f = choose_fmt(sfmt, v);\n      if (isgeneral(f[1])) return general_fmt(v, o);\n      if (v === true) v = \"TRUE\";else if (v === false) v = \"FALSE\";else if (v === \"\" || v == null) return \"\";\n      return eval_fmt(f[1], v, o, f[0]);\n    }\n\n    SSF._table = table_fmt;\n\n    SSF.load = function load_entry(fmt, idx) {\n      table_fmt[idx] = fmt;\n    };\n\n    SSF.format = format;\n\n    SSF.get_table = function get_table() {\n      return table_fmt;\n    };\n\n    SSF.load_table = function load_table(tbl) {\n      for (var i = 0; i != 0x0188; ++i) if (tbl[i] !== undefined) SSF.load(tbl[i], i);\n    };\n  };\n\n  make_ssf(SSF);\n  /* map from xlml named formats to SSF TODO: localize */\n\n  var XLMLFormatMap = {\n    \"General Number\": \"General\",\n    \"General Date\": SSF._table[22],\n    \"Long Date\": \"dddd, mmmm dd, yyyy\",\n    \"Medium Date\": SSF._table[15],\n    \"Short Date\": SSF._table[14],\n    \"Long Time\": SSF._table[19],\n    \"Medium Time\": SSF._table[18],\n    \"Short Time\": SSF._table[20],\n    \"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n    \"Fixed\": SSF._table[2],\n    \"Standard\": SSF._table[4],\n    \"Percent\": SSF._table[10],\n    \"Scientific\": SSF._table[11],\n    \"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n    \"True/False\": '\"True\";\"True\";\"False\";@',\n    \"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n  };\n  var DO_NOT_EXPORT_CFB = true;\n  /* cfb.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\n\n  /* vim: set ts=2: */\n\n  /*jshint eqnull:true */\n\n  /* [MS-CFB] v20130118 */\n\n  var CFB = function _CFB() {\n    var exports = {};\n    exports.version = '0.10.2';\n\n    function parse(file) {\n      var mver = 3; // major version\n\n      var ssz = 512; // sector size\n\n      var nmfs = 0; // number of mini FAT sectors\n\n      var ndfs = 0; // number of DIFAT sectors\n\n      var dir_start = 0; // first directory sector location\n\n      var minifat_start = 0; // first mini FAT sector location\n\n      var difat_start = 0; // first mini FAT sector location\n\n      var fat_addrs = []; // locations of FAT sectors\n\n      /* [MS-CFB] 2.2 Compound File Header */\n\n      var blob = file.slice(0, 512);\n      prep_blob(blob, 0);\n      /* major version */\n\n      var mv = check_get_mver(blob);\n      mver = mv[0];\n\n      switch (mver) {\n        case 3:\n          ssz = 512;\n          break;\n\n        case 4:\n          ssz = 4096;\n          break;\n\n        default:\n          throw \"Major Version: Expected 3 or 4 saw \" + mver;\n      }\n      /* reprocess header */\n\n\n      if (ssz !== 512) {\n        blob = file.slice(0, ssz);\n        prep_blob(blob, 28\n        /* blob.l */\n        );\n      }\n      /* Save header for final object */\n\n\n      var header = file.slice(0, ssz);\n      check_shifts(blob, mver); // Number of Directory Sectors\n\n      var nds = blob.read_shift(4, 'i');\n      if (mver === 3 && nds !== 0) throw '# Directory Sectors: Expected 0 saw ' + nds; // Number of FAT Sectors\n      //var nfs = blob.read_shift(4, 'i');\n\n      blob.l += 4; // First Directory Sector Location\n\n      dir_start = blob.read_shift(4, 'i'); // Transaction Signature\n\n      blob.l += 4; // Mini Stream Cutoff Size\n\n      blob.chk('00100000', 'Mini Stream Cutoff Size: '); // First Mini FAT Sector Location\n\n      minifat_start = blob.read_shift(4, 'i'); // Number of Mini FAT Sectors\n\n      nmfs = blob.read_shift(4, 'i'); // First DIFAT sector location\n\n      difat_start = blob.read_shift(4, 'i'); // Number of DIFAT Sectors\n\n      ndfs = blob.read_shift(4, 'i'); // Grab FAT Sector Locations\n\n      for (var q, j = 0; j < 109; ++j) {\n        /* 109 = (512 - blob.l)>>>2; */\n        q = blob.read_shift(4, 'i');\n        if (q < 0) break;\n        fat_addrs[j] = q;\n      }\n      /** Break the file up into sectors */\n\n\n      var sectors = sectorify(file, ssz);\n      sleuth_fat(difat_start, ndfs, sectors, ssz, fat_addrs);\n      /** Chains */\n\n      var sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n      sector_list[dir_start].name = \"!Directory\";\n      if (nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\n      sector_list[fat_addrs[0]].name = \"!FAT\";\n      sector_list.fat_addrs = fat_addrs;\n      sector_list.ssz = ssz;\n      /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n\n      var files = {},\n          Paths = [],\n          FileIndex = [],\n          FullPaths = [],\n          FullPathDir = {};\n      read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex);\n      build_full_paths(FileIndex, FullPathDir, FullPaths, Paths);\n      var root_name = Paths.shift();\n      Paths.root = root_name;\n      /* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\n\n      var find_path = make_find_path(FullPaths, Paths, FileIndex, files, root_name);\n      return {\n        raw: {\n          header: header,\n          sectors: sectors\n        },\n        FileIndex: FileIndex,\n        FullPaths: FullPaths,\n        FullPathDir: FullPathDir,\n        find: find_path\n      };\n    } // parse\n\n    /* [MS-CFB] 2.2 Compound File Header -- read up to major version */\n\n\n    function check_get_mver(blob) {\n      // header signature 8\n      blob.chk(HEADER_SIGNATURE, 'Header Signature: '); // clsid 16\n\n      blob.chk(HEADER_CLSID, 'CLSID: '); // minor version 2\n\n      var mver = blob.read_shift(2, 'u');\n      return [blob.read_shift(2, 'u'), mver];\n    }\n\n    function check_shifts(blob, mver) {\n      var shift = 0x09; // Byte Order\n\n      blob.chk('feff', 'Byte Order: '); // Sector Shift\n\n      switch (shift = blob.read_shift(2)) {\n        case 0x09:\n          if (mver !== 3) throw 'MajorVersion/SectorShift Mismatch';\n          break;\n\n        case 0x0c:\n          if (mver !== 4) throw 'MajorVersion/SectorShift Mismatch';\n          break;\n\n        default:\n          throw 'Sector Shift: Expected 9 or 12 saw ' + shift;\n      } // Mini Sector Shift\n\n\n      blob.chk('0600', 'Mini Sector Shift: '); // Reserved\n\n      blob.chk('000000000000', 'Reserved: ');\n    }\n    /** Break the file up into sectors */\n\n\n    function sectorify(file, ssz) {\n      var nsectors = Math.ceil(file.length / ssz) - 1;\n      var sectors = new Array(nsectors);\n\n      for (var i = 1; i < nsectors; ++i) sectors[i - 1] = file.slice(i * ssz, (i + 1) * ssz);\n\n      sectors[nsectors - 1] = file.slice(nsectors * ssz);\n      return sectors;\n    }\n    /* [MS-CFB] 2.6.4 Red-Black Tree */\n\n\n    function build_full_paths(FI, FPD, FP, Paths) {\n      var i = 0,\n          L = 0,\n          R = 0,\n          C = 0,\n          j = 0,\n          pl = Paths.length;\n      var dad = new Array(pl),\n          q = new Array(pl);\n\n      for (; i < pl; ++i) {\n        dad[i] = q[i] = i;\n        FP[i] = Paths[i];\n      }\n\n      for (; j < q.length; ++j) {\n        i = q[j];\n        L = FI[i].L;\n        R = FI[i].R;\n        C = FI[i].C;\n\n        if (dad[i] === i) {\n          if (L !== -1\n          /*NOSTREAM*/\n          && dad[L] !== L) dad[i] = dad[L];\n          if (R !== -1 && dad[R] !== R) dad[i] = dad[R];\n        }\n\n        if (C !== -1\n        /*NOSTREAM*/\n        ) dad[C] = i;\n\n        if (L !== -1) {\n          dad[L] = dad[i];\n          q.push(L);\n        }\n\n        if (R !== -1) {\n          dad[R] = dad[i];\n          q.push(R);\n        }\n      }\n\n      for (i = 1; i !== pl; ++i) if (dad[i] === i) {\n        if (R !== -1\n        /*NOSTREAM*/\n        && dad[R] !== R) dad[i] = dad[R];else if (L !== -1 && dad[L] !== L) dad[i] = dad[L];\n      }\n\n      for (i = 1; i < pl; ++i) {\n        if (FI[i].type === 0\n        /* unknown */\n        ) continue;\n        j = dad[i];\n        if (j === 0) FP[i] = FP[0] + \"/\" + FP[i];else while (j !== 0) {\n          FP[i] = FP[j] + \"/\" + FP[i];\n          j = dad[j];\n        }\n        dad[i] = 0;\n      }\n\n      FP[0] += \"/\";\n\n      for (i = 1; i < pl; ++i) {\n        if (FI[i].type !== 2\n        /* stream */\n        ) FP[i] += \"/\";\n        FPD[FP[i]] = FI[i];\n      }\n    }\n    /* [MS-CFB] 2.6.4 */\n\n\n    function make_find_path(FullPaths, Paths, FileIndex, files, root_name) {\n      var UCFullPaths = new Array(FullPaths.length);\n      var UCPaths = new Array(Paths.length),\n          i;\n\n      for (i = 0; i < FullPaths.length; ++i) UCFullPaths[i] = FullPaths[i].toUpperCase().replace(chr0, '').replace(chr1, '!');\n\n      for (i = 0; i < Paths.length; ++i) UCPaths[i] = Paths[i].toUpperCase().replace(chr0, '').replace(chr1, '!');\n\n      return function find_path(path) {\n        var k;\n\n        if (path.charCodeAt(0) === 47\n        /* \"/\" */\n        ) {\n          k = true;\n          path = root_name + path;\n        } else k = path.indexOf(\"/\") !== -1;\n\n        var UCPath = path.toUpperCase().replace(chr0, '').replace(chr1, '!');\n        var w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n        if (w === -1) return null;\n        return k === true ? FileIndex[w] : files[Paths[w]];\n      };\n    }\n    /** Chase down the rest of the DIFAT chain to build a comprehensive list\n        DIFAT chains by storing the next sector number as the last 32 bytes */\n\n\n    function sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {\n      var q;\n\n      if (idx === ENDOFCHAIN) {\n        if (cnt !== 0) throw \"DIFAT chain shorter than expected\";\n      } else if (idx !== -1\n      /*FREESECT*/\n      ) {\n        var sector = sectors[idx],\n            m = (ssz >>> 2) - 1;\n\n        for (var i = 0; i < m; ++i) {\n          if ((q = __readInt32LE(sector, i * 4)) === ENDOFCHAIN) break;\n          fat_addrs.push(q);\n        }\n\n        sleuth_fat(__readInt32LE(sector, ssz - 4), cnt - 1, sectors, ssz, fat_addrs);\n      }\n    }\n    /** Follow the linked list of sectors for a given starting point */\n\n\n    function get_sector_list(sectors, start, fat_addrs, ssz, chkd) {\n      var sl = sectors.length;\n      var buf, buf_chain;\n      if (!chkd) chkd = new Array(sl);\n      var modulus = ssz - 1,\n          j,\n          jj;\n      buf = [];\n      buf_chain = [];\n\n      for (j = start; j >= 0;) {\n        chkd[j] = true;\n        buf[buf.length] = j;\n        buf_chain.push(sectors[j]);\n        var addr = fat_addrs[Math.floor(j * 4 / ssz)];\n        jj = j * 4 & modulus;\n        if (ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \" + ssz;\n        j = __readInt32LE(sectors[addr], jj);\n      }\n\n      return {\n        nodes: buf,\n        data: __toBuffer([buf_chain])\n      };\n    }\n    /** Chase down the sector linked lists */\n\n\n    function make_sector_list(sectors, dir_start, fat_addrs, ssz) {\n      var sl = sectors.length,\n          sector_list = new Array(sl);\n      var chkd = new Array(sl),\n          buf,\n          buf_chain;\n      var modulus = ssz - 1,\n          i,\n          j,\n          k,\n          jj;\n\n      for (i = 0; i < sl; ++i) {\n        buf = [];\n        k = i + dir_start;\n        if (k >= sl) k -= sl;\n        if (chkd[k] === true) continue;\n        buf_chain = [];\n\n        for (j = k; j >= 0;) {\n          chkd[j] = true;\n          buf[buf.length] = j;\n          buf_chain.push(sectors[j]);\n          var addr = fat_addrs[Math.floor(j * 4 / ssz)];\n          jj = j * 4 & modulus;\n          if (ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \" + ssz;\n          j = __readInt32LE(sectors[addr], jj);\n        }\n\n        sector_list[k] = {\n          nodes: buf,\n          data: __toBuffer([buf_chain])\n        };\n      }\n\n      return sector_list;\n    }\n    /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n\n\n    function read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex) {\n      var blob;\n      var minifat_store = 0,\n          pl = Paths.length ? 2 : 0;\n      var sector = sector_list[dir_start].data;\n      var i = 0,\n          namelen = 0,\n          name,\n          o,\n          ctime,\n          mtime;\n\n      for (; i < sector.length; i += 128) {\n        blob = sector.slice(i, i + 128);\n        prep_blob(blob, 64);\n        namelen = blob.read_shift(2);\n        if (namelen === 0) continue;\n        name = __utf16le(blob, 0, namelen - pl);\n        Paths.push(name);\n        o = {\n          name: name,\n          type: blob.read_shift(1),\n          color: blob.read_shift(1),\n          L: blob.read_shift(4, 'i'),\n          R: blob.read_shift(4, 'i'),\n          C: blob.read_shift(4, 'i'),\n          clsid: blob.read_shift(16),\n          state: blob.read_shift(4, 'i')\n        };\n        ctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\n        if (ctime !== 0) {\n          o.ctime = ctime;\n          o.ct = read_date(blob, blob.l - 8);\n        }\n\n        mtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\n        if (mtime !== 0) {\n          o.mtime = mtime;\n          o.mt = read_date(blob, blob.l - 8);\n        }\n\n        o.start = blob.read_shift(4, 'i');\n        o.size = blob.read_shift(4, 'i');\n\n        if (o.type === 5) {\n          /* root */\n          minifat_store = o.start;\n          if (nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n          /*minifat_size = o.size;*/\n        } else if (o.size >= 4096\n        /* MSCSZ */\n        ) {\n          o.storage = 'fat';\n          if (sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n          sector_list[o.start].name = o.name;\n          o.content = sector_list[o.start].data.slice(0, o.size);\n          prep_blob(o.content, 0);\n        } else {\n          o.storage = 'minifat';\n\n          if (minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN) {\n            o.content = sector_list[minifat_store].data.slice(o.start * MSSZ, o.start * MSSZ + o.size);\n            prep_blob(o.content, 0);\n          }\n        }\n\n        files[name] = o;\n        FileIndex.push(o);\n      }\n    }\n\n    function read_date(blob, offset) {\n      return new Date((__readUInt32LE(blob, offset + 4) / 1e7 * Math.pow(2, 32) + __readUInt32LE(blob, offset) / 1e7 - 11644473600) * 1000);\n    }\n\n    var fs;\n\n    function readFileSync(filename, options) {\n      if (fs === undefined) fs = require('fs');\n      return parse(fs.readFileSync(filename), options);\n    }\n\n    function readSync(blob, options) {\n      switch (options !== undefined && options.type !== undefined ? options.type : \"base64\") {\n        case \"file\":\n          return readFileSync(blob, options);\n\n        case \"base64\":\n          return parse(s2a(Base64.decode(blob)), options);\n\n        case \"binary\":\n          return parse(s2a(blob), options);\n      }\n\n      return parse(blob);\n    }\n    /** CFB Constants */\n\n\n    var MSSZ = 64;\n    /* Mini Sector Size = 1<<6 */\n    //var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n\n    /* 2.1 Compound File Sector Numbers and Types */\n\n    var ENDOFCHAIN = -2;\n    /* 2.2 Compound File Header */\n\n    var HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\n    var HEADER_CLSID = '00000000000000000000000000000000';\n    var consts = {\n      /* 2.1 Compund File Sector Numbers and Types */\n      MAXREGSECT: -6,\n      DIFSECT: -4,\n      FATSECT: -3,\n      ENDOFCHAIN: ENDOFCHAIN,\n      FREESECT: -1,\n\n      /* 2.2 Compound File Header */\n      HEADER_SIGNATURE: HEADER_SIGNATURE,\n      HEADER_MINOR_VERSION: '3e00',\n      MAXREGSID: -6,\n      NOSTREAM: -1,\n      HEADER_CLSID: HEADER_CLSID,\n\n      /* 2.6.1 Compound File Directory Entry */\n      EntryTypes: ['unknown', 'storage', 'stream', 'lockbytes', 'property', 'root']\n    };\n    exports.read = readSync;\n    exports.parse = parse;\n    exports.utils = {\n      ReadShift: ReadShift,\n      CheckField: CheckField,\n      prep_blob: prep_blob,\n      bconcat: bconcat,\n      consts: consts\n    };\n    return exports;\n  }();\n\n  if (typeof require !== 'undefined' && typeof module !== 'undefined' && typeof DO_NOT_EXPORT_CFB === 'undefined') {\n    module.exports = CFB;\n  }\n\n  function isval(x) {\n    return x !== undefined && x !== null;\n  }\n\n  function keys(o) {\n    return Object.keys(o);\n  }\n\n  function evert_key(obj, key) {\n    var o = [],\n        K = keys(obj);\n\n    for (var i = 0; i !== K.length; ++i) o[obj[K[i]][key]] = K[i];\n\n    return o;\n  }\n\n  function evert(obj) {\n    var o = [],\n        K = keys(obj);\n\n    for (var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];\n\n    return o;\n  }\n\n  function evert_num(obj) {\n    var o = [],\n        K = keys(obj);\n\n    for (var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i], 10);\n\n    return o;\n  }\n\n  function evert_arr(obj) {\n    var o = [],\n        K = keys(obj);\n\n    for (var i = 0; i !== K.length; ++i) {\n      if (o[obj[K[i]]] == null) o[obj[K[i]]] = [];\n      o[obj[K[i]]].push(K[i]);\n    }\n\n    return o;\n  }\n  /* TODO: date1904 logic */\n\n\n  function datenum(v, date1904) {\n    if (date1904) v += 1462;\n    var epoch = Date.parse(v);\n    return (epoch + 2209161600000) / (24 * 60 * 60 * 1000);\n  }\n\n  function cc2str(arr) {\n    var o = \"\";\n\n    for (var i = 0; i != arr.length; ++i) o += String.fromCharCode(arr[i]);\n\n    return o;\n  }\n\n  function getdata(data) {\n    if (!data) return null;\n\n    if (data.name.substr(-4) === \".bin\") {\n      if (data.data) return char_codes(data.data);\n      if (data.asNodeBuffer && has_buf) return data.asNodeBuffer();\n      if (data._data && data._data.getContent) return Array.prototype.slice.call(data._data.getContent());\n    } else {\n      if (data.data) return data.name.substr(-4) !== \".bin\" ? debom_xml(data.data) : char_codes(data.data);\n      if (data.asNodeBuffer && has_buf) return debom_xml(data.asNodeBuffer().toString('binary'));\n      if (data.asBinary) return debom_xml(data.asBinary());\n      if (data._data && data._data.getContent) return debom_xml(cc2str(Array.prototype.slice.call(data._data.getContent(), 0)));\n    }\n\n    return null;\n  }\n\n  function safegetzipfile(zip, file) {\n    var f = file;\n    if (zip.files[f]) return zip.files[f];\n    var lowerCaseFiles = {};\n\n    for (var key in zip.files) {\n      lowerCaseFiles[key.toLowerCase()] = zip.files[key];\n    }\n\n    f = file.toLowerCase();\n    if (lowerCaseFiles[f]) return lowerCaseFiles[f];\n    f = f.replace(/\\//g, '\\\\');\n    if (lowerCaseFiles[f]) return lowerCaseFiles[f];\n    return null;\n  }\n\n  function getzipfile(zip, file) {\n    var o = safegetzipfile(zip, file);\n    if (o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n    return o;\n  }\n\n  function getzipdata(zip, file, safe) {\n    if (!safe) return getdata(getzipfile(zip, file));\n    if (!file) return null;\n\n    try {\n      return getzipdata(zip, file);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  var _fs, jszip;\n\n  if (typeof JSZip !== 'undefined') jszip = JSZip;\n\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      if (has_buf && typeof jszip === 'undefined') jszip = require('js' + 'zip');\n      if (typeof jszip === 'undefined') jszip = require('./js' + 'zip').JSZip;\n      _fs = require('f' + 's');\n    }\n  }\n\n  var attregexg = /([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\n  var tagregex = /<[^>]*>/g;\n  var nsregex = /<\\w*:/,\n      nsregex2 = /<(\\/?)\\w+:/;\n\n  function parsexmltag(tag, skip_root) {\n    var z = [];\n    var eq = 0,\n        c = 0;\n\n    for (; eq !== tag.length; ++eq) if ((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n\n    if (!skip_root) z[0] = tag.substr(0, eq);\n    if (eq === tag.length) return z;\n    var m = tag.match(attregexg),\n        j = 0,\n        w = \"\",\n        v = \"\",\n        i = 0,\n        q = \"\",\n        cc = \"\";\n    if (m) for (i = 0; i != m.length; ++i) {\n      cc = m[i];\n\n      for (c = 0; c != cc.length; ++c) if (cc.charCodeAt(c) === 61) break;\n\n      q = cc.substr(0, c);\n      v = cc.substring(c + 2, cc.length - 1);\n\n      for (j = 0; j != q.length; ++j) if (q.charCodeAt(j) === 58) break;\n\n      if (j === q.length) z[q] = v;else z[(j === 5 && q.substr(0, 5) === \"xmlns\" ? \"xmlns\" : \"\") + q.substr(j + 1)] = v;\n    }\n    return z;\n  }\n\n  function strip_ns(x) {\n    return x.replace(nsregex2, \"<$1\");\n  }\n\n  var encodings = {\n    '&quot;': '\"',\n    '&apos;': \"'\",\n    '&gt;': '>',\n    '&lt;': '<',\n    '&amp;': '&'\n  };\n  var rencoding = evert(encodings);\n  var rencstr = \"&<>'\\\"\".split(\"\"); // TODO: CP remap (need to read file version to determine OS)\n\n  var unescapexml = function () {\n    var encregex = /&[a-z]*;/g,\n        coderegex = /_x([\\da-fA-F]+)_/g;\n    return function unescapexml(text) {\n      var s = text + '';\n      return s.replace(encregex, function ($$) {\n        return encodings[$$];\n      }).replace(coderegex, function (m, c) {\n        return String.fromCharCode(parseInt(c, 16));\n      });\n    };\n  }();\n\n  var decregex = /[&<>'\"]/g,\n      charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\n\n  function escapexml(text) {\n    var s = text + '';\n    return s.replace(decregex, function (y) {\n      return rencoding[y];\n    }).replace(charegex, function (s) {\n      return \"_x\" + (\"000\" + s.charCodeAt(0).toString(16)).substr(-4) + \"_\";\n    });\n  }\n  /* TODO: handle codepages */\n\n\n  var xlml_fixstr = function () {\n    var entregex = /&#(\\d+);/g;\n\n    function entrepl($$, $1) {\n      return String.fromCharCode(parseInt($1, 10));\n    }\n\n    return function xlml_fixstr(str) {\n      return str.replace(entregex, entrepl);\n    };\n  }();\n\n  function parsexmlbool(value, tag) {\n    switch (value) {\n      case '1':\n      case 'true':\n      case 'TRUE':\n        return true;\n\n      /* case '0': case 'false': case 'FALSE':*/\n\n      default:\n        return false;\n    }\n  }\n\n  var utf8read = function utf8reada(orig) {\n    var out = \"\",\n        i = 0,\n        c = 0,\n        d = 0,\n        e = 0,\n        f = 0,\n        w = 0;\n\n    while (i < orig.length) {\n      c = orig.charCodeAt(i++);\n\n      if (c < 128) {\n        out += String.fromCharCode(c);\n        continue;\n      }\n\n      d = orig.charCodeAt(i++);\n\n      if (c > 191 && c < 224) {\n        out += String.fromCharCode((c & 31) << 6 | d & 63);\n        continue;\n      }\n\n      e = orig.charCodeAt(i++);\n\n      if (c < 240) {\n        out += String.fromCharCode((c & 15) << 12 | (d & 63) << 6 | e & 63);\n        continue;\n      }\n\n      f = orig.charCodeAt(i++);\n      w = ((c & 7) << 18 | (d & 63) << 12 | (e & 63) << 6 | f & 63) - 65536;\n      out += String.fromCharCode(0xD800 + (w >>> 10 & 1023));\n      out += String.fromCharCode(0xDC00 + (w & 1023));\n    }\n\n    return out;\n  };\n\n  if (has_buf) {\n    var utf8readb = function utf8readb(data) {\n      var out = new Buffer(2 * data.length),\n          w,\n          i,\n          j = 1,\n          k = 0,\n          ww = 0,\n          c;\n\n      for (i = 0; i < data.length; i += j) {\n        j = 1;\n        if ((c = data.charCodeAt(i)) < 128) w = c;else if (c < 224) {\n          w = (c & 31) * 64 + (data.charCodeAt(i + 1) & 63);\n          j = 2;\n        } else if (c < 240) {\n          w = (c & 15) * 4096 + (data.charCodeAt(i + 1) & 63) * 64 + (data.charCodeAt(i + 2) & 63);\n          j = 3;\n        } else {\n          j = 4;\n          w = (c & 7) * 262144 + (data.charCodeAt(i + 1) & 63) * 4096 + (data.charCodeAt(i + 2) & 63) * 64 + (data.charCodeAt(i + 3) & 63);\n          w -= 65536;\n          ww = 0xD800 + (w >>> 10 & 1023);\n          w = 0xDC00 + (w & 1023);\n        }\n\n        if (ww !== 0) {\n          out[k++] = ww & 255;\n          out[k++] = ww >>> 8;\n          ww = 0;\n        }\n\n        out[k++] = w % 256;\n        out[k++] = w >>> 8;\n      }\n\n      out.length = k;\n      return out.toString('ucs2');\n    };\n\n    var corpus = \"foo bar baz\\u00e2\\u0098\\u0083\\u00f0\\u009f\\u008d\\u00a3\";\n    if (utf8read(corpus) == utf8readb(corpus)) utf8read = utf8readb;\n\n    var utf8readc = function utf8readc(data) {\n      return Buffer(data, 'binary').toString('utf8');\n    };\n\n    if (utf8read(corpus) == utf8readc(corpus)) utf8read = utf8readc;\n  } // matches <foo>...</foo> extracts content\n\n\n  var matchtag = function () {\n    var mtcache = {};\n    return function matchtag(f, g) {\n      var t = f + \"|\" + g;\n      if (mtcache[t] !== undefined) return mtcache[t];\n      return mtcache[t] = new RegExp('<(?:\\\\w+:)?' + f + '(?: xml:space=\"preserve\")?(?:[^>]*)>([^\\u2603]*)</(?:\\\\w+:)?' + f + '>', g || \"\");\n    };\n  }();\n\n  var vtregex = function () {\n    var vt_cache = {};\n    return function vt_regex(bt) {\n      if (vt_cache[bt] !== undefined) return vt_cache[bt];\n      return vt_cache[bt] = new RegExp(\"<vt:\" + bt + \">(.*?)</vt:\" + bt + \">\", 'g');\n    };\n  }();\n\n  var vtvregex = /<\\/?vt:variant>/g,\n      vtmregex = /<vt:([^>]*)>(.*)</;\n\n  function parseVector(data) {\n    var h = parsexmltag(data);\n    var matches = data.match(vtregex(h.baseType)) || [];\n    if (matches.length != h.size) throw \"unexpected vector length \" + matches.length + \" != \" + h.size;\n    var res = [];\n    matches.forEach(function (x) {\n      var v = x.replace(vtvregex, \"\").match(vtmregex);\n      res.push({\n        v: v[2],\n        t: v[1]\n      });\n    });\n    return res;\n  }\n\n  var wtregex = /(^\\s|\\s$|\\n)/;\n\n  function writetag(f, g) {\n    return '<' + f + (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>';\n  }\n\n  function wxt_helper(h) {\n    return keys(h).map(function (k) {\n      return \" \" + k + '=\"' + h[k] + '\"';\n    }).join(\"\");\n  }\n\n  function writextag(f, g, h) {\n    return '<' + f + (isval(h) ? wxt_helper(h) : \"\") + (isval(g) ? (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';\n  }\n\n  function write_w3cdtf(d, t) {\n    try {\n      return d.toISOString().replace(/\\.\\d*/, \"\");\n    } catch (e) {\n      if (t) throw e;\n    }\n  }\n\n  function write_vt(s) {\n    switch (typeof s) {\n      case 'string':\n        return writextag('vt:lpwstr', s);\n\n      case 'number':\n        return writextag((s | 0) == s ? 'vt:i4' : 'vt:r8', String(s));\n\n      case 'boolean':\n        return writextag('vt:bool', s ? 'true' : 'false');\n    }\n\n    if (s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\n    throw new Error(\"Unable to serialize \" + s);\n  }\n\n  var XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\n  var XMLNS = {\n    'dc': 'http://purl.org/dc/elements/1.1/',\n    'dcterms': 'http://purl.org/dc/terms/',\n    'dcmitype': 'http://purl.org/dc/dcmitype/',\n    'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\n    'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n    'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\n    'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n    'xsd': 'http://www.w3.org/2001/XMLSchema'\n  };\n  XMLNS.main = ['http://schemas.openxmlformats.org/spreadsheetml/2006/main', 'http://purl.oclc.org/ooxml/spreadsheetml/main', 'http://schemas.microsoft.com/office/excel/2006/main', 'http://schemas.microsoft.com/office/excel/2006/2'];\n\n  function readIEEE754(buf, idx, isLE, nl, ml) {\n    if (isLE === undefined) isLE = true;\n    if (!nl) nl = 8;\n    if (!ml && nl === 8) ml = 52;\n    var e,\n        m,\n        el = nl * 8 - ml - 1,\n        eMax = (1 << el) - 1,\n        eBias = eMax >> 1;\n    var bits = -7,\n        d = isLE ? -1 : 1,\n        i = isLE ? nl - 1 : 0,\n        s = buf[idx + i];\n    i += d;\n    e = s & (1 << -bits) - 1;\n    s >>>= -bits;\n    bits += el;\n\n    for (; bits > 0; e = e * 256 + buf[idx + i], i += d, bits -= 8);\n\n    m = e & (1 << -bits) - 1;\n    e >>>= -bits;\n    bits += ml;\n\n    for (; bits > 0; m = m * 256 + buf[idx + i], i += d, bits -= 8);\n\n    if (e === eMax) return m ? NaN : (s ? -1 : 1) * Infinity;else if (e === 0) e = 1 - eBias;else {\n      m = m + Math.pow(2, ml);\n      e = e - eBias;\n    }\n    return (s ? -1 : 1) * m * Math.pow(2, e - ml);\n  }\n\n  var __toBuffer, ___toBuffer;\n\n  __toBuffer = ___toBuffer = function toBuffer_(bufs) {\n    var x = [];\n\n    for (var i = 0; i < bufs[0].length; ++i) {\n      x.push.apply(x, bufs[0][i]);\n    }\n\n    return x;\n  };\n\n  var __utf16le, ___utf16le;\n\n  __utf16le = ___utf16le = function utf16le_(b, s, e) {\n    var ss = [];\n\n    for (var i = s; i < e; i += 2) ss.push(String.fromCharCode(__readUInt16LE(b, i)));\n\n    return ss.join(\"\");\n  };\n\n  var __hexlify, ___hexlify;\n\n  __hexlify = ___hexlify = function hexlify_(b, s, l) {\n    return b.slice(s, s + l).map(function (x) {\n      return (x < 16 ? \"0\" : \"\") + x.toString(16);\n    }).join(\"\");\n  };\n\n  var __utf8, ___utf8;\n\n  __utf8 = ___utf8 = function (b, s, e) {\n    var ss = [];\n\n    for (var i = s; i < e; i++) ss.push(String.fromCharCode(__readUInt8(b, i)));\n\n    return ss.join(\"\");\n  };\n\n  var __lpstr, ___lpstr;\n\n  __lpstr = ___lpstr = function lpstr_(b, i) {\n    var len = __readUInt32LE(b, i);\n\n    return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n  };\n\n  var __lpwstr, ___lpwstr;\n\n  __lpwstr = ___lpwstr = function lpwstr_(b, i) {\n    var len = 2 * __readUInt32LE(b, i);\n\n    return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n  };\n\n  var __double, ___double;\n\n  __double = ___double = function (b, idx) {\n    return readIEEE754(b, idx);\n  };\n\n  var is_buf = function is_buf_a(a) {\n    return Array.isArray(a);\n  };\n\n  if (has_buf) {\n    __utf16le = function utf16le_b(b, s, e) {\n      if (!Buffer.isBuffer(b)) return ___utf16le(b, s, e);\n      return b.toString('utf16le', s, e);\n    };\n\n    __hexlify = function (b, s, l) {\n      return Buffer.isBuffer(b) ? b.toString('hex', s, s + l) : ___hexlify(b, s, l);\n    };\n\n    __lpstr = function lpstr_b(b, i) {\n      if (!Buffer.isBuffer(b)) return ___lpstr(b, i);\n      var len = b.readUInt32LE(i);\n      return len > 0 ? b.toString('utf8', i + 4, i + 4 + len - 1) : \"\";\n    };\n\n    __lpwstr = function lpwstr_b(b, i) {\n      if (!Buffer.isBuffer(b)) return ___lpwstr(b, i);\n      var len = 2 * b.readUInt32LE(i);\n      return b.toString('utf16le', i + 4, i + 4 + len - 1);\n    };\n\n    __utf8 = function utf8_b(s, e) {\n      return this.toString('utf8', s, e);\n    };\n\n    __toBuffer = function (bufs) {\n      return bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0]) ? Buffer.concat(bufs[0]) : ___toBuffer(bufs);\n    };\n\n    bconcat = function (bufs) {\n      return Buffer.isBuffer(bufs[0]) ? Buffer.concat(bufs) : [].concat.apply([], bufs);\n    };\n\n    __double = function double_(b, i) {\n      if (Buffer.isBuffer(b)) return b.readDoubleLE(i);\n      return ___double(b, i);\n    };\n\n    is_buf = function is_buf_b(a) {\n      return Buffer.isBuffer(a) || Array.isArray(a);\n    };\n  }\n  /* from js-xls */\n\n\n  if (typeof cptable !== 'undefined') {\n    __utf16le = function (b, s, e) {\n      return cptable.utils.decode(1200, b.slice(s, e));\n    };\n\n    __utf8 = function (b, s, e) {\n      return cptable.utils.decode(65001, b.slice(s, e));\n    };\n\n    __lpstr = function (b, i) {\n      var len = __readUInt32LE(b, i);\n\n      return len > 0 ? cptable.utils.decode(current_codepage, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n    };\n\n    __lpwstr = function (b, i) {\n      var len = 2 * __readUInt32LE(b, i);\n\n      return len > 0 ? cptable.utils.decode(1200, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n    };\n  }\n\n  var __readUInt8 = function (b, idx) {\n    return b[idx];\n  };\n\n  var __readUInt16LE = function (b, idx) {\n    return b[idx + 1] * (1 << 8) + b[idx];\n  };\n\n  var __readInt16LE = function (b, idx) {\n    var u = b[idx + 1] * (1 << 8) + b[idx];\n    return u < 0x8000 ? u : (0xffff - u + 1) * -1;\n  };\n\n  var __readUInt32LE = function (b, idx) {\n    return b[idx + 3] * (1 << 24) + (b[idx + 2] << 16) + (b[idx + 1] << 8) + b[idx];\n  };\n\n  var __readInt32LE = function (b, idx) {\n    return b[idx + 3] << 24 | b[idx + 2] << 16 | b[idx + 1] << 8 | b[idx];\n  };\n\n  var ___unhexlify = function (s) {\n    return s.match(/../g).map(function (x) {\n      return parseInt(x, 16);\n    });\n  };\n\n  var __unhexlify = typeof Buffer !== \"undefined\" ? function (s) {\n    return Buffer.isBuffer(s) ? new Buffer(s, 'hex') : ___unhexlify(s);\n  } : ___unhexlify;\n\n  function ReadShift(size, t) {\n    var o = \"\",\n        oI,\n        oR,\n        oo = [],\n        w,\n        vv,\n        i,\n        loc;\n\n    switch (t) {\n      case 'dbcs':\n        loc = this.l;\n        if (has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l + 2 * size).toString(\"utf16le\");else for (i = 0; i != size; ++i) {\n          o += String.fromCharCode(__readUInt16LE(this, loc));\n          loc += 2;\n        }\n        size *= 2;\n        break;\n\n      case 'utf8':\n        o = __utf8(this, this.l, this.l + size);\n        break;\n\n      case 'utf16le':\n        size *= 2;\n        o = __utf16le(this, this.l, this.l + size);\n        break;\n\n      /* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n\n      case 'lpstr':\n        o = __lpstr(this, this.l);\n        size = 5 + o.length;\n        break;\n\n      /* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n\n      case 'lpwstr':\n        o = __lpwstr(this, this.l);\n        size = 5 + o.length;\n        if (o[o.length - 1] == '\\u0000') size += 2;\n        break;\n\n      case 'cstr':\n        size = 0;\n        o = \"\";\n\n        while ((w = __readUInt8(this, this.l + size++)) !== 0) oo.push(_getchar(w));\n\n        o = oo.join(\"\");\n        break;\n\n      case 'wstr':\n        size = 0;\n        o = \"\";\n\n        while ((w = __readUInt16LE(this, this.l + size)) !== 0) {\n          oo.push(_getchar(w));\n          size += 2;\n        }\n\n        size += 2;\n        o = oo.join(\"\");\n        break;\n\n      /* sbcs and dbcs support continue records in the SST way TODO codepages */\n\n      case 'dbcs-cont':\n        o = \"\";\n        loc = this.l;\n\n        for (i = 0; i != size; ++i) {\n          if (this.lens && this.lens.indexOf(loc) !== -1) {\n            w = __readUInt8(this, loc);\n            this.l = loc + 1;\n            vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n            return oo.join(\"\") + vv;\n          }\n\n          oo.push(_getchar(__readUInt16LE(this, loc)));\n          loc += 2;\n        }\n\n        o = oo.join(\"\");\n        size *= 2;\n        break;\n\n      case 'sbcs-cont':\n        o = \"\";\n        loc = this.l;\n\n        for (i = 0; i != size; ++i) {\n          if (this.lens && this.lens.indexOf(loc) !== -1) {\n            w = __readUInt8(this, loc);\n            this.l = loc + 1;\n            vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n            return oo.join(\"\") + vv;\n          }\n\n          oo.push(_getchar(__readUInt8(this, loc)));\n          loc += 1;\n        }\n\n        o = oo.join(\"\");\n        break;\n\n      default:\n        switch (size) {\n          case 1:\n            oI = __readUInt8(this, this.l);\n            this.l++;\n            return oI;\n\n          case 2:\n            oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l);\n            this.l += 2;\n            return oI;\n\n          case 4:\n            if (t === 'i' || (this[this.l + 3] & 0x80) === 0) {\n              oI = __readInt32LE(this, this.l);\n              this.l += 4;\n              return oI;\n            } else {\n              oR = __readUInt32LE(this, this.l);\n              this.l += 4;\n              return oR;\n            }\n\n            break;\n\n          case 8:\n            if (t === 'f') {\n              oR = __double(this, this.l);\n              this.l += 8;\n              return oR;\n            }\n\n          /* falls through */\n\n          case 16:\n            o = __hexlify(this, this.l, size);\n            break;\n        }\n\n    }\n\n    this.l += size;\n    return o;\n  }\n\n  function WriteShift(t, val, f) {\n    var size, i;\n\n    if (f === 'dbcs') {\n      for (i = 0; i != val.length; ++i) this.writeUInt16LE(val.charCodeAt(i), this.l + 2 * i);\n\n      size = 2 * val.length;\n    } else switch (t) {\n      case 1:\n        size = 1;\n        this[this.l] = val & 255;\n        break;\n\n      case 3:\n        size = 3;\n        this[this.l + 2] = val & 255;\n        val >>>= 8;\n        this[this.l + 1] = val & 255;\n        val >>>= 8;\n        this[this.l] = val & 255;\n        break;\n\n      case 4:\n        size = 4;\n        this.writeUInt32LE(val, this.l);\n        break;\n\n      case 8:\n        size = 8;\n\n        if (f === 'f') {\n          this.writeDoubleLE(val, this.l);\n          break;\n        }\n\n      /* falls through */\n\n      case 16:\n        break;\n\n      case -4:\n        size = 4;\n        this.writeInt32LE(val, this.l);\n        break;\n    }\n\n    this.l += size;\n    return this;\n  }\n\n  function CheckField(hexstr, fld) {\n    var m = __hexlify(this, this.l, hexstr.length >> 1);\n\n    if (m !== hexstr) throw fld + 'Expected ' + hexstr + ' saw ' + m;\n    this.l += hexstr.length >> 1;\n  }\n\n  function prep_blob(blob, pos) {\n    blob.l = pos;\n    blob.read_shift = ReadShift;\n    blob.chk = CheckField;\n    blob.write_shift = WriteShift;\n  }\n\n  function parsenoop(blob, length) {\n    blob.l += length;\n  }\n\n  function writenoop(blob, length) {\n    blob.l += length;\n  }\n\n  function new_buf(sz) {\n    var o = new_raw_buf(sz);\n    prep_blob(o, 0);\n    return o;\n  }\n  /* [MS-XLSB] 2.1.4 Record */\n\n\n  function recordhopper(data, cb, opts) {\n    var tmpbyte, cntbyte, length;\n    prep_blob(data, data.l || 0);\n\n    while (data.l < data.length) {\n      var RT = data.read_shift(1);\n      if (RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F) << 7);\n      var R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\n      tmpbyte = data.read_shift(1);\n      length = tmpbyte & 0x7F;\n\n      for (cntbyte = 1; cntbyte < 4 && tmpbyte & 0x80; ++cntbyte) length += ((tmpbyte = data.read_shift(1)) & 0x7F) << 7 * cntbyte;\n\n      var d = R.f(data, length, opts);\n      if (cb(d, R, RT)) return;\n    }\n  }\n  /* control buffer usage for fixed-length buffers */\n\n\n  function buf_array() {\n    var bufs = [],\n        blksz = 2048;\n\n    var newblk = function ba_newblk(sz) {\n      var o = new_buf(sz);\n      prep_blob(o, 0);\n      return o;\n    };\n\n    var curbuf = newblk(blksz);\n\n    var endbuf = function ba_endbuf() {\n      curbuf.length = curbuf.l;\n      if (curbuf.length > 0) bufs.push(curbuf);\n      curbuf = null;\n    };\n\n    var next = function ba_next(sz) {\n      if (sz < curbuf.length - curbuf.l) return curbuf;\n      endbuf();\n      return curbuf = newblk(Math.max(sz + 1, blksz));\n    };\n\n    var end = function ba_end() {\n      endbuf();\n      return __toBuffer([bufs]);\n    };\n\n    var push = function ba_push(buf) {\n      endbuf();\n      curbuf = buf;\n      next(blksz);\n    };\n\n    return {\n      next: next,\n      push: push,\n      end: end,\n      _bufs: bufs\n    };\n  }\n\n  function write_record(ba, type, payload, length) {\n    var t = evert_RE[type],\n        l;\n    if (!length) length = XLSBRecordEnum[t].p || (payload || []).length || 0;\n    l = 1 + (t >= 0x80 ? 1 : 0) + 1 + length;\n    if (length >= 0x80) ++l;\n    if (length >= 0x4000) ++l;\n    if (length >= 0x200000) ++l;\n    var o = ba.next(l);\n    if (t <= 0x7F) o.write_shift(1, t);else {\n      o.write_shift(1, (t & 0x7F) + 0x80);\n      o.write_shift(1, t >> 7);\n    }\n\n    for (var i = 0; i != 4; ++i) {\n      if (length >= 0x80) {\n        o.write_shift(1, (length & 0x7F) + 0x80);\n        length >>= 7;\n      } else {\n        o.write_shift(1, length);\n        break;\n      }\n    }\n\n    if (length > 0 && is_buf(payload)) ba.push(payload);\n  }\n  /* XLS ranges enforced */\n\n\n  function shift_cell_xls(cell, tgt) {\n    if (tgt.s) {\n      if (cell.cRel) cell.c += tgt.s.c;\n      if (cell.rRel) cell.r += tgt.s.r;\n    } else {\n      cell.c += tgt.c;\n      cell.r += tgt.r;\n    }\n\n    cell.cRel = cell.rRel = 0;\n\n    while (cell.c >= 0x100) cell.c -= 0x100;\n\n    while (cell.r >= 0x10000) cell.r -= 0x10000;\n\n    return cell;\n  }\n\n  function shift_range_xls(cell, range) {\n    cell.s = shift_cell_xls(cell.s, range.s);\n    cell.e = shift_cell_xls(cell.e, range.s);\n    return cell;\n  }\n\n  var OFFCRYPTO = {};\n\n  var make_offcrypto = function (O, _crypto) {\n    var crypto;\n    if (typeof _crypto !== 'undefined') crypto = _crypto;else if (typeof require !== 'undefined') {\n      try {\n        crypto = require('cry' + 'pto');\n      } catch (e) {\n        crypto = null;\n      }\n    }\n\n    O.rc4 = function (key, data) {\n      var S = new Array(256);\n      var c = 0,\n          i = 0,\n          j = 0,\n          t = 0;\n\n      for (i = 0; i != 256; ++i) S[i] = i;\n\n      for (i = 0; i != 256; ++i) {\n        j = j + S[i] + key[i % key.length].charCodeAt(0) & 255;\n        t = S[i];\n        S[i] = S[j];\n        S[j] = t;\n      }\n\n      i = j = 0;\n      out = Buffer(data.length);\n\n      for (c = 0; c != data.length; ++c) {\n        i = i + 1 & 255;\n        j = (j + S[i]) % 256;\n        t = S[i];\n        S[i] = S[j];\n        S[j] = t;\n        out[c] = data[c] ^ S[S[i] + S[j] & 255];\n      }\n\n      return out;\n    };\n\n    if (crypto) {\n      O.md5 = function (hex) {\n        return crypto.createHash('md5').update(hex).digest('hex');\n      };\n    } else {\n      O.md5 = function (hex) {\n        throw \"unimplemented\";\n      };\n    }\n  };\n\n  make_offcrypto(OFFCRYPTO, typeof crypto !== \"undefined\" ? crypto : undefined);\n  /* [MS-XLSB] 2.5.143 */\n\n  function parse_StrRun(data, length) {\n    return {\n      ich: data.read_shift(2),\n      ifnt: data.read_shift(2)\n    };\n  }\n  /* [MS-XLSB] 2.1.7.121 */\n\n\n  function parse_RichStr(data, length) {\n    var start = data.l;\n    var flags = data.read_shift(1);\n    var str = parse_XLWideString(data);\n    var rgsStrRun = [];\n    var z = {\n      t: str,\n      h: str\n    };\n\n    if ((flags & 1) !== 0) {\n      /* fRichStr */\n\n      /* TODO: formatted string */\n      var dwSizeStrRun = data.read_shift(4);\n\n      for (var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));\n\n      z.r = rgsStrRun;\n    } else z.r = \"<t>\" + escapexml(str) + \"</t>\";\n\n    if ((flags & 2) !== 0) {\n      /* fExtStr */\n\n      /* TODO: phonetic string */\n    }\n\n    data.l = start + length;\n    return z;\n  }\n\n  function write_RichStr(str, o) {\n    /* TODO: formatted string */\n    if (o == null) o = new_buf(5 + 2 * str.t.length);\n    o.write_shift(1, 0);\n    write_XLWideString(str.t, o);\n    return o;\n  }\n  /* [MS-XLSB] 2.5.9 */\n\n\n  function parse_XLSBCell(data) {\n    var col = data.read_shift(4);\n    var iStyleRef = data.read_shift(2);\n    iStyleRef += data.read_shift(1) << 16;\n    var fPhShow = data.read_shift(1);\n    return {\n      c: col,\n      iStyleRef: iStyleRef\n    };\n  }\n\n  function write_XLSBCell(cell, o) {\n    if (o == null) o = new_buf(8);\n    o.write_shift(-4, cell.c);\n    o.write_shift(3, cell.iStyleRef === undefined ? cell.iStyleRef : cell.s);\n    o.write_shift(1, 0);\n    /* fPhShow */\n\n    return o;\n  }\n  /* [MS-XLSB] 2.5.21 */\n\n\n  function parse_XLSBCodeName(data, length) {\n    return parse_XLWideString(data, length);\n  }\n  /* [MS-XLSB] 2.5.166 */\n\n\n  function parse_XLNullableWideString(data) {\n    var cchCharacters = data.read_shift(4);\n    return cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n  }\n\n  function write_XLNullableWideString(data, o) {\n    if (!o) o = new_buf(127);\n    o.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\n    if (data.length > 0) o.write_shift(0, data, 'dbcs');\n    return o;\n  }\n  /* [MS-XLSB] 2.5.168 */\n\n\n  function parse_XLWideString(data) {\n    var cchCharacters = data.read_shift(4);\n    return cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n  }\n\n  function write_XLWideString(data, o) {\n    if (o == null) o = new_buf(4 + 2 * data.length);\n    o.write_shift(4, data.length);\n    if (data.length > 0) o.write_shift(0, data, 'dbcs');\n    return o;\n  }\n  /* [MS-XLSB] 2.5.114 */\n\n\n  var parse_RelID = parse_XLNullableWideString;\n  var write_RelID = write_XLNullableWideString;\n  /* [MS-XLSB] 2.5.122 */\n\n  /* [MS-XLS] 2.5.217 */\n\n  function parse_RkNumber(data) {\n    var b = data.slice(data.l, data.l + 4);\n    var fX100 = b[0] & 1,\n        fInt = b[0] & 2;\n    data.l += 4;\n    b[0] &= 0xFC; // b[0] &= ~3;\n\n    var RK = fInt === 0 ? __double([0, 0, 0, 0, b[0], b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;\n    return fX100 ? RK / 100 : RK;\n  }\n  /* [MS-XLSB] 2.5.153 */\n\n\n  function parse_UncheckedRfX(data) {\n    var cell = {\n      s: {},\n      e: {}\n    };\n    cell.s.r = data.read_shift(4);\n    cell.e.r = data.read_shift(4);\n    cell.s.c = data.read_shift(4);\n    cell.e.c = data.read_shift(4);\n    return cell;\n  }\n\n  function write_UncheckedRfX(r, o) {\n    if (!o) o = new_buf(16);\n    o.write_shift(4, r.s.r);\n    o.write_shift(4, r.e.r);\n    o.write_shift(4, r.s.c);\n    o.write_shift(4, r.e.c);\n    return o;\n  }\n  /* [MS-XLSB] 2.5.171 */\n\n  /* [MS-XLS] 2.5.342 */\n\n\n  function parse_Xnum(data, length) {\n    return data.read_shift(8, 'f');\n  }\n\n  function write_Xnum(data, o) {\n    return (o || new_buf(8)).write_shift(8, 'f', data);\n  }\n  /* [MS-XLSB] 2.5.198.2 */\n\n\n  var BErr = {\n    0x00: \"#NULL!\",\n    0x07: \"#DIV/0!\",\n    0x0F: \"#VALUE!\",\n    0x17: \"#REF!\",\n    0x1D: \"#NAME?\",\n    0x24: \"#NUM!\",\n    0x2A: \"#N/A\",\n    0x2B: \"#GETTING_DATA\",\n    0xFF: \"#WTF?\"\n  };\n  var RBErr = evert_num(BErr);\n  /* [MS-XLSB] 2.4.321 BrtColor */\n\n  function parse_BrtColor(data, length) {\n    var out = {};\n    var d = data.read_shift(1);\n    out.fValidRGB = d & 1;\n    out.xColorType = d >>> 1;\n    out.index = data.read_shift(1);\n    out.nTintAndShade = data.read_shift(2, 'i');\n    out.bRed = data.read_shift(1);\n    out.bGreen = data.read_shift(1);\n    out.bBlue = data.read_shift(1);\n    out.bAlpha = data.read_shift(1);\n  }\n  /* [MS-XLSB] 2.5.52 */\n\n\n  function parse_FontFlags(data, length) {\n    var d = data.read_shift(1);\n    data.l++;\n    var out = {\n      fItalic: d & 0x2,\n      fStrikeout: d & 0x8,\n      fOutline: d & 0x10,\n      fShadow: d & 0x20,\n      fCondense: d & 0x40,\n      fExtend: d & 0x80\n    };\n    return out;\n  }\n  /* [MS-OLEPS] 2.2 PropertyType */\n\n\n  {\n    var VT_EMPTY = 0x0000;\n    var VT_NULL = 0x0001;\n    var VT_I2 = 0x0002;\n    var VT_I4 = 0x0003;\n    var VT_R4 = 0x0004;\n    var VT_R8 = 0x0005;\n    var VT_CY = 0x0006;\n    var VT_DATE = 0x0007;\n    var VT_BSTR = 0x0008;\n    var VT_ERROR = 0x000A;\n    var VT_BOOL = 0x000B;\n    var VT_VARIANT = 0x000C;\n    var VT_DECIMAL = 0x000E;\n    var VT_I1 = 0x0010;\n    var VT_UI1 = 0x0011;\n    var VT_UI2 = 0x0012;\n    var VT_UI4 = 0x0013;\n    var VT_I8 = 0x0014;\n    var VT_UI8 = 0x0015;\n    var VT_INT = 0x0016;\n    var VT_UINT = 0x0017;\n    var VT_LPSTR = 0x001E;\n    var VT_LPWSTR = 0x001F;\n    var VT_FILETIME = 0x0040;\n    var VT_BLOB = 0x0041;\n    var VT_STREAM = 0x0042;\n    var VT_STORAGE = 0x0043;\n    var VT_STREAMED_Object = 0x0044;\n    var VT_STORED_Object = 0x0045;\n    var VT_BLOB_Object = 0x0046;\n    var VT_CF = 0x0047;\n    var VT_CLSID = 0x0048;\n    var VT_VERSIONED_STREAM = 0x0049;\n    var VT_VECTOR = 0x1000;\n    var VT_ARRAY = 0x2000;\n    var VT_STRING = 0x0050; // 2.3.3.1.11 VtString\n\n    var VT_USTR = 0x0051; // 2.3.3.1.12 VtUnalignedString\n\n    var VT_CUSTOM = [VT_STRING, VT_USTR];\n  }\n  /* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\n\n  var DocSummaryPIDDSI = {\n    0x01: {\n      n: 'CodePage',\n      t: VT_I2\n    },\n    0x02: {\n      n: 'Category',\n      t: VT_STRING\n    },\n    0x03: {\n      n: 'PresentationFormat',\n      t: VT_STRING\n    },\n    0x04: {\n      n: 'ByteCount',\n      t: VT_I4\n    },\n    0x05: {\n      n: 'LineCount',\n      t: VT_I4\n    },\n    0x06: {\n      n: 'ParagraphCount',\n      t: VT_I4\n    },\n    0x07: {\n      n: 'SlideCount',\n      t: VT_I4\n    },\n    0x08: {\n      n: 'NoteCount',\n      t: VT_I4\n    },\n    0x09: {\n      n: 'HiddenCount',\n      t: VT_I4\n    },\n    0x0a: {\n      n: 'MultimediaClipCount',\n      t: VT_I4\n    },\n    0x0b: {\n      n: 'Scale',\n      t: VT_BOOL\n    },\n    0x0c: {\n      n: 'HeadingPair',\n      t: VT_VECTOR | VT_VARIANT\n    },\n    0x0d: {\n      n: 'DocParts',\n      t: VT_VECTOR | VT_LPSTR\n    },\n    0x0e: {\n      n: 'Manager',\n      t: VT_STRING\n    },\n    0x0f: {\n      n: 'Company',\n      t: VT_STRING\n    },\n    0x10: {\n      n: 'LinksDirty',\n      t: VT_BOOL\n    },\n    0x11: {\n      n: 'CharacterCount',\n      t: VT_I4\n    },\n    0x13: {\n      n: 'SharedDoc',\n      t: VT_BOOL\n    },\n    0x16: {\n      n: 'HLinksChanged',\n      t: VT_BOOL\n    },\n    0x17: {\n      n: 'AppVersion',\n      t: VT_I4,\n      p: 'version'\n    },\n    0x1A: {\n      n: 'ContentType',\n      t: VT_STRING\n    },\n    0x1B: {\n      n: 'ContentStatus',\n      t: VT_STRING\n    },\n    0x1C: {\n      n: 'Language',\n      t: VT_STRING\n    },\n    0x1D: {\n      n: 'Version',\n      t: VT_STRING\n    },\n    0xFF: {}\n  };\n  /* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\n\n  var SummaryPIDSI = {\n    0x01: {\n      n: 'CodePage',\n      t: VT_I2\n    },\n    0x02: {\n      n: 'Title',\n      t: VT_STRING\n    },\n    0x03: {\n      n: 'Subject',\n      t: VT_STRING\n    },\n    0x04: {\n      n: 'Author',\n      t: VT_STRING\n    },\n    0x05: {\n      n: 'Keywords',\n      t: VT_STRING\n    },\n    0x06: {\n      n: 'Comments',\n      t: VT_STRING\n    },\n    0x07: {\n      n: 'Template',\n      t: VT_STRING\n    },\n    0x08: {\n      n: 'LastAuthor',\n      t: VT_STRING\n    },\n    0x09: {\n      n: 'RevNumber',\n      t: VT_STRING\n    },\n    0x0A: {\n      n: 'EditTime',\n      t: VT_FILETIME\n    },\n    0x0B: {\n      n: 'LastPrinted',\n      t: VT_FILETIME\n    },\n    0x0C: {\n      n: 'CreatedDate',\n      t: VT_FILETIME\n    },\n    0x0D: {\n      n: 'ModifiedDate',\n      t: VT_FILETIME\n    },\n    0x0E: {\n      n: 'PageCount',\n      t: VT_I4\n    },\n    0x0F: {\n      n: 'WordCount',\n      t: VT_I4\n    },\n    0x10: {\n      n: 'CharCount',\n      t: VT_I4\n    },\n    0x11: {\n      n: 'Thumbnail',\n      t: VT_CF\n    },\n    0x12: {\n      n: 'ApplicationName',\n      t: VT_LPSTR\n    },\n    0x13: {\n      n: 'DocumentSecurity',\n      t: VT_I4\n    },\n    0xFF: {}\n  };\n  /* [MS-OLEPS] 2.18 */\n\n  var SpecialProperties = {\n    0x80000000: {\n      n: 'Locale',\n      t: VT_UI4\n    },\n    0x80000003: {\n      n: 'Behavior',\n      t: VT_UI4\n    },\n    0x72627262: {}\n  };\n\n  (function () {\n    for (var y in SpecialProperties) if (SpecialProperties.hasOwnProperty(y)) DocSummaryPIDDSI[y] = SummaryPIDSI[y] = SpecialProperties[y];\n  })();\n  /* [MS-XLS] 2.4.63 Country/Region codes */\n\n\n  var CountryEnum = {\n    0x0001: \"US\",\n    // United States\n    0x0002: \"CA\",\n    // Canada\n    0x0003: \"\",\n    // Latin America (except Brazil)\n    0x0007: \"RU\",\n    // Russia\n    0x0014: \"EG\",\n    // Egypt\n    0x001E: \"GR\",\n    // Greece\n    0x001F: \"NL\",\n    // Netherlands\n    0x0020: \"BE\",\n    // Belgium\n    0x0021: \"FR\",\n    // France\n    0x0022: \"ES\",\n    // Spain\n    0x0024: \"HU\",\n    // Hungary\n    0x0027: \"IT\",\n    // Italy\n    0x0029: \"CH\",\n    // Switzerland\n    0x002B: \"AT\",\n    // Austria\n    0x002C: \"GB\",\n    // United Kingdom\n    0x002D: \"DK\",\n    // Denmark\n    0x002E: \"SE\",\n    // Sweden\n    0x002F: \"NO\",\n    // Norway\n    0x0030: \"PL\",\n    // Poland\n    0x0031: \"DE\",\n    // Germany\n    0x0034: \"MX\",\n    // Mexico\n    0x0037: \"BR\",\n    // Brazil\n    0x003d: \"AU\",\n    // Australia\n    0x0040: \"NZ\",\n    // New Zealand\n    0x0042: \"TH\",\n    // Thailand\n    0x0051: \"JP\",\n    // Japan\n    0x0052: \"KR\",\n    // Korea\n    0x0054: \"VN\",\n    // Viet Nam\n    0x0056: \"CN\",\n    // China\n    0x005A: \"TR\",\n    // Turkey\n    0x0069: \"JS\",\n    // Ramastan\n    0x00D5: \"DZ\",\n    // Algeria\n    0x00D8: \"MA\",\n    // Morocco\n    0x00DA: \"LY\",\n    // Libya\n    0x015F: \"PT\",\n    // Portugal\n    0x0162: \"IS\",\n    // Iceland\n    0x0166: \"FI\",\n    // Finland\n    0x01A4: \"CZ\",\n    // Czech Republic\n    0x0376: \"TW\",\n    // Taiwan\n    0x03C1: \"LB\",\n    // Lebanon\n    0x03C2: \"JO\",\n    // Jordan\n    0x03C3: \"SY\",\n    // Syria\n    0x03C4: \"IQ\",\n    // Iraq\n    0x03C5: \"KW\",\n    // Kuwait\n    0x03C6: \"SA\",\n    // Saudi Arabia\n    0x03CB: \"AE\",\n    // United Arab Emirates\n    0x03CC: \"IL\",\n    // Israel\n    0x03CE: \"QA\",\n    // Qatar\n    0x03D5: \"IR\",\n    // Iran\n    0xFFFF: \"US\" // United States\n\n  };\n  /* [MS-XLS] 2.5.127 */\n\n  var XLSFillPattern = [null, 'solid', 'mediumGray', 'darkGray', 'lightGray', 'darkHorizontal', 'darkVertical', 'darkDown', 'darkUp', 'darkGrid', 'darkTrellis', 'lightHorizontal', 'lightVertical', 'lightDown', 'lightUp', 'lightGrid', 'lightTrellis', 'gray125', 'gray0625'];\n\n  function rgbify(arr) {\n    return arr.map(function (x) {\n      return [x >> 16 & 255, x >> 8 & 255, x & 255];\n    });\n  }\n  /* [MS-XLS] 2.5.161 */\n\n\n  var XLSIcv = rgbify([\n  /* Color Constants */\n  0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF,\n  /* Defaults */\n  0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF, 0x800000, 0x008000, 0x000080, 0x808000, 0x800080, 0x008080, 0xC0C0C0, 0x808080, 0x9999FF, 0x993366, 0xFFFFCC, 0xCCFFFF, 0x660066, 0xFF8080, 0x0066CC, 0xCCCCFF, 0x000080, 0xFF00FF, 0xFFFF00, 0x00FFFF, 0x800080, 0x800000, 0x008080, 0x0000FF, 0x00CCFF, 0xCCFFFF, 0xCCFFCC, 0xFFFF99, 0x99CCFF, 0xFF99CC, 0xCC99FF, 0xFFCC99, 0x3366FF, 0x33CCCC, 0x99CC00, 0xFFCC00, 0xFF9900, 0xFF6600, 0x666699, 0x969696, 0x003366, 0x339966, 0x003300, 0x333300, 0x993300, 0x993366, 0x333399, 0x333333,\n  /* Sheet */\n  0xFFFFFF, 0x000000]);\n  /* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\n\n  /* 12.3 Part Summary <SpreadsheetML> */\n\n  /* 14.2 Part Summary <DrawingML> */\n\n  /* [MS-XLSX] 2.1 Part Enumerations */\n\n  /* [MS-XLSB] 2.1.7 Part Enumeration */\n\n  var ct2type = {\n    /* Workbook */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\n\n    /* Worksheet */\n    \"application/vnd.ms-excel.binIndexWs\": \"TODO\",\n\n    /* Binary Index */\n\n    /* Chartsheet */\n    \"application/vnd.ms-excel.chartsheet\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"TODO\",\n\n    /* Dialogsheet */\n    \"application/vnd.ms-excel.dialogsheet\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"TODO\",\n\n    /* Macrosheet */\n    \"application/vnd.ms-excel.macrosheet\": \"TODO\",\n    \"application/vnd.ms-excel.macrosheet+xml\": \"TODO\",\n    \"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\n    \"application/vnd.ms-excel.binIndexMs\": \"TODO\",\n\n    /* Binary Index */\n\n    /* File Properties */\n    \"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\n    \"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\n    \"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\n\n    /* Custom Data Properties */\n    \"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\n\n    /* Comments */\n    \"application/vnd.ms-excel.comments\": \"comments\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\n\n    /* PivotTable */\n    \"application/vnd.ms-excel.pivotTable\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\n\n    /* Calculation Chain */\n    \"application/vnd.ms-excel.calcChain\": \"calcchains\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\n\n    /* Printer Settings */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\n\n    /* ActiveX */\n    \"application/vnd.ms-office.activeX\": \"TODO\",\n    \"application/vnd.ms-office.activeX+xml\": \"TODO\",\n\n    /* Custom Toolbars */\n    \"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\n\n    /* External Data Connections */\n    \"application/vnd.ms-excel.connections\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\n\n    /* External Links */\n    \"application/vnd.ms-excel.externalLink\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"TODO\",\n\n    /* Metadata */\n    \"application/vnd.ms-excel.sheetMetadata\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"TODO\",\n\n    /* PivotCache */\n    \"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\n    \"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\n\n    /* Query Table */\n    \"application/vnd.ms-excel.queryTable\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\n\n    /* Shared Workbook */\n    \"application/vnd.ms-excel.userNames\": \"TODO\",\n    \"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\n    \"application/vnd.ms-excel.revisionLog\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\n\n    /* Single Cell Table */\n    \"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\n\n    /* Slicer */\n    \"application/vnd.ms-excel.slicer\": \"TODO\",\n    \"application/vnd.ms-excel.slicerCache\": \"TODO\",\n    \"application/vnd.ms-excel.slicer+xml\": \"TODO\",\n    \"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\n\n    /* Sort Map */\n    \"application/vnd.ms-excel.wsSortMap\": \"TODO\",\n\n    /* Table */\n    \"application/vnd.ms-excel.table\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\n\n    /* Themes */\n    \"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\n\n    /* Timeline */\n    \"application/vnd.ms-excel.Timeline+xml\": \"TODO\",\n\n    /* verify */\n    \"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\",\n\n    /* verify */\n\n    /* VBA */\n    \"application/vnd.ms-office.vbaProject\": \"vba\",\n    \"application/vnd.ms-office.vbaProjectSignature\": \"vba\",\n\n    /* Volatile Dependencies */\n    \"application/vnd.ms-office.volatileDependencies\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\n\n    /* Control Properties */\n    \"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\n\n    /* Data Model */\n    \"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\n\n    /* Survey */\n    \"application/vnd.ms-excel.Survey+xml\": \"TODO\",\n\n    /* Drawing */\n    \"application/vnd.openxmlformats-officedocument.drawing+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\n\n    /* VML */\n    \"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\n    \"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\n    \"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\n    \"sheet\": \"js\"\n  };\n\n  var CT_LIST = function () {\n    var o = {\n      workbooks: {\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\n        xlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n        xlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\n        xltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\n      },\n      strs: {\n        /* Shared Strings */\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\n        xlsb: \"application/vnd.ms-excel.sharedStrings\"\n      },\n      sheets: {\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\n        xlsb: \"application/vnd.ms-excel.worksheet\"\n      },\n      styles: {\n        /* Styles */\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\n        xlsb: \"application/vnd.ms-excel.styles\"\n      }\n    };\n    keys(o).forEach(function (k) {\n      if (!o[k].xlsm) o[k].xlsm = o[k].xlsx;\n    });\n    keys(o).forEach(function (k) {\n      keys(o[k]).forEach(function (v) {\n        ct2type[o[k][v]] = k;\n      });\n    });\n    return o;\n  }();\n\n  var type2ct = evert_arr(ct2type);\n  XMLNS.CT = 'http://schemas.openxmlformats.org/package/2006/content-types';\n\n  function parse_ct(data, opts) {\n    var ctext = {};\n    if (!data || !data.match) return data;\n    var ct = {\n      workbooks: [],\n      sheets: [],\n      calcchains: [],\n      themes: [],\n      styles: [],\n      coreprops: [],\n      extprops: [],\n      custprops: [],\n      strs: [],\n      comments: [],\n      vba: [],\n      TODO: [],\n      rels: [],\n      xmlns: \"\"\n    };\n    (data.match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0].replace(nsregex, \"<\")) {\n        case '<?xml':\n          break;\n\n        case '<Types':\n          ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/) || [\"\", \"\"])[1]];\n          break;\n\n        case '<Default':\n          ctext[y.Extension] = y.ContentType;\n          break;\n\n        case '<Override':\n          if (ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);else if (opts.WTF) console.error(y);\n          break;\n      }\n    });\n    if (ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\n    ct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\n    ct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\n    ct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\n    ct.defaults = ctext;\n    delete ct.calcchains;\n    return ct;\n  }\n\n  var CTYPE_XML_ROOT = writextag('Types', null, {\n    'xmlns': XMLNS.CT,\n    'xmlns:xsd': XMLNS.xsd,\n    'xmlns:xsi': XMLNS.xsi\n  });\n  var CTYPE_DEFAULTS = [['xml', 'application/xml'], ['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'], ['rels', type2ct.rels[0]]].map(function (x) {\n    return writextag('Default', null, {\n      'Extension': x[0],\n      'ContentType': x[1]\n    });\n  });\n\n  function write_ct(ct, opts) {\n    var o = [],\n        v;\n    o[o.length] = XML_HEADER;\n    o[o.length] = CTYPE_XML_ROOT;\n    o = o.concat(CTYPE_DEFAULTS);\n\n    var f1 = function (w) {\n      if (ct[w] && ct[w].length > 0) {\n        v = ct[w][0];\n        o[o.length] = writextag('Override', null, {\n          'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n          'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\n        });\n      }\n    };\n\n    var f2 = function (w) {\n      ct[w].forEach(function (v) {\n        o[o.length] = writextag('Override', null, {\n          'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n          'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\n        });\n      });\n    };\n\n    var f3 = function (t) {\n      (ct[t] || []).forEach(function (v) {\n        o[o.length] = writextag('Override', null, {\n          'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n          'ContentType': type2ct[t][0]\n        });\n      });\n    };\n\n    f1('workbooks');\n    f2('sheets');\n    f3('themes');\n    ['strs', 'styles'].forEach(f1);\n    ['coreprops', 'extprops', 'custprops'].forEach(f3);\n\n    if (o.length > 2) {\n      o[o.length] = '</Types>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* 9.3.2 OPC Relationships Markup */\n\n\n  var RELS = {\n    WB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n    SHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\"\n  };\n\n  function parse_rels(data, currentFilePath) {\n    if (!data) return data;\n\n    if (currentFilePath.charAt(0) !== '/') {\n      currentFilePath = '/' + currentFilePath;\n    }\n\n    var rels = {};\n    var hash = {};\n\n    var resolveRelativePathIntoAbsolute = function (to) {\n      var toksFrom = currentFilePath.split('/');\n      toksFrom.pop(); // folder path\n\n      var toksTo = to.split('/');\n      var reversed = [];\n\n      while (toksTo.length !== 0) {\n        var tokTo = toksTo.shift();\n\n        if (tokTo === '..') {\n          toksFrom.pop();\n        } else if (tokTo !== '.') {\n          toksFrom.push(tokTo);\n        }\n      }\n\n      return toksFrom.join('/');\n    };\n\n    data.match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n      /* 9.3.2.2 OPC_Relationships */\n\n      if (y[0] === '<Relationship') {\n        var rel = {};\n        rel.Type = y.Type;\n        rel.Target = y.Target;\n        rel.Id = y.Id;\n        rel.TargetMode = y.TargetMode;\n        var canonictarget = y.TargetMode === 'External' ? y.Target : resolveRelativePathIntoAbsolute(y.Target);\n        rels[canonictarget] = rel;\n        hash[y.Id] = rel;\n      }\n    });\n    rels[\"!id\"] = hash;\n    return rels;\n  }\n\n  XMLNS.RELS = 'http://schemas.openxmlformats.org/package/2006/relationships';\n  var RELS_ROOT = writextag('Relationships', null, {\n    //'xmlns:ns0': XMLNS.RELS,\n    'xmlns': XMLNS.RELS\n  });\n  /* TODO */\n\n  function write_rels(rels) {\n    var o = [];\n    o[o.length] = XML_HEADER;\n    o[o.length] = RELS_ROOT;\n    keys(rels['!id']).forEach(function (rid) {\n      var rel = rels['!id'][rid];\n      o[o.length] = writextag('Relationship', null, rel);\n    });\n\n    if (o.length > 2) {\n      o[o.length] = '</Relationships>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* ECMA-376 Part II 11.1 Core Properties Part */\n\n  /* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\n\n\n  var CORE_PROPS = [[\"cp:category\", \"Category\"], [\"cp:contentStatus\", \"ContentStatus\"], [\"cp:keywords\", \"Keywords\"], [\"cp:lastModifiedBy\", \"LastAuthor\"], [\"cp:lastPrinted\", \"LastPrinted\"], [\"cp:revision\", \"RevNumber\"], [\"cp:version\", \"Version\"], [\"dc:creator\", \"Author\"], [\"dc:description\", \"Comments\"], [\"dc:identifier\", \"Identifier\"], [\"dc:language\", \"Language\"], [\"dc:subject\", \"Subject\"], [\"dc:title\", \"Title\"], [\"dcterms:created\", \"CreatedDate\", 'date'], [\"dcterms:modified\", \"ModifiedDate\", 'date']];\n  XMLNS.CORE_PROPS = \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\";\n  RELS.CORE_PROPS = 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties';\n\n  var CORE_PROPS_REGEX = function () {\n    var r = new Array(CORE_PROPS.length);\n\n    for (var i = 0; i < CORE_PROPS.length; ++i) {\n      var f = CORE_PROPS[i];\n      var g = \"(?:\" + f[0].substr(0, f[0].indexOf(\":\")) + \":)\" + f[0].substr(f[0].indexOf(\":\") + 1);\n      r[i] = new RegExp(\"<\" + g + \"[^>]*>(.*)<\\/\" + g + \">\");\n    }\n\n    return r;\n  }();\n\n  function parse_core_props(data) {\n    var p = {};\n\n    for (var i = 0; i < CORE_PROPS.length; ++i) {\n      var f = CORE_PROPS[i],\n          cur = data.match(CORE_PROPS_REGEX[i]);\n      if (cur != null && cur.length > 0) p[f[1]] = cur[1];\n      if (f[2] === 'date' && p[f[1]]) p[f[1]] = new Date(p[f[1]]);\n    }\n\n    return p;\n  }\n\n  var CORE_PROPS_XML_ROOT = writextag('cp:coreProperties', null, {\n    //'xmlns': XMLNS.CORE_PROPS,\n    'xmlns:cp': XMLNS.CORE_PROPS,\n    'xmlns:dc': XMLNS.dc,\n    'xmlns:dcterms': XMLNS.dcterms,\n    'xmlns:dcmitype': XMLNS.dcmitype,\n    'xmlns:xsi': XMLNS.xsi\n  });\n\n  function cp_doit(f, g, h, o, p) {\n    if (p[f] != null || g == null || g === \"\") return;\n    p[f] = g;\n    o[o.length] = h ? writextag(f, g, h) : writetag(f, g);\n  }\n\n  function write_core_props(cp, opts) {\n    var o = [XML_HEADER, CORE_PROPS_XML_ROOT],\n        p = {};\n\n    if (opts && opts.Props) {\n      if (opts.Props.title) o[o.length] = '<dc:title>' + opts.Props.title + '</dc:title>';\n      if (opts.Props.subject) o[o.length] = '<dc:subject>' + opts.Props.subject + '</dc:subject>';\n      if (opts.Props.creator) o[o.length] = '<dc:creator>' + opts.Props.creator + '</dc:creator>';\n      if (opts.Props.keywords) o[o.length] = '<cp:keywords>' + opts.Props.keywords + '</cp:keywords>';\n      if (opts.Props.description) o[o.length] = '<dc:description>' + opts.Props.description + '</dc:description>';\n    }\n\n    if (cp) {\n      if (cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {\n        \"xsi:type\": \"dcterms:W3CDTF\"\n      }, o, p);\n      if (cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {\n        \"xsi:type\": \"dcterms:W3CDTF\"\n      }, o, p);\n\n      for (var i = 0; i != CORE_PROPS.length; ++i) {\n        var f = CORE_PROPS[i];\n        cp_doit(f[0], cp[f[1]], null, o, p);\n      }\n    }\n\n    if (o.length > 2) {\n      o[o.length] = '</cp:coreProperties>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* 15.2.12.3 Extended File Properties Part */\n\n  /* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\n\n\n  var EXT_PROPS = [[\"Application\", \"Application\", \"string\"], [\"AppVersion\", \"AppVersion\", \"string\"], [\"Company\", \"Company\", \"string\"], [\"DocSecurity\", \"DocSecurity\", \"string\"], [\"Manager\", \"Manager\", \"string\"], [\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"], [\"SharedDoc\", \"SharedDoc\", \"bool\"], [\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"], [\"ScaleCrop\", \"ScaleCrop\", \"bool\"], [\"HeadingPairs\", \"HeadingPairs\", \"raw\"], [\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]];\n  XMLNS.EXT_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\";\n  RELS.EXT_PROPS = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties';\n\n  function parse_ext_props(data, p) {\n    var q = {};\n    if (!p) p = {};\n    EXT_PROPS.forEach(function (f) {\n      switch (f[2]) {\n        case \"string\":\n          p[f[1]] = (data.match(matchtag(f[0])) || [])[1];\n          break;\n\n        case \"bool\":\n          p[f[1]] = (data.match(matchtag(f[0])) || [])[1] === \"true\";\n          break;\n\n        case \"raw\":\n          var cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>(.*)<\\/\" + f[0] + \">\"));\n          if (cur && cur.length > 0) q[f[1]] = cur[1];\n          break;\n      }\n    });\n\n    if (q.HeadingPairs && q.TitlesOfParts) {\n      var v = parseVector(q.HeadingPairs);\n      var j = 0,\n          widx = 0;\n\n      for (var i = 0; i !== v.length; ++i) {\n        switch (v[i].v) {\n          case \"Worksheets\":\n            widx = j;\n            p.Worksheets = +v[++i].v;\n            break;\n\n          case \"Named Ranges\":\n            ++i;\n            break;\n          // TODO: Handle Named Ranges\n        }\n      }\n\n      var parts = parseVector(q.TitlesOfParts).map(function (x) {\n        return utf8read(x.v);\n      });\n      p.SheetNames = parts.slice(widx, widx + p.Worksheets);\n    }\n\n    return p;\n  }\n\n  var EXT_PROPS_XML_ROOT = writextag('Properties', null, {\n    'xmlns': XMLNS.EXT_PROPS,\n    'xmlns:vt': XMLNS.vt\n  });\n\n  function write_ext_props(cp, opts) {\n    var o = [],\n        p = {},\n        W = writextag;\n    if (!cp) cp = {};\n    cp.Application = \"SheetJS\";\n    o[o.length] = XML_HEADER;\n    o[o.length] = EXT_PROPS_XML_ROOT;\n    EXT_PROPS.forEach(function (f) {\n      if (cp[f[1]] === undefined) return;\n      var v;\n\n      switch (f[2]) {\n        case 'string':\n          v = cp[f[1]];\n          break;\n\n        case 'bool':\n          v = cp[f[1]] ? 'true' : 'false';\n          break;\n      }\n\n      if (v !== undefined) o[o.length] = W(f[0], v);\n    });\n    /* TODO: HeadingPairs, TitlesOfParts */\n\n    o[o.length] = W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>') + W('vt:variant', W('vt:i4', String(cp.Worksheets))), {\n      size: 2,\n      baseType: \"variant\"\n    }));\n    o[o.length] = W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function (s) {\n      return \"<vt:lpstr>\" + s + \"</vt:lpstr>\";\n    }).join(\"\"), {\n      size: cp.Worksheets,\n      baseType: \"lpstr\"\n    }));\n\n    if (o.length > 2) {\n      o[o.length] = '</Properties>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* 15.2.12.2 Custom File Properties Part */\n\n\n  XMLNS.CUST_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\";\n  RELS.CUST_PROPS = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties';\n  var custregex = /<[^>]+>[^<]*/g;\n\n  function parse_cust_props(data, opts) {\n    var p = {},\n        name;\n    var m = data.match(custregex);\n    if (m) for (var i = 0; i != m.length; ++i) {\n      var x = m[i],\n          y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<?xml':\n          break;\n\n        case '<Properties':\n          if (y.xmlns !== XMLNS.CUST_PROPS) throw \"unrecognized xmlns \" + y.xmlns;\n          if (y.xmlnsvt && y.xmlnsvt !== XMLNS.vt) throw \"unrecognized vt \" + y.xmlnsvt;\n          break;\n\n        case '<property':\n          name = y.name;\n          break;\n\n        case '</property>':\n          name = null;\n          break;\n\n        default:\n          if (x.indexOf('<vt:') === 0) {\n            var toks = x.split('>');\n            var type = toks[0].substring(4),\n                text = toks[1];\n            /* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\n\n            switch (type) {\n              case 'lpstr':\n              case 'lpwstr':\n              case 'bstr':\n              case 'lpwstr':\n                p[name] = unescapexml(text);\n                break;\n\n              case 'bool':\n                p[name] = parsexmlbool(text, '<vt:bool>');\n                break;\n\n              case 'i1':\n              case 'i2':\n              case 'i4':\n              case 'i8':\n              case 'int':\n              case 'uint':\n                p[name] = parseInt(text, 10);\n                break;\n\n              case 'r4':\n              case 'r8':\n              case 'decimal':\n                p[name] = parseFloat(text);\n                break;\n\n              case 'filetime':\n              case 'date':\n                p[name] = new Date(text);\n                break;\n\n              case 'cy':\n              case 'error':\n                p[name] = unescapexml(text);\n                break;\n\n              default:\n                if (typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\n            }\n          } else if (x.substr(0, 2) === \"</\") {} else if (opts.WTF) throw new Error(x);\n\n      }\n    }\n    return p;\n  }\n\n  var CUST_PROPS_XML_ROOT = writextag('Properties', null, {\n    'xmlns': XMLNS.CUST_PROPS,\n    'xmlns:vt': XMLNS.vt\n  });\n\n  function write_cust_props(cp, opts) {\n    var o = [XML_HEADER, CUST_PROPS_XML_ROOT];\n    if (!cp) return o.join(\"\");\n    var pid = 1;\n    keys(cp).forEach(function custprop(k) {\n      ++pid;\n      o[o.length] = writextag('property', write_vt(cp[k]), {\n        'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\n        'pid': pid,\n        'name': k\n      });\n    });\n\n    if (o.length > 2) {\n      o[o.length] = '</Properties>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n\n  function xlml_set_prop(Props, tag, val) {\n    /* TODO: Normalize the properties */\n    switch (tag) {\n      case 'Description':\n        tag = 'Comments';\n        break;\n    }\n\n    Props[tag] = val;\n  }\n  /* [MS-DTYP] 2.3.3 FILETIME */\n\n  /* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n\n  /* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\n\n\n  function parse_FILETIME(blob) {\n    var dwLowDateTime = blob.read_shift(4),\n        dwHighDateTime = blob.read_shift(4);\n    return new Date((dwHighDateTime / 1e7 * Math.pow(2, 32) + dwLowDateTime / 1e7 - 11644473600) * 1000).toISOString().replace(/\\.000/, \"\");\n  }\n  /* [MS-OSHARED] 2.3.3.1.4 Lpstr */\n\n\n  function parse_lpstr(blob, type, pad) {\n    var str = blob.read_shift(0, 'lpstr');\n    if (pad) blob.l += 4 - (str.length + 1 & 3) & 3;\n    return str;\n  }\n  /* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\n\n\n  function parse_lpwstr(blob, type, pad) {\n    var str = blob.read_shift(0, 'lpwstr');\n    if (pad) blob.l += 4 - (str.length + 1 & 3) & 3;\n    return str;\n  }\n  /* [MS-OSHARED] 2.3.3.1.11 VtString */\n\n  /* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\n\n\n  function parse_VtStringBase(blob, stringType, pad) {\n    if (stringType === 0x1F\n    /*VT_LPWSTR*/\n    ) return parse_lpwstr(blob);\n    return parse_lpstr(blob, stringType, pad);\n  }\n\n  function parse_VtString(blob, t, pad) {\n    return parse_VtStringBase(blob, t, pad === false ? 0 : 4);\n  }\n\n  function parse_VtUnalignedString(blob, t) {\n    if (!t) throw new Error(\"dafuq?\");\n    return parse_VtStringBase(blob, t, 0);\n  }\n  /* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\n\n\n  function parse_VtVecUnalignedLpstrValue(blob) {\n    var length = blob.read_shift(4);\n    var ret = [];\n\n    for (var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr');\n\n    return ret;\n  }\n  /* [MS-OSHARED] 2.3.3.1.10 VtVecUnalignedLpstr */\n\n\n  function parse_VtVecUnalignedLpstr(blob) {\n    return parse_VtVecUnalignedLpstrValue(blob);\n  }\n  /* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\n\n\n  function parse_VtHeadingPair(blob) {\n    var headingString = parse_TypedPropertyValue(blob, VT_USTR);\n    var headerParts = parse_TypedPropertyValue(blob, VT_I4);\n    return [headingString, headerParts];\n  }\n  /* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\n\n\n  function parse_VtVecHeadingPairValue(blob) {\n    var cElements = blob.read_shift(4);\n    var out = [];\n\n    for (var i = 0; i != cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\n\n    return out;\n  }\n  /* [MS-OSHARED] 2.3.3.1.15 VtVecHeadingPair */\n\n\n  function parse_VtVecHeadingPair(blob) {\n    // NOTE: When invoked, wType & padding were already consumed\n    return parse_VtVecHeadingPairValue(blob);\n  }\n  /* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\n\n\n  function parse_dictionary(blob, CodePage) {\n    var cnt = blob.read_shift(4);\n    var dict = {};\n\n    for (var j = 0; j != cnt; ++j) {\n      var pid = blob.read_shift(4);\n      var len = blob.read_shift(4);\n      dict[pid] = blob.read_shift(len, CodePage === 0x4B0 ? 'utf16le' : 'utf8').replace(chr0, '').replace(chr1, '!');\n    }\n\n    if (blob.l & 3) blob.l = blob.l >> 2 + 1 << 2;\n    return dict;\n  }\n  /* [MS-OLEPS] 2.9 BLOB */\n\n\n  function parse_BLOB(blob) {\n    var size = blob.read_shift(4);\n    var bytes = blob.slice(blob.l, blob.l + size);\n    if (size & 3 > 0) blob.l += 4 - (size & 3) & 3;\n    return bytes;\n  }\n  /* [MS-OLEPS] 2.11 ClipboardData */\n\n\n  function parse_ClipboardData(blob) {\n    // TODO\n    var o = {};\n    o.Size = blob.read_shift(4); //o.Format = blob.read_shift(4);\n\n    blob.l += o.Size;\n    return o;\n  }\n  /* [MS-OLEPS] 2.14 Vector and Array Property Types */\n\n\n  function parse_VtVector(blob, cb) {\n    /* [MS-OLEPS] 2.14.2 VectorHeader */\n\n    /*\tvar Length = blob.read_shift(4);\n    \tvar o = [];\n    \tfor(var i = 0; i != Length; ++i) {\n    \t\to.push(cb(blob));\n    \t}\n    \treturn o;*/\n  }\n  /* [MS-OLEPS] 2.15 TypedPropertyValue */\n\n\n  function parse_TypedPropertyValue(blob, type, _opts) {\n    var t = blob.read_shift(2),\n        ret,\n        opts = _opts || {};\n    blob.l += 2;\n    if (type !== VT_VARIANT) if (t !== type && VT_CUSTOM.indexOf(type) === -1) throw new Error('Expected type ' + type + ' saw ' + t);\n\n    switch (type === VT_VARIANT ? t : type) {\n      case 0x02\n      /*VT_I2*/\n      :\n        ret = blob.read_shift(2, 'i');\n        if (!opts.raw) blob.l += 2;\n        return ret;\n\n      case 0x03\n      /*VT_I4*/\n      :\n        ret = blob.read_shift(4, 'i');\n        return ret;\n\n      case 0x0B\n      /*VT_BOOL*/\n      :\n        return blob.read_shift(4) !== 0x0;\n\n      case 0x13\n      /*VT_UI4*/\n      :\n        ret = blob.read_shift(4);\n        return ret;\n\n      case 0x1E\n      /*VT_LPSTR*/\n      :\n        return parse_lpstr(blob, t, 4).replace(chr0, '');\n\n      case 0x1F\n      /*VT_LPWSTR*/\n      :\n        return parse_lpwstr(blob);\n\n      case 0x40\n      /*VT_FILETIME*/\n      :\n        return parse_FILETIME(blob);\n\n      case 0x41\n      /*VT_BLOB*/\n      :\n        return parse_BLOB(blob);\n\n      case 0x47\n      /*VT_CF*/\n      :\n        return parse_ClipboardData(blob);\n\n      case 0x50\n      /*VT_STRING*/\n      :\n        return parse_VtString(blob, t, !opts.raw && 4).replace(chr0, '');\n\n      case 0x51\n      /*VT_USTR*/\n      :\n        return parse_VtUnalignedString(blob, t, 4).replace(chr0, '');\n\n      case 0x100C\n      /*VT_VECTOR|VT_VARIANT*/\n      :\n        return parse_VtVecHeadingPair(blob);\n\n      case 0x101E\n      /*VT_LPSTR*/\n      :\n        return parse_VtVecUnalignedLpstr(blob);\n\n      default:\n        throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n    }\n  }\n  /* [MS-OLEPS] 2.14.2 VectorHeader */\n\n  /*function parse_VTVectorVariant(blob) {\n  \tvar Length = blob.read_shift(4);\n  \n  \tif(Length & 1 !== 0) throw new Error(\"VectorHeader Length=\" + Length + \" must be even\");\n  \tvar o = [];\n  \tfor(var i = 0; i != Length; ++i) {\n  \t\to.push(parse_TypedPropertyValue(blob, VT_VARIANT));\n  \t}\n  \treturn o;\n  }*/\n\n  /* [MS-OLEPS] 2.20 PropertySet */\n\n\n  function parse_PropertySet(blob, PIDSI) {\n    var start_addr = blob.l;\n    var size = blob.read_shift(4);\n    var NumProps = blob.read_shift(4);\n    var Props = [],\n        i = 0;\n    var CodePage = 0;\n    var Dictionary = -1,\n        DictObj;\n\n    for (i = 0; i != NumProps; ++i) {\n      var PropID = blob.read_shift(4);\n      var Offset = blob.read_shift(4);\n      Props[i] = [PropID, Offset + start_addr];\n    }\n\n    var PropH = {};\n\n    for (i = 0; i != NumProps; ++i) {\n      if (blob.l !== Props[i][1]) {\n        var fail = true;\n        if (i > 0 && PIDSI) switch (PIDSI[Props[i - 1][0]].t) {\n          case 0x02\n          /*VT_I2*/\n          :\n            if (blob.l + 2 === Props[i][1]) {\n              blob.l += 2;\n              fail = false;\n            }\n\n            break;\n\n          case 0x50\n          /*VT_STRING*/\n          :\n            if (blob.l <= Props[i][1]) {\n              blob.l = Props[i][1];\n              fail = false;\n            }\n\n            break;\n\n          case 0x100C\n          /*VT_VECTOR|VT_VARIANT*/\n          :\n            if (blob.l <= Props[i][1]) {\n              blob.l = Props[i][1];\n              fail = false;\n            }\n\n            break;\n        }\n\n        if (!PIDSI && blob.l <= Props[i][1]) {\n          fail = false;\n          blob.l = Props[i][1];\n        }\n\n        if (fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n      }\n\n      if (PIDSI) {\n        var piddsi = PIDSI[Props[i][0]];\n        PropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {\n          raw: true\n        });\n        if (piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + String(PropH[piddsi.n] & 0xFFFF);\n        if (piddsi.n == \"CodePage\") switch (PropH[piddsi.n]) {\n          case 0:\n            PropH[piddsi.n] = 1252;\n\n          /* falls through */\n\n          case 10000: // OSX Roman\n\n          case 1252: // Windows Latin\n\n          case 874: // SB Windows Thai\n\n          case 1250: // SB Windows Central Europe\n\n          case 1251: // SB Windows Cyrillic\n\n          case 1253: // SB Windows Greek\n\n          case 1254: // SB Windows Turkish\n\n          case 1255: // SB Windows Hebrew\n\n          case 1256: // SB Windows Arabic\n\n          case 1257: // SB Windows Baltic\n\n          case 1258: // SB Windows Vietnam\n\n          case 932: // DB Windows Japanese Shift-JIS\n\n          case 936: // DB Windows Simplified Chinese GBK\n\n          case 949: // DB Windows Korean\n\n          case 950: // DB Windows Traditional Chinese Big5\n\n          case 1200: // UTF16LE\n\n          case 1201: // UTF16BE\n\n          case 65000:\n          case -536: // UTF-7\n\n          case 65001:\n          case -535:\n            // UTF-8\n            set_cp(CodePage = PropH[piddsi.n]);\n            break;\n\n          default:\n            throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n        }\n      } else {\n        if (Props[i][0] === 0x1) {\n          CodePage = PropH.CodePage = parse_TypedPropertyValue(blob, VT_I2);\n          set_cp(CodePage);\n\n          if (Dictionary !== -1) {\n            var oldpos = blob.l;\n            blob.l = Props[Dictionary][1];\n            DictObj = parse_dictionary(blob, CodePage);\n            blob.l = oldpos;\n          }\n        } else if (Props[i][0] === 0) {\n          if (CodePage === 0) {\n            Dictionary = i;\n            blob.l = Props[i + 1][1];\n            continue;\n          }\n\n          DictObj = parse_dictionary(blob, CodePage);\n        } else {\n          var name = DictObj[Props[i][0]];\n          var val;\n          /* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n\n          switch (blob[blob.l]) {\n            case 0x41\n            /*VT_BLOB*/\n            :\n              blob.l += 4;\n              val = parse_BLOB(blob);\n              break;\n\n            case 0x1E\n            /*VT_LPSTR*/\n            :\n              blob.l += 4;\n              val = parse_VtString(blob, blob[blob.l - 4]);\n              break;\n\n            case 0x1F\n            /*VT_LPWSTR*/\n            :\n              blob.l += 4;\n              val = parse_VtString(blob, blob[blob.l - 4]);\n              break;\n\n            case 0x03\n            /*VT_I4*/\n            :\n              blob.l += 4;\n              val = blob.read_shift(4, 'i');\n              break;\n\n            case 0x13\n            /*VT_UI4*/\n            :\n              blob.l += 4;\n              val = blob.read_shift(4);\n              break;\n\n            case 0x05\n            /*VT_R8*/\n            :\n              blob.l += 4;\n              val = blob.read_shift(8, 'f');\n              break;\n\n            case 0x0B\n            /*VT_BOOL*/\n            :\n              blob.l += 4;\n              val = parsebool(blob, 4);\n              break;\n\n            case 0x40\n            /*VT_FILETIME*/\n            :\n              blob.l += 4;\n              val = new Date(parse_FILETIME(blob));\n              break;\n\n            default:\n              throw new Error(\"unparsed value: \" + blob[blob.l]);\n          }\n\n          PropH[name] = val;\n        }\n      }\n    }\n\n    blob.l = start_addr + size;\n    /* step ahead to skip padding */\n\n    return PropH;\n  }\n  /* [MS-OLEPS] 2.21 PropertySetStream */\n\n\n  function parse_PropertySetStream(file, PIDSI) {\n    var blob = file.content;\n    prep_blob(blob, 0);\n    var NumSets, FMTID0, FMTID1, Offset0, Offset1;\n    blob.chk('feff', 'Byte Order: ');\n    var vers = blob.read_shift(2); // TODO: check version\n\n    var SystemIdentifier = blob.read_shift(4);\n    blob.chk(CFB.utils.consts.HEADER_CLSID, 'CLSID: ');\n    NumSets = blob.read_shift(4);\n    if (NumSets !== 1 && NumSets !== 2) throw \"Unrecognized #Sets: \" + NumSets;\n    FMTID0 = blob.read_shift(16);\n    Offset0 = blob.read_shift(4);\n    if (NumSets === 1 && Offset0 !== blob.l) throw \"Length mismatch\";else if (NumSets === 2) {\n      FMTID1 = blob.read_shift(16);\n      Offset1 = blob.read_shift(4);\n    }\n    var PSet0 = parse_PropertySet(blob, PIDSI);\n    var rval = {\n      SystemIdentifier: SystemIdentifier\n    };\n\n    for (var y in PSet0) rval[y] = PSet0[y]; //rval.blob = blob;\n\n\n    rval.FMTID = FMTID0; //rval.PSet0 = PSet0;\n\n    if (NumSets === 1) return rval;\n    if (blob.l !== Offset1) throw \"Length mismatch 2: \" + blob.l + \" !== \" + Offset1;\n    var PSet1;\n\n    try {\n      PSet1 = parse_PropertySet(blob, null);\n    } catch (e) {}\n\n    for (y in PSet1) rval[y] = PSet1[y];\n\n    rval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n\n    return rval;\n  }\n\n  function parsenoop2(blob, length) {\n    blob.read_shift(length);\n    return null;\n  }\n\n  function parslurp(blob, length, cb) {\n    var arr = [],\n        target = blob.l + length;\n\n    while (blob.l < target) arr.push(cb(blob, target - blob.l));\n\n    if (target !== blob.l) throw new Error(\"Slurp error\");\n    return arr;\n  }\n\n  function parslurp2(blob, length, cb) {\n    var arr = [],\n        target = blob.l + length,\n        len = blob.read_shift(2);\n\n    while (len-- !== 0) arr.push(cb(blob, target - blob.l));\n\n    if (target !== blob.l) throw new Error(\"Slurp error\");\n    return arr;\n  }\n\n  function parsebool(blob, length) {\n    return blob.read_shift(length) === 0x1;\n  }\n\n  function parseuint16(blob) {\n    return blob.read_shift(2, 'u');\n  }\n\n  function parseuint16a(blob, length) {\n    return parslurp(blob, length, parseuint16);\n  }\n  /* --- 2.5 Structures --- */\n\n  /* [MS-XLS] 2.5.14 Boolean */\n\n\n  var parse_Boolean = parsebool;\n  /* [MS-XLS] 2.5.10 Bes (boolean or error) */\n\n  function parse_Bes(blob) {\n    var v = blob.read_shift(1),\n        t = blob.read_shift(1);\n    return t === 0x01 ? v : v === 0x01;\n  }\n  /* [MS-XLS] 2.5.240 ShortXLUnicodeString */\n\n\n  function parse_ShortXLUnicodeString(blob, length, opts) {\n    var cch = blob.read_shift(1);\n    var width = 1,\n        encoding = 'sbcs-cont';\n    var cp = current_codepage;\n    if (opts && opts.biff >= 8) current_codepage = 1200;\n\n    if (opts === undefined || opts.biff !== 5) {\n      var fHighByte = blob.read_shift(1);\n\n      if (fHighByte) {\n        width = 2;\n        encoding = 'dbcs-cont';\n      }\n    }\n\n    var o = cch ? blob.read_shift(cch, encoding) : \"\";\n    current_codepage = cp;\n    return o;\n  }\n  /* 2.5.293 XLUnicodeRichExtendedString */\n\n\n  function parse_XLUnicodeRichExtendedString(blob) {\n    var cp = current_codepage;\n    current_codepage = 1200;\n    var cch = blob.read_shift(2),\n        flags = blob.read_shift(1);\n    var fHighByte = flags & 0x1,\n        fExtSt = flags & 0x4,\n        fRichSt = flags & 0x8;\n    var width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n\n    var cRun, cbExtRst;\n    var z = {};\n    if (fRichSt) cRun = blob.read_shift(2);\n    if (fExtSt) cbExtRst = blob.read_shift(4);\n    var encoding = flags & 0x1 ? 'dbcs-cont' : 'sbcs-cont';\n    var msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n    if (fRichSt) blob.l += 4 * cRun; //TODO: parse this\n\n    if (fExtSt) blob.l += cbExtRst; //TODO: parse this\n\n    z.t = msg;\n\n    if (!fRichSt) {\n      z.raw = \"<t>\" + z.t + \"</t>\";\n      z.r = z.t;\n    }\n\n    current_codepage = cp;\n    return z;\n  }\n  /* 2.5.296 XLUnicodeStringNoCch */\n\n\n  function parse_XLUnicodeStringNoCch(blob, cch, opts) {\n    var retval;\n    var fHighByte = blob.read_shift(1);\n\n    if (fHighByte === 0) {\n      retval = blob.read_shift(cch, 'sbcs-cont');\n    } else {\n      retval = blob.read_shift(cch, 'dbcs-cont');\n    }\n\n    return retval;\n  }\n  /* 2.5.294 XLUnicodeString */\n\n\n  function parse_XLUnicodeString(blob, length, opts) {\n    var cch = blob.read_shift(opts !== undefined && opts.biff > 0 && opts.biff < 8 ? 1 : 2);\n\n    if (cch === 0) {\n      blob.l++;\n      return \"\";\n    }\n\n    return parse_XLUnicodeStringNoCch(blob, cch, opts);\n  }\n  /* BIFF5 override */\n\n\n  function parse_XLUnicodeString2(blob, length, opts) {\n    if (opts.biff !== 5 && opts.biff !== 2) return parse_XLUnicodeString(blob, length, opts);\n    var cch = blob.read_shift(1);\n\n    if (cch === 0) {\n      blob.l++;\n      return \"\";\n    }\n\n    return blob.read_shift(cch, 'sbcs-cont');\n  }\n  /* [MS-XLS] 2.5.61 ControlInfo */\n\n\n  var parse_ControlInfo = parsenoop;\n  /* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\n\n  var parse_URLMoniker = function (blob, length) {\n    var len = blob.read_shift(4),\n        start = blob.l;\n    var extra = false;\n\n    if (len > 24) {\n      /* look ahead */\n      blob.l += len - 24;\n      if (blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n      blob.l = start;\n    }\n\n    var url = blob.read_shift((extra ? len - 24 : len) >> 1, 'utf16le').replace(chr0, \"\");\n    if (extra) blob.l += 24;\n    return url;\n  };\n  /* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\n\n\n  var parse_FileMoniker = function (blob, length) {\n    var cAnti = blob.read_shift(2);\n    var ansiLength = blob.read_shift(4);\n    var ansiPath = blob.read_shift(ansiLength, 'cstr');\n    var endServer = blob.read_shift(2);\n    var versionNumber = blob.read_shift(2);\n    var cbUnicodePathSize = blob.read_shift(4);\n    if (cbUnicodePathSize === 0) return ansiPath.replace(/\\\\/g, \"/\");\n    var cbUnicodePathBytes = blob.read_shift(4);\n    var usKeyValue = blob.read_shift(2);\n    var unicodePath = blob.read_shift(cbUnicodePathBytes >> 1, 'utf16le').replace(chr0, \"\");\n    return unicodePath;\n  };\n  /* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\n\n\n  var parse_HyperlinkMoniker = function (blob, length) {\n    var clsid = blob.read_shift(16);\n    length -= 16;\n\n    switch (clsid) {\n      case \"e0c9ea79f9bace118c8200aa004ba90b\":\n        return parse_URLMoniker(blob, length);\n\n      case \"0303000000000000c000000000000046\":\n        return parse_FileMoniker(blob, length);\n\n      default:\n        throw \"unsupported moniker \" + clsid;\n    }\n  };\n  /* [MS-OSHARED] 2.3.7.9 HyperlinkString */\n\n\n  var parse_HyperlinkString = function (blob, length) {\n    var len = blob.read_shift(4);\n    var o = blob.read_shift(len, 'utf16le').replace(chr0, \"\");\n    return o;\n  };\n  /* [MS-OSHARED] 2.3.7.1 Hyperlink Object TODO: unify params with XLSX */\n\n\n  var parse_Hyperlink = function (blob, length) {\n    var end = blob.l + length;\n    var sVer = blob.read_shift(4);\n    if (sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n    var flags = blob.read_shift(2);\n    blob.l += 2;\n    var displayName, targetFrameName, moniker, oleMoniker, location, guid, fileTime;\n    if (flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n    if (flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n    if ((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n    if ((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n    if (flags & 0x0008) location = parse_HyperlinkString(blob, end - blob.l);\n    if (flags & 0x0020) guid = blob.read_shift(16);\n    if (flags & 0x0040) fileTime = parse_FILETIME(blob, 8);\n    blob.l = end;\n    var target = targetFrameName || moniker || oleMoniker;\n    if (location) target += \"#\" + location;\n    return {\n      Target: target\n    };\n  };\n  /* 2.5.178 LongRGBA */\n\n\n  function parse_LongRGBA(blob, length) {\n    var r = blob.read_shift(1),\n        g = blob.read_shift(1),\n        b = blob.read_shift(1),\n        a = blob.read_shift(1);\n    return [r, g, b, a];\n  }\n  /* 2.5.177 LongRGB */\n\n\n  function parse_LongRGB(blob, length) {\n    var x = parse_LongRGBA(blob, length);\n    x[3] = 0;\n    return x;\n  }\n  /* --- MS-XLS --- */\n\n  /* 2.5.19 */\n\n\n  function parse_XLSCell(blob, length) {\n    var rw = blob.read_shift(2); // 0-indexed\n\n    var col = blob.read_shift(2);\n    var ixfe = blob.read_shift(2);\n    return {\n      r: rw,\n      c: col,\n      ixfe: ixfe\n    };\n  }\n  /* 2.5.134 */\n\n\n  function parse_frtHeader(blob) {\n    var rt = blob.read_shift(2);\n    var flags = blob.read_shift(2); // TODO: parse these flags\n\n    blob.l += 8;\n    return {\n      type: rt,\n      flags: flags\n    };\n  }\n\n  function parse_OptXLUnicodeString(blob, length, opts) {\n    return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts);\n  }\n  /* 2.5.158 */\n\n\n  var HIDEOBJENUM = ['SHOWALL', 'SHOWPLACEHOLDER', 'HIDEALL'];\n  var parse_HideObjEnum = parseuint16;\n  /* 2.5.344 */\n\n  function parse_XTI(blob, length) {\n    var iSupBook = blob.read_shift(2),\n        itabFirst = blob.read_shift(2, 'i'),\n        itabLast = blob.read_shift(2, 'i');\n    return [iSupBook, itabFirst, itabLast];\n  }\n  /* 2.5.218 */\n\n\n  function parse_RkRec(blob, length) {\n    var ixfe = blob.read_shift(2);\n    var RK = parse_RkNumber(blob); //console.log(\"::\", ixfe, RK,\";;\");\n\n    return [ixfe, RK];\n  }\n  /* 2.5.1 */\n\n\n  function parse_AddinUdf(blob, length) {\n    blob.l += 4;\n    length -= 4;\n    var l = blob.l + length;\n    var udfName = parse_ShortXLUnicodeString(blob, length);\n    var cb = blob.read_shift(2);\n    l -= blob.l;\n    if (cb !== l) throw \"Malformed AddinUdf: padding = \" + l + \" != \" + cb;\n    blob.l += cb;\n    return udfName;\n  }\n  /* 2.5.209 TODO: Check sizes */\n\n\n  function parse_Ref8U(blob, length) {\n    var rwFirst = blob.read_shift(2);\n    var rwLast = blob.read_shift(2);\n    var colFirst = blob.read_shift(2);\n    var colLast = blob.read_shift(2);\n    return {\n      s: {\n        c: colFirst,\n        r: rwFirst\n      },\n      e: {\n        c: colLast,\n        r: rwLast\n      }\n    };\n  }\n  /* 2.5.211 */\n\n\n  function parse_RefU(blob, length) {\n    var rwFirst = blob.read_shift(2);\n    var rwLast = blob.read_shift(2);\n    var colFirst = blob.read_shift(1);\n    var colLast = blob.read_shift(1);\n    return {\n      s: {\n        c: colFirst,\n        r: rwFirst\n      },\n      e: {\n        c: colLast,\n        r: rwLast\n      }\n    };\n  }\n  /* 2.5.207 */\n\n\n  var parse_Ref = parse_RefU;\n  /* 2.5.143 */\n\n  function parse_FtCmo(blob, length) {\n    blob.l += 4;\n    var ot = blob.read_shift(2);\n    var id = blob.read_shift(2);\n    var flags = blob.read_shift(2);\n    blob.l += 12;\n    return [id, ot, flags];\n  }\n  /* 2.5.149 */\n\n\n  function parse_FtNts(blob, length) {\n    var out = {};\n    blob.l += 4;\n    blob.l += 16; // GUID TODO\n\n    out.fSharedNote = blob.read_shift(2);\n    blob.l += 4;\n    return out;\n  }\n  /* 2.5.142 */\n\n\n  function parse_FtCf(blob, length) {\n    var out = {};\n    blob.l += 4;\n    blob.cf = blob.read_shift(2);\n    return out;\n  }\n  /* 2.5.140 - 2.5.154 and friends */\n\n\n  var FtTab = {\n    0x15: parse_FtCmo,\n    0x13: parsenoop,\n\n    /* FtLbsData */\n    0x12: function (blob, length) {\n      blob.l += 12;\n    },\n\n    /* FtCblsData */\n    0x11: function (blob, length) {\n      blob.l += 8;\n    },\n\n    /* FtRboData */\n    0x10: parsenoop,\n\n    /* FtEdoData */\n    0x0F: parsenoop,\n\n    /* FtGboData */\n    0x0D: parse_FtNts,\n\n    /* FtNts */\n    0x0C: function (blob, length) {\n      blob.l += 24;\n    },\n\n    /* FtSbs */\n    0x0B: function (blob, length) {\n      blob.l += 10;\n    },\n\n    /* FtRbo */\n    0x0A: function (blob, length) {\n      blob.l += 16;\n    },\n\n    /* FtCbls */\n    0x09: parsenoop,\n\n    /* FtPictFmla */\n    0x08: function (blob, length) {\n      blob.l += 6;\n    },\n\n    /* FtPioGrbit */\n    0x07: parse_FtCf,\n\n    /* FtCf */\n    0x06: function (blob, length) {\n      blob.l += 6;\n    },\n\n    /* FtGmo */\n    0x04: parsenoop,\n\n    /* FtMacro */\n    0x00: function (blob, length) {\n      blob.l += 4;\n    }\n    /* FtEnding */\n\n  };\n\n  function parse_FtArray(blob, length, ot) {\n    var s = blob.l;\n    var fts = [];\n\n    while (blob.l < s + length) {\n      var ft = blob.read_shift(2);\n      blob.l -= 2;\n\n      try {\n        fts.push(FtTab[ft](blob, s + length - blob.l));\n      } catch (e) {\n        blob.l = s + length;\n        return fts;\n      }\n    }\n\n    if (blob.l != s + length) blob.l = s + length; //throw \"bad Object Ft-sequence\";\n\n    return fts;\n  }\n  /* 2.5.129 */\n\n\n  var parse_FontIndex = parseuint16;\n  /* --- 2.4 Records --- */\n\n  /* 2.4.21 */\n\n  function parse_BOF(blob, length) {\n    var o = {};\n    o.BIFFVer = blob.read_shift(2);\n    length -= 2;\n\n    switch (o.BIFFVer) {\n      case 0x0600:\n      /* BIFF8 */\n\n      case 0x0500:\n      /* BIFF5 */\n\n      case 0x0002:\n      case 0x0007:\n        /* BIFF2 */\n        break;\n\n      default:\n        throw \"Unexpected BIFF Ver \" + o.BIFFVer;\n    }\n\n    blob.read_shift(length);\n    return o;\n  }\n  /* 2.4.146 */\n\n\n  function parse_InterfaceHdr(blob, length) {\n    if (length === 0) return 0x04b0;\n    var q;\n    if ((q = blob.read_shift(2)) !== 0x04b0) throw 'InterfaceHdr codePage ' + q;\n    return 0x04b0;\n  }\n  /* 2.4.349 */\n\n\n  function parse_WriteAccess(blob, length, opts) {\n    if (opts.enc) {\n      blob.l += length;\n      return \"\";\n    }\n\n    var l = blob.l; // TODO: make sure XLUnicodeString doesnt overrun\n\n    var UserName = parse_XLUnicodeString(blob, 0, opts);\n    blob.read_shift(length + l - blob.l);\n    return UserName;\n  }\n  /* 2.4.28 */\n\n\n  function parse_BoundSheet8(blob, length, opts) {\n    var pos = blob.read_shift(4);\n    var hidden = blob.read_shift(1) >> 6;\n    var dt = blob.read_shift(1);\n\n    switch (dt) {\n      case 0:\n        dt = 'Worksheet';\n        break;\n\n      case 1:\n        dt = 'Macrosheet';\n        break;\n\n      case 2:\n        dt = 'Chartsheet';\n        break;\n\n      case 6:\n        dt = 'VBAModule';\n        break;\n    }\n\n    var name = parse_ShortXLUnicodeString(blob, 0, opts);\n    if (name.length === 0) name = \"Sheet1\";\n    return {\n      pos: pos,\n      hs: hidden,\n      dt: dt,\n      name: name\n    };\n  }\n  /* 2.4.265 TODO */\n\n\n  function parse_SST(blob, length) {\n    var cnt = blob.read_shift(4);\n    var ucnt = blob.read_shift(4);\n    var strs = [];\n\n    for (var i = 0; i != ucnt; ++i) {\n      strs.push(parse_XLUnicodeRichExtendedString(blob));\n    }\n\n    strs.Count = cnt;\n    strs.Unique = ucnt;\n    return strs;\n  }\n  /* 2.4.107 */\n\n\n  function parse_ExtSST(blob, length) {\n    var extsst = {};\n    extsst.dsst = blob.read_shift(2);\n    blob.l += length - 2;\n    return extsst;\n  }\n  /* 2.4.221 TODO*/\n\n\n  function parse_Row(blob, length) {\n    var rw = blob.read_shift(2),\n        col = blob.read_shift(2),\n        Col = blob.read_shift(2),\n        rht = blob.read_shift(2);\n    blob.read_shift(4); // reserved(2), unused(2)\n\n    var flags = blob.read_shift(1); // various flags\n\n    blob.read_shift(1); // reserved\n\n    blob.read_shift(2); //ixfe, other flags\n\n    return {\n      r: rw,\n      c: col,\n      cnt: Col - col\n    };\n  }\n  /* 2.4.125 */\n\n\n  function parse_ForceFullCalculation(blob, length) {\n    var header = parse_frtHeader(blob);\n    if (header.type != 0x08A3) throw \"Invalid Future Record \" + header.type;\n    var fullcalc = blob.read_shift(4);\n    return fullcalc !== 0x0;\n  }\n\n  var parse_CompressPictures = parsenoop2;\n  /* 2.4.55 Not interesting */\n\n  /* 2.4.215 rt */\n\n  function parse_RecalcId(blob, length) {\n    blob.read_shift(2);\n    return blob.read_shift(4);\n  }\n  /* 2.4.87 */\n\n\n  function parse_DefaultRowHeight(blob, length) {\n    var f = blob.read_shift(2),\n        miyRw;\n    miyRw = blob.read_shift(2); // flags & 0x02 -> hidden, else empty\n\n    var fl = {\n      Unsynced: f & 1,\n      DyZero: (f & 2) >> 1,\n      ExAsc: (f & 4) >> 2,\n      ExDsc: (f & 8) >> 3\n    };\n    return [fl, miyRw];\n  }\n  /* 2.4.345 TODO */\n\n\n  function parse_Window1(blob, length) {\n    var xWn = blob.read_shift(2),\n        yWn = blob.read_shift(2),\n        dxWn = blob.read_shift(2),\n        dyWn = blob.read_shift(2);\n    var flags = blob.read_shift(2),\n        iTabCur = blob.read_shift(2),\n        iTabFirst = blob.read_shift(2);\n    var ctabSel = blob.read_shift(2),\n        wTabRatio = blob.read_shift(2);\n    return {\n      Pos: [xWn, yWn],\n      Dim: [dxWn, dyWn],\n      Flags: flags,\n      CurTab: iTabCur,\n      FirstTab: iTabFirst,\n      Selected: ctabSel,\n      TabRatio: wTabRatio\n    };\n  }\n  /* 2.4.122 TODO */\n\n\n  function parse_Font(blob, length, opts) {\n    blob.l += 14;\n    var name = parse_ShortXLUnicodeString(blob, 0, opts);\n    return name;\n  }\n  /* 2.4.149 */\n\n\n  function parse_LabelSst(blob, length) {\n    var cell = parse_XLSCell(blob);\n    cell.isst = blob.read_shift(4);\n    return cell;\n  }\n  /* 2.4.148 */\n\n\n  function parse_Label(blob, length, opts) {\n    var cell = parse_XLSCell(blob, 6);\n    var str = parse_XLUnicodeString(blob, length - 6, opts);\n    cell.val = str;\n    return cell;\n  }\n  /* 2.4.126 Number Formats */\n\n\n  function parse_Format(blob, length, opts) {\n    var ifmt = blob.read_shift(2);\n    var fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n    return [ifmt, fmtstr];\n  }\n  /* 2.4.90 */\n\n\n  function parse_Dimensions(blob, length) {\n    var w = length === 10 ? 2 : 4;\n    var r = blob.read_shift(w),\n        R = blob.read_shift(w),\n        c = blob.read_shift(2),\n        C = blob.read_shift(2);\n    blob.l += 2;\n    return {\n      s: {\n        r: r,\n        c: c\n      },\n      e: {\n        r: R,\n        c: C\n      }\n    };\n  }\n  /* 2.4.220 */\n\n\n  function parse_RK(blob, length) {\n    var rw = blob.read_shift(2),\n        col = blob.read_shift(2);\n    var rkrec = parse_RkRec(blob);\n    return {\n      r: rw,\n      c: col,\n      ixfe: rkrec[0],\n      rknum: rkrec[1]\n    };\n  }\n  /* 2.4.175 */\n\n\n  function parse_MulRk(blob, length) {\n    var target = blob.l + length - 2;\n    var rw = blob.read_shift(2),\n        col = blob.read_shift(2);\n    var rkrecs = [];\n\n    while (blob.l < target) rkrecs.push(parse_RkRec(blob));\n\n    if (blob.l !== target) throw \"MulRK read error\";\n    var lastcol = blob.read_shift(2);\n    if (rkrecs.length != lastcol - col + 1) throw \"MulRK length mismatch\";\n    return {\n      r: rw,\n      c: col,\n      C: lastcol,\n      rkrec: rkrecs\n    };\n  }\n  /* 2.5.20 2.5.249 TODO */\n\n\n  function parse_CellStyleXF(blob, length, style) {\n    var o = {};\n    var a = blob.read_shift(4),\n        b = blob.read_shift(4);\n    var c = blob.read_shift(4),\n        d = blob.read_shift(2);\n    o.patternType = XLSFillPattern[c >> 26];\n    o.icvFore = d & 0x7F;\n    o.icvBack = d >> 7 & 0x7F;\n    return o;\n  }\n\n  function parse_CellXF(blob, length) {\n    return parse_CellStyleXF(blob, length, 0);\n  }\n\n  function parse_StyleXF(blob, length) {\n    return parse_CellStyleXF(blob, length, 1);\n  }\n  /* 2.4.353 TODO: actually do this right */\n\n\n  function parse_XF(blob, length) {\n    var o = {};\n    o.ifnt = blob.read_shift(2);\n    o.ifmt = blob.read_shift(2);\n    o.flags = blob.read_shift(2);\n    o.fStyle = o.flags >> 2 & 0x01;\n    length -= 6;\n    o.data = parse_CellStyleXF(blob, length, o.fStyle);\n    return o;\n  }\n  /* 2.4.134 */\n\n\n  function parse_Guts(blob, length) {\n    blob.l += 4;\n    var out = [blob.read_shift(2), blob.read_shift(2)];\n    if (out[0] !== 0) out[0]--;\n    if (out[1] !== 0) out[1]--;\n    if (out[0] > 7 || out[1] > 7) throw \"Bad Gutters: \" + out;\n    return out;\n  }\n  /* 2.4.24 */\n\n\n  function parse_BoolErr(blob, length) {\n    var cell = parse_XLSCell(blob, 6);\n    var val = parse_Bes(blob, 2);\n    cell.val = val;\n    cell.t = val === true || val === false ? 'b' : 'e';\n    return cell;\n  }\n  /* 2.4.180 Number */\n\n\n  function parse_Number(blob, length) {\n    var cell = parse_XLSCell(blob, 6);\n    var xnum = parse_Xnum(blob, 8);\n    cell.val = xnum;\n    return cell;\n  }\n\n  var parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n  /* 2.4.271 */\n\n  function parse_SupBook(blob, length, opts) {\n    var end = blob.l + length;\n    var ctab = blob.read_shift(2);\n    var cch = blob.read_shift(2);\n    var virtPath;\n    if (cch >= 0x01 && cch <= 0xff) virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n    var rgst = blob.read_shift(end - blob.l);\n    opts.sbcch = cch;\n    return [cch, ctab, virtPath, rgst];\n  }\n  /* 2.4.105 TODO */\n\n\n  function parse_ExternName(blob, length, opts) {\n    var flags = blob.read_shift(2);\n    var body;\n    var o = {\n      fBuiltIn: flags & 0x01,\n      fWantAdvise: flags >>> 1 & 0x01,\n      fWantPict: flags >>> 2 & 0x01,\n      fOle: flags >>> 3 & 0x01,\n      fOleLink: flags >>> 4 & 0x01,\n      cf: flags >>> 5 & 0x3FF,\n      fIcon: flags >>> 15 & 0x01\n    };\n    if (opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length - 2); //else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n\n    o.body = body || blob.read_shift(length - 2);\n    return o;\n  }\n  /* 2.4.150 TODO */\n\n\n  function parse_Lbl(blob, length, opts) {\n    if (opts.biff < 8) return parse_Label(blob, length, opts);\n    var target = blob.l + length;\n    var flags = blob.read_shift(2);\n    var chKey = blob.read_shift(1);\n    var cch = blob.read_shift(1);\n    var cce = blob.read_shift(2);\n    blob.l += 2;\n    var itab = blob.read_shift(2);\n    blob.l += 4;\n    var name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n    var rgce = parse_NameParsedFormula(blob, target - blob.l, opts, cce);\n    return {\n      chKey: chKey,\n      Name: name,\n      rgce: rgce\n    };\n  }\n  /* 2.4.106 TODO: verify supbook manipulation */\n\n\n  function parse_ExternSheet(blob, length, opts) {\n    if (opts.biff < 8) return parse_ShortXLUnicodeString(blob, length, opts);\n    var o = parslurp2(blob, length, parse_XTI);\n    var oo = [];\n\n    if (opts.sbcch === 0x0401) {\n      for (var i = 0; i != o.length; ++i) oo.push(opts.snames[o[i][1]]);\n\n      return oo;\n    } else return o;\n  }\n  /* 2.4.260 */\n\n\n  function parse_ShrFmla(blob, length, opts) {\n    var ref = parse_RefU(blob, 6);\n    blob.l++;\n    var cUse = blob.read_shift(1);\n    length -= 8;\n    return [parse_SharedParsedFormula(blob, length, opts), cUse];\n  }\n  /* 2.4.4 TODO */\n\n\n  function parse_Array(blob, length, opts) {\n    var ref = parse_Ref(blob, 6);\n    blob.l += 6;\n    length -= 12;\n    /* TODO: fAlwaysCalc */\n\n    return [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\n  }\n  /* 2.4.173 */\n\n\n  function parse_MTRSettings(blob, length) {\n    var fMTREnabled = blob.read_shift(4) !== 0x00;\n    var fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n    var cUserThreadCount = blob.read_shift(4);\n    return [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n  }\n  /* 2.5.186 TODO: BIFF5 */\n\n\n  function parse_NoteSh(blob, length, opts) {\n    if (opts.biff < 8) return;\n    var row = blob.read_shift(2),\n        col = blob.read_shift(2);\n    var flags = blob.read_shift(2),\n        idObj = blob.read_shift(2);\n    var stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n    if (opts.biff < 8) blob.read_shift(1);\n    return [{\n      r: row,\n      c: col\n    }, stAuthor, idObj, flags];\n  }\n  /* 2.4.179 */\n\n\n  function parse_Note(blob, length, opts) {\n    /* TODO: Support revisions */\n    return parse_NoteSh(blob, length, opts);\n  }\n  /* 2.4.168 */\n\n\n  function parse_MergeCells(blob, length) {\n    var merges = [];\n    var cmcs = blob.read_shift(2);\n\n    while (cmcs--) merges.push(parse_Ref8U(blob, length));\n\n    return merges;\n  }\n  /* 2.4.181 TODO: parse all the things! */\n\n\n  function parse_Obj(blob, length) {\n    var cmo = parse_FtCmo(blob, 22); // id, ot, flags\n\n    var fts = parse_FtArray(blob, length - 22, cmo[1]);\n    return {\n      cmo: cmo,\n      ft: fts\n    };\n  }\n  /* 2.4.329 TODO: parse properly */\n\n\n  function parse_TxO(blob, length, opts) {\n    var s = blob.l;\n\n    try {\n      blob.l += 4;\n      var ot = (opts.lastobj || {\n        cmo: [0, 0]\n      }).cmo[1];\n      var controlInfo;\n      if ([0, 5, 7, 11, 12, 14].indexOf(ot) == -1) blob.l += 6;else controlInfo = parse_ControlInfo(blob, 6, opts);\n      var cchText = blob.read_shift(2);\n      var cbRuns = blob.read_shift(2);\n      var ifntEmpty = parse_FontIndex(blob, 2);\n      var len = blob.read_shift(2);\n      blob.l += len; //var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n      var texts = \"\";\n\n      for (var i = 1; i < blob.lens.length - 1; ++i) {\n        if (blob.l - s != blob.lens[i]) throw \"TxO: bad continue record\";\n        var hdr = blob[blob.l];\n        var t = parse_XLUnicodeStringNoCch(blob, blob.lens[i + 1] - blob.lens[i] - 1);\n        texts += t;\n        if (texts.length >= (hdr ? cchText : 2 * cchText)) break;\n      }\n\n      if (texts.length !== cchText && texts.length !== cchText * 2) {\n        throw \"cchText: \" + cchText + \" != \" + texts.length;\n      }\n\n      blob.l = s + length;\n      /* 2.5.272 TxORuns */\n      //\tvar rgTxoRuns = [];\n      //\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n      //\tvar cchText2 = blob.read_shift(2);\n      //\tif(cchText2 !== cchText) throw \"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText;\n      //\tblob.l += 6;\n      //\tif(s + length != blob.l) throw \"TxO \" + (s + length) + \", at \" + blob.l;\n\n      return {\n        t: texts\n      };\n    } catch (e) {\n      blob.l = s + length;\n      return {\n        t: texts || \"\"\n      };\n    }\n  }\n  /* 2.4.140 */\n\n\n  var parse_HLink = function (blob, length) {\n    var ref = parse_Ref8U(blob, 8);\n    blob.l += 16;\n    /* CLSID */\n\n    var hlink = parse_Hyperlink(blob, length - 24);\n    return [ref, hlink];\n  };\n  /* 2.4.141 */\n\n\n  var parse_HLinkTooltip = function (blob, length) {\n    var end = blob.l + length;\n    blob.read_shift(2);\n    var ref = parse_Ref8U(blob, 8);\n    var wzTooltip = blob.read_shift((length - 10) / 2, 'dbcs-cont');\n    wzTooltip = wzTooltip.replace(chr0, \"\");\n    return [ref, wzTooltip];\n  };\n  /* 2.4.63 */\n\n\n  function parse_Country(blob, length) {\n    var o = [],\n        d;\n    d = blob.read_shift(2);\n    o[0] = CountryEnum[d] || d;\n    d = blob.read_shift(2);\n    o[1] = CountryEnum[d] || d;\n    return o;\n  }\n  /* 2.4.50 ClrtClient */\n\n\n  function parse_ClrtClient(blob, length) {\n    var ccv = blob.read_shift(2);\n    var o = [];\n\n    while (ccv-- > 0) o.push(parse_LongRGB(blob, 8));\n\n    return o;\n  }\n  /* 2.4.188 */\n\n\n  function parse_Palette(blob, length) {\n    var ccv = blob.read_shift(2);\n    var o = [];\n\n    while (ccv-- > 0) o.push(parse_LongRGB(blob, 8));\n\n    return o;\n  }\n  /* 2.4.354 */\n\n\n  function parse_XFCRC(blob, length) {\n    blob.l += 2;\n    var o = {\n      cxfs: 0,\n      crc: 0\n    };\n    o.cxfs = blob.read_shift(2);\n    o.crc = blob.read_shift(4);\n    return o;\n  }\n\n  var parse_Style = parsenoop;\n  var parse_StyleExt = parsenoop;\n  var parse_ColInfo = parsenoop;\n  var parse_Window2 = parsenoop;\n  var parse_Backup = parsebool;\n  /* 2.4.14 */\n\n  var parse_Blank = parse_XLSCell;\n  /* 2.4.20 Just the cell */\n\n  var parse_BottomMargin = parse_Xnum;\n  /* 2.4.27 */\n\n  var parse_BuiltInFnGroupCount = parseuint16;\n  /* 2.4.30 0x0E or 0x10 but excel 2011 generates 0x11? */\n\n  var parse_CalcCount = parseuint16;\n  /* 2.4.31 #Iterations */\n\n  var parse_CalcDelta = parse_Xnum;\n  /* 2.4.32 */\n\n  var parse_CalcIter = parsebool;\n  /* 2.4.33 1=iterative calc */\n\n  var parse_CalcMode = parseuint16;\n  /* 2.4.34 0=manual, 1=auto (def), 2=table */\n\n  var parse_CalcPrecision = parsebool;\n  /* 2.4.35 */\n\n  var parse_CalcRefMode = parsenoop2;\n  /* 2.4.36 */\n\n  var parse_CalcSaveRecalc = parsebool;\n  /* 2.4.37 */\n\n  var parse_CodePage = parseuint16;\n  /* 2.4.52 */\n\n  var parse_Compat12 = parsebool;\n  /* 2.4.54 true = no compatibility check */\n\n  var parse_Date1904 = parsebool;\n  /* 2.4.77 - 1=1904,0=1900 */\n\n  var parse_DefColWidth = parseuint16;\n  /* 2.4.89 */\n\n  var parse_DSF = parsenoop2;\n  /* 2.4.94 -- MUST be ignored */\n\n  var parse_EntExU2 = parsenoop2;\n  /* 2.4.102 -- Explicitly says to ignore */\n\n  var parse_EOF = parsenoop2;\n  /* 2.4.103 */\n\n  var parse_Excel9File = parsenoop2;\n  /* 2.4.104 -- Optional and unused */\n\n  var parse_FeatHdr = parsenoop2;\n  /* 2.4.112 */\n\n  var parse_FontX = parseuint16;\n  /* 2.4.123 */\n\n  var parse_Footer = parse_XLHeaderFooter;\n  /* 2.4.124 */\n\n  var parse_GridSet = parseuint16;\n  /* 2.4.132, =1 */\n\n  var parse_HCenter = parsebool;\n  /* 2.4.135 sheet centered horizontal on print */\n\n  var parse_Header = parse_XLHeaderFooter;\n  /* 2.4.136 */\n\n  var parse_HideObj = parse_HideObjEnum;\n  /* 2.4.139 */\n\n  var parse_InterfaceEnd = parsenoop2;\n  /* 2.4.145 -- noop */\n\n  var parse_LeftMargin = parse_Xnum;\n  /* 2.4.151 */\n\n  var parse_Mms = parsenoop2;\n  /* 2.4.169 -- Explicitly says to ignore */\n\n  var parse_ObjProtect = parsebool;\n  /* 2.4.183 -- must be 1 if present */\n\n  var parse_Password = parseuint16;\n  /* 2.4.191 */\n\n  var parse_PrintGrid = parsebool;\n  /* 2.4.202 */\n\n  var parse_PrintRowCol = parsebool;\n  /* 2.4.203 */\n\n  var parse_PrintSize = parseuint16;\n  /* 2.4.204 0:3 */\n\n  var parse_Prot4Rev = parsebool;\n  /* 2.4.205 */\n\n  var parse_Prot4RevPass = parseuint16;\n  /* 2.4.206 */\n\n  var parse_Protect = parsebool;\n  /* 2.4.207 */\n\n  var parse_RefreshAll = parsebool;\n  /* 2.4.217 -- must be 0 if not template */\n\n  var parse_RightMargin = parse_Xnum;\n  /* 2.4.219 */\n\n  var parse_RRTabId = parseuint16a;\n  /* 2.4.241 */\n\n  var parse_ScenarioProtect = parsebool;\n  /* 2.4.245 */\n\n  var parse_Scl = parseuint16a;\n  /* 2.4.247 num, den */\n\n  var parse_String = parse_XLUnicodeString;\n  /* 2.4.268 */\n\n  var parse_SxBool = parsebool;\n  /* 2.4.274 */\n\n  var parse_TopMargin = parse_Xnum;\n  /* 2.4.328 */\n\n  var parse_UsesELFs = parsebool;\n  /* 2.4.337 -- should be 0 */\n\n  var parse_VCenter = parsebool;\n  /* 2.4.342 */\n\n  var parse_WinProtect = parsebool;\n  /* 2.4.347 */\n\n  var parse_WriteProtect = parsenoop;\n  /* 2.4.350 empty record */\n\n  /* ---- */\n\n  var parse_VerticalPageBreaks = parsenoop;\n  var parse_HorizontalPageBreaks = parsenoop;\n  var parse_Selection = parsenoop;\n  var parse_Continue = parsenoop;\n  var parse_Pane = parsenoop;\n  var parse_Pls = parsenoop;\n  var parse_DCon = parsenoop;\n  var parse_DConRef = parsenoop;\n  var parse_DConName = parsenoop;\n  var parse_XCT = parsenoop;\n  var parse_CRN = parsenoop;\n  var parse_FileSharing = parsenoop;\n  var parse_Uncalced = parsenoop;\n  var parse_Template = parsenoop;\n  var parse_Intl = parsenoop;\n  var parse_WsBool = parsenoop;\n  var parse_Sort = parsenoop;\n  var parse_Sync = parsenoop;\n  var parse_LPr = parsenoop;\n  var parse_DxGCol = parsenoop;\n  var parse_FnGroupName = parsenoop;\n  var parse_FilterMode = parsenoop;\n  var parse_AutoFilterInfo = parsenoop;\n  var parse_AutoFilter = parsenoop;\n  var parse_Setup = parsenoop;\n  var parse_ScenMan = parsenoop;\n  var parse_SCENARIO = parsenoop;\n  var parse_SxView = parsenoop;\n  var parse_Sxvd = parsenoop;\n  var parse_SXVI = parsenoop;\n  var parse_SxIvd = parsenoop;\n  var parse_SXLI = parsenoop;\n  var parse_SXPI = parsenoop;\n  var parse_DocRoute = parsenoop;\n  var parse_RecipName = parsenoop;\n  var parse_MulBlank = parsenoop;\n  var parse_SXDI = parsenoop;\n  var parse_SXDB = parsenoop;\n  var parse_SXFDB = parsenoop;\n  var parse_SXDBB = parsenoop;\n  var parse_SXNum = parsenoop;\n  var parse_SxErr = parsenoop;\n  var parse_SXInt = parsenoop;\n  var parse_SXString = parsenoop;\n  var parse_SXDtr = parsenoop;\n  var parse_SxNil = parsenoop;\n  var parse_SXTbl = parsenoop;\n  var parse_SXTBRGIITM = parsenoop;\n  var parse_SxTbpg = parsenoop;\n  var parse_ObProj = parsenoop;\n  var parse_SXStreamID = parsenoop;\n  var parse_DBCell = parsenoop;\n  var parse_SXRng = parsenoop;\n  var parse_SxIsxoper = parsenoop;\n  var parse_BookBool = parsenoop;\n  var parse_DbOrParamQry = parsenoop;\n  var parse_OleObjectSize = parsenoop;\n  var parse_SXVS = parsenoop;\n  var parse_BkHim = parsenoop;\n  var parse_MsoDrawingGroup = parsenoop;\n  var parse_MsoDrawing = parsenoop;\n  var parse_MsoDrawingSelection = parsenoop;\n  var parse_PhoneticInfo = parsenoop;\n  var parse_SxRule = parsenoop;\n  var parse_SXEx = parsenoop;\n  var parse_SxFilt = parsenoop;\n  var parse_SxDXF = parsenoop;\n  var parse_SxItm = parsenoop;\n  var parse_SxName = parsenoop;\n  var parse_SxSelect = parsenoop;\n  var parse_SXPair = parsenoop;\n  var parse_SxFmla = parsenoop;\n  var parse_SxFormat = parsenoop;\n  var parse_SXVDEx = parsenoop;\n  var parse_SXFormula = parsenoop;\n  var parse_SXDBEx = parsenoop;\n  var parse_RRDInsDel = parsenoop;\n  var parse_RRDHead = parsenoop;\n  var parse_RRDChgCell = parsenoop;\n  var parse_RRDRenSheet = parsenoop;\n  var parse_RRSort = parsenoop;\n  var parse_RRDMove = parsenoop;\n  var parse_RRFormat = parsenoop;\n  var parse_RRAutoFmt = parsenoop;\n  var parse_RRInsertSh = parsenoop;\n  var parse_RRDMoveBegin = parsenoop;\n  var parse_RRDMoveEnd = parsenoop;\n  var parse_RRDInsDelBegin = parsenoop;\n  var parse_RRDInsDelEnd = parsenoop;\n  var parse_RRDConflict = parsenoop;\n  var parse_RRDDefName = parsenoop;\n  var parse_RRDRstEtxp = parsenoop;\n  var parse_LRng = parsenoop;\n  var parse_CUsr = parsenoop;\n  var parse_CbUsr = parsenoop;\n  var parse_UsrInfo = parsenoop;\n  var parse_UsrExcl = parsenoop;\n  var parse_FileLock = parsenoop;\n  var parse_RRDInfo = parsenoop;\n  var parse_BCUsrs = parsenoop;\n  var parse_UsrChk = parsenoop;\n  var parse_UserBView = parsenoop;\n  var parse_UserSViewBegin = parsenoop; // overloaded\n\n  var parse_UserSViewEnd = parsenoop;\n  var parse_RRDUserView = parsenoop;\n  var parse_Qsi = parsenoop;\n  var parse_CondFmt = parsenoop;\n  var parse_CF = parsenoop;\n  var parse_DVal = parsenoop;\n  var parse_DConBin = parsenoop;\n  var parse_Lel = parsenoop;\n  var parse_XLSCodeName = parse_XLUnicodeString;\n  var parse_SXFDBType = parsenoop;\n  var parse_ObNoMacros = parsenoop;\n  var parse_Dv = parsenoop;\n  var parse_Index = parsenoop;\n  var parse_Table = parsenoop;\n  var parse_BigName = parsenoop;\n  var parse_ContinueBigName = parsenoop;\n  var parse_WebPub = parsenoop;\n  var parse_QsiSXTag = parsenoop;\n  var parse_DBQueryExt = parsenoop;\n  var parse_ExtString = parsenoop;\n  var parse_TxtQry = parsenoop;\n  var parse_Qsir = parsenoop;\n  var parse_Qsif = parsenoop;\n  var parse_RRDTQSIF = parsenoop;\n  var parse_OleDbConn = parsenoop;\n  var parse_WOpt = parsenoop;\n  var parse_SXViewEx = parsenoop;\n  var parse_SXTH = parsenoop;\n  var parse_SXPIEx = parsenoop;\n  var parse_SXVDTEx = parsenoop;\n  var parse_SXViewEx9 = parsenoop;\n  var parse_ContinueFrt = parsenoop;\n  var parse_RealTimeData = parsenoop;\n  var parse_ChartFrtInfo = parsenoop;\n  var parse_FrtWrapper = parsenoop;\n  var parse_StartBlock = parsenoop;\n  var parse_EndBlock = parsenoop;\n  var parse_StartObject = parsenoop;\n  var parse_EndObject = parsenoop;\n  var parse_CatLab = parsenoop;\n  var parse_YMult = parsenoop;\n  var parse_SXViewLink = parsenoop;\n  var parse_PivotChartBits = parsenoop;\n  var parse_FrtFontList = parsenoop;\n  var parse_SheetExt = parsenoop;\n  var parse_BookExt = parsenoop;\n  var parse_SXAddl = parsenoop;\n  var parse_CrErr = parsenoop;\n  var parse_HFPicture = parsenoop;\n  var parse_Feat = parsenoop;\n  var parse_DataLabExt = parsenoop;\n  var parse_DataLabExtContents = parsenoop;\n  var parse_CellWatch = parsenoop;\n  var parse_FeatHdr11 = parsenoop;\n  var parse_Feature11 = parsenoop;\n  var parse_DropDownObjIds = parsenoop;\n  var parse_ContinueFrt11 = parsenoop;\n  var parse_DConn = parsenoop;\n  var parse_List12 = parsenoop;\n  var parse_Feature12 = parsenoop;\n  var parse_CondFmt12 = parsenoop;\n  var parse_CF12 = parsenoop;\n  var parse_CFEx = parsenoop;\n  var parse_AutoFilter12 = parsenoop;\n  var parse_ContinueFrt12 = parsenoop;\n  var parse_MDTInfo = parsenoop;\n  var parse_MDXStr = parsenoop;\n  var parse_MDXTuple = parsenoop;\n  var parse_MDXSet = parsenoop;\n  var parse_MDXProp = parsenoop;\n  var parse_MDXKPI = parsenoop;\n  var parse_MDB = parsenoop;\n  var parse_PLV = parsenoop;\n  var parse_DXF = parsenoop;\n  var parse_TableStyles = parsenoop;\n  var parse_TableStyle = parsenoop;\n  var parse_TableStyleElement = parsenoop;\n  var parse_NamePublish = parsenoop;\n  var parse_NameCmt = parsenoop;\n  var parse_SortData = parsenoop;\n  var parse_GUIDTypeLib = parsenoop;\n  var parse_FnGrp12 = parsenoop;\n  var parse_NameFnGrp12 = parsenoop;\n  var parse_HeaderFooter = parsenoop;\n  var parse_CrtLayout12 = parsenoop;\n  var parse_CrtMlFrt = parsenoop;\n  var parse_CrtMlFrtContinue = parsenoop;\n  var parse_ShapePropsStream = parsenoop;\n  var parse_TextPropsStream = parsenoop;\n  var parse_RichTextStream = parsenoop;\n  var parse_CrtLayout12A = parsenoop;\n  var parse_Units = parsenoop;\n  var parse_Chart = parsenoop;\n  var parse_Series = parsenoop;\n  var parse_DataFormat = parsenoop;\n  var parse_LineFormat = parsenoop;\n  var parse_MarkerFormat = parsenoop;\n  var parse_AreaFormat = parsenoop;\n  var parse_PieFormat = parsenoop;\n  var parse_AttachedLabel = parsenoop;\n  var parse_SeriesText = parsenoop;\n  var parse_ChartFormat = parsenoop;\n  var parse_Legend = parsenoop;\n  var parse_SeriesList = parsenoop;\n  var parse_Bar = parsenoop;\n  var parse_Line = parsenoop;\n  var parse_Pie = parsenoop;\n  var parse_Area = parsenoop;\n  var parse_Scatter = parsenoop;\n  var parse_CrtLine = parsenoop;\n  var parse_Axis = parsenoop;\n  var parse_Tick = parsenoop;\n  var parse_ValueRange = parsenoop;\n  var parse_CatSerRange = parsenoop;\n  var parse_AxisLine = parsenoop;\n  var parse_CrtLink = parsenoop;\n  var parse_DefaultText = parsenoop;\n  var parse_Text = parsenoop;\n  var parse_ObjectLink = parsenoop;\n  var parse_Frame = parsenoop;\n  var parse_Begin = parsenoop;\n  var parse_End = parsenoop;\n  var parse_PlotArea = parsenoop;\n  var parse_Chart3d = parsenoop;\n  var parse_PicF = parsenoop;\n  var parse_DropBar = parsenoop;\n  var parse_Radar = parsenoop;\n  var parse_Surf = parsenoop;\n  var parse_RadarArea = parsenoop;\n  var parse_AxisParent = parsenoop;\n  var parse_LegendException = parsenoop;\n  var parse_ShtProps = parsenoop;\n  var parse_SerToCrt = parsenoop;\n  var parse_AxesUsed = parsenoop;\n  var parse_SBaseRef = parsenoop;\n  var parse_SerParent = parsenoop;\n  var parse_SerAuxTrend = parsenoop;\n  var parse_IFmtRecord = parsenoop;\n  var parse_Pos = parsenoop;\n  var parse_AlRuns = parsenoop;\n  var parse_BRAI = parsenoop;\n  var parse_SerAuxErrBar = parsenoop;\n  var parse_SerFmt = parsenoop;\n  var parse_Chart3DBarShape = parsenoop;\n  var parse_Fbi = parsenoop;\n  var parse_BopPop = parsenoop;\n  var parse_AxcExt = parsenoop;\n  var parse_Dat = parsenoop;\n  var parse_PlotGrowth = parsenoop;\n  var parse_SIIndex = parsenoop;\n  var parse_GelFrame = parsenoop;\n  var parse_BopPopCustom = parsenoop;\n  var parse_Fbi2 = parsenoop;\n  /* --- Specific to versions before BIFF8 --- */\n\n  function parse_BIFF5String(blob) {\n    var len = blob.read_shift(1);\n    return blob.read_shift(len, 'sbcs-cont');\n  }\n  /* BIFF2_??? where ??? is the name from [XLS] */\n\n\n  function parse_BIFF2STR(blob, length, opts) {\n    var cell = parse_XLSCell(blob, 6);\n    ++blob.l;\n    var str = parse_XLUnicodeString2(blob, length - 7, opts);\n    cell.val = str;\n    return cell;\n  }\n\n  function parse_BIFF2NUM(blob, length, opts) {\n    var cell = parse_XLSCell(blob, 6);\n    ++blob.l;\n    var num = parse_Xnum(blob, 8);\n    cell.val = num;\n    return cell;\n  }\n  /* 18.4.1 charset to codepage mapping */\n\n\n  var CS2CP = {\n    0: 1252,\n\n    /* ANSI */\n    1: 65001,\n\n    /* DEFAULT */\n    2: 65001,\n\n    /* SYMBOL */\n    77: 10000,\n\n    /* MAC */\n    128: 932,\n\n    /* SHIFTJIS */\n    129: 949,\n\n    /* HANGUL */\n    130: 1361,\n\n    /* JOHAB */\n    134: 936,\n\n    /* GB2312 */\n    136: 950,\n\n    /* CHINESEBIG5 */\n    161: 1253,\n\n    /* GREEK */\n    162: 1254,\n\n    /* TURKISH */\n    163: 1258,\n\n    /* VIETNAMESE */\n    177: 1255,\n\n    /* HEBREW */\n    178: 1256,\n\n    /* ARABIC */\n    186: 1257,\n\n    /* BALTIC */\n    204: 1251,\n\n    /* RUSSIAN */\n    222: 874,\n\n    /* THAI */\n    238: 1250,\n\n    /* EASTEUROPE */\n    255: 1252,\n\n    /* OEM */\n    69: 6969\n    /* MISC */\n\n  };\n  /* Parse a list of <r> tags */\n\n  var parse_rs = function parse_rs_factory() {\n    var tregex = matchtag(\"t\"),\n        rpregex = matchtag(\"rPr\"),\n        rregex = /<r>/g,\n        rend = /<\\/r>/,\n        nlregex = /\\r\\n/g;\n    /* 18.4.7 rPr CT_RPrElt */\n\n    var parse_rpr = function parse_rpr(rpr, intro, outro) {\n      var font = {},\n          cp = 65001;\n      var m = rpr.match(tagregex),\n          i = 0;\n      if (m) for (; i != m.length; ++i) {\n        var y = parsexmltag(m[i]);\n\n        switch (y[0]) {\n          /* 18.8.12 condense CT_BooleanProperty */\n\n          /* ** not required . */\n          case '<condense':\n            break;\n\n          /* 18.8.17 extend CT_BooleanProperty */\n\n          /* ** not required . */\n\n          case '<extend':\n            break;\n\n          /* 18.8.36 shadow CT_BooleanProperty */\n\n          /* ** not required . */\n\n          case '<shadow':\n          /* falls through */\n\n          case '<shadow/>':\n            break;\n\n          /* 18.4.1 charset CT_IntProperty TODO */\n\n          case '<charset':\n            if (y.val == '1') break;\n            cp = CS2CP[parseInt(y.val, 10)];\n            break;\n\n          /* 18.4.2 outline CT_BooleanProperty TODO */\n\n          case '<outline':\n          /* falls through */\n\n          case '<outline/>':\n            break;\n\n          /* 18.4.5 rFont CT_FontName */\n\n          case '<rFont':\n            font.name = y.val;\n            break;\n\n          /* 18.4.11 sz CT_FontSize */\n\n          case '<sz':\n            font.sz = y.val;\n            break;\n\n          /* 18.4.10 strike CT_BooleanProperty */\n\n          case '<strike':\n            if (!y.val) break;\n\n          /* falls through */\n\n          case '<strike/>':\n            font.strike = 1;\n            break;\n\n          case '</strike>':\n            break;\n\n          /* 18.4.13 u CT_UnderlineProperty */\n\n          case '<u':\n            if (!y.val) break;\n\n          /* falls through */\n\n          case '<u/>':\n            font.u = 1;\n            break;\n\n          case '</u>':\n            break;\n\n          /* 18.8.2 b */\n\n          case '<b':\n            if (!y.val) break;\n\n          /* falls through */\n\n          case '<b/>':\n            font.b = 1;\n            break;\n\n          case '</b>':\n            break;\n\n          /* 18.8.26 i */\n\n          case '<i':\n            if (!y.val) break;\n\n          /* falls through */\n\n          case '<i/>':\n            font.i = 1;\n            break;\n\n          case '</i>':\n            break;\n\n          /* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\n\n          case '<color':\n            if (y.rgb) font.color = y.rgb.substr(2, 6);\n            break;\n\n          /* 18.8.18 family ST_FontFamily */\n\n          case '<family':\n            font.family = y.val;\n            break;\n\n          /* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\n\n          case '<vertAlign':\n            break;\n\n          /* 18.8.35 scheme CT_FontScheme TODO */\n\n          case '<scheme':\n            break;\n\n          default:\n            if (y[0].charCodeAt(1) !== 47) throw 'Unrecognized rich format ' + y[0];\n        }\n      }\n      /* TODO: These should be generated styles, not inline */\n\n      var style = [];\n      if (font.b) style.push(\"font-weight: bold;\");\n      if (font.i) style.push(\"font-style: italic;\");\n      intro.push('<span style=\"' + style.join(\"\") + '\">');\n      outro.push(\"</span>\");\n      return cp;\n    };\n    /* 18.4.4 r CT_RElt */\n\n\n    function parse_r(r) {\n      var terms = [[], \"\", []];\n      /* 18.4.12 t ST_Xstring */\n\n      var t = r.match(tregex),\n          cp = 65001;\n      if (!isval(t)) return \"\";\n      terms[1] = t[1];\n      var rpr = r.match(rpregex);\n      if (isval(rpr)) cp = parse_rpr(rpr[1], terms[0], terms[2]);\n      return terms[0].join(\"\") + terms[1].replace(nlregex, '<br/>') + terms[2].join(\"\");\n    }\n\n    return function parse_rs(rs) {\n      return rs.replace(rregex, \"\").split(rend).map(parse_r).join(\"\");\n    };\n  }();\n  /* 18.4.8 si CT_Rst */\n\n\n  var sitregex = /<t[^>]*>([^<]*)<\\/t>/g,\n      sirregex = /<r>/;\n\n  function parse_si(x, opts) {\n    var html = opts ? opts.cellHTML : true;\n    var z = {};\n    if (!x) return null;\n    var y;\n    /* 18.4.12 t ST_Xstring (Plaintext String) */\n\n    if (x.charCodeAt(1) === 116) {\n      z.t = utf8read(unescapexml(x.substr(x.indexOf(\">\") + 1).split(/<\\/t>/)[0]));\n      z.r = x;\n      if (html) z.h = z.t;\n    }\n    /* 18.4.4 r CT_RElt (Rich Text Run) */\n    else if (y = x.match(sirregex)) {\n      z.r = x;\n      z.t = utf8read(unescapexml(x.match(sitregex).join(\"\").replace(tagregex, \"\")));\n      if (html) z.h = parse_rs(x);\n    }\n    /* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\n\n    /* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\n\n\n    return z;\n  }\n  /* 18.4 Shared String Table */\n\n\n  var sstr0 = /<sst([^>]*)>([\\s\\S]*)<\\/sst>/;\n  var sstr1 = /<(?:si|sstItem)>/g;\n  var sstr2 = /<\\/(?:si|sstItem)>/;\n\n  function parse_sst_xml(data, opts) {\n    var s = [],\n        ss;\n    /* 18.4.9 sst CT_Sst */\n\n    var sst = data.match(sstr0);\n\n    if (isval(sst)) {\n      ss = sst[2].replace(sstr1, \"\").split(sstr2);\n\n      for (var i = 0; i != ss.length; ++i) {\n        var o = parse_si(ss[i], opts);\n        if (o != null) s[s.length] = o;\n      }\n\n      sst = parsexmltag(sst[1]);\n      s.Count = sst.count;\n      s.Unique = sst.uniqueCount;\n    }\n\n    return s;\n  }\n\n  RELS.SST = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\";\n  var straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\n\n  function write_sst_xml(sst, opts) {\n    if (!opts.bookSST) return \"\";\n    var o = [XML_HEADER];\n    o[o.length] = writextag('sst', null, {\n      xmlns: XMLNS.main[0],\n      count: sst.Count,\n      uniqueCount: sst.Unique\n    });\n\n    for (var i = 0; i != sst.length; ++i) {\n      if (sst[i] == null) continue;\n      var s = sst[i];\n      var sitag = \"<si>\";\n      if (s.r) sitag += s.r;else {\n        sitag += \"<t\";\n        if (s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\n        sitag += \">\" + escapexml(s.t) + \"</t>\";\n      }\n      sitag += \"</si>\";\n      o[o.length] = sitag;\n    }\n\n    if (o.length > 2) {\n      o[o.length] = '</sst>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* [MS-XLSB] 2.4.219 BrtBeginSst */\n\n\n  function parse_BrtBeginSst(data, length) {\n    return [data.read_shift(4), data.read_shift(4)];\n  }\n  /* [MS-XLSB] 2.1.7.45 Shared Strings */\n\n\n  function parse_sst_bin(data, opts) {\n    var s = [];\n    var pass = false;\n    recordhopper(data, function hopper_sst(val, R, RT) {\n      switch (R.n) {\n        case 'BrtBeginSst':\n          s.Count = val[0];\n          s.Unique = val[1];\n          break;\n\n        case 'BrtSSTItem':\n          s.push(val);\n          break;\n\n        case 'BrtEndSst':\n          return true;\n\n        /* TODO: produce a test case with a future record */\n\n        case 'BrtFRTBegin':\n          pass = true;\n          break;\n\n        case 'BrtFRTEnd':\n          pass = false;\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n      }\n    });\n    return s;\n  }\n\n  function write_BrtBeginSst(sst, o) {\n    if (!o) o = new_buf(8);\n    o.write_shift(4, sst.Count);\n    o.write_shift(4, sst.Unique);\n    return o;\n  }\n\n  var write_BrtSSTItem = write_RichStr;\n\n  function write_sst_bin(sst, opts) {\n    var ba = buf_array();\n    write_record(ba, \"BrtBeginSst\", write_BrtBeginSst(sst));\n\n    for (var i = 0; i < sst.length; ++i) write_record(ba, \"BrtSSTItem\", write_BrtSSTItem(sst[i]));\n\n    write_record(ba, \"BrtEndSst\");\n    return ba.end();\n  }\n\n  function _JS2ANSI(str) {\n    if (typeof cptable !== 'undefined') return cptable.utils.encode(1252, str);\n    return str.split(\"\").map(function (x) {\n      return x.charCodeAt(0);\n    });\n  }\n  /* [MS-OFFCRYPTO] 2.1.4 Version */\n\n\n  function parse_Version(blob, length) {\n    var o = {};\n    o.Major = blob.read_shift(2);\n    o.Minor = blob.read_shift(2);\n    return o;\n  }\n  /* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\n\n\n  function parse_EncryptionHeader(blob, length) {\n    var o = {};\n    o.Flags = blob.read_shift(4); // Check if SizeExtra is 0x00000000\n\n    var tmp = blob.read_shift(4);\n    if (tmp !== 0) throw 'Unrecognized SizeExtra: ' + tmp;\n    o.AlgID = blob.read_shift(4);\n\n    switch (o.AlgID) {\n      case 0:\n      case 0x6801:\n      case 0x660E:\n      case 0x660F:\n      case 0x6610:\n        break;\n\n      default:\n        throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n    }\n\n    parsenoop(blob, length - 12);\n    return o;\n  }\n  /* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\n\n\n  function parse_EncryptionVerifier(blob, length) {\n    return parsenoop(blob, length);\n  }\n  /* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\n\n\n  function parse_RC4CryptoHeader(blob, length) {\n    var o = {};\n    var vers = o.EncryptionVersionInfo = parse_Version(blob, 4);\n    length -= 4;\n    if (vers.Minor != 2) throw 'unrecognized minor version code: ' + vers.Minor;\n    if (vers.Major > 4 || vers.Major < 2) throw 'unrecognized major version code: ' + vers.Major;\n    o.Flags = blob.read_shift(4);\n    length -= 4;\n    var sz = blob.read_shift(4);\n    length -= 4;\n    o.EncryptionHeader = parse_EncryptionHeader(blob, sz);\n    length -= sz;\n    o.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n    return o;\n  }\n  /* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\n\n\n  function parse_RC4Header(blob, length) {\n    var o = {};\n    var vers = o.EncryptionVersionInfo = parse_Version(blob, 4);\n    length -= 4;\n    if (vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n    o.Salt = blob.read_shift(16);\n    o.EncryptedVerifier = blob.read_shift(16);\n    o.EncryptedVerifierHash = blob.read_shift(16);\n    return o;\n  }\n  /* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\n\n\n  function crypto_CreatePasswordVerifier_Method1(Password) {\n    var Verifier = 0x0000,\n        PasswordArray;\n\n    var PasswordDecoded = _JS2ANSI(Password);\n\n    var len = PasswordDecoded.length + 1,\n        i,\n        PasswordByte;\n    var Intermediate1, Intermediate2, Intermediate3;\n    PasswordArray = new_raw_buf(len);\n    PasswordArray[0] = PasswordDecoded.length;\n\n    for (i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i - 1];\n\n    for (i = len - 1; i >= 0; --i) {\n      PasswordByte = PasswordArray[i];\n      Intermediate1 = (Verifier & 0x4000) === 0x0000 ? 0 : 1;\n      Intermediate2 = Verifier << 1 & 0x7FFF;\n      Intermediate3 = Intermediate1 | Intermediate2;\n      Verifier = Intermediate3 ^ PasswordByte;\n    }\n\n    return Verifier ^ 0xCE4B;\n  }\n  /* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\n\n\n  var crypto_CreateXorArray_Method1 = function () {\n    var PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n    var InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n    var XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n\n    var Ror = function (Byte) {\n      return (Byte / 2 | Byte * 128) & 0xFF;\n    };\n\n    var XorRor = function (byte1, byte2) {\n      return Ror(byte1 ^ byte2);\n    };\n\n    var CreateXorKey_Method1 = function (Password) {\n      var XorKey = InitialCode[Password.length - 1];\n      var CurrentElement = 0x68;\n\n      for (var i = Password.length - 1; i >= 0; --i) {\n        var Char = Password[i];\n\n        for (var j = 0; j != 7; ++j) {\n          if (Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n          Char *= 2;\n          --CurrentElement;\n        }\n      }\n\n      return XorKey;\n    };\n\n    return function (password) {\n      var Password = _JS2ANSI(password);\n\n      var XorKey = CreateXorKey_Method1(Password);\n      var Index = Password.length;\n      var ObfuscationArray = new_raw_buf(16);\n\n      for (var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\n\n      var Temp, PasswordLastChar, PadIndex;\n\n      if ((Index & 1) === 1) {\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n        --Index;\n        Temp = XorKey & 0xFF;\n        PasswordLastChar = Password[Password.length - 1];\n        ObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n      }\n\n      while (Index > 0) {\n        --Index;\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n        --Index;\n        Temp = XorKey & 0xFF;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n      }\n\n      Index = 15;\n      PadIndex = 15 - Password.length;\n\n      while (PadIndex > 0) {\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n        --Index;\n        --PadIndex;\n        Temp = XorKey & 0xFF;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n        --Index;\n        --PadIndex;\n      }\n\n      return ObfuscationArray;\n    };\n  }();\n  /* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\n\n\n  var crypto_DecryptData_Method1 = function (password, Data, XorArrayIndex, XorArray, O) {\n    /* If XorArray is set, use it; if O is not set, make changes in-place */\n    if (!O) O = Data;\n    if (!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n    var Index, Value;\n\n    for (Index = 0; Index != Data.length; ++Index) {\n      Value = Data[Index];\n      Value ^= XorArray[XorArrayIndex];\n      Value = (Value >> 5 | Value << 3) & 0xFF;\n      O[Index] = Value;\n      ++XorArrayIndex;\n    }\n\n    return [O, XorArrayIndex, XorArray];\n  };\n\n  var crypto_MakeXorDecryptor = function (password) {\n    var XorArrayIndex = 0,\n        XorArray = crypto_CreateXorArray_Method1(password);\n    return function (Data) {\n      var O = crypto_DecryptData_Method1(null, Data, XorArrayIndex, XorArray);\n      XorArrayIndex = O[1];\n      return O[0];\n    };\n  };\n  /* 2.5.343 */\n\n\n  function parse_XORObfuscation(blob, length, opts, out) {\n    var o = {\n      key: parseuint16(blob),\n      verificationBytes: parseuint16(blob)\n    };\n    if (opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n    out.valid = o.verificationBytes === o.verifier;\n    if (out.valid) out.insitu_decrypt = crypto_MakeXorDecryptor(opts.password);\n    return o;\n  }\n  /* 2.4.117 */\n\n\n  function parse_FilePassHeader(blob, length, oo) {\n    var o = oo || {};\n    o.Info = blob.read_shift(2);\n    blob.l -= 2;\n    if (o.Info === 1) o.Data = parse_RC4Header(blob, length);else o.Data = parse_RC4CryptoHeader(blob, length);\n    return o;\n  }\n\n  function parse_FilePass(blob, length, opts) {\n    var o = {\n      Type: blob.read_shift(2)\n    };\n    /* wEncryptionType */\n\n    if (o.Type) parse_FilePassHeader(blob, length - 2, o);else parse_XORObfuscation(blob, length - 2, opts, o);\n    return o;\n  }\n\n  function hex2RGB(h) {\n    var o = h.substr(h[0] === \"#\" ? 1 : 0, 6);\n    return [parseInt(o.substr(0, 2), 16), parseInt(o.substr(2, 2), 16), parseInt(o.substr(4, 2), 16)];\n  }\n\n  function rgb2Hex(rgb) {\n    for (var i = 0, o = 1; i != 3; ++i) o = o * 256 + (rgb[i] > 255 ? 255 : rgb[i] < 0 ? 0 : rgb[i]);\n\n    return o.toString(16).toUpperCase().substr(1);\n  }\n\n  function rgb2HSL(rgb) {\n    var R = rgb[0] / 255,\n        G = rgb[1] / 255,\n        B = rgb[2] / 255;\n    var M = Math.max(R, G, B),\n        m = Math.min(R, G, B),\n        C = M - m;\n    if (C === 0) return [0, 0, R];\n    var H6 = 0,\n        S = 0,\n        L2 = M + m;\n    S = C / (L2 > 1 ? 2 - L2 : L2);\n\n    switch (M) {\n      case R:\n        H6 = ((G - B) / C + 6) % 6;\n        break;\n\n      case G:\n        H6 = (B - R) / C + 2;\n        break;\n\n      case B:\n        H6 = (R - G) / C + 4;\n        break;\n    }\n\n    return [H6 / 6, S, L2 / 2];\n  }\n\n  function hsl2RGB(hsl) {\n    var H = hsl[0],\n        S = hsl[1],\n        L = hsl[2];\n    var C = S * 2 * (L < 0.5 ? L : 1 - L),\n        m = L - C / 2;\n    var rgb = [m, m, m],\n        h6 = 6 * H;\n    var X;\n    if (S !== 0) switch (h6 | 0) {\n      case 0:\n      case 6:\n        X = C * h6;\n        rgb[0] += C;\n        rgb[1] += X;\n        break;\n\n      case 1:\n        X = C * (2 - h6);\n        rgb[0] += X;\n        rgb[1] += C;\n        break;\n\n      case 2:\n        X = C * (h6 - 2);\n        rgb[1] += C;\n        rgb[2] += X;\n        break;\n\n      case 3:\n        X = C * (4 - h6);\n        rgb[1] += X;\n        rgb[2] += C;\n        break;\n\n      case 4:\n        X = C * (h6 - 4);\n        rgb[2] += C;\n        rgb[0] += X;\n        break;\n\n      case 5:\n        X = C * (6 - h6);\n        rgb[2] += X;\n        rgb[0] += C;\n        break;\n    }\n\n    for (var i = 0; i != 3; ++i) rgb[i] = Math.round(rgb[i] * 255);\n\n    return rgb;\n  }\n  /* 18.8.3 bgColor tint algorithm */\n\n\n  function rgb_tint(hex, tint) {\n    if (tint == 0) return hex;\n    var hsl = rgb2HSL(hex2RGB(hex));\n    if (tint < 0) hsl[2] = hsl[2] * (1 + tint);else hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\n    var rev = rgb2Hex(hsl2RGB(hsl));\n    return rev;\n  }\n  /* 18.3.1.13 width calculations */\n\n\n  var DEF_MDW = 7,\n      MAX_MDW = 15,\n      MIN_MDW = 1,\n      MDW = DEF_MDW;\n\n  function width2px(width) {\n    return (width + (128 / MDW | 0) / 256) * MDW | 0;\n  }\n\n  function px2char(px) {\n    return ((px - 5) / MDW * 100 + 0.5 | 0) / 100;\n  }\n\n  function char2width(chr) {\n    return ((chr * MDW + 5) / MDW * 256 | 0) / 256;\n  }\n\n  function cycle_width(collw) {\n    return char2width(px2char(width2px(collw)));\n  }\n\n  function find_mdw(collw, coll) {\n    if (cycle_width(collw) != collw) {\n      for (MDW = DEF_MDW; MDW > MIN_MDW; --MDW) if (cycle_width(collw) === collw) break;\n\n      if (MDW === MIN_MDW) for (MDW = DEF_MDW + 1; MDW < MAX_MDW; ++MDW) if (cycle_width(collw) === collw) break;\n      if (MDW === MAX_MDW) MDW = DEF_MDW;\n    }\n  }\n  /* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\n\n\n  var XLMLPatternTypeMap = {\n    \"None\": \"none\",\n    \"Solid\": \"solid\",\n    \"Gray50\": \"mediumGray\",\n    \"Gray75\": \"darkGray\",\n    \"Gray25\": \"lightGray\",\n    \"HorzStripe\": \"darkHorizontal\",\n    \"VertStripe\": \"darkVertical\",\n    \"ReverseDiagStripe\": \"darkDown\",\n    \"DiagStripe\": \"darkUp\",\n    \"DiagCross\": \"darkGrid\",\n    \"ThickDiagCross\": \"darkTrellis\",\n    \"ThinHorzStripe\": \"lightHorizontal\",\n    \"ThinVertStripe\": \"lightVertical\",\n    \"ThinReverseDiagStripe\": \"lightDown\",\n    \"ThinHorzCross\": \"lightGrid\"\n  };\n  var styles = {}; // shared styles\n\n  var themes = {}; // shared themes\n\n  /* 18.8.21 fills CT_Fills */\n\n  function parse_fills(t, opts) {\n    styles.Fills = [];\n    var fill = {};\n    t[0].match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<fills':\n        case '<fills>':\n        case '</fills>':\n          break;\n\n        /* 18.8.20 fill CT_Fill */\n\n        case '<fill>':\n          break;\n\n        case '</fill>':\n          styles.Fills.push(fill);\n          fill = {};\n          break;\n\n        /* 18.8.32 patternFill CT_PatternFill */\n\n        case '<patternFill':\n          if (y.patternType) fill.patternType = y.patternType;\n          break;\n\n        case '<patternFill/>':\n        case '</patternFill>':\n          break;\n\n        /* 18.8.3 bgColor CT_Color */\n\n        case '<bgColor':\n          if (!fill.bgColor) fill.bgColor = {};\n          if (y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\n          if (y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\n          if (y.tint) fill.bgColor.tint = parseFloat(y.tint);\n\n          if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n            fill.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[fill.bgColor.theme].rgb, fill.bgColor.tint || 0);\n            if (opts.WTF) fill.bgColor.raw_rgb = rgb_tint(themes.themeElements.clrScheme[fill.bgColor.theme].rgb, 0);\n          }\n          /* Excel uses ARGB strings */\n\n\n          if (y.rgb) fill.bgColor.rgb = y.rgb; //.substring(y.rgb.length - 6);\n\n          break;\n\n        case '<bgColor/>':\n        case '</bgColor>':\n          break;\n\n        /* 18.8.19 fgColor CT_Color */\n\n        case '<fgColor':\n          if (!fill.fgColor) fill.fgColor = {};\n          if (y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\n          if (y.tint) fill.fgColor.tint = parseFloat(y.tint);\n\n          if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n            fill.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[fill.fgColor.theme].rgb, fill.fgColor.tint || 0);\n            if (opts.WTF) fill.fgColor.raw_rgb = rgb_tint(themes.themeElements.clrScheme[fill.fgColor.theme].rgb, 0);\n          }\n          /* Excel uses ARGB strings */\n\n\n          if (y.rgb) fill.fgColor.rgb = y.rgb; //.substring(y.rgb.length - 6);\n\n          break;\n\n        case '<fgColor/>':\n        case '</fgColor>':\n          break;\n\n        default:\n          if (opts.WTF) throw 'unrecognized ' + y[0] + ' in fills';\n      }\n    });\n  }\n\n  function parse_fonts(t, opts) {\n    styles.Fonts = [];\n    var font = {};\n    t[0].match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<fonts':\n        case '<fonts>':\n        case '</fonts>':\n          break;\n\n        case '<font':\n          break;\n\n        case '</font>':\n          styles.Fonts.push(font);\n          ;\n          font = {};\n          break;\n\n        case '<name':\n          if (y.val) font.name = y.val;\n          break;\n\n        case '<name/>':\n        case '</name>':\n          break;\n\n        case '<b/>':\n          font.bold = true;\n          break;\n\n        case '<u/>':\n          font.underline = true;\n          break;\n\n        case '<i/>':\n          font.italic = true;\n          break;\n\n        case '<strike/>':\n          font.strike = true;\n          break;\n\n        case '<outline/>':\n          font.outline = true;\n          break;\n\n        case '<shadow/>':\n          font.shadow = true;\n          break;\n\n        case '<sz':\n          if (y.val) font.sz = y.val;\n          break;\n\n        case '<sz/>':\n        case '</sz>':\n          break;\n\n        case '<vertAlign':\n          if (y.val) font.vertAlign = y.val;\n          break;\n\n        case '<vertAlign/>':\n        case '</vertAlign>':\n          break;\n\n        case '<color':\n          if (!font.color) font.color = {};\n          if (y.theme) font.color.theme = y.theme;\n          if (y.tint) font.color.tint = y.tint;\n\n          if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n            font.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\n          }\n\n          if (y.rgb) font.color.rgb = y.rgb;\n          break;\n\n        case '<color/>':\n        case '</color>':\n          break;\n      }\n    });\n  }\n\n  function parse_borders(t, opts) {\n    styles.Borders = [];\n    var border = {},\n        sub_border = {};\n    t[0].match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<borders':\n        case '<borders>':\n        case '</borders>':\n          break;\n\n        case '<border':\n        case '<border>':\n          border = {};\n\n          if (y.diagonalUp) {\n            border.diagonalUp = y.diagonalUp;\n          }\n\n          if (y.diagonalDown) {\n            border.diagonalDown = y.diagonalDown;\n          }\n\n          styles.Borders.push(border);\n          break;\n          break;\n\n        case '</border>':\n          break;\n\n        case '<left':\n          sub_border = border.left = {};\n\n          if (y.style) {\n            sub_border.style = y.style;\n          }\n\n          break;\n\n        case '<right':\n          sub_border = border.right = {};\n\n          if (y.style) {\n            sub_border.style = y.style;\n          }\n\n          break;\n\n        case '<top':\n          sub_border = border.top = {};\n\n          if (y.style) {\n            sub_border.style = y.style;\n          }\n\n          break;\n\n        case '<bottom':\n          sub_border = border.bottom = {};\n\n          if (y.style) {\n            sub_border.style = y.style;\n          }\n\n          break;\n\n        case '<diagonal':\n          sub_border = border.diagonal = {};\n\n          if (y.style) {\n            sub_border.style = y.style;\n          }\n\n          break;\n\n        case '<color':\n          sub_border.color = {};\n          if (y.theme) sub_border.color.theme = y.theme;\n\n          if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n            sub_border.color.rgb = rgb_tint(themes.themeElements.clrScheme[sub_border.color.theme].rgb, sub_border.color.tint || 0);\n          }\n\n          if (y.tint) sub_border.color.tint = y.tint;\n          if (y.rgb) sub_border.color.rgb = y.rgb;\n          if (y.auto) sub_border.color.auto = y.auto;\n          break;\n\n        case '<name/>':\n        case '</name>':\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n  /* 18.8.31 numFmts CT_NumFmts */\n\n\n  function parse_numFmts(t, opts) {\n    styles.NumberFmt = [];\n    var k = keys(SSF._table);\n\n    for (var i = 0; i < k.length; ++i) styles.NumberFmt[k[i]] = SSF._table[k[i]];\n\n    var m = t[0].match(tagregex);\n\n    for (i = 0; i < m.length; ++i) {\n      var y = parsexmltag(m[i]);\n\n      switch (y[0]) {\n        case '<numFmts':\n        case '</numFmts>':\n        case '<numFmts/>':\n        case '<numFmts>':\n          break;\n\n        case '<numFmt':\n          {\n            var f = unescapexml(utf8read(y.formatCode)),\n                j = parseInt(y.numFmtId, 10);\n            styles.NumberFmt[j] = f;\n            if (j > 0) SSF.load(f, j);\n          }\n          break;\n\n        default:\n          if (opts.WTF) throw 'unrecognized ' + y[0] + ' in numFmts';\n      }\n    }\n  }\n\n  function write_numFmts(NF, opts) {\n    var o = [\"<numFmts>\"];\n    [[5, 8], [23, 26], [41, 44], [63, 66], [164, 392]].forEach(function (r) {\n      for (var i = r[0]; i <= r[1]; ++i) if (NF[i] !== undefined) o[o.length] = writextag('numFmt', null, {\n        numFmtId: i,\n        formatCode: escapexml(NF[i])\n      });\n    });\n    if (o.length === 1) return \"\";\n    o[o.length] = \"</numFmts>\";\n    o[0] = writextag('numFmts', null, {\n      count: o.length - 2\n    }).replace(\"/>\", \">\");\n    return o.join(\"\");\n  }\n  /* 18.8.10 cellXfs CT_CellXfs */\n\n\n  function parse_cellXfs(t, opts) {\n    styles.CellXf = [];\n    var xf;\n    t[0].match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<cellXfs':\n        case '<cellXfs>':\n        case '<cellXfs/>':\n        case '</cellXfs>':\n          break;\n\n        /* 18.8.45 xf CT_Xf */\n\n        case '<xf':\n          xf = y;\n          delete xf[0];\n          delete y[0];\n          if (xf.numFmtId) xf.numFmtId = parseInt(xf.numFmtId, 10);\n          if (xf.fillId) xf.fillId = parseInt(xf.fillId, 10);\n          styles.CellXf.push(xf);\n          break;\n\n        case '</xf>':\n          break;\n\n        /* 18.8.1 alignment CT_CellAlignment */\n\n        case '<alignment':\n        case '<alignment/>':\n          var alignment = {};\n\n          if (y.vertical) {\n            alignment.vertical = y.vertical;\n          }\n\n          if (y.horizontal) {\n            alignment.horizontal = y.horizontal;\n          }\n\n          if (y.textRotation != undefined) {\n            alignment.textRotation = y.textRotation;\n          }\n\n          if (y.indent) {\n            alignment.indent = y.indent;\n          }\n\n          if (y.wrapText) {\n            alignment.wrapText = y.wrapText;\n          }\n\n          xf.alignment = alignment;\n          break;\n\n        /* 18.8.33 protection CT_CellProtection */\n\n        case '<protection':\n        case '</protection>':\n        case '<protection/>':\n          break;\n\n        case '<extLst':\n        case '</extLst>':\n          break;\n\n        case '<ext':\n          break;\n\n        default:\n          if (opts.WTF) throw 'unrecognized ' + y[0] + ' in cellXfs';\n      }\n    });\n  }\n\n  function write_cellXfs(cellXfs) {\n    var o = [];\n    o[o.length] = writextag('cellXfs', null);\n    cellXfs.forEach(function (c) {\n      o[o.length] = writextag('xf', null, c);\n    });\n    o[o.length] = \"</cellXfs>\";\n    if (o.length === 2) return \"\";\n    o[0] = writextag('cellXfs', null, {\n      count: o.length - 2\n    }).replace(\"/>\", \">\");\n    return o.join(\"\");\n  }\n  /* 18.8 Styles CT_Stylesheet*/\n\n\n  var parse_sty_xml = function make_pstyx() {\n    var numFmtRegex = /<numFmts([^>]*)>.*<\\/numFmts>/;\n    var cellXfRegex = /<cellXfs([^>]*)>.*<\\/cellXfs>/;\n    var fillsRegex = /<fills([^>]*)>.*<\\/fills>/;\n    var bordersRegex = /<borders([^>]*)>.*<\\/borders>/;\n    return function parse_sty_xml(data, opts) {\n      /* 18.8.39 styleSheet CT_Stylesheet */\n      var t;\n      /* numFmts CT_NumFmts ? */\n\n      if (t = data.match(numFmtRegex)) parse_numFmts(t, opts);\n      /* fonts CT_Fonts ? */\n\n      if (t = data.match(/<fonts([^>]*)>.*<\\/fonts>/)) parse_fonts(t, opts);\n      /* fills CT_Fills */\n\n      if (t = data.match(fillsRegex)) parse_fills(t, opts);\n      /* borders CT_Borders ? */\n\n      if (t = data.match(bordersRegex)) parse_borders(t, opts);\n      /* cellStyleXfs CT_CellStyleXfs ? */\n\n      /* cellXfs CT_CellXfs ? */\n\n      if (t = data.match(cellXfRegex)) parse_cellXfs(t, opts);\n      /* dxfs CT_Dxfs ? */\n\n      /* tableStyles CT_TableStyles ? */\n\n      /* colors CT_Colors ? */\n\n      /* extLst CT_ExtensionList ? */\n\n      return styles;\n    };\n  }();\n\n  var STYLES_XML_ROOT = writextag('styleSheet', null, {\n    'xmlns': XMLNS.main[0],\n    'xmlns:vt': XMLNS.vt\n  });\n  RELS.STY = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\";\n\n  function write_sty_xml(wb, opts) {\n    if (typeof style_builder != 'undefined' && typeof 'require' != 'undefined') {\n      return style_builder.toXml();\n    }\n\n    var o = [XML_HEADER, STYLES_XML_ROOT],\n        w;\n    if ((w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\n    o[o.length] = '<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>';\n    o[o.length] = '<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>';\n    o[o.length] = '<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>';\n    o[o.length] = '<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>';\n    if (w = write_cellXfs(opts.cellXfs)) o[o.length] = w;\n    o[o.length] = '<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>';\n    o[o.length] = '<dxfs count=\"0\"/>';\n    o[o.length] = '<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>';\n\n    if (o.length > 2) {\n      o[o.length] = '</styleSheet>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* [MS-XLSB] 2.4.651 BrtFmt */\n\n\n  function parse_BrtFmt(data, length) {\n    var ifmt = data.read_shift(2);\n    var stFmtCode = parse_XLWideString(data, length - 2);\n    return [ifmt, stFmtCode];\n  }\n  /* [MS-XLSB] 2.4.653 BrtFont TODO */\n\n\n  function parse_BrtFont(data, length) {\n    var out = {\n      flags: {}\n    };\n    out.dyHeight = data.read_shift(2);\n    out.grbit = parse_FontFlags(data, 2);\n    out.bls = data.read_shift(2);\n    out.sss = data.read_shift(2);\n    out.uls = data.read_shift(1);\n    out.bFamily = data.read_shift(1);\n    out.bCharSet = data.read_shift(1);\n    data.l++;\n    out.brtColor = parse_BrtColor(data, 8);\n    out.bFontScheme = data.read_shift(1);\n    out.name = parse_XLWideString(data, length - 21);\n    out.flags.Bold = out.bls === 0x02BC;\n    out.flags.Italic = out.grbit.fItalic;\n    out.flags.Strikeout = out.grbit.fStrikeout;\n    out.flags.Outline = out.grbit.fOutline;\n    out.flags.Shadow = out.grbit.fShadow;\n    out.flags.Condense = out.grbit.fCondense;\n    out.flags.Extend = out.grbit.fExtend;\n    out.flags.Sub = out.sss & 0x2;\n    out.flags.Sup = out.sss & 0x1;\n    return out;\n  }\n  /* [MS-XLSB] 2.4.816 BrtXF */\n\n\n  function parse_BrtXF(data, length) {\n    var ixfeParent = data.read_shift(2);\n    var ifmt = data.read_shift(2);\n    parsenoop(data, length - 4);\n    return {\n      ixfe: ixfeParent,\n      ifmt: ifmt\n    };\n  }\n  /* [MS-XLSB] 2.1.7.50 Styles */\n\n\n  function parse_sty_bin(data, opts) {\n    styles.NumberFmt = [];\n\n    for (var y in SSF._table) styles.NumberFmt[y] = SSF._table[y];\n\n    styles.CellXf = [];\n    var state = \"\";\n    /* TODO: this should be a stack */\n\n    var pass = false;\n    recordhopper(data, function hopper_sty(val, R, RT) {\n      switch (R.n) {\n        case 'BrtFmt':\n          styles.NumberFmt[val[0]] = val[1];\n          SSF.load(val[1], val[0]);\n          break;\n\n        case 'BrtFont':\n          break;\n\n        /* TODO */\n\n        case 'BrtKnownFonts':\n          break;\n\n        /* TODO */\n\n        case 'BrtFill':\n          break;\n\n        /* TODO */\n\n        case 'BrtBorder':\n          break;\n\n        /* TODO */\n\n        case 'BrtXF':\n          if (state === \"CELLXFS\") {\n            styles.CellXf.push(val);\n          }\n\n          break;\n\n        /* TODO */\n\n        case 'BrtStyle':\n          break;\n\n        /* TODO */\n\n        case 'BrtDXF':\n          break;\n\n        /* TODO */\n\n        case 'BrtMRUColor':\n          break;\n\n        /* TODO */\n\n        case 'BrtIndexedColor':\n          break;\n\n        /* TODO */\n\n        case 'BrtBeginStyleSheet':\n          break;\n\n        case 'BrtEndStyleSheet':\n          break;\n\n        case 'BrtBeginTableStyle':\n          break;\n\n        case 'BrtTableStyleElement':\n          break;\n\n        case 'BrtEndTableStyle':\n          break;\n\n        case 'BrtBeginFmts':\n          state = \"FMTS\";\n          break;\n\n        case 'BrtEndFmts':\n          state = \"\";\n          break;\n\n        case 'BrtBeginFonts':\n          state = \"FONTS\";\n          break;\n\n        case 'BrtEndFonts':\n          state = \"\";\n          break;\n\n        case 'BrtACBegin':\n          state = \"ACFONTS\";\n          break;\n\n        case 'BrtACEnd':\n          state = \"\";\n          break;\n\n        case 'BrtBeginFills':\n          state = \"FILLS\";\n          break;\n\n        case 'BrtEndFills':\n          state = \"\";\n          break;\n\n        case 'BrtBeginBorders':\n          state = \"BORDERS\";\n          break;\n\n        case 'BrtEndBorders':\n          state = \"\";\n          break;\n\n        case 'BrtBeginCellStyleXFs':\n          state = \"CELLSTYLEXFS\";\n          break;\n\n        case 'BrtEndCellStyleXFs':\n          state = \"\";\n          break;\n\n        case 'BrtBeginCellXFs':\n          state = \"CELLXFS\";\n          break;\n\n        case 'BrtEndCellXFs':\n          state = \"\";\n          break;\n\n        case 'BrtBeginStyles':\n          state = \"STYLES\";\n          break;\n\n        case 'BrtEndStyles':\n          state = \"\";\n          break;\n\n        case 'BrtBeginDXFs':\n          state = \"DXFS\";\n          break;\n\n        case 'BrtEndDXFs':\n          state = \"\";\n          break;\n\n        case 'BrtBeginTableStyles':\n          state = \"TABLESTYLES\";\n          break;\n\n        case 'BrtEndTableStyles':\n          state = \"\";\n          break;\n\n        case 'BrtBeginColorPalette':\n          state = \"COLORPALETTE\";\n          break;\n\n        case 'BrtEndColorPalette':\n          state = \"\";\n          break;\n\n        case 'BrtBeginIndexedColors':\n          state = \"INDEXEDCOLORS\";\n          break;\n\n        case 'BrtEndIndexedColors':\n          state = \"\";\n          break;\n\n        case 'BrtBeginMRUColors':\n          state = \"MRUCOLORS\";\n          break;\n\n        case 'BrtEndMRUColors':\n          state = \"\";\n          break;\n\n        case 'BrtFRTBegin':\n          pass = true;\n          break;\n\n        case 'BrtFRTEnd':\n          pass = false;\n          break;\n\n        case 'BrtBeginStyleSheetExt14':\n          break;\n\n        case 'BrtBeginSlicerStyles':\n          break;\n\n        case 'BrtEndSlicerStyles':\n          break;\n\n        case 'BrtBeginTimelineStylesheetExt15':\n          break;\n\n        case 'BrtEndTimelineStylesheetExt15':\n          break;\n\n        case 'BrtBeginTimelineStyles':\n          break;\n\n        case 'BrtEndTimelineStyles':\n          break;\n\n        case 'BrtEndStyleSheetExt14':\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n      }\n    });\n    return styles;\n  }\n  /* [MS-XLSB] 2.1.7.50 Styles */\n\n\n  function write_sty_bin(data, opts) {\n    var ba = buf_array();\n    write_record(ba, \"BrtBeginStyleSheet\");\n    /* [FMTS] */\n\n    /* [FONTS] */\n\n    /* [FILLS] */\n\n    /* [BORDERS] */\n\n    /* CELLSTYLEXFS */\n\n    /* CELLXFS*/\n\n    /* STYLES */\n\n    /* DXFS */\n\n    /* TABLESTYLES */\n\n    /* [COLORPALETTE] */\n\n    /* FRTSTYLESHEET*/\n\n    write_record(ba, \"BrtEndStyleSheet\");\n    return ba.end();\n  }\n\n  RELS.THEME = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\";\n  /* 20.1.6.2 clrScheme CT_ColorScheme */\n\n  function parse_clrScheme(t, opts) {\n    themes.themeElements.clrScheme = [];\n    var color = {};\n    t[0].match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<a:clrScheme':\n        case '</a:clrScheme>':\n          break;\n\n        /* 20.1.2.3.32 srgbClr CT_SRgbColor */\n\n        case '<a:srgbClr':\n          color.rgb = y.val;\n          break;\n\n        /* 20.1.2.3.33 sysClr CT_SystemColor */\n\n        case '<a:sysClr':\n          color.rgb = y.lastClr;\n          break;\n\n        /* 20.1.4.1.9 dk1 (Dark 1) */\n\n        case '<a:dk1>':\n        case '</a:dk1>':\n        /* 20.1.4.1.10 dk2 (Dark 2) */\n\n        case '<a:dk2>':\n        case '</a:dk2>':\n        /* 20.1.4.1.22 lt1 (Light 1) */\n\n        case '<a:lt1>':\n        case '</a:lt1>':\n        /* 20.1.4.1.23 lt2 (Light 2) */\n\n        case '<a:lt2>':\n        case '</a:lt2>':\n        /* 20.1.4.1.1 accent1 (Accent 1) */\n\n        case '<a:accent1>':\n        case '</a:accent1>':\n        /* 20.1.4.1.2 accent2 (Accent 2) */\n\n        case '<a:accent2>':\n        case '</a:accent2>':\n        /* 20.1.4.1.3 accent3 (Accent 3) */\n\n        case '<a:accent3>':\n        case '</a:accent3>':\n        /* 20.1.4.1.4 accent4 (Accent 4) */\n\n        case '<a:accent4>':\n        case '</a:accent4>':\n        /* 20.1.4.1.5 accent5 (Accent 5) */\n\n        case '<a:accent5>':\n        case '</a:accent5>':\n        /* 20.1.4.1.6 accent6 (Accent 6) */\n\n        case '<a:accent6>':\n        case '</a:accent6>':\n        /* 20.1.4.1.19 hlink (Hyperlink) */\n\n        case '<a:hlink>':\n        case '</a:hlink>':\n        /* 20.1.4.1.15 folHlink (Followed Hyperlink) */\n\n        case '<a:folHlink>':\n        case '</a:folHlink>':\n          if (y[0][1] === '/') {\n            themes.themeElements.clrScheme.push(color);\n            color = {};\n          } else {\n            color.name = y[0].substring(3, y[0].length - 1);\n          }\n\n          break;\n\n        default:\n          if (opts.WTF) throw 'unrecognized ' + y[0] + ' in clrScheme';\n      }\n    });\n  }\n  /* 20.1.4.1.18 fontScheme CT_FontScheme */\n\n\n  function parse_fontScheme(t, opts) {}\n  /* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\n\n\n  function parse_fmtScheme(t, opts) {}\n\n  var clrsregex = /<a:clrScheme([^>]*)>[^\\u2603]*<\\/a:clrScheme>/;\n  var fntsregex = /<a:fontScheme([^>]*)>[^\\u2603]*<\\/a:fontScheme>/;\n  var fmtsregex = /<a:fmtScheme([^>]*)>[^\\u2603]*<\\/a:fmtScheme>/;\n  /* 20.1.6.10 themeElements CT_BaseStyles */\n\n  function parse_themeElements(data, opts) {\n    themes.themeElements = {};\n    var t;\n    [\n    /* clrScheme CT_ColorScheme */\n    ['clrScheme', clrsregex, parse_clrScheme],\n    /* fontScheme CT_FontScheme */\n    ['fontScheme', fntsregex, parse_fontScheme],\n    /* fmtScheme CT_StyleMatrix */\n    ['fmtScheme', fmtsregex, parse_fmtScheme]].forEach(function (m) {\n      if (!(t = data.match(m[1]))) throw m[0] + ' not found in themeElements';\n      m[2](t, opts);\n    });\n  }\n\n  var themeltregex = /<a:themeElements([^>]*)>[^\\u2603]*<\\/a:themeElements>/;\n  /* 14.2.7 Theme Part */\n\n  function parse_theme_xml(data, opts) {\n    /* 20.1.6.9 theme CT_OfficeStyleSheet */\n    if (!data || data.length === 0) return themes;\n    var t;\n    /* themeElements CT_BaseStyles */\n\n    if (!(t = data.match(themeltregex))) throw 'themeElements not found in theme';\n    parse_themeElements(t[0], opts);\n    return themes;\n  } //function write_theme() { return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>'; }\n\n\n  function write_theme(opts) {\n    if (opts.themeXml) {\n      return opts.themeXml;\n    }\n\n    return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>';\n  }\n  /* [MS-XLS] 2.4.326 TODO: payload is a zip file */\n\n\n  function parse_Theme(blob, length) {\n    var dwThemeVersion = blob.read_shift(4);\n    if (dwThemeVersion === 124226) return;\n    blob.l += length - 4;\n  }\n  /* 2.5.49 */\n\n\n  function parse_ColorTheme(blob, length) {\n    return blob.read_shift(4);\n  }\n  /* 2.5.155 */\n\n\n  function parse_FullColorExt(blob, length) {\n    var o = {};\n    o.xclrType = blob.read_shift(2);\n    o.nTintShade = blob.read_shift(2);\n\n    switch (o.xclrType) {\n      case 0:\n        blob.l += 4;\n        break;\n\n      case 1:\n        o.xclrValue = parse_IcvXF(blob, 4);\n        break;\n\n      case 2:\n        o.xclrValue = parse_LongRGBA(blob, 4);\n        break;\n\n      case 3:\n        o.xclrValue = parse_ColorTheme(blob, 4);\n        break;\n\n      case 4:\n        blob.l += 4;\n        break;\n    }\n\n    blob.l += 8;\n    return o;\n  }\n  /* 2.5.164 TODO: read 7 bits*/\n\n\n  function parse_IcvXF(blob, length) {\n    return parsenoop(blob, length);\n  }\n  /* 2.5.280 */\n\n\n  function parse_XFExtGradient(blob, length) {\n    return parsenoop(blob, length);\n  }\n  /* 2.5.108 */\n\n\n  function parse_ExtProp(blob, length) {\n    var extType = blob.read_shift(2);\n    var cb = blob.read_shift(2);\n    var o = [extType];\n\n    switch (extType) {\n      case 0x04:\n      case 0x05:\n      case 0x07:\n      case 0x08:\n      case 0x09:\n      case 0x0A:\n      case 0x0B:\n      case 0x0D:\n        o[1] = parse_FullColorExt(blob, cb);\n        break;\n\n      case 0x06:\n        o[1] = parse_XFExtGradient(blob, cb);\n        break;\n\n      case 0x0E:\n      case 0x0F:\n        o[1] = blob.read_shift(cb === 5 ? 1 : 2);\n        break;\n\n      default:\n        throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n    }\n\n    return o;\n  }\n  /* 2.4.355 */\n\n\n  function parse_XFExt(blob, length) {\n    var end = blob.l + length;\n    blob.l += 2;\n    var ixfe = blob.read_shift(2);\n    blob.l += 2;\n    var cexts = blob.read_shift(2);\n    var ext = [];\n\n    while (cexts-- > 0) ext.push(parse_ExtProp(blob, end - blob.l));\n\n    return {\n      ixfe: ixfe,\n      ext: ext\n    };\n  }\n  /* xf is an XF, see parse_XFExt for xfext */\n\n\n  function update_xfext(xf, xfext) {\n    xfext.forEach(function (xfe) {\n      switch (xfe[0]) {\n        /* 2.5.108 extPropData */\n        case 0x04:\n          break;\n\n        /* foreground color */\n\n        case 0x05:\n          break;\n\n        /* background color */\n\n        case 0x07:\n        case 0x08:\n        case 0x09:\n        case 0x0a:\n          break;\n\n        case 0x0d:\n          break;\n\n        /* text color */\n\n        case 0x0e:\n          break;\n\n        /* font scheme */\n\n        default:\n          throw \"bafuq\" + xfe[0].toString(16);\n      }\n    });\n  }\n  /* 18.6 Calculation Chain */\n\n\n  function parse_cc_xml(data, opts) {\n    var d = [];\n    var l = 0,\n        i = 1;\n    (data.match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<?xml':\n          break;\n\n        /* 18.6.2  calcChain CT_CalcChain 1 */\n\n        case '<calcChain':\n        case '<calcChain>':\n        case '</calcChain>':\n          break;\n\n        /* 18.6.1  c CT_CalcCell 1 */\n\n        case '<c':\n          delete y[0];\n          if (y.i) i = y.i;else y.i = i;\n          d.push(y);\n          break;\n      }\n    });\n    return d;\n  }\n\n  function write_cc_xml(data, opts) {}\n  /* [MS-XLSB] 2.6.4.1 */\n\n\n  function parse_BrtCalcChainItem$(data, length) {\n    var out = {};\n    out.i = data.read_shift(4);\n    var cell = {};\n    cell.r = data.read_shift(4);\n    cell.c = data.read_shift(4);\n    out.r = encode_cell(cell);\n    var flags = data.read_shift(1);\n    if (flags & 0x2) out.l = '1';\n    if (flags & 0x8) out.a = '1';\n    return out;\n  }\n  /* 18.6 Calculation Chain */\n\n\n  function parse_cc_bin(data, opts) {\n    var out = [];\n    var pass = false;\n    recordhopper(data, function hopper_cc(val, R, RT) {\n      switch (R.n) {\n        case 'BrtCalcChainItem$':\n          out.push(val);\n          break;\n\n        case 'BrtBeginCalcChain$':\n          break;\n\n        case 'BrtEndCalcChain$':\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n      }\n    });\n    return out;\n  }\n\n  function write_cc_bin(data, opts) {}\n\n  function parse_comments(zip, dirComments, sheets, sheetRels, opts) {\n    for (var i = 0; i != dirComments.length; ++i) {\n      var canonicalpath = dirComments[i];\n      var comments = parse_cmnt(getzipdata(zip, canonicalpath.replace(/^\\//, ''), true), canonicalpath, opts);\n      if (!comments || !comments.length) continue; // find the sheets targeted by these comments\n\n      var sheetNames = keys(sheets);\n\n      for (var j = 0; j != sheetNames.length; ++j) {\n        var sheetName = sheetNames[j];\n        var rels = sheetRels[sheetName];\n\n        if (rels) {\n          var rel = rels[canonicalpath];\n          if (rel) insertCommentsIntoSheet(sheetName, sheets[sheetName], comments);\n        }\n      }\n    }\n  }\n\n  function insertCommentsIntoSheet(sheetName, sheet, comments) {\n    comments.forEach(function (comment) {\n      var cell = sheet[comment.ref];\n\n      if (!cell) {\n        cell = {};\n        sheet[comment.ref] = cell;\n        var range = safe_decode_range(sheet[\"!ref\"] || \"BDWGO1000001:A1\");\n        var thisCell = decode_cell(comment.ref);\n        if (range.s.r > thisCell.r) range.s.r = thisCell.r;\n        if (range.e.r < thisCell.r) range.e.r = thisCell.r;\n        if (range.s.c > thisCell.c) range.s.c = thisCell.c;\n        if (range.e.c < thisCell.c) range.e.c = thisCell.c;\n        var encoded = encode_range(range);\n        if (encoded !== sheet[\"!ref\"]) sheet[\"!ref\"] = encoded;\n      }\n\n      if (!cell.c) cell.c = [];\n      var o = {\n        a: comment.author,\n        t: comment.t,\n        r: comment.r\n      };\n      if (comment.h) o.h = comment.h;\n      cell.c.push(o);\n    });\n  }\n  /* 18.7.3 CT_Comment */\n\n\n  function parse_comments_xml(data, opts) {\n    if (data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\n    var authors = [];\n    var commentList = [];\n    data.match(/<(?:\\w+:)?authors>([^\\u2603]*)<\\/(?:\\w+:)?authors>/)[1].split(/<\\/\\w*:?author>/).forEach(function (x) {\n      if (x === \"\" || x.trim() === \"\") return;\n      authors.push(x.match(/<(?:\\w+:)?author[^>]*>(.*)/)[1]);\n    });\n    (data.match(/<(?:\\w+:)?commentList>([^\\u2603]*)<\\/(?:\\w+:)?commentList>/) || [\"\", \"\"])[1].split(/<\\/\\w*:?comment>/).forEach(function (x, index) {\n      if (x === \"\" || x.trim() === \"\") return;\n      var y = parsexmltag(x.match(/<(?:\\w+:)?comment[^>]*>/)[0]);\n      var comment = {\n        author: y.authorId && authors[y.authorId] ? authors[y.authorId] : undefined,\n        ref: y.ref,\n        guid: y.guid\n      };\n      var cell = decode_cell(y.ref);\n      if (opts.sheetRows && opts.sheetRows <= cell.r) return;\n      var textMatch = x.match(/<text>([^\\u2603]*)<\\/text>/);\n      if (!textMatch || !textMatch[1]) return; // a comment may contain an empty text tag.\n\n      var rt = parse_si(textMatch[1]);\n      comment.r = rt.r;\n      comment.t = rt.t;\n      if (opts.cellHTML) comment.h = rt.h;\n      commentList.push(comment);\n    });\n    return commentList;\n  }\n\n  function write_comments_xml(data, opts) {}\n  /* [MS-XLSB] 2.4.28 BrtBeginComment */\n\n\n  function parse_BrtBeginComment(data, length) {\n    var out = {};\n    out.iauthor = data.read_shift(4);\n    var rfx = parse_UncheckedRfX(data, 16);\n    out.rfx = rfx.s;\n    out.ref = encode_cell(rfx.s);\n    data.l += 16;\n    /*var guid = parse_GUID(data); */\n\n    return out;\n  }\n  /* [MS-XLSB] 2.4.324 BrtCommentAuthor */\n\n\n  var parse_BrtCommentAuthor = parse_XLWideString;\n  /* [MS-XLSB] 2.4.325 BrtCommentText */\n\n  var parse_BrtCommentText = parse_RichStr;\n  /* [MS-XLSB] 2.1.7.8 Comments */\n\n  function parse_comments_bin(data, opts) {\n    var out = [];\n    var authors = [];\n    var c = {};\n    var pass = false;\n    recordhopper(data, function hopper_cmnt(val, R, RT) {\n      switch (R.n) {\n        case 'BrtCommentAuthor':\n          authors.push(val);\n          break;\n\n        case 'BrtBeginComment':\n          c = val;\n          break;\n\n        case 'BrtCommentText':\n          c.t = val.t;\n          c.h = val.h;\n          c.r = val.r;\n          break;\n\n        case 'BrtEndComment':\n          c.author = authors[c.iauthor];\n          delete c.iauthor;\n          if (opts.sheetRows && opts.sheetRows <= c.rfx.r) break;\n          delete c.rfx;\n          out.push(c);\n          break;\n\n        case 'BrtBeginComments':\n          break;\n\n        case 'BrtEndComments':\n          break;\n\n        case 'BrtBeginCommentAuthors':\n          break;\n\n        case 'BrtEndCommentAuthors':\n          break;\n\n        case 'BrtBeginCommentList':\n          break;\n\n        case 'BrtEndCommentList':\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n      }\n    });\n    return out;\n  }\n\n  function write_comments_bin(data, opts) {}\n  /* TODO: it will be useful to parse the function str */\n\n\n  var rc_to_a1 = function () {\n    var rcregex = /(^|[^A-Za-z])R(\\[?)(-?\\d+|)\\]?C(\\[?)(-?\\d+|)\\]?/g;\n    var rcbase;\n\n    function rcfunc($$, $1, $2, $3, $4, $5) {\n      var R = $3.length > 0 ? parseInt($3, 10) | 0 : 0,\n          C = $5.length > 0 ? parseInt($5, 10) | 0 : 0;\n      if (C < 0 && $4.length === 0) C = 0;\n      if ($4.length > 0) C += rcbase.c;\n      if ($2.length > 0) R += rcbase.r;\n      return $1 + encode_col(C) + encode_row(R);\n    }\n\n    return function rc_to_a1(fstr, base) {\n      rcbase = base;\n      return fstr.replace(rcregex, rcfunc);\n    };\n  }();\n  /* --- formula references point to MS-XLS --- */\n\n  /* Small helpers */\n\n\n  function parseread(l) {\n    return function (blob, length) {\n      blob.l += l;\n      return;\n    };\n  }\n\n  function parseread1(blob, length) {\n    blob.l += 1;\n    return;\n  }\n  /* Rgce Helpers */\n\n  /* 2.5.51 */\n\n\n  function parse_ColRelU(blob, length) {\n    var c = blob.read_shift(2);\n    return [c & 0x3FFF, c >> 14 & 1, c >> 15 & 1];\n  }\n  /* 2.5.198.105 */\n\n\n  function parse_RgceArea(blob, length) {\n    var r = blob.read_shift(2),\n        R = blob.read_shift(2);\n    var c = parse_ColRelU(blob, 2);\n    var C = parse_ColRelU(blob, 2);\n    return {\n      s: {\n        r: r,\n        c: c[0],\n        cRel: c[1],\n        rRel: c[2]\n      },\n      e: {\n        r: R,\n        c: C[0],\n        cRel: C[1],\n        rRel: C[2]\n      }\n    };\n  }\n  /* 2.5.198.105 TODO */\n\n\n  function parse_RgceAreaRel(blob, length) {\n    var r = blob.read_shift(2),\n        R = blob.read_shift(2);\n    var c = parse_ColRelU(blob, 2);\n    var C = parse_ColRelU(blob, 2);\n    return {\n      s: {\n        r: r,\n        c: c[0],\n        cRel: c[1],\n        rRel: c[2]\n      },\n      e: {\n        r: R,\n        c: C[0],\n        cRel: C[1],\n        rRel: C[2]\n      }\n    };\n  }\n  /* 2.5.198.109 */\n\n\n  function parse_RgceLoc(blob, length) {\n    var r = blob.read_shift(2);\n    var c = parse_ColRelU(blob, 2);\n    return {\n      r: r,\n      c: c[0],\n      cRel: c[1],\n      rRel: c[2]\n    };\n  }\n  /* 2.5.198.111 */\n\n\n  function parse_RgceLocRel(blob, length) {\n    var r = blob.read_shift(2);\n    var cl = blob.read_shift(2);\n    var cRel = (cl & 0x8000) >> 15,\n        rRel = (cl & 0x4000) >> 14;\n    cl &= 0x3FFF;\n    if (cRel !== 0) while (cl >= 0x100) cl -= 0x100;\n    return {\n      r: r,\n      c: cl,\n      cRel: cRel,\n      rRel: rRel\n    };\n  }\n  /* Ptg Tokens */\n\n  /* 2.5.198.27 */\n\n\n  function parse_PtgArea(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var area = parse_RgceArea(blob, 8);\n    return [type, area];\n  }\n  /* 2.5.198.28 */\n\n\n  function parse_PtgArea3d(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var ixti = blob.read_shift(2);\n    var area = parse_RgceArea(blob, 8);\n    return [type, ixti, area];\n  }\n  /* 2.5.198.29 */\n\n\n  function parse_PtgAreaErr(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    blob.l += 8;\n    return [type];\n  }\n  /* 2.5.198.30 */\n\n\n  function parse_PtgAreaErr3d(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var ixti = blob.read_shift(2);\n    blob.l += 8;\n    return [type, ixti];\n  }\n  /* 2.5.198.31 */\n\n\n  function parse_PtgAreaN(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var area = parse_RgceAreaRel(blob, 8);\n    return [type, area];\n  }\n  /* 2.5.198.32 -- ignore this and look in PtgExtraArray for shape + values */\n\n\n  function parse_PtgArray(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    blob.l += 7;\n    return [type];\n  }\n  /* 2.5.198.33 */\n\n\n  function parse_PtgAttrBaxcel(blob, length) {\n    var bitSemi = blob[blob.l + 1] & 0x01;\n    /* 1 = volatile */\n\n    var bitBaxcel = 1;\n    blob.l += 4;\n    return [bitSemi, bitBaxcel];\n  }\n  /* 2.5.198.34 */\n\n\n  function parse_PtgAttrChoose(blob, length) {\n    blob.l += 2;\n    var offset = blob.read_shift(2);\n    var o = [];\n    /* offset is 1 less than the number of elements */\n\n    for (var i = 0; i <= offset; ++i) o.push(blob.read_shift(2));\n\n    return o;\n  }\n  /* 2.5.198.35 */\n\n\n  function parse_PtgAttrGoto(blob, length) {\n    var bitGoto = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += 2;\n    return [bitGoto, blob.read_shift(2)];\n  }\n  /* 2.5.198.36 */\n\n\n  function parse_PtgAttrIf(blob, length) {\n    var bitIf = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += 2;\n    return [bitIf, blob.read_shift(2)];\n  }\n  /* 2.5.198.37 */\n\n\n  function parse_PtgAttrSemi(blob, length) {\n    var bitSemi = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += 4;\n    return [bitSemi];\n  }\n  /* 2.5.198.40 (used by PtgAttrSpace and PtgAttrSpaceSemi) */\n\n\n  function parse_PtgAttrSpaceType(blob, length) {\n    var type = blob.read_shift(1),\n        cch = blob.read_shift(1);\n    return [type, cch];\n  }\n  /* 2.5.198.38 */\n\n\n  function parse_PtgAttrSpace(blob, length) {\n    blob.read_shift(2);\n    return parse_PtgAttrSpaceType(blob, 2);\n  }\n  /* 2.5.198.39 */\n\n\n  function parse_PtgAttrSpaceSemi(blob, length) {\n    blob.read_shift(2);\n    return parse_PtgAttrSpaceType(blob, 2);\n  }\n  /* 2.5.198.84 TODO */\n\n\n  function parse_PtgRef(blob, length) {\n    var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var loc = parse_RgceLoc(blob, 4);\n    return [type, loc];\n  }\n  /* 2.5.198.88 TODO */\n\n\n  function parse_PtgRefN(blob, length) {\n    var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var loc = parse_RgceLocRel(blob, 4);\n    return [type, loc];\n  }\n  /* 2.5.198.85 TODO */\n\n\n  function parse_PtgRef3d(blob, length) {\n    var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var ixti = blob.read_shift(2); // XtiIndex\n\n    var loc = parse_RgceLoc(blob, 4);\n    return [type, ixti, loc];\n  }\n  /* 2.5.198.62 TODO */\n\n\n  function parse_PtgFunc(blob, length) {\n    var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var iftab = blob.read_shift(2);\n    return [FtabArgc[iftab], Ftab[iftab]];\n  }\n  /* 2.5.198.63 TODO */\n\n\n  function parse_PtgFuncVar(blob, length) {\n    blob.l++;\n    var cparams = blob.read_shift(1),\n        tab = parsetab(blob);\n    return [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n  }\n\n  function parsetab(blob, length) {\n    return [blob[blob.l + 1] >> 7, blob.read_shift(2) & 0x7FFF];\n  }\n  /* 2.5.198.41 */\n\n\n  var parse_PtgAttrSum = parseread(4);\n  /* 2.5.198.43 */\n\n  var parse_PtgConcat = parseread1;\n  /* 2.5.198.58 */\n\n  function parse_PtgExp(blob, length) {\n    blob.l++;\n    var row = blob.read_shift(2);\n    var col = blob.read_shift(2);\n    return [row, col];\n  }\n  /* 2.5.198.57 */\n\n\n  function parse_PtgErr(blob, length) {\n    blob.l++;\n    return BErr[blob.read_shift(1)];\n  }\n  /* 2.5.198.66 TODO */\n\n\n  function parse_PtgInt(blob, length) {\n    blob.l++;\n    return blob.read_shift(2);\n  }\n  /* 2.5.198.42 */\n\n\n  function parse_PtgBool(blob, length) {\n    blob.l++;\n    return blob.read_shift(1) !== 0;\n  }\n  /* 2.5.198.79 */\n\n\n  function parse_PtgNum(blob, length) {\n    blob.l++;\n    return parse_Xnum(blob, 8);\n  }\n  /* 2.5.198.89 */\n\n\n  function parse_PtgStr(blob, length) {\n    blob.l++;\n    return parse_ShortXLUnicodeString(blob);\n  }\n  /* 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\n\n\n  function parse_SerAr(blob) {\n    var val = [];\n\n    switch (val[0] = blob.read_shift(1)) {\n      /* 2.5.192.113 */\n      case 0x04:\n        /* SerBool -- boolean */\n        val[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n        blob.l += 7;\n        break;\n\n      /* 2.5.192.114 */\n\n      case 0x10:\n        /* SerErr -- error */\n        val[1] = BErr[blob[blob.l]];\n        blob.l += 8;\n        break;\n\n      /* 2.5.192.115 */\n\n      case 0x00:\n        /* SerNil -- honestly, I'm not sure how to reproduce this */\n        blob.l += 8;\n        break;\n\n      /* 2.5.192.116 */\n\n      case 0x01:\n        /* SerNum -- Xnum */\n        val[1] = parse_Xnum(blob, 8);\n        break;\n\n      /* 2.5.192.117 */\n\n      case 0x02:\n        /* SerStr -- XLUnicodeString (<256 chars) */\n        val[1] = parse_XLUnicodeString(blob);\n        break;\n      // default: throw \"Bad SerAr: \" + val[0]; /* Unreachable */\n    }\n\n    return val;\n  }\n  /* 2.5.198.61 */\n\n\n  function parse_PtgExtraMem(blob, cce) {\n    var count = blob.read_shift(2);\n    var out = [];\n\n    for (var i = 0; i != count; ++i) out.push(parse_Ref8U(blob, 8));\n\n    return out;\n  }\n  /* 2.5.198.59 */\n\n\n  function parse_PtgExtraArray(blob) {\n    var cols = 1 + blob.read_shift(1); //DColByteU\n\n    var rows = 1 + blob.read_shift(2); //DRw\n\n    for (var i = 0, o = []; i != rows && (o[i] = []); ++i) for (var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob);\n\n    return o;\n  }\n  /* 2.5.198.76 */\n\n\n  function parse_PtgName(blob, length) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var nameindex = blob.read_shift(4);\n    return [type, 0, nameindex];\n  }\n  /* 2.5.198.77 */\n\n\n  function parse_PtgNameX(blob, length) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var ixti = blob.read_shift(2); // XtiIndex\n\n    var nameindex = blob.read_shift(4);\n    return [type, ixti, nameindex];\n  }\n  /* 2.5.198.70 */\n\n\n  function parse_PtgMemArea(blob, length) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    blob.l += 4;\n    var cce = blob.read_shift(2);\n    return [type, cce];\n  }\n  /* 2.5.198.72 */\n\n\n  function parse_PtgMemFunc(blob, length) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var cce = blob.read_shift(2);\n    return [type, cce];\n  }\n  /* 2.5.198.86 */\n\n\n  function parse_PtgRefErr(blob, length) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    blob.l += 4;\n    return [type];\n  }\n  /* 2.5.198.26 */\n\n\n  var parse_PtgAdd = parseread1;\n  /* 2.5.198.45 */\n\n  var parse_PtgDiv = parseread1;\n  /* 2.5.198.56 */\n\n  var parse_PtgEq = parseread1;\n  /* 2.5.198.64 */\n\n  var parse_PtgGe = parseread1;\n  /* 2.5.198.65 */\n\n  var parse_PtgGt = parseread1;\n  /* 2.5.198.67 */\n\n  var parse_PtgIsect = parseread1;\n  /* 2.5.198.68 */\n\n  var parse_PtgLe = parseread1;\n  /* 2.5.198.69 */\n\n  var parse_PtgLt = parseread1;\n  /* 2.5.198.74 */\n\n  var parse_PtgMissArg = parseread1;\n  /* 2.5.198.75 */\n\n  var parse_PtgMul = parseread1;\n  /* 2.5.198.78 */\n\n  var parse_PtgNe = parseread1;\n  /* 2.5.198.80 */\n\n  var parse_PtgParen = parseread1;\n  /* 2.5.198.81 */\n\n  var parse_PtgPercent = parseread1;\n  /* 2.5.198.82 */\n\n  var parse_PtgPower = parseread1;\n  /* 2.5.198.83 */\n\n  var parse_PtgRange = parseread1;\n  /* 2.5.198.90 */\n\n  var parse_PtgSub = parseread1;\n  /* 2.5.198.93 */\n\n  var parse_PtgUminus = parseread1;\n  /* 2.5.198.94 */\n\n  var parse_PtgUnion = parseread1;\n  /* 2.5.198.95 */\n\n  var parse_PtgUplus = parseread1;\n  /* 2.5.198.71 */\n\n  var parse_PtgMemErr = parsenoop;\n  /* 2.5.198.73 */\n\n  var parse_PtgMemNoMem = parsenoop;\n  /* 2.5.198.87 */\n\n  var parse_PtgRefErr3d = parsenoop;\n  /* 2.5.198.92 */\n\n  var parse_PtgTbl = parsenoop;\n  /* 2.5.198.25 */\n\n  var PtgTypes = {\n    0x01: {\n      n: 'PtgExp',\n      f: parse_PtgExp\n    },\n    0x02: {\n      n: 'PtgTbl',\n      f: parse_PtgTbl\n    },\n    0x03: {\n      n: 'PtgAdd',\n      f: parse_PtgAdd\n    },\n    0x04: {\n      n: 'PtgSub',\n      f: parse_PtgSub\n    },\n    0x05: {\n      n: 'PtgMul',\n      f: parse_PtgMul\n    },\n    0x06: {\n      n: 'PtgDiv',\n      f: parse_PtgDiv\n    },\n    0x07: {\n      n: 'PtgPower',\n      f: parse_PtgPower\n    },\n    0x08: {\n      n: 'PtgConcat',\n      f: parse_PtgConcat\n    },\n    0x09: {\n      n: 'PtgLt',\n      f: parse_PtgLt\n    },\n    0x0A: {\n      n: 'PtgLe',\n      f: parse_PtgLe\n    },\n    0x0B: {\n      n: 'PtgEq',\n      f: parse_PtgEq\n    },\n    0x0C: {\n      n: 'PtgGe',\n      f: parse_PtgGe\n    },\n    0x0D: {\n      n: 'PtgGt',\n      f: parse_PtgGt\n    },\n    0x0E: {\n      n: 'PtgNe',\n      f: parse_PtgNe\n    },\n    0x0F: {\n      n: 'PtgIsect',\n      f: parse_PtgIsect\n    },\n    0x10: {\n      n: 'PtgUnion',\n      f: parse_PtgUnion\n    },\n    0x11: {\n      n: 'PtgRange',\n      f: parse_PtgRange\n    },\n    0x12: {\n      n: 'PtgUplus',\n      f: parse_PtgUplus\n    },\n    0x13: {\n      n: 'PtgUminus',\n      f: parse_PtgUminus\n    },\n    0x14: {\n      n: 'PtgPercent',\n      f: parse_PtgPercent\n    },\n    0x15: {\n      n: 'PtgParen',\n      f: parse_PtgParen\n    },\n    0x16: {\n      n: 'PtgMissArg',\n      f: parse_PtgMissArg\n    },\n    0x17: {\n      n: 'PtgStr',\n      f: parse_PtgStr\n    },\n    0x1C: {\n      n: 'PtgErr',\n      f: parse_PtgErr\n    },\n    0x1D: {\n      n: 'PtgBool',\n      f: parse_PtgBool\n    },\n    0x1E: {\n      n: 'PtgInt',\n      f: parse_PtgInt\n    },\n    0x1F: {\n      n: 'PtgNum',\n      f: parse_PtgNum\n    },\n    0x20: {\n      n: 'PtgArray',\n      f: parse_PtgArray\n    },\n    0x21: {\n      n: 'PtgFunc',\n      f: parse_PtgFunc\n    },\n    0x22: {\n      n: 'PtgFuncVar',\n      f: parse_PtgFuncVar\n    },\n    0x23: {\n      n: 'PtgName',\n      f: parse_PtgName\n    },\n    0x24: {\n      n: 'PtgRef',\n      f: parse_PtgRef\n    },\n    0x25: {\n      n: 'PtgArea',\n      f: parse_PtgArea\n    },\n    0x26: {\n      n: 'PtgMemArea',\n      f: parse_PtgMemArea\n    },\n    0x27: {\n      n: 'PtgMemErr',\n      f: parse_PtgMemErr\n    },\n    0x28: {\n      n: 'PtgMemNoMem',\n      f: parse_PtgMemNoMem\n    },\n    0x29: {\n      n: 'PtgMemFunc',\n      f: parse_PtgMemFunc\n    },\n    0x2A: {\n      n: 'PtgRefErr',\n      f: parse_PtgRefErr\n    },\n    0x2B: {\n      n: 'PtgAreaErr',\n      f: parse_PtgAreaErr\n    },\n    0x2C: {\n      n: 'PtgRefN',\n      f: parse_PtgRefN\n    },\n    0x2D: {\n      n: 'PtgAreaN',\n      f: parse_PtgAreaN\n    },\n    0x39: {\n      n: 'PtgNameX',\n      f: parse_PtgNameX\n    },\n    0x3A: {\n      n: 'PtgRef3d',\n      f: parse_PtgRef3d\n    },\n    0x3B: {\n      n: 'PtgArea3d',\n      f: parse_PtgArea3d\n    },\n    0x3C: {\n      n: 'PtgRefErr3d',\n      f: parse_PtgRefErr3d\n    },\n    0x3D: {\n      n: 'PtgAreaErr3d',\n      f: parse_PtgAreaErr3d\n    },\n    0xFF: {}\n  };\n  /* These are duplicated in the PtgTypes table */\n\n  var PtgDupes = {\n    0x40: 0x20,\n    0x60: 0x20,\n    0x41: 0x21,\n    0x61: 0x21,\n    0x42: 0x22,\n    0x62: 0x22,\n    0x43: 0x23,\n    0x63: 0x23,\n    0x44: 0x24,\n    0x64: 0x24,\n    0x45: 0x25,\n    0x65: 0x25,\n    0x46: 0x26,\n    0x66: 0x26,\n    0x47: 0x27,\n    0x67: 0x27,\n    0x48: 0x28,\n    0x68: 0x28,\n    0x49: 0x29,\n    0x69: 0x29,\n    0x4A: 0x2A,\n    0x6A: 0x2A,\n    0x4B: 0x2B,\n    0x6B: 0x2B,\n    0x4C: 0x2C,\n    0x6C: 0x2C,\n    0x4D: 0x2D,\n    0x6D: 0x2D,\n    0x59: 0x39,\n    0x79: 0x39,\n    0x5A: 0x3A,\n    0x7A: 0x3A,\n    0x5B: 0x3B,\n    0x7B: 0x3B,\n    0x5C: 0x3C,\n    0x7C: 0x3C,\n    0x5D: 0x3D,\n    0x7D: 0x3D\n  };\n\n  (function () {\n    for (var y in PtgDupes) PtgTypes[y] = PtgTypes[PtgDupes[y]];\n  })();\n\n  var Ptg18 = {};\n  var Ptg19 = {\n    0x01: {\n      n: 'PtgAttrSemi',\n      f: parse_PtgAttrSemi\n    },\n    0x02: {\n      n: 'PtgAttrIf',\n      f: parse_PtgAttrIf\n    },\n    0x04: {\n      n: 'PtgAttrChoose',\n      f: parse_PtgAttrChoose\n    },\n    0x08: {\n      n: 'PtgAttrGoto',\n      f: parse_PtgAttrGoto\n    },\n    0x10: {\n      n: 'PtgAttrSum',\n      f: parse_PtgAttrSum\n    },\n    0x20: {\n      n: 'PtgAttrBaxcel',\n      f: parse_PtgAttrBaxcel\n    },\n    0x40: {\n      n: 'PtgAttrSpace',\n      f: parse_PtgAttrSpace\n    },\n    0x41: {\n      n: 'PtgAttrSpaceSemi',\n      f: parse_PtgAttrSpaceSemi\n    },\n    0xFF: {}\n  };\n  /* 2.4.127 TODO */\n\n  function parse_Formula(blob, length, opts) {\n    var cell = parse_XLSCell(blob, 6);\n    var val = parse_FormulaValue(blob, 8);\n    var flags = blob.read_shift(1);\n    blob.read_shift(1);\n    var chn = blob.read_shift(4);\n    var cbf = \"\";\n    if (opts.biff === 5) blob.l += length - 20;else cbf = parse_XLSCellParsedFormula(blob, length - 20, opts);\n    return {\n      cell: cell,\n      val: val[0],\n      formula: cbf,\n      shared: flags >> 3 & 1,\n      tt: val[1]\n    };\n  }\n  /* 2.5.133 TODO: how to emit empty strings? */\n\n\n  function parse_FormulaValue(blob) {\n    var b;\n    if (__readUInt16LE(blob, blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob), 'n'];\n\n    switch (blob[blob.l]) {\n      case 0x00:\n        blob.l += 8;\n        return [\"String\", 's'];\n\n      case 0x01:\n        b = blob[blob.l + 2] === 0x1;\n        blob.l += 8;\n        return [b, 'b'];\n\n      case 0x02:\n        b = blob[blob.l + 2];\n        blob.l += 8;\n        return [b, 'e'];\n\n      case 0x03:\n        blob.l += 8;\n        return [\"\", 's'];\n    }\n  }\n  /* 2.5.198.103 */\n\n\n  function parse_RgbExtra(blob, length, rgce, opts) {\n    if (opts.biff < 8) return parsenoop(blob, length);\n    var target = blob.l + length;\n    var o = [];\n\n    for (var i = 0; i !== rgce.length; ++i) {\n      switch (rgce[i][0]) {\n        case 'PtgArray':\n          /* PtgArray -> PtgExtraArray */\n          rgce[i][1] = parse_PtgExtraArray(blob);\n          o.push(rgce[i][1]);\n          break;\n\n        case 'PtgMemArea':\n          /* PtgMemArea -> PtgExtraMem */\n          rgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1]);\n          o.push(rgce[i][2]);\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    length = target - blob.l;\n    if (length !== 0) o.push(parsenoop(blob, length));\n    return o;\n  }\n  /* 2.5.198.21 */\n\n\n  function parse_NameParsedFormula(blob, length, opts, cce) {\n    var target = blob.l + length;\n    var rgce = parse_Rgce(blob, cce);\n    var rgcb;\n    if (target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n    return [rgce, rgcb];\n  }\n  /* 2.5.198.3 TODO */\n\n\n  function parse_XLSCellParsedFormula(blob, length, opts) {\n    var target = blob.l + length;\n    var rgcb,\n        cce = blob.read_shift(2); // length of rgce\n\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    var rgce = parse_Rgce(blob, cce);\n    if (length !== cce + 2) rgcb = parse_RgbExtra(blob, length - cce - 2, rgce, opts);\n    return [rgce, rgcb];\n  }\n  /* 2.5.198.118 TODO */\n\n\n  function parse_SharedParsedFormula(blob, length, opts) {\n    var target = blob.l + length;\n    var rgcb,\n        cce = blob.read_shift(2); // length of rgce\n\n    var rgce = parse_Rgce(blob, cce);\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    if (length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n    return [rgce, rgcb];\n  }\n  /* 2.5.198.1 TODO */\n\n\n  function parse_ArrayParsedFormula(blob, length, opts, ref) {\n    var target = blob.l + length;\n    var rgcb,\n        cce = blob.read_shift(2); // length of rgce\n\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    var rgce = parse_Rgce(blob, cce);\n    if (length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n    return [rgce, rgcb];\n  }\n  /* 2.5.198.104 */\n\n\n  function parse_Rgce(blob, length) {\n    var target = blob.l + length;\n    var R,\n        id,\n        ptgs = [];\n\n    while (target != blob.l) {\n      length = target - blob.l;\n      id = blob[blob.l];\n      R = PtgTypes[id]; //console.log(\"ptg\", id, R)\n\n      if (id === 0x18 || id === 0x19) {\n        id = blob[blob.l + 1];\n        R = (id === 0x18 ? Ptg18 : Ptg19)[id];\n      }\n\n      if (!R || !R.f) {\n        ptgs.push(parsenoop(blob, length));\n      } else {\n        ptgs.push([R.n, R.f(blob, length)]);\n      }\n    }\n\n    return ptgs;\n  }\n\n  function mapper(x) {\n    return x.map(function f2(y) {\n      return y[1];\n    }).join(\",\");\n  }\n  /* 2.2.2 + Magic TODO */\n\n\n  function stringify_formula(formula, range, cell, supbooks, opts) {\n    if (opts !== undefined && opts.biff === 5) return \"BIFF5??\";\n\n    var _range = range !== undefined ? range : {\n      s: {\n        c: 0,\n        r: 0\n      }\n    };\n\n    var stack = [],\n        e1,\n        e2,\n        type,\n        c,\n        ixti,\n        nameidx,\n        r;\n    if (!formula[0] || !formula[0][0]) return \"\"; //console.log(\"--\",cell,formula[0])\n\n    for (var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n      var f = formula[0][ff]; //console.log(\"++\",f, stack)\n\n      switch (f[0]) {\n        /* 2.2.2.1 Unary Operator Tokens */\n\n        /* 2.5.198.93 */\n        case 'PtgUminus':\n          stack.push(\"-\" + stack.pop());\n          break;\n\n        /* 2.5.198.95 */\n\n        case 'PtgUplus':\n          stack.push(\"+\" + stack.pop());\n          break;\n\n        /* 2.5.198.81 */\n\n        case 'PtgPercent':\n          stack.push(stack.pop() + \"%\");\n          break;\n\n        /* 2.2.2.1 Binary Value Operator Token */\n\n        /* 2.5.198.26 */\n\n        case 'PtgAdd':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"+\" + e1);\n          break;\n\n        /* 2.5.198.90 */\n\n        case 'PtgSub':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"-\" + e1);\n          break;\n\n        /* 2.5.198.75 */\n\n        case 'PtgMul':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"*\" + e1);\n          break;\n\n        /* 2.5.198.45 */\n\n        case 'PtgDiv':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"/\" + e1);\n          break;\n\n        /* 2.5.198.82 */\n\n        case 'PtgPower':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"^\" + e1);\n          break;\n\n        /* 2.5.198.43 */\n\n        case 'PtgConcat':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"&\" + e1);\n          break;\n\n        /* 2.5.198.69 */\n\n        case 'PtgLt':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"<\" + e1);\n          break;\n\n        /* 2.5.198.68 */\n\n        case 'PtgLe':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"<=\" + e1);\n          break;\n\n        /* 2.5.198.56 */\n\n        case 'PtgEq':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"=\" + e1);\n          break;\n\n        /* 2.5.198.64 */\n\n        case 'PtgGe':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \">=\" + e1);\n          break;\n\n        /* 2.5.198.65 */\n\n        case 'PtgGt':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \">\" + e1);\n          break;\n\n        /* 2.5.198.78 */\n\n        case 'PtgNe':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"<>\" + e1);\n          break;\n\n        /* 2.2.2.1 Binary Reference Operator Token */\n\n        /* 2.5.198.67 */\n\n        case 'PtgIsect':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \" \" + e1);\n          break;\n\n        case 'PtgUnion':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \",\" + e1);\n          break;\n\n        case 'PtgRange':\n          break;\n\n        /* 2.2.2.3 Control Tokens \"can be ignored\" */\n\n        /* 2.5.198.34 */\n\n        case 'PtgAttrChoose':\n          break;\n\n        /* 2.5.198.35 */\n\n        case 'PtgAttrGoto':\n          break;\n\n        /* 2.5.198.36 */\n\n        case 'PtgAttrIf':\n          break;\n\n        /* 2.5.198.84 */\n\n        case 'PtgRef':\n          type = f[1][0];\n          c = shift_cell_xls(decode_cell(encode_cell(f[1][1])), _range);\n          stack.push(encode_cell(c));\n          break;\n\n        /* 2.5.198.88 */\n\n        case 'PtgRefN':\n          type = f[1][0];\n          c = shift_cell_xls(decode_cell(encode_cell(f[1][1])), cell);\n          stack.push(encode_cell(c));\n          break;\n\n        case 'PtgRef3d':\n          // TODO: lots of stuff\n          type = f[1][0];\n          ixti = f[1][1];\n          c = shift_cell_xls(f[1][2], _range);\n          stack.push(supbooks[1][ixti + 1] + \"!\" + encode_cell(c));\n          break;\n\n        /* Function Call */\n\n        /* 2.5.198.62 */\n\n        case 'PtgFunc':\n        /* 2.5.198.63 */\n\n        case 'PtgFuncVar':\n          /* f[1] = [argc, func] */\n          var argc = f[1][0],\n              func = f[1][1];\n          if (!argc) argc = 0;\n          var args = stack.slice(-argc);\n          stack.length -= argc;\n          if (func === 'User') func = args.shift();\n          stack.push(func + \"(\" + args.join(\",\") + \")\");\n          break;\n\n        /* 2.5.198.42 */\n\n        case 'PtgBool':\n          stack.push(f[1] ? \"TRUE\" : \"FALSE\");\n          break;\n\n        /* 2.5.198.66 */\n\n        case 'PtgInt':\n          stack.push(f[1]);\n          break;\n\n        /* 2.5.198.79 TODO: precision? */\n\n        case 'PtgNum':\n          stack.push(String(f[1]));\n          break;\n\n        /* 2.5.198.89 */\n\n        case 'PtgStr':\n          stack.push('\"' + f[1] + '\"');\n          break;\n\n        /* 2.5.198.57 */\n\n        case 'PtgErr':\n          stack.push(f[1]);\n          break;\n\n        /* 2.5.198.27 TODO: fixed points */\n\n        case 'PtgArea':\n          type = f[1][0];\n          r = shift_range_xls(f[1][1], _range);\n          stack.push(encode_range(r));\n          break;\n\n        /* 2.5.198.28 */\n\n        case 'PtgArea3d':\n          // TODO: lots of stuff\n          type = f[1][0];\n          ixti = f[1][1];\n          r = f[1][2];\n          stack.push(supbooks[1][ixti + 1] + \"!\" + encode_range(r));\n          break;\n\n        /* 2.5.198.41 */\n\n        case 'PtgAttrSum':\n          stack.push(\"SUM(\" + stack.pop() + \")\");\n          break;\n\n        /* Expression Prefixes */\n\n        /* 2.5.198.37 */\n\n        case 'PtgAttrSemi':\n          break;\n\n        /* 2.5.97.60 TODO: do something different for revisions */\n\n        case 'PtgName':\n          /* f[1] = type, 0, nameindex */\n          nameidx = f[1][2];\n          var lbl = supbooks[0][nameidx];\n          var name = lbl.Name;\n          if (name in XLSXFutureFunctions) name = XLSXFutureFunctions[name];\n          stack.push(name);\n          break;\n\n        /* 2.5.97.61 TODO: do something different for revisions */\n\n        case 'PtgNameX':\n          /* f[1] = type, ixti, nameindex */\n          var bookidx = f[1][1];\n          nameidx = f[1][2];\n          var externbook;\n          /* TODO: Properly handle missing values */\n\n          if (supbooks[bookidx + 1]) externbook = supbooks[bookidx + 1][nameidx];else if (supbooks[bookidx - 1]) externbook = supbooks[bookidx - 1][nameidx];\n          if (!externbook) externbook = {\n            body: \"??NAMEX??\"\n          };\n          stack.push(externbook.body);\n          break;\n\n        /* 2.2.2.4 Display Tokens */\n\n        /* 2.5.198.80 */\n\n        case 'PtgParen':\n          stack.push('(' + stack.pop() + ')');\n          break;\n\n        /* 2.5.198.86 */\n\n        case 'PtgRefErr':\n          stack.push('#REF!');\n          break;\n\n        /* */\n\n        /* 2.5.198.58 TODO */\n\n        case 'PtgExp':\n          c = {\n            c: f[1][1],\n            r: f[1][0]\n          };\n          var q = {\n            c: cell.c,\n            r: cell.r\n          };\n\n          if (supbooks.sharedf[encode_cell(c)]) {\n            var parsedf = supbooks.sharedf[encode_cell(c)];\n            stack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n          } else {\n            var fnd = false;\n\n            for (e1 = 0; e1 != supbooks.arrayf.length; ++e1) {\n              /* TODO: should be something like range_has */\n              e2 = supbooks.arrayf[e1];\n              if (c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n              if (c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n              stack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n            }\n\n            if (!fnd) stack.push(f[1]);\n          }\n\n          break;\n\n        /* 2.5.198.32 TODO */\n\n        case 'PtgArray':\n          stack.push(\"{\" + f[1].map(mapper).join(\";\") + \"}\");\n          break;\n\n        /* 2.2.2.5 Mem Tokens */\n\n        /* 2.5.198.70 TODO: confirm this is a non-display */\n\n        case 'PtgMemArea':\n          //stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n          break;\n\n        /* 2.5.198.38 TODO */\n\n        case 'PtgAttrSpace':\n          break;\n\n        /* 2.5.198.92 TODO */\n\n        case 'PtgTbl':\n          break;\n\n        /* 2.5.198.71 */\n\n        case 'PtgMemErr':\n          break;\n\n        /* 2.5.198.74 */\n\n        case 'PtgMissArg':\n          stack.push(\"\");\n          break;\n\n        /* 2.5.198.29 TODO */\n\n        case 'PtgAreaErr':\n          break;\n\n        /* 2.5.198.31 TODO */\n\n        case 'PtgAreaN':\n          stack.push(\"\");\n          break;\n\n        /* 2.5.198.87 TODO */\n\n        case 'PtgRefErr3d':\n          break;\n\n        /* 2.5.198.72 TODO */\n\n        case 'PtgMemFunc':\n          break;\n\n        default:\n          throw 'Unrecognized Formula Token: ' + f;\n      } //console.log(\"::\",f, stack)\n\n    } //console.log(\"--\",stack);\n\n\n    return stack[0];\n  }\n  /* [MS-XLSB] 2.5.97.4 CellParsedFormula TODO: use similar logic to js-xls */\n\n\n  function parse_XLSBCellParsedFormula(data, length) {\n    var cce = data.read_shift(4);\n    return parsenoop(data, length - 4);\n  }\n  /* [MS-XLS] 2.5.198.44 */\n\n\n  var PtgDataType = {\n    0x1: \"REFERENCE\",\n    // reference to range\n    0x2: \"VALUE\",\n    // single value\n    0x3: \"ARRAY\" // array of values\n\n  };\n  /* [MS-XLS] 2.5.198.4 */\n\n  var Cetab = {\n    0x0000: 'BEEP',\n    0x0001: 'OPEN',\n    0x0002: 'OPEN.LINKS',\n    0x0003: 'CLOSE.ALL',\n    0x0004: 'SAVE',\n    0x0005: 'SAVE.AS',\n    0x0006: 'FILE.DELETE',\n    0x0007: 'PAGE.SETUP',\n    0x0008: 'PRINT',\n    0x0009: 'PRINTER.SETUP',\n    0x000A: 'QUIT',\n    0x000B: 'NEW.WINDOW',\n    0x000C: 'ARRANGE.ALL',\n    0x000D: 'WINDOW.SIZE',\n    0x000E: 'WINDOW.MOVE',\n    0x000F: 'FULL',\n    0x0010: 'CLOSE',\n    0x0011: 'RUN',\n    0x0016: 'SET.PRINT.AREA',\n    0x0017: 'SET.PRINT.TITLES',\n    0x0018: 'SET.PAGE.BREAK',\n    0x0019: 'REMOVE.PAGE.BREAK',\n    0x001A: 'FONT',\n    0x001B: 'DISPLAY',\n    0x001C: 'PROTECT.DOCUMENT',\n    0x001D: 'PRECISION',\n    0x001E: 'A1.R1C1',\n    0x001F: 'CALCULATE.NOW',\n    0x0020: 'CALCULATION',\n    0x0022: 'DATA.FIND',\n    0x0023: 'EXTRACT',\n    0x0024: 'DATA.DELETE',\n    0x0025: 'SET.DATABASE',\n    0x0026: 'SET.CRITERIA',\n    0x0027: 'SORT',\n    0x0028: 'DATA.SERIES',\n    0x0029: 'TABLE',\n    0x002A: 'FORMAT.NUMBER',\n    0x002B: 'ALIGNMENT',\n    0x002C: 'STYLE',\n    0x002D: 'BORDER',\n    0x002E: 'CELL.PROTECTION',\n    0x002F: 'COLUMN.WIDTH',\n    0x0030: 'UNDO',\n    0x0031: 'CUT',\n    0x0032: 'COPY',\n    0x0033: 'PASTE',\n    0x0034: 'CLEAR',\n    0x0035: 'PASTE.SPECIAL',\n    0x0036: 'EDIT.DELETE',\n    0x0037: 'INSERT',\n    0x0038: 'FILL.RIGHT',\n    0x0039: 'FILL.DOWN',\n    0x003D: 'DEFINE.NAME',\n    0x003E: 'CREATE.NAMES',\n    0x003F: 'FORMULA.GOTO',\n    0x0040: 'FORMULA.FIND',\n    0x0041: 'SELECT.LAST.CELL',\n    0x0042: 'SHOW.ACTIVE.CELL',\n    0x0043: 'GALLERY.AREA',\n    0x0044: 'GALLERY.BAR',\n    0x0045: 'GALLERY.COLUMN',\n    0x0046: 'GALLERY.LINE',\n    0x0047: 'GALLERY.PIE',\n    0x0048: 'GALLERY.SCATTER',\n    0x0049: 'COMBINATION',\n    0x004A: 'PREFERRED',\n    0x004B: 'ADD.OVERLAY',\n    0x004C: 'GRIDLINES',\n    0x004D: 'SET.PREFERRED',\n    0x004E: 'AXES',\n    0x004F: 'LEGEND',\n    0x0050: 'ATTACH.TEXT',\n    0x0051: 'ADD.ARROW',\n    0x0052: 'SELECT.CHART',\n    0x0053: 'SELECT.PLOT.AREA',\n    0x0054: 'PATTERNS',\n    0x0055: 'MAIN.CHART',\n    0x0056: 'OVERLAY',\n    0x0057: 'SCALE',\n    0x0058: 'FORMAT.LEGEND',\n    0x0059: 'FORMAT.TEXT',\n    0x005A: 'EDIT.REPEAT',\n    0x005B: 'PARSE',\n    0x005C: 'JUSTIFY',\n    0x005D: 'HIDE',\n    0x005E: 'UNHIDE',\n    0x005F: 'WORKSPACE',\n    0x0060: 'FORMULA',\n    0x0061: 'FORMULA.FILL',\n    0x0062: 'FORMULA.ARRAY',\n    0x0063: 'DATA.FIND.NEXT',\n    0x0064: 'DATA.FIND.PREV',\n    0x0065: 'FORMULA.FIND.NEXT',\n    0x0066: 'FORMULA.FIND.PREV',\n    0x0067: 'ACTIVATE',\n    0x0068: 'ACTIVATE.NEXT',\n    0x0069: 'ACTIVATE.PREV',\n    0x006A: 'UNLOCKED.NEXT',\n    0x006B: 'UNLOCKED.PREV',\n    0x006C: 'COPY.PICTURE',\n    0x006D: 'SELECT',\n    0x006E: 'DELETE.NAME',\n    0x006F: 'DELETE.FORMAT',\n    0x0070: 'VLINE',\n    0x0071: 'HLINE',\n    0x0072: 'VPAGE',\n    0x0073: 'HPAGE',\n    0x0074: 'VSCROLL',\n    0x0075: 'HSCROLL',\n    0x0076: 'ALERT',\n    0x0077: 'NEW',\n    0x0078: 'CANCEL.COPY',\n    0x0079: 'SHOW.CLIPBOARD',\n    0x007A: 'MESSAGE',\n    0x007C: 'PASTE.LINK',\n    0x007D: 'APP.ACTIVATE',\n    0x007E: 'DELETE.ARROW',\n    0x007F: 'ROW.HEIGHT',\n    0x0080: 'FORMAT.MOVE',\n    0x0081: 'FORMAT.SIZE',\n    0x0082: 'FORMULA.REPLACE',\n    0x0083: 'SEND.KEYS',\n    0x0084: 'SELECT.SPECIAL',\n    0x0085: 'APPLY.NAMES',\n    0x0086: 'REPLACE.FONT',\n    0x0087: 'FREEZE.PANES',\n    0x0088: 'SHOW.INFO',\n    0x0089: 'SPLIT',\n    0x008A: 'ON.WINDOW',\n    0x008B: 'ON.DATA',\n    0x008C: 'DISABLE.INPUT',\n    0x008E: 'OUTLINE',\n    0x008F: 'LIST.NAMES',\n    0x0090: 'FILE.CLOSE',\n    0x0091: 'SAVE.WORKBOOK',\n    0x0092: 'DATA.FORM',\n    0x0093: 'COPY.CHART',\n    0x0094: 'ON.TIME',\n    0x0095: 'WAIT',\n    0x0096: 'FORMAT.FONT',\n    0x0097: 'FILL.UP',\n    0x0098: 'FILL.LEFT',\n    0x0099: 'DELETE.OVERLAY',\n    0x009B: 'SHORT.MENUS',\n    0x009F: 'SET.UPDATE.STATUS',\n    0x00A1: 'COLOR.PALETTE',\n    0x00A2: 'DELETE.STYLE',\n    0x00A3: 'WINDOW.RESTORE',\n    0x00A4: 'WINDOW.MAXIMIZE',\n    0x00A6: 'CHANGE.LINK',\n    0x00A7: 'CALCULATE.DOCUMENT',\n    0x00A8: 'ON.KEY',\n    0x00A9: 'APP.RESTORE',\n    0x00AA: 'APP.MOVE',\n    0x00AB: 'APP.SIZE',\n    0x00AC: 'APP.MINIMIZE',\n    0x00AD: 'APP.MAXIMIZE',\n    0x00AE: 'BRING.TO.FRONT',\n    0x00AF: 'SEND.TO.BACK',\n    0x00B9: 'MAIN.CHART.TYPE',\n    0x00BA: 'OVERLAY.CHART.TYPE',\n    0x00BB: 'SELECT.END',\n    0x00BC: 'OPEN.MAIL',\n    0x00BD: 'SEND.MAIL',\n    0x00BE: 'STANDARD.FONT',\n    0x00BF: 'CONSOLIDATE',\n    0x00C0: 'SORT.SPECIAL',\n    0x00C1: 'GALLERY.3D.AREA',\n    0x00C2: 'GALLERY.3D.COLUMN',\n    0x00C3: 'GALLERY.3D.LINE',\n    0x00C4: 'GALLERY.3D.PIE',\n    0x00C5: 'VIEW.3D',\n    0x00C6: 'GOAL.SEEK',\n    0x00C7: 'WORKGROUP',\n    0x00C8: 'FILL.GROUP',\n    0x00C9: 'UPDATE.LINK',\n    0x00CA: 'PROMOTE',\n    0x00CB: 'DEMOTE',\n    0x00CC: 'SHOW.DETAIL',\n    0x00CE: 'UNGROUP',\n    0x00CF: 'OBJECT.PROPERTIES',\n    0x00D0: 'SAVE.NEW.OBJECT',\n    0x00D1: 'SHARE',\n    0x00D2: 'SHARE.NAME',\n    0x00D3: 'DUPLICATE',\n    0x00D4: 'APPLY.STYLE',\n    0x00D5: 'ASSIGN.TO.OBJECT',\n    0x00D6: 'OBJECT.PROTECTION',\n    0x00D7: 'HIDE.OBJECT',\n    0x00D8: 'SET.EXTRACT',\n    0x00D9: 'CREATE.PUBLISHER',\n    0x00DA: 'SUBSCRIBE.TO',\n    0x00DB: 'ATTRIBUTES',\n    0x00DC: 'SHOW.TOOLBAR',\n    0x00DE: 'PRINT.PREVIEW',\n    0x00DF: 'EDIT.COLOR',\n    0x00E0: 'SHOW.LEVELS',\n    0x00E1: 'FORMAT.MAIN',\n    0x00E2: 'FORMAT.OVERLAY',\n    0x00E3: 'ON.RECALC',\n    0x00E4: 'EDIT.SERIES',\n    0x00E5: 'DEFINE.STYLE',\n    0x00F0: 'LINE.PRINT',\n    0x00F3: 'ENTER.DATA',\n    0x00F9: 'GALLERY.RADAR',\n    0x00FA: 'MERGE.STYLES',\n    0x00FB: 'EDITION.OPTIONS',\n    0x00FC: 'PASTE.PICTURE',\n    0x00FD: 'PASTE.PICTURE.LINK',\n    0x00FE: 'SPELLING',\n    0x0100: 'ZOOM',\n    0x0103: 'INSERT.OBJECT',\n    0x0104: 'WINDOW.MINIMIZE',\n    0x0109: 'SOUND.NOTE',\n    0x010A: 'SOUND.PLAY',\n    0x010B: 'FORMAT.SHAPE',\n    0x010C: 'EXTEND.POLYGON',\n    0x010D: 'FORMAT.AUTO',\n    0x0110: 'GALLERY.3D.BAR',\n    0x0111: 'GALLERY.3D.SURFACE',\n    0x0112: 'FILL.AUTO',\n    0x0114: 'CUSTOMIZE.TOOLBAR',\n    0x0115: 'ADD.TOOL',\n    0x0116: 'EDIT.OBJECT',\n    0x0117: 'ON.DOUBLECLICK',\n    0x0118: 'ON.ENTRY',\n    0x0119: 'WORKBOOK.ADD',\n    0x011A: 'WORKBOOK.MOVE',\n    0x011B: 'WORKBOOK.COPY',\n    0x011C: 'WORKBOOK.OPTIONS',\n    0x011D: 'SAVE.WORKSPACE',\n    0x0120: 'CHART.WIZARD',\n    0x0121: 'DELETE.TOOL',\n    0x0122: 'MOVE.TOOL',\n    0x0123: 'WORKBOOK.SELECT',\n    0x0124: 'WORKBOOK.ACTIVATE',\n    0x0125: 'ASSIGN.TO.TOOL',\n    0x0127: 'COPY.TOOL',\n    0x0128: 'RESET.TOOL',\n    0x0129: 'CONSTRAIN.NUMERIC',\n    0x012A: 'PASTE.TOOL',\n    0x012E: 'WORKBOOK.NEW',\n    0x0131: 'SCENARIO.CELLS',\n    0x0132: 'SCENARIO.DELETE',\n    0x0133: 'SCENARIO.ADD',\n    0x0134: 'SCENARIO.EDIT',\n    0x0135: 'SCENARIO.SHOW',\n    0x0136: 'SCENARIO.SHOW.NEXT',\n    0x0137: 'SCENARIO.SUMMARY',\n    0x0138: 'PIVOT.TABLE.WIZARD',\n    0x0139: 'PIVOT.FIELD.PROPERTIES',\n    0x013A: 'PIVOT.FIELD',\n    0x013B: 'PIVOT.ITEM',\n    0x013C: 'PIVOT.ADD.FIELDS',\n    0x013E: 'OPTIONS.CALCULATION',\n    0x013F: 'OPTIONS.EDIT',\n    0x0140: 'OPTIONS.VIEW',\n    0x0141: 'ADDIN.MANAGER',\n    0x0142: 'MENU.EDITOR',\n    0x0143: 'ATTACH.TOOLBARS',\n    0x0144: 'VBAActivate',\n    0x0145: 'OPTIONS.CHART',\n    0x0148: 'VBA.INSERT.FILE',\n    0x014A: 'VBA.PROCEDURE.DEFINITION',\n    0x0150: 'ROUTING.SLIP',\n    0x0152: 'ROUTE.DOCUMENT',\n    0x0153: 'MAIL.LOGON',\n    0x0156: 'INSERT.PICTURE',\n    0x0157: 'EDIT.TOOL',\n    0x0158: 'GALLERY.DOUGHNUT',\n    0x015E: 'CHART.TREND',\n    0x0160: 'PIVOT.ITEM.PROPERTIES',\n    0x0162: 'WORKBOOK.INSERT',\n    0x0163: 'OPTIONS.TRANSITION',\n    0x0164: 'OPTIONS.GENERAL',\n    0x0172: 'FILTER.ADVANCED',\n    0x0175: 'MAIL.ADD.MAILER',\n    0x0176: 'MAIL.DELETE.MAILER',\n    0x0177: 'MAIL.REPLY',\n    0x0178: 'MAIL.REPLY.ALL',\n    0x0179: 'MAIL.FORWARD',\n    0x017A: 'MAIL.NEXT.LETTER',\n    0x017B: 'DATA.LABEL',\n    0x017C: 'INSERT.TITLE',\n    0x017D: 'FONT.PROPERTIES',\n    0x017E: 'MACRO.OPTIONS',\n    0x017F: 'WORKBOOK.HIDE',\n    0x0180: 'WORKBOOK.UNHIDE',\n    0x0181: 'WORKBOOK.DELETE',\n    0x0182: 'WORKBOOK.NAME',\n    0x0184: 'GALLERY.CUSTOM',\n    0x0186: 'ADD.CHART.AUTOFORMAT',\n    0x0187: 'DELETE.CHART.AUTOFORMAT',\n    0x0188: 'CHART.ADD.DATA',\n    0x0189: 'AUTO.OUTLINE',\n    0x018A: 'TAB.ORDER',\n    0x018B: 'SHOW.DIALOG',\n    0x018C: 'SELECT.ALL',\n    0x018D: 'UNGROUP.SHEETS',\n    0x018E: 'SUBTOTAL.CREATE',\n    0x018F: 'SUBTOTAL.REMOVE',\n    0x0190: 'RENAME.OBJECT',\n    0x019C: 'WORKBOOK.SCROLL',\n    0x019D: 'WORKBOOK.NEXT',\n    0x019E: 'WORKBOOK.PREV',\n    0x019F: 'WORKBOOK.TAB.SPLIT',\n    0x01A0: 'FULL.SCREEN',\n    0x01A1: 'WORKBOOK.PROTECT',\n    0x01A4: 'SCROLLBAR.PROPERTIES',\n    0x01A5: 'PIVOT.SHOW.PAGES',\n    0x01A6: 'TEXT.TO.COLUMNS',\n    0x01A7: 'FORMAT.CHARTTYPE',\n    0x01A8: 'LINK.FORMAT',\n    0x01A9: 'TRACER.DISPLAY',\n    0x01AE: 'TRACER.NAVIGATE',\n    0x01AF: 'TRACER.CLEAR',\n    0x01B0: 'TRACER.ERROR',\n    0x01B1: 'PIVOT.FIELD.GROUP',\n    0x01B2: 'PIVOT.FIELD.UNGROUP',\n    0x01B3: 'CHECKBOX.PROPERTIES',\n    0x01B4: 'LABEL.PROPERTIES',\n    0x01B5: 'LISTBOX.PROPERTIES',\n    0x01B6: 'EDITBOX.PROPERTIES',\n    0x01B7: 'PIVOT.REFRESH',\n    0x01B8: 'LINK.COMBO',\n    0x01B9: 'OPEN.TEXT',\n    0x01BA: 'HIDE.DIALOG',\n    0x01BB: 'SET.DIALOG.FOCUS',\n    0x01BC: 'ENABLE.OBJECT',\n    0x01BD: 'PUSHBUTTON.PROPERTIES',\n    0x01BE: 'SET.DIALOG.DEFAULT',\n    0x01BF: 'FILTER',\n    0x01C0: 'FILTER.SHOW.ALL',\n    0x01C1: 'CLEAR.OUTLINE',\n    0x01C2: 'FUNCTION.WIZARD',\n    0x01C3: 'ADD.LIST.ITEM',\n    0x01C4: 'SET.LIST.ITEM',\n    0x01C5: 'REMOVE.LIST.ITEM',\n    0x01C6: 'SELECT.LIST.ITEM',\n    0x01C7: 'SET.CONTROL.VALUE',\n    0x01C8: 'SAVE.COPY.AS',\n    0x01CA: 'OPTIONS.LISTS.ADD',\n    0x01CB: 'OPTIONS.LISTS.DELETE',\n    0x01CC: 'SERIES.AXES',\n    0x01CD: 'SERIES.X',\n    0x01CE: 'SERIES.Y',\n    0x01CF: 'ERRORBAR.X',\n    0x01D0: 'ERRORBAR.Y',\n    0x01D1: 'FORMAT.CHART',\n    0x01D2: 'SERIES.ORDER',\n    0x01D3: 'MAIL.LOGOFF',\n    0x01D4: 'CLEAR.ROUTING.SLIP',\n    0x01D5: 'APP.ACTIVATE.MICROSOFT',\n    0x01D6: 'MAIL.EDIT.MAILER',\n    0x01D7: 'ON.SHEET',\n    0x01D8: 'STANDARD.WIDTH',\n    0x01D9: 'SCENARIO.MERGE',\n    0x01DA: 'SUMMARY.INFO',\n    0x01DB: 'FIND.FILE',\n    0x01DC: 'ACTIVE.CELL.FONT',\n    0x01DD: 'ENABLE.TIPWIZARD',\n    0x01DE: 'VBA.MAKE.ADDIN',\n    0x01E0: 'INSERTDATATABLE',\n    0x01E1: 'WORKGROUP.OPTIONS',\n    0x01E2: 'MAIL.SEND.MAILER',\n    0x01E5: 'AUTOCORRECT',\n    0x01E9: 'POST.DOCUMENT',\n    0x01EB: 'PICKLIST',\n    0x01ED: 'VIEW.SHOW',\n    0x01EE: 'VIEW.DEFINE',\n    0x01EF: 'VIEW.DELETE',\n    0x01FD: 'SHEET.BACKGROUND',\n    0x01FE: 'INSERT.MAP.OBJECT',\n    0x01FF: 'OPTIONS.MENONO',\n    0x0205: 'MSOCHECKS',\n    0x0206: 'NORMAL',\n    0x0207: 'LAYOUT',\n    0x0208: 'RM.PRINT.AREA',\n    0x0209: 'CLEAR.PRINT.AREA',\n    0x020A: 'ADD.PRINT.AREA',\n    0x020B: 'MOVE.BRK',\n    0x0221: 'HIDECURR.NOTE',\n    0x0222: 'HIDEALL.NOTES',\n    0x0223: 'DELETE.NOTE',\n    0x0224: 'TRAVERSE.NOTES',\n    0x0225: 'ACTIVATE.NOTES',\n    0x026C: 'PROTECT.REVISIONS',\n    0x026D: 'UNPROTECT.REVISIONS',\n    0x0287: 'OPTIONS.ME',\n    0x028D: 'WEB.PUBLISH',\n    0x029B: 'NEWWEBQUERY',\n    0x02A1: 'PIVOT.TABLE.CHART',\n    0x02F1: 'OPTIONS.SAVE',\n    0x02F3: 'OPTIONS.SPELL',\n    0x0328: 'HIDEALL.INKANNOTS'\n  };\n  /* [MS-XLS] 2.5.198.17 */\n\n  var Ftab = {\n    0x0000: 'COUNT',\n    0x0001: 'IF',\n    0x0002: 'ISNA',\n    0x0003: 'ISERROR',\n    0x0004: 'SUM',\n    0x0005: 'AVERAGE',\n    0x0006: 'MIN',\n    0x0007: 'MAX',\n    0x0008: 'ROW',\n    0x0009: 'COLUMN',\n    0x000A: 'NA',\n    0x000B: 'NPV',\n    0x000C: 'STDEV',\n    0x000D: 'DOLLAR',\n    0x000E: 'FIXED',\n    0x000F: 'SIN',\n    0x0010: 'COS',\n    0x0011: 'TAN',\n    0x0012: 'ATAN',\n    0x0013: 'PI',\n    0x0014: 'SQRT',\n    0x0015: 'EXP',\n    0x0016: 'LN',\n    0x0017: 'LOG10',\n    0x0018: 'ABS',\n    0x0019: 'INT',\n    0x001A: 'SIGN',\n    0x001B: 'ROUND',\n    0x001C: 'LOOKUP',\n    0x001D: 'INDEX',\n    0x001E: 'REPT',\n    0x001F: 'MID',\n    0x0020: 'LEN',\n    0x0021: 'VALUE',\n    0x0022: 'TRUE',\n    0x0023: 'FALSE',\n    0x0024: 'AND',\n    0x0025: 'OR',\n    0x0026: 'NOT',\n    0x0027: 'MOD',\n    0x0028: 'DCOUNT',\n    0x0029: 'DSUM',\n    0x002A: 'DAVERAGE',\n    0x002B: 'DMIN',\n    0x002C: 'DMAX',\n    0x002D: 'DSTDEV',\n    0x002E: 'VAR',\n    0x002F: 'DVAR',\n    0x0030: 'TEXT',\n    0x0031: 'LINEST',\n    0x0032: 'TREND',\n    0x0033: 'LOGEST',\n    0x0034: 'GROWTH',\n    0x0035: 'GOTO',\n    0x0036: 'HALT',\n    0x0037: 'RETURN',\n    0x0038: 'PV',\n    0x0039: 'FV',\n    0x003A: 'NPER',\n    0x003B: 'PMT',\n    0x003C: 'RATE',\n    0x003D: 'MIRR',\n    0x003E: 'IRR',\n    0x003F: 'RAND',\n    0x0040: 'MATCH',\n    0x0041: 'DATE',\n    0x0042: 'TIME',\n    0x0043: 'DAY',\n    0x0044: 'MONTH',\n    0x0045: 'YEAR',\n    0x0046: 'WEEKDAY',\n    0x0047: 'HOUR',\n    0x0048: 'MINUTE',\n    0x0049: 'SECOND',\n    0x004A: 'NOW',\n    0x004B: 'AREAS',\n    0x004C: 'ROWS',\n    0x004D: 'COLUMNS',\n    0x004E: 'OFFSET',\n    0x004F: 'ABSREF',\n    0x0050: 'RELREF',\n    0x0051: 'ARGUMENT',\n    0x0052: 'SEARCH',\n    0x0053: 'TRANSPOSE',\n    0x0054: 'ERROR',\n    0x0055: 'STEP',\n    0x0056: 'TYPE',\n    0x0057: 'ECHO',\n    0x0058: 'SET.NAME',\n    0x0059: 'CALLER',\n    0x005A: 'DEREF',\n    0x005B: 'WINDOWS',\n    0x005C: 'SERIES',\n    0x005D: 'DOCUMENTS',\n    0x005E: 'ACTIVE.CELL',\n    0x005F: 'SELECTION',\n    0x0060: 'RESULT',\n    0x0061: 'ATAN2',\n    0x0062: 'ASIN',\n    0x0063: 'ACOS',\n    0x0064: 'CHOOSE',\n    0x0065: 'HLOOKUP',\n    0x0066: 'VLOOKUP',\n    0x0067: 'LINKS',\n    0x0068: 'INPUT',\n    0x0069: 'ISREF',\n    0x006A: 'GET.FORMULA',\n    0x006B: 'GET.NAME',\n    0x006C: 'SET.VALUE',\n    0x006D: 'LOG',\n    0x006E: 'EXEC',\n    0x006F: 'CHAR',\n    0x0070: 'LOWER',\n    0x0071: 'UPPER',\n    0x0072: 'PROPER',\n    0x0073: 'LEFT',\n    0x0074: 'RIGHT',\n    0x0075: 'EXACT',\n    0x0076: 'TRIM',\n    0x0077: 'REPLACE',\n    0x0078: 'SUBSTITUTE',\n    0x0079: 'CODE',\n    0x007A: 'NAMES',\n    0x007B: 'DIRECTORY',\n    0x007C: 'FIND',\n    0x007D: 'CELL',\n    0x007E: 'ISERR',\n    0x007F: 'ISTEXT',\n    0x0080: 'ISNUMBER',\n    0x0081: 'ISBLANK',\n    0x0082: 'T',\n    0x0083: 'N',\n    0x0084: 'FOPEN',\n    0x0085: 'FCLOSE',\n    0x0086: 'FSIZE',\n    0x0087: 'FREADLN',\n    0x0088: 'FREAD',\n    0x0089: 'FWRITELN',\n    0x008A: 'FWRITE',\n    0x008B: 'FPOS',\n    0x008C: 'DATEVALUE',\n    0x008D: 'TIMEVALUE',\n    0x008E: 'SLN',\n    0x008F: 'SYD',\n    0x0090: 'DDB',\n    0x0091: 'GET.DEF',\n    0x0092: 'REFTEXT',\n    0x0093: 'TEXTREF',\n    0x0094: 'INDIRECT',\n    0x0095: 'REGISTER',\n    0x0096: 'CALL',\n    0x0097: 'ADD.BAR',\n    0x0098: 'ADD.MENU',\n    0x0099: 'ADD.COMMAND',\n    0x009A: 'ENABLE.COMMAND',\n    0x009B: 'CHECK.COMMAND',\n    0x009C: 'RENAME.COMMAND',\n    0x009D: 'SHOW.BAR',\n    0x009E: 'DELETE.MENU',\n    0x009F: 'DELETE.COMMAND',\n    0x00A0: 'GET.CHART.ITEM',\n    0x00A1: 'DIALOG.BOX',\n    0x00A2: 'CLEAN',\n    0x00A3: 'MDETERM',\n    0x00A4: 'MINVERSE',\n    0x00A5: 'MMULT',\n    0x00A6: 'FILES',\n    0x00A7: 'IPMT',\n    0x00A8: 'PPMT',\n    0x00A9: 'COUNTA',\n    0x00AA: 'CANCEL.KEY',\n    0x00AB: 'FOR',\n    0x00AC: 'WHILE',\n    0x00AD: 'BREAK',\n    0x00AE: 'NEXT',\n    0x00AF: 'INITIATE',\n    0x00B0: 'REQUEST',\n    0x00B1: 'POKE',\n    0x00B2: 'EXECUTE',\n    0x00B3: 'TERMINATE',\n    0x00B4: 'RESTART',\n    0x00B5: 'HELP',\n    0x00B6: 'GET.BAR',\n    0x00B7: 'PRODUCT',\n    0x00B8: 'FACT',\n    0x00B9: 'GET.CELL',\n    0x00BA: 'GET.WORKSPACE',\n    0x00BB: 'GET.WINDOW',\n    0x00BC: 'GET.DOCUMENT',\n    0x00BD: 'DPRODUCT',\n    0x00BE: 'ISNONTEXT',\n    0x00BF: 'GET.NOTE',\n    0x00C0: 'NOTE',\n    0x00C1: 'STDEVP',\n    0x00C2: 'VARP',\n    0x00C3: 'DSTDEVP',\n    0x00C4: 'DVARP',\n    0x00C5: 'TRUNC',\n    0x00C6: 'ISLOGICAL',\n    0x00C7: 'DCOUNTA',\n    0x00C8: 'DELETE.BAR',\n    0x00C9: 'UNREGISTER',\n    0x00CC: 'USDOLLAR',\n    0x00CD: 'FINDB',\n    0x00CE: 'SEARCHB',\n    0x00CF: 'REPLACEB',\n    0x00D0: 'LEFTB',\n    0x00D1: 'RIGHTB',\n    0x00D2: 'MIDB',\n    0x00D3: 'LENB',\n    0x00D4: 'ROUNDUP',\n    0x00D5: 'ROUNDDOWN',\n    0x00D6: 'ASC',\n    0x00D7: 'DBCS',\n    0x00D8: 'RANK',\n    0x00DB: 'ADDRESS',\n    0x00DC: 'DAYS360',\n    0x00DD: 'TODAY',\n    0x00DE: 'VDB',\n    0x00DF: 'ELSE',\n    0x00E0: 'ELSE.IF',\n    0x00E1: 'END.IF',\n    0x00E2: 'FOR.CELL',\n    0x00E3: 'MEDIAN',\n    0x00E4: 'SUMPRODUCT',\n    0x00E5: 'SINH',\n    0x00E6: 'COSH',\n    0x00E7: 'TANH',\n    0x00E8: 'ASINH',\n    0x00E9: 'ACOSH',\n    0x00EA: 'ATANH',\n    0x00EB: 'DGET',\n    0x00EC: 'CREATE.OBJECT',\n    0x00ED: 'VOLATILE',\n    0x00EE: 'LAST.ERROR',\n    0x00EF: 'CUSTOM.UNDO',\n    0x00F0: 'CUSTOM.REPEAT',\n    0x00F1: 'FORMULA.CONVERT',\n    0x00F2: 'GET.LINK.INFO',\n    0x00F3: 'TEXT.BOX',\n    0x00F4: 'INFO',\n    0x00F5: 'GROUP',\n    0x00F6: 'GET.OBJECT',\n    0x00F7: 'DB',\n    0x00F8: 'PAUSE',\n    0x00FB: 'RESUME',\n    0x00FC: 'FREQUENCY',\n    0x00FD: 'ADD.TOOLBAR',\n    0x00FE: 'DELETE.TOOLBAR',\n    0x00FF: 'User',\n    0x0100: 'RESET.TOOLBAR',\n    0x0101: 'EVALUATE',\n    0x0102: 'GET.TOOLBAR',\n    0x0103: 'GET.TOOL',\n    0x0104: 'SPELLING.CHECK',\n    0x0105: 'ERROR.TYPE',\n    0x0106: 'APP.TITLE',\n    0x0107: 'WINDOW.TITLE',\n    0x0108: 'SAVE.TOOLBAR',\n    0x0109: 'ENABLE.TOOL',\n    0x010A: 'PRESS.TOOL',\n    0x010B: 'REGISTER.ID',\n    0x010C: 'GET.WORKBOOK',\n    0x010D: 'AVEDEV',\n    0x010E: 'BETADIST',\n    0x010F: 'GAMMALN',\n    0x0110: 'BETAINV',\n    0x0111: 'BINOMDIST',\n    0x0112: 'CHIDIST',\n    0x0113: 'CHIINV',\n    0x0114: 'COMBIN',\n    0x0115: 'CONFIDENCE',\n    0x0116: 'CRITBINOM',\n    0x0117: 'EVEN',\n    0x0118: 'EXPONDIST',\n    0x0119: 'FDIST',\n    0x011A: 'FINV',\n    0x011B: 'FISHER',\n    0x011C: 'FISHERINV',\n    0x011D: 'FLOOR',\n    0x011E: 'GAMMADIST',\n    0x011F: 'GAMMAINV',\n    0x0120: 'CEILING',\n    0x0121: 'HYPGEOMDIST',\n    0x0122: 'LOGNORMDIST',\n    0x0123: 'LOGINV',\n    0x0124: 'NEGBINOMDIST',\n    0x0125: 'NORMDIST',\n    0x0126: 'NORMSDIST',\n    0x0127: 'NORMINV',\n    0x0128: 'NORMSINV',\n    0x0129: 'STANDARDIZE',\n    0x012A: 'ODD',\n    0x012B: 'PERMUT',\n    0x012C: 'POISSON',\n    0x012D: 'TDIST',\n    0x012E: 'WEIBULL',\n    0x012F: 'SUMXMY2',\n    0x0130: 'SUMX2MY2',\n    0x0131: 'SUMX2PY2',\n    0x0132: 'CHITEST',\n    0x0133: 'CORREL',\n    0x0134: 'COVAR',\n    0x0135: 'FORECAST',\n    0x0136: 'FTEST',\n    0x0137: 'INTERCEPT',\n    0x0138: 'PEARSON',\n    0x0139: 'RSQ',\n    0x013A: 'STEYX',\n    0x013B: 'SLOPE',\n    0x013C: 'TTEST',\n    0x013D: 'PROB',\n    0x013E: 'DEVSQ',\n    0x013F: 'GEOMEAN',\n    0x0140: 'HARMEAN',\n    0x0141: 'SUMSQ',\n    0x0142: 'KURT',\n    0x0143: 'SKEW',\n    0x0144: 'ZTEST',\n    0x0145: 'LARGE',\n    0x0146: 'SMALL',\n    0x0147: 'QUARTILE',\n    0x0148: 'PERCENTILE',\n    0x0149: 'PERCENTRANK',\n    0x014A: 'MODE',\n    0x014B: 'TRIMMEAN',\n    0x014C: 'TINV',\n    0x014E: 'MOVIE.COMMAND',\n    0x014F: 'GET.MOVIE',\n    0x0150: 'CONCATENATE',\n    0x0151: 'POWER',\n    0x0152: 'PIVOT.ADD.DATA',\n    0x0153: 'GET.PIVOT.TABLE',\n    0x0154: 'GET.PIVOT.FIELD',\n    0x0155: 'GET.PIVOT.ITEM',\n    0x0156: 'RADIANS',\n    0x0157: 'DEGREES',\n    0x0158: 'SUBTOTAL',\n    0x0159: 'SUMIF',\n    0x015A: 'COUNTIF',\n    0x015B: 'COUNTBLANK',\n    0x015C: 'SCENARIO.GET',\n    0x015D: 'OPTIONS.LISTS.GET',\n    0x015E: 'ISPMT',\n    0x015F: 'DATEDIF',\n    0x0160: 'DATESTRING',\n    0x0161: 'NUMBERSTRING',\n    0x0162: 'ROMAN',\n    0x0163: 'OPEN.DIALOG',\n    0x0164: 'SAVE.DIALOG',\n    0x0165: 'VIEW.GET',\n    0x0166: 'GETPIVOTDATA',\n    0x0167: 'HYPERLINK',\n    0x0168: 'PHONETIC',\n    0x0169: 'AVERAGEA',\n    0x016A: 'MAXA',\n    0x016B: 'MINA',\n    0x016C: 'STDEVPA',\n    0x016D: 'VARPA',\n    0x016E: 'STDEVA',\n    0x016F: 'VARA',\n    0x0170: 'BAHTTEXT',\n    0x0171: 'THAIDAYOFWEEK',\n    0x0172: 'THAIDIGIT',\n    0x0173: 'THAIMONTHOFYEAR',\n    0x0174: 'THAINUMSOUND',\n    0x0175: 'THAINUMSTRING',\n    0x0176: 'THAISTRINGLENGTH',\n    0x0177: 'ISTHAIDIGIT',\n    0x0178: 'ROUNDBAHTDOWN',\n    0x0179: 'ROUNDBAHTUP',\n    0x017A: 'THAIYEAR',\n    0x017B: 'RTD'\n  };\n  var FtabArgc = {\n    0x0002: 1,\n\n    /* ISNA */\n    0x0003: 1,\n\n    /* ISERROR */\n    0x000F: 1,\n\n    /* SIN */\n    0x0010: 1,\n\n    /* COS */\n    0x0011: 1,\n\n    /* TAN */\n    0x0012: 1,\n\n    /* ATAN */\n    0x0014: 1,\n\n    /* SQRT */\n    0x0015: 1,\n\n    /* EXP */\n    0x0016: 1,\n\n    /* LN */\n    0x0017: 1,\n\n    /* LOG10 */\n    0x0018: 1,\n\n    /* ABS */\n    0x0019: 1,\n\n    /* INT */\n    0x001A: 1,\n\n    /* SIGN */\n    0x001B: 2,\n\n    /* ROUND */\n    0x001E: 2,\n\n    /* REPT */\n    0x001F: 3,\n\n    /* MID */\n    0x0020: 1,\n\n    /* LEN */\n    0x0021: 1,\n\n    /* VALUE */\n    0x0026: 1,\n\n    /* NOT */\n    0x0027: 2,\n\n    /* MOD */\n    0x0028: 3,\n\n    /* DCOUNT */\n    0x0029: 3,\n\n    /* DSUM */\n    0x002A: 3,\n\n    /* DAVERAGE */\n    0x002B: 3,\n\n    /* DMIN */\n    0x002C: 3,\n\n    /* DMAX */\n    0x002D: 3,\n\n    /* DSTDEV */\n    0x002F: 3,\n\n    /* DVAR */\n    0x0030: 2,\n\n    /* TEXT */\n    0x0035: 1,\n\n    /* GOTO */\n    0x003D: 3,\n\n    /* MIRR */\n    0x0041: 3,\n\n    /* DATE */\n    0x0042: 3,\n\n    /* TIME */\n    0x0043: 1,\n\n    /* DAY */\n    0x0044: 1,\n\n    /* MONTH */\n    0x0045: 1,\n\n    /* YEAR */\n    0x0047: 1,\n\n    /* HOUR */\n    0x0048: 1,\n\n    /* MINUTE */\n    0x0049: 1,\n\n    /* SECOND */\n    0x004B: 1,\n\n    /* AREAS */\n    0x004C: 1,\n\n    /* ROWS */\n    0x004D: 1,\n\n    /* COLUMNS */\n    0x004F: 2,\n\n    /* ABSREF */\n    0x0050: 2,\n\n    /* RELREF */\n    0x0053: 1,\n\n    /* TRANSPOSE */\n    0x0056: 1,\n\n    /* TYPE */\n    0x005A: 1,\n\n    /* DEREF */\n    0x0061: 2,\n\n    /* ATAN2 */\n    0x0062: 1,\n\n    /* ASIN */\n    0x0063: 1,\n\n    /* ACOS */\n    0x0069: 1,\n\n    /* ISREF */\n    0x006F: 1,\n\n    /* CHAR */\n    0x0070: 1,\n\n    /* LOWER */\n    0x0071: 1,\n\n    /* UPPER */\n    0x0072: 1,\n\n    /* PROPER */\n    0x0075: 2,\n\n    /* EXACT */\n    0x0076: 1,\n\n    /* TRIM */\n    0x0077: 4,\n\n    /* REPLACE */\n    0x0079: 1,\n\n    /* CODE */\n    0x007E: 1,\n\n    /* ISERR */\n    0x007F: 1,\n\n    /* ISTEXT */\n    0x0080: 1,\n\n    /* ISNUMBER */\n    0x0081: 1,\n\n    /* ISBLANK */\n    0x0082: 1,\n\n    /* T */\n    0x0083: 1,\n\n    /* N */\n    0x0085: 1,\n\n    /* FCLOSE */\n    0x0086: 1,\n\n    /* FSIZE */\n    0x0087: 1,\n\n    /* FREADLN */\n    0x0088: 2,\n\n    /* FREAD */\n    0x0089: 2,\n\n    /* FWRITELN */\n    0x008A: 2,\n\n    /* FWRITE */\n    0x008C: 1,\n\n    /* DATEVALUE */\n    0x008D: 1,\n\n    /* TIMEVALUE */\n    0x008E: 3,\n\n    /* SLN */\n    0x008F: 4,\n\n    /* SYD */\n    0x00A2: 1,\n\n    /* CLEAN */\n    0x00A3: 1,\n\n    /* MDETERM */\n    0x00A4: 1,\n\n    /* MINVERSE */\n    0x00A5: 2,\n\n    /* MMULT */\n    0x00AC: 1,\n\n    /* WHILE */\n    0x00AF: 2,\n\n    /* INITIATE */\n    0x00B0: 2,\n\n    /* REQUEST */\n    0x00B1: 3,\n\n    /* POKE */\n    0x00B2: 2,\n\n    /* EXECUTE */\n    0x00B3: 1,\n\n    /* TERMINATE */\n    0x00B8: 1,\n\n    /* FACT */\n    0x00BD: 3,\n\n    /* DPRODUCT */\n    0x00BE: 1,\n\n    /* ISNONTEXT */\n    0x00C3: 3,\n\n    /* DSTDEVP */\n    0x00C4: 3,\n\n    /* DVARP */\n    0x00C6: 1,\n\n    /* ISLOGICAL */\n    0x00C7: 3,\n\n    /* DCOUNTA */\n    0x00C9: 1,\n\n    /* UNREGISTER */\n    0x00CF: 4,\n\n    /* REPLACEB */\n    0x00D2: 3,\n\n    /* MIDB */\n    0x00D3: 1,\n\n    /* LENB */\n    0x00D4: 2,\n\n    /* ROUNDUP */\n    0x00D5: 2,\n\n    /* ROUNDDOWN */\n    0x00D6: 1,\n\n    /* ASC */\n    0x00D7: 1,\n\n    /* DBCS */\n    0x00E5: 1,\n\n    /* SINH */\n    0x00E6: 1,\n\n    /* COSH */\n    0x00E7: 1,\n\n    /* TANH */\n    0x00E8: 1,\n\n    /* ASINH */\n    0x00E9: 1,\n\n    /* ACOSH */\n    0x00EA: 1,\n\n    /* ATANH */\n    0x00EB: 3,\n\n    /* DGET */\n    0x00F4: 1,\n\n    /* INFO */\n    0x00FC: 2,\n\n    /* FREQUENCY */\n    0x0101: 1,\n\n    /* EVALUATE */\n    0x0105: 1,\n\n    /* ERROR.TYPE */\n    0x010F: 1,\n\n    /* GAMMALN */\n    0x0111: 4,\n\n    /* BINOMDIST */\n    0x0112: 2,\n\n    /* CHIDIST */\n    0x0113: 2,\n\n    /* CHIINV */\n    0x0114: 2,\n\n    /* COMBIN */\n    0x0115: 3,\n\n    /* CONFIDENCE */\n    0x0116: 3,\n\n    /* CRITBINOM */\n    0x0117: 1,\n\n    /* EVEN */\n    0x0118: 3,\n\n    /* EXPONDIST */\n    0x0119: 3,\n\n    /* FDIST */\n    0x011A: 3,\n\n    /* FINV */\n    0x011B: 1,\n\n    /* FISHER */\n    0x011C: 1,\n\n    /* FISHERINV */\n    0x011D: 2,\n\n    /* FLOOR */\n    0x011E: 4,\n\n    /* GAMMADIST */\n    0x011F: 3,\n\n    /* GAMMAINV */\n    0x0120: 2,\n\n    /* CEILING */\n    0x0121: 4,\n\n    /* HYPGEOMDIST */\n    0x0122: 3,\n\n    /* LOGNORMDIST */\n    0x0123: 3,\n\n    /* LOGINV */\n    0x0124: 3,\n\n    /* NEGBINOMDIST */\n    0x0125: 4,\n\n    /* NORMDIST */\n    0x0126: 1,\n\n    /* NORMSDIST */\n    0x0127: 3,\n\n    /* NORMINV */\n    0x0128: 1,\n\n    /* NORMSINV */\n    0x0129: 3,\n\n    /* STANDARDIZE */\n    0x012A: 1,\n\n    /* ODD */\n    0x012B: 2,\n\n    /* PERMUT */\n    0x012C: 3,\n\n    /* POISSON */\n    0x012D: 3,\n\n    /* TDIST */\n    0x012E: 4,\n\n    /* WEIBULL */\n    0x012F: 2,\n\n    /* SUMXMY2 */\n    0x0130: 2,\n\n    /* SUMX2MY2 */\n    0x0131: 2,\n\n    /* SUMX2PY2 */\n    0x0132: 2,\n\n    /* CHITEST */\n    0x0133: 2,\n\n    /* CORREL */\n    0x0134: 2,\n\n    /* COVAR */\n    0x0135: 3,\n\n    /* FORECAST */\n    0x0136: 2,\n\n    /* FTEST */\n    0x0137: 2,\n\n    /* INTERCEPT */\n    0x0138: 2,\n\n    /* PEARSON */\n    0x0139: 2,\n\n    /* RSQ */\n    0x013A: 2,\n\n    /* STEYX */\n    0x013B: 2,\n\n    /* SLOPE */\n    0x013C: 4,\n\n    /* TTEST */\n    0x0145: 2,\n\n    /* LARGE */\n    0x0146: 2,\n\n    /* SMALL */\n    0x0147: 2,\n\n    /* QUARTILE */\n    0x0148: 2,\n\n    /* PERCENTILE */\n    0x014B: 2,\n\n    /* TRIMMEAN */\n    0x014C: 2,\n\n    /* TINV */\n    0x0151: 2,\n\n    /* POWER */\n    0x0156: 1,\n\n    /* RADIANS */\n    0x0157: 1,\n\n    /* DEGREES */\n    0x015A: 2,\n\n    /* COUNTIF */\n    0x015B: 1,\n\n    /* COUNTBLANK */\n    0x015E: 4,\n\n    /* ISPMT */\n    0x015F: 3,\n\n    /* DATEDIF */\n    0x0160: 1,\n\n    /* DATESTRING */\n    0x0161: 2,\n\n    /* NUMBERSTRING */\n    0x0168: 1,\n\n    /* PHONETIC */\n    0x0170: 1,\n\n    /* BAHTTEXT */\n    0x0171: 1,\n\n    /* THAIDAYOFWEEK */\n    0x0172: 1,\n\n    /* THAIDIGIT */\n    0x0173: 1,\n\n    /* THAIMONTHOFYEAR */\n    0x0174: 1,\n\n    /* THAINUMSOUND */\n    0x0175: 1,\n\n    /* THAINUMSTRING */\n    0x0176: 1,\n\n    /* THAISTRINGLENGTH */\n    0x0177: 1,\n\n    /* ISTHAIDIGIT */\n    0x0178: 1,\n\n    /* ROUNDBAHTDOWN */\n    0x0179: 1,\n\n    /* ROUNDBAHTUP */\n    0x017A: 1,\n\n    /* THAIYEAR */\n    0xFFFF: 0\n  };\n  /* [MS-XLSX] 2.2.3 Functions */\n\n  var XLSXFutureFunctions = {\n    \"_xlfn.ACOT\": \"ACOT\",\n    \"_xlfn.ACOTH\": \"ACOTH\",\n    \"_xlfn.AGGREGATE\": \"AGGREGATE\",\n    \"_xlfn.ARABIC\": \"ARABIC\",\n    \"_xlfn.AVERAGEIF\": \"AVERAGEIF\",\n    \"_xlfn.AVERAGEIFS\": \"AVERAGEIFS\",\n    \"_xlfn.BASE\": \"BASE\",\n    \"_xlfn.BETA.DIST\": \"BETA.DIST\",\n    \"_xlfn.BETA.INV\": \"BETA.INV\",\n    \"_xlfn.BINOM.DIST\": \"BINOM.DIST\",\n    \"_xlfn.BINOM.DIST.RANGE\": \"BINOM.DIST.RANGE\",\n    \"_xlfn.BINOM.INV\": \"BINOM.INV\",\n    \"_xlfn.BITAND\": \"BITAND\",\n    \"_xlfn.BITLSHIFT\": \"BITLSHIFT\",\n    \"_xlfn.BITOR\": \"BITOR\",\n    \"_xlfn.BITRSHIFT\": \"BITRSHIFT\",\n    \"_xlfn.BITXOR\": \"BITXOR\",\n    \"_xlfn.CEILING.MATH\": \"CEILING.MATH\",\n    \"_xlfn.CEILING.PRECISE\": \"CEILING.PRECISE\",\n    \"_xlfn.CHISQ.DIST\": \"CHISQ.DIST\",\n    \"_xlfn.CHISQ.DIST.RT\": \"CHISQ.DIST.RT\",\n    \"_xlfn.CHISQ.INV\": \"CHISQ.INV\",\n    \"_xlfn.CHISQ.INV.RT\": \"CHISQ.INV.RT\",\n    \"_xlfn.CHISQ.TEST\": \"CHISQ.TEST\",\n    \"_xlfn.COMBINA\": \"COMBINA\",\n    \"_xlfn.CONFIDENCE.NORM\": \"CONFIDENCE.NORM\",\n    \"_xlfn.CONFIDENCE.T\": \"CONFIDENCE.T\",\n    \"_xlfn.COT\": \"COT\",\n    \"_xlfn.COTH\": \"COTH\",\n    \"_xlfn.COUNTIFS\": \"COUNTIFS\",\n    \"_xlfn.COVARIANCE.P\": \"COVARIANCE.P\",\n    \"_xlfn.COVARIANCE.S\": \"COVARIANCE.S\",\n    \"_xlfn.CSC\": \"CSC\",\n    \"_xlfn.CSCH\": \"CSCH\",\n    \"_xlfn.DAYS\": \"DAYS\",\n    \"_xlfn.DECIMAL\": \"DECIMAL\",\n    \"_xlfn.ECMA.CEILING\": \"ECMA.CEILING\",\n    \"_xlfn.ERF.PRECISE\": \"ERF.PRECISE\",\n    \"_xlfn.ERFC.PRECISE\": \"ERFC.PRECISE\",\n    \"_xlfn.EXPON.DIST\": \"EXPON.DIST\",\n    \"_xlfn.F.DIST\": \"F.DIST\",\n    \"_xlfn.F.DIST.RT\": \"F.DIST.RT\",\n    \"_xlfn.F.INV\": \"F.INV\",\n    \"_xlfn.F.INV.RT\": \"F.INV.RT\",\n    \"_xlfn.F.TEST\": \"F.TEST\",\n    \"_xlfn.FILTERXML\": \"FILTERXML\",\n    \"_xlfn.FLOOR.MATH\": \"FLOOR.MATH\",\n    \"_xlfn.FLOOR.PRECISE\": \"FLOOR.PRECISE\",\n    \"_xlfn.FORMULATEXT\": \"FORMULATEXT\",\n    \"_xlfn.GAMMA\": \"GAMMA\",\n    \"_xlfn.GAMMA.DIST\": \"GAMMA.DIST\",\n    \"_xlfn.GAMMA.INV\": \"GAMMA.INV\",\n    \"_xlfn.GAMMALN.PRECISE\": \"GAMMALN.PRECISE\",\n    \"_xlfn.GAUSS\": \"GAUSS\",\n    \"_xlfn.HYPGEOM.DIST\": \"HYPGEOM.DIST\",\n    \"_xlfn.IFNA\": \"IFNA\",\n    \"_xlfn.IFERROR\": \"IFERROR\",\n    \"_xlfn.IMCOSH\": \"IMCOSH\",\n    \"_xlfn.IMCOT\": \"IMCOT\",\n    \"_xlfn.IMCSC\": \"IMCSC\",\n    \"_xlfn.IMCSCH\": \"IMCSCH\",\n    \"_xlfn.IMSEC\": \"IMSEC\",\n    \"_xlfn.IMSECH\": \"IMSECH\",\n    \"_xlfn.IMSINH\": \"IMSINH\",\n    \"_xlfn.IMTAN\": \"IMTAN\",\n    \"_xlfn.ISFORMULA\": \"ISFORMULA\",\n    \"_xlfn.ISO.CEILING\": \"ISO.CEILING\",\n    \"_xlfn.ISOWEEKNUM\": \"ISOWEEKNUM\",\n    \"_xlfn.LOGNORM.DIST\": \"LOGNORM.DIST\",\n    \"_xlfn.LOGNORM.INV\": \"LOGNORM.INV\",\n    \"_xlfn.MODE.MULT\": \"MODE.MULT\",\n    \"_xlfn.MODE.SNGL\": \"MODE.SNGL\",\n    \"_xlfn.MUNIT\": \"MUNIT\",\n    \"_xlfn.NEGBINOM.DIST\": \"NEGBINOM.DIST\",\n    \"_xlfn.NETWORKDAYS.INTL\": \"NETWORKDAYS.INTL\",\n    \"_xlfn.NIGBINOM\": \"NIGBINOM\",\n    \"_xlfn.NORM.DIST\": \"NORM.DIST\",\n    \"_xlfn.NORM.INV\": \"NORM.INV\",\n    \"_xlfn.NORM.S.DIST\": \"NORM.S.DIST\",\n    \"_xlfn.NORM.S.INV\": \"NORM.S.INV\",\n    \"_xlfn.NUMBERVALUE\": \"NUMBERVALUE\",\n    \"_xlfn.PDURATION\": \"PDURATION\",\n    \"_xlfn.PERCENTILE.EXC\": \"PERCENTILE.EXC\",\n    \"_xlfn.PERCENTILE.INC\": \"PERCENTILE.INC\",\n    \"_xlfn.PERCENTRANK.EXC\": \"PERCENTRANK.EXC\",\n    \"_xlfn.PERCENTRANK.INC\": \"PERCENTRANK.INC\",\n    \"_xlfn.PERMUTATIONA\": \"PERMUTATIONA\",\n    \"_xlfn.PHI\": \"PHI\",\n    \"_xlfn.POISSON.DIST\": \"POISSON.DIST\",\n    \"_xlfn.QUARTILE.EXC\": \"QUARTILE.EXC\",\n    \"_xlfn.QUARTILE.INC\": \"QUARTILE.INC\",\n    \"_xlfn.QUERYSTRING\": \"QUERYSTRING\",\n    \"_xlfn.RANK.AVG\": \"RANK.AVG\",\n    \"_xlfn.RANK.EQ\": \"RANK.EQ\",\n    \"_xlfn.RRI\": \"RRI\",\n    \"_xlfn.SEC\": \"SEC\",\n    \"_xlfn.SECH\": \"SECH\",\n    \"_xlfn.SHEET\": \"SHEET\",\n    \"_xlfn.SHEETS\": \"SHEETS\",\n    \"_xlfn.SKEW.P\": \"SKEW.P\",\n    \"_xlfn.STDEV.P\": \"STDEV.P\",\n    \"_xlfn.STDEV.S\": \"STDEV.S\",\n    \"_xlfn.SUMIFS\": \"SUMIFS\",\n    \"_xlfn.T.DIST\": \"T.DIST\",\n    \"_xlfn.T.DIST.2T\": \"T.DIST.2T\",\n    \"_xlfn.T.DIST.RT\": \"T.DIST.RT\",\n    \"_xlfn.T.INV\": \"T.INV\",\n    \"_xlfn.T.INV.2T\": \"T.INV.2T\",\n    \"_xlfn.T.TEST\": \"T.TEST\",\n    \"_xlfn.UNICHAR\": \"UNICHAR\",\n    \"_xlfn.UNICODE\": \"UNICODE\",\n    \"_xlfn.VAR.P\": \"VAR.P\",\n    \"_xlfn.VAR.S\": \"VAR.S\",\n    \"_xlfn.WEBSERVICE\": \"WEBSERVICE\",\n    \"_xlfn.WEIBULL.DIST\": \"WEIBULL.DIST\",\n    \"_xlfn.WORKDAY.INTL\": \"WORKDAY.INTL\",\n    \"_xlfn.XOR\": \"XOR\",\n    \"_xlfn.Z.TEST\": \"Z.TEST\"\n  };\n  var strs = {}; // shared strings\n\n  var _ssfopts = {}; // spreadsheet formatting options\n\n  RELS.WS = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\";\n\n  function get_sst_id(sst, str) {\n    for (var i = 0, len = sst.length; i < len; ++i) if (sst[i].t === str) {\n      sst.Count++;\n      return i;\n    }\n\n    sst[len] = {\n      t: str\n    };\n    sst.Count++;\n    sst.Unique++;\n    return len;\n  }\n\n  function get_cell_style(styles, cell, opts) {\n    if (typeof style_builder != 'undefined') {\n      if (/^\\d+$/.exec(cell.s)) {\n        return cell.s;\n      } // if its already an integer index, let it be\n\n\n      if (cell.s && cell.s == +cell.s) {\n        return cell.s;\n      } // if its already an integer index, let it be\n\n\n      var s = cell.s || {};\n      if (cell.z) s.numFmt = cell.z;\n      return style_builder.addStyle(s);\n    } else {\n      var z = opts.revssf[cell.z != null ? cell.z : \"General\"];\n\n      for (var i = 0, len = styles.length; i != len; ++i) if (styles[i].numFmtId === z) return i;\n\n      styles[len] = {\n        numFmtId: z,\n        fontId: 0,\n        fillId: 0,\n        borderId: 0,\n        xfId: 0,\n        applyNumberFormat: 1\n      };\n      return len;\n    }\n  }\n\n  function get_cell_style_csf(cellXf) {\n    if (cellXf) {\n      var s = {};\n\n      if (typeof cellXf.numFmtId != undefined) {\n        s.numFmt = SSF._table[cellXf.numFmtId];\n      }\n\n      if (cellXf.fillId) {\n        s.fill = styles.Fills[cellXf.fillId];\n      }\n\n      if (cellXf.fontId) {\n        s.font = styles.Fonts[cellXf.fontId];\n      }\n\n      if (cellXf.borderId) {\n        s.border = styles.Borders[cellXf.borderId];\n      }\n\n      if (cellXf.applyAlignment == 1) {\n        s.alignment = cellXf.alignment;\n      }\n\n      return JSON.parse(JSON.stringify(s));\n    }\n\n    return null;\n  }\n\n  function safe_format(p, fmtid, fillid, opts) {\n    try {\n      if (p.t === 'e') p.w = p.w || BErr[p.v];else if (fmtid === 0) {\n        if (p.t === 'n') {\n          if ((p.v | 0) === p.v) p.w = SSF._general_int(p.v, _ssfopts);else p.w = SSF._general_num(p.v, _ssfopts);\n        } else if (p.t === 'd') {\n          var dd = datenum(p.v);\n          if ((dd | 0) === dd) p.w = SSF._general_int(dd, _ssfopts);else p.w = SSF._general_num(dd, _ssfopts);\n        } else if (p.v === undefined) return \"\";else p.w = SSF._general(p.v, _ssfopts);\n      } else if (p.t === 'd') p.w = SSF.format(fmtid, datenum(p.v), _ssfopts);else p.w = SSF.format(fmtid, p.v, _ssfopts);\n      if (opts.cellNF) p.z = SSF._table[fmtid];\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n  }\n\n  function parse_ws_xml_dim(ws, s) {\n    var d = safe_decode_range(s);\n    if (d.s.r <= d.e.r && d.s.c <= d.e.c && d.s.r >= 0 && d.s.c >= 0) ws[\"!ref\"] = encode_range(d);\n  }\n\n  var mergecregex = /<mergeCell ref=\"[A-Z0-9:]+\"\\s*\\/>/g;\n  var sheetdataregex = /<(?:\\w+:)?sheetData>([^\\u2603]*)<\\/(?:\\w+:)?sheetData>/;\n  var hlinkregex = /<hyperlink[^>]*\\/>/g;\n  var dimregex = /\"(\\w*:\\w*)\"/;\n  var colregex = /<col[^>]*\\/>/g;\n  /* 18.3 Worksheets */\n\n  function parse_ws_xml(data, opts, rels) {\n    if (!data) return data;\n    /* 18.3.1.99 worksheet CT_Worksheet */\n\n    var s = {};\n    /* 18.3.1.35 dimension CT_SheetDimension ? */\n\n    var ridx = data.indexOf(\"<dimension\");\n\n    if (ridx > 0) {\n      var ref = data.substr(ridx, 50).match(dimregex);\n      if (ref != null) parse_ws_xml_dim(s, ref[1]);\n    }\n    /* 18.3.1.55 mergeCells CT_MergeCells */\n\n\n    var mergecells = [];\n\n    if (data.indexOf(\"</mergeCells>\") !== -1) {\n      var merges = data.match(mergecregex);\n\n      for (ridx = 0; ridx != merges.length; ++ridx) mergecells[ridx] = safe_decode_range(merges[ridx].substr(merges[ridx].indexOf(\"\\\"\") + 1));\n    }\n    /* 18.3.1.17 cols CT_Cols */\n\n\n    var columns = [];\n\n    if (opts.cellStyles && data.indexOf(\"</cols>\") !== -1) {\n      /* 18.3.1.13 col CT_Col */\n      var cols = data.match(colregex);\n      parse_ws_xml_cols(columns, cols);\n    }\n\n    var refguess = {\n      s: {\n        r: 1000000,\n        c: 1000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    /* 18.3.1.80 sheetData CT_SheetData ? */\n\n    var mtch = data.match(sheetdataregex);\n    if (mtch) parse_ws_xml_data(mtch[1], s, opts, refguess);\n    /* 18.3.1.48 hyperlinks CT_Hyperlinks */\n\n    if (data.indexOf(\"</hyperlinks>\") !== -1) parse_ws_xml_hlinks(s, data.match(hlinkregex), rels);\n    if (!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\n\n    if (opts.sheetRows > 0 && s[\"!ref\"]) {\n      var tmpref = safe_decode_range(s[\"!ref\"]);\n\n      if (opts.sheetRows < +tmpref.e.r) {\n        tmpref.e.r = opts.sheetRows - 1;\n        if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n        if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n        if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n        if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n        s[\"!fullref\"] = s[\"!ref\"];\n        s[\"!ref\"] = encode_range(tmpref);\n      }\n    }\n\n    if (mergecells.length > 0) s[\"!merges\"] = mergecells;\n    if (columns.length > 0) s[\"!cols\"] = columns;\n    return s;\n  }\n\n  function write_ws_xml_merges(merges) {\n    if (merges.length == 0) return \"\";\n    var o = '<mergeCells count=\"' + merges.length + '\">';\n\n    for (var i = 0; i != merges.length; ++i) o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\n\n    return o + '</mergeCells>';\n  }\n\n  function write_ws_xml_pagesetup(setup) {\n    var pageSetup = writextag('pageSetup', null, {\n      scale: setup.scale || '100',\n      orientation: setup.orientation || 'portrait',\n      horizontalDpi: setup.horizontalDpi || '4294967292',\n      verticalDpi: setup.verticalDpi || '4294967292'\n    });\n    return pageSetup;\n  }\n\n  function parse_ws_xml_hlinks(s, data, rels) {\n    for (var i = 0; i != data.length; ++i) {\n      var val = parsexmltag(data[i], true);\n      if (!val.ref) return;\n      var rel = rels ? rels['!id'][val.id] : null;\n\n      if (rel) {\n        val.Target = rel.Target;\n        if (val.location) val.Target += \"#\" + val.location;\n        val.Rel = rel;\n      } else {\n        val.Target = val.location;\n        rel = {\n          Target: val.location,\n          TargetMode: 'Internal'\n        };\n        val.Rel = rel;\n      }\n\n      var rng = safe_decode_range(val.ref);\n\n      for (var R = rng.s.r; R <= rng.e.r; ++R) for (var C = rng.s.c; C <= rng.e.c; ++C) {\n        var addr = encode_cell({\n          c: C,\n          r: R\n        });\n        if (!s[addr]) s[addr] = {\n          t: \"stub\",\n          v: undefined\n        };\n        s[addr].l = val;\n      }\n    }\n  }\n\n  function parse_ws_xml_cols(columns, cols) {\n    var seencol = false;\n\n    for (var coli = 0; coli != cols.length; ++coli) {\n      var coll = parsexmltag(cols[coli], true);\n      var colm = parseInt(coll.min, 10) - 1,\n          colM = parseInt(coll.max, 10) - 1;\n      delete coll.min;\n      delete coll.max;\n\n      if (!seencol && coll.width) {\n        seencol = true;\n        find_mdw(+coll.width, coll);\n      }\n\n      if (coll.width) {\n        coll.wpx = width2px(+coll.width);\n        coll.wch = px2char(coll.wpx);\n        coll.MDW = MDW;\n      }\n\n      while (colm <= colM) columns[colm++] = coll;\n    }\n  }\n\n  function write_ws_xml_cols(ws, cols) {\n    var o = [\"<cols>\"],\n        col,\n        width;\n\n    for (var i = 0; i != cols.length; ++i) {\n      if (!(col = cols[i])) continue;\n      var p = {\n        min: i + 1,\n        max: i + 1\n      };\n      /* wch (chars), wpx (pixels) */\n\n      width = -1;\n      if (col.wpx) width = px2char(col.wpx);else if (col.wch) width = col.wch;\n\n      if (width > -1) {\n        p.width = char2width(width);\n        p.customWidth = 1;\n      }\n\n      o[o.length] = writextag('col', null, p);\n    }\n\n    o[o.length] = \"</cols>\";\n    return o.join(\"\");\n  }\n\n  function write_ws_xml_cell(cell, ref, ws, opts, idx, wb) {\n    if (cell.v === undefined && cell.s === undefined) return \"\";\n    var vv = \"\";\n    var oldt = cell.t,\n        oldv = cell.v;\n\n    switch (cell.t) {\n      case 'b':\n        vv = cell.v ? \"1\" : \"0\";\n        break;\n\n      case 'n':\n        vv = '' + cell.v;\n        break;\n\n      case 'e':\n        vv = BErr[cell.v];\n        break;\n\n      case 'd':\n        if (opts.cellDates) vv = new Date(cell.v).toISOString();else {\n          cell.t = 'n';\n          vv = '' + (cell.v = datenum(cell.v));\n          if (typeof cell.z === 'undefined') cell.z = SSF._table[14];\n        }\n        break;\n\n      default:\n        vv = cell.v;\n        break;\n    }\n\n    var v = writetag('v', escapexml(vv)),\n        o = {\n      r: ref\n    };\n    /* TODO: cell style */\n\n    var os = get_cell_style(opts.cellXfs, cell, opts);\n    if (os !== 0) o.s = os;\n\n    switch (cell.t) {\n      case 'n':\n        break;\n\n      case 'd':\n        o.t = \"d\";\n        break;\n\n      case 'b':\n        o.t = \"b\";\n        break;\n\n      case 'e':\n        o.t = \"e\";\n        break;\n\n      default:\n        if (opts.bookSST) {\n          v = writetag('v', '' + get_sst_id(opts.Strings, cell.v));\n          o.t = \"s\";\n          break;\n        }\n\n        o.t = \"str\";\n        break;\n    }\n\n    if (cell.t != oldt) {\n      cell.t = oldt;\n      cell.v = oldv;\n    }\n\n    return writextag('c', v, o);\n  }\n\n  var parse_ws_xml_data = function parse_ws_xml_data_factory() {\n    var cellregex = /<(?:\\w+:)?c[ >]/,\n        rowregex = /<\\/(?:\\w+:)?row>/;\n    var rregex = /r=[\"']([^\"']*)[\"']/,\n        isregex = /<is>([\\S\\s]*?)<\\/is>/;\n    var match_v = matchtag(\"v\"),\n        match_f = matchtag(\"f\");\n    return function parse_ws_xml_data(sdata, s, opts, guess) {\n      var ri = 0,\n          x = \"\",\n          cells = [],\n          cref = [],\n          idx = 0,\n          i = 0,\n          cc = 0,\n          d = \"\",\n          p;\n      var tag,\n          tagr = 0,\n          tagc = 0;\n      var sstr;\n      var fmtid = 0,\n          fillid = 0,\n          do_format = Array.isArray(styles.CellXf),\n          cf;\n\n      for (var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\n        x = marr[mt].trim();\n        var xlen = x.length;\n        if (xlen === 0) continue;\n        /* 18.3.1.73 row CT_Row */\n\n        for (ri = 0; ri < xlen; ++ri) if (x.charCodeAt(ri) === 62) break;\n\n        ++ri;\n        tag = parsexmltag(x.substr(0, ri), true);\n        /* SpreadSheetGear uses implicit r/c */\n\n        tagr = typeof tag.r !== 'undefined' ? parseInt(tag.r, 10) : tagr + 1;\n        tagc = -1;\n        if (opts.sheetRows && opts.sheetRows < tagr) continue;\n        if (guess.s.r > tagr - 1) guess.s.r = tagr - 1;\n        if (guess.e.r < tagr - 1) guess.e.r = tagr - 1;\n        /* 18.3.1.4 c CT_Cell */\n\n        cells = x.substr(ri).split(cellregex);\n\n        for (ri = typeof tag.r === 'undefined' ? 0 : 1; ri != cells.length; ++ri) {\n          x = cells[ri].trim();\n          if (x.length === 0) continue;\n          cref = x.match(rregex);\n          idx = ri;\n          i = 0;\n          cc = 0;\n          x = \"<c \" + (x.substr(0, 1) == \"<\" ? \">\" : \"\") + x;\n\n          if (cref !== null && cref.length === 2) {\n            idx = 0;\n            d = cref[1];\n\n            for (i = 0; i != d.length; ++i) {\n              if ((cc = d.charCodeAt(i) - 64) < 1 || cc > 26) break;\n              idx = 26 * idx + cc;\n            }\n\n            --idx;\n            tagc = idx;\n          } else ++tagc;\n\n          for (i = 0; i != x.length; ++i) if (x.charCodeAt(i) === 62) break;\n\n          ++i;\n          tag = parsexmltag(x.substr(0, i), true);\n          if (!tag.r) tag.r = utils.encode_cell({\n            r: tagr - 1,\n            c: tagc\n          });\n          d = x.substr(i);\n          p = {\n            t: \"\"\n          };\n          if ((cref = d.match(match_v)) !== null && cref[1] !== '') p.v = unescapexml(cref[1]);\n          if (opts.cellFormula && (cref = d.match(match_f)) !== null) p.f = unescapexml(cref[1]);\n          /* SCHEMA IS ACTUALLY INCORRECT HERE.  IF A CELL HAS NO T, EMIT \"\" */\n\n          if (tag.t === undefined && tag.s === undefined && p.v === undefined) {\n            if (!opts.sheetStubs) continue;\n            p.t = \"stub\";\n          } else p.t = tag.t || \"n\";\n\n          if (guess.s.c > idx) guess.s.c = idx;\n          if (guess.e.c < idx) guess.e.c = idx;\n          /* 18.18.11 t ST_CellType */\n\n          switch (p.t) {\n            case 'n':\n              p.v = parseFloat(p.v);\n              if (isNaN(p.v)) p.v = \"\"; // we don't want NaN if p.v is null\n\n              break;\n\n            case 's':\n              // if (!p.hasOwnProperty('v')) continue;\n              sstr = strs[parseInt(p.v, 10)];\n              p.v = sstr.t;\n              p.r = sstr.r;\n              if (opts.cellHTML) p.h = sstr.h;\n              break;\n\n            case 'str':\n              p.t = \"s\";\n              p.v = p.v != null ? utf8read(p.v) : '';\n              if (opts.cellHTML) p.h = p.v;\n              break;\n\n            case 'inlineStr':\n              cref = d.match(isregex);\n              p.t = 's';\n\n              if (cref !== null) {\n                sstr = parse_si(cref[1]);\n                p.v = sstr.t;\n              } else p.v = \"\";\n\n              break;\n            // inline string\n\n            case 'b':\n              p.v = parsexmlbool(p.v);\n              break;\n\n            case 'd':\n              if (!opts.cellDates) {\n                p.v = datenum(p.v);\n                p.t = 'n';\n              }\n\n              break;\n\n            /* error string in .v, number in .v */\n\n            case 'e':\n              p.w = p.v;\n              p.v = RBErr[p.v];\n              break;\n          }\n          /* formatting */\n\n\n          fmtid = fillid = 0;\n\n          if (do_format && tag.s !== undefined) {\n            cf = styles.CellXf[tag.s];\n\n            if (opts.cellStyles) {\n              p.s = get_cell_style_csf(cf);\n            }\n\n            if (cf != null) {\n              if (cf.numFmtId != null) fmtid = cf.numFmtId;\n              if (opts.cellStyles && cf.fillId != null) fillid = cf.fillId;\n            }\n          }\n\n          safe_format(p, fmtid, fillid, opts);\n          s[tag.r] = p;\n        }\n      }\n    };\n  }();\n\n  function write_ws_xml_data(ws, opts, idx, wb) {\n    var o = [],\n        r = [],\n        range = safe_decode_range(ws['!ref']),\n        cell,\n        ref,\n        rr = \"\",\n        cols = [],\n        R,\n        C;\n\n    for (C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\n    for (R = range.s.r; R <= range.e.r; ++R) {\n      r = [];\n      rr = encode_row(R);\n\n      for (C = range.s.c; C <= range.e.c; ++C) {\n        ref = cols[C] + rr;\n        if (ws[ref] === undefined) continue;\n        if ((cell = write_ws_xml_cell(ws[ref], ref, ws, opts, idx, wb)) != null) r.push(cell);\n      }\n\n      if (r.length > 0) o[o.length] = writextag('row', r.join(\"\"), {\n        r: rr\n      });\n    }\n\n    return o.join(\"\");\n  }\n\n  var WS_XML_ROOT = writextag('worksheet', null, {\n    'xmlns': XMLNS.main[0],\n    'xmlns:r': XMLNS.r\n  });\n\n  function write_ws_xml(idx, opts, wb) {\n    var o = [XML_HEADER, WS_XML_ROOT];\n    var s = wb.SheetNames[idx],\n        sidx = 0,\n        rdata = \"\";\n    var ws = wb.Sheets[s];\n    if (ws === undefined) ws = {};\n    var ref = ws['!ref'];\n    if (ref === undefined) ref = 'A1';\n    o[o.length] = writextag('dimension', null, {\n      'ref': ref\n    });\n    var kids = [];\n\n    if (ws['!freeze']) {\n      var pane = '';\n      pane = writextag('pane', null, ws['!freeze']);\n      kids.push(pane);\n      var selection = writextag('selection', null, {\n        pane: \"topLeft\"\n      });\n      kids.push(selection);\n      var selection = writextag('selection', null, {\n        pane: \"bottomLeft\"\n      });\n      kids.push(selection);\n      var selection = writextag('selection', null, {\n        pane: \"bottomRight\",\n        activeCell: ws['!freeze'],\n        sqref: ws['!freeze']\n      });\n      kids.push(selection);\n    } //<selection pane=\"bottomRight\" activeCell=\"A4\" sqref=\"A4\"/>\n\n\n    var sheetView = writextag('sheetView', kids.join('') || undefined, {\n      showGridLines: opts.showGridLines == false ? '0' : '1',\n      tabSelected: opts.tabSelected === undefined ? '0' : opts.tabSelected,\n      // see issue #26, need to set WorkbookViews if this is set\n      workbookViewId: opts.workbookViewId === undefined ? '0' : opts.workbookViewId\n    });\n    o[o.length] = writextag('sheetViews', sheetView);\n    if (ws['!cols'] !== undefined && ws['!cols'].length > 0) o[o.length] = write_ws_xml_cols(ws, ws['!cols']);\n    o[sidx = o.length] = '<sheetData/>';\n\n    if (ws['!ref'] !== undefined) {\n      rdata = write_ws_xml_data(ws, opts, idx, wb);\n      if (rdata.length > 0) o[o.length] = rdata;\n    }\n\n    if (o.length > sidx + 1) {\n      o[o.length] = '</sheetData>';\n      o[sidx] = o[sidx].replace(\"/>\", \">\");\n    }\n\n    if (ws['!merges'] !== undefined && ws['!merges'].length > 0) o[o.length] = write_ws_xml_merges(ws['!merges']);\n    if (ws['!pageSetup'] !== undefined) o[o.length] = write_ws_xml_pagesetup(ws['!pageSetup']);\n    if (ws['!rowBreaks'] !== undefined) o[o.length] = write_ws_xml_row_breaks(ws['!rowBreaks']);\n    if (ws['!colBreaks'] !== undefined) o[o.length] = write_ws_xml_col_breaks(ws['!colBreaks']);\n\n    if (o.length > 2) {\n      o[o.length] = '</worksheet>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n\n  function write_ws_xml_row_breaks(breaks) {\n    var brk = [];\n\n    for (var i = 0; i < breaks.length; i++) {\n      var thisBreak = '' + breaks[i];\n      var nextBreak = '' + (breaks[i + 1] || '16383');\n      brk.push(writextag('brk', null, {\n        id: thisBreak,\n        max: nextBreak,\n        man: '1'\n      }));\n    }\n\n    return writextag('rowBreaks', brk.join(' '), {\n      count: brk.length,\n      manualBreakCount: brk.length\n    });\n  }\n\n  function write_ws_xml_col_breaks(breaks) {\n    var brk = [];\n\n    for (var i = 0; i < breaks.length; i++) {\n      var thisBreak = '' + breaks[i];\n      var nextBreak = '' + (breaks[i + 1] || '1048575');\n      brk.push(writextag('brk', null, {\n        id: thisBreak,\n        max: nextBreak,\n        man: '1'\n      }));\n    }\n\n    return writextag('colBreaks', brk.join(' '), {\n      count: brk.length,\n      manualBreakCount: brk.length\n    });\n  }\n  /* [MS-XLSB] 2.4.718 BrtRowHdr */\n\n\n  function parse_BrtRowHdr(data, length) {\n    var z = [];\n    z.r = data.read_shift(4);\n    data.l += length - 4;\n    return z;\n  }\n  /* [MS-XLSB] 2.4.812 BrtWsDim */\n\n\n  var parse_BrtWsDim = parse_UncheckedRfX;\n  var write_BrtWsDim = write_UncheckedRfX;\n  /* [MS-XLSB] 2.4.815 BrtWsProp */\n\n  function parse_BrtWsProp(data, length) {\n    var z = {};\n    /* TODO: pull flags */\n\n    data.l += 19;\n    z.name = parse_XLSBCodeName(data, length - 19);\n    return z;\n  }\n  /* [MS-XLSB] 2.4.303 BrtCellBlank */\n\n\n  function parse_BrtCellBlank(data, length) {\n    var cell = parse_XLSBCell(data);\n    return [cell];\n  }\n\n  function write_BrtCellBlank(cell, val, o) {\n    if (o == null) o = new_buf(8);\n    return write_XLSBCell(val, o);\n  }\n  /* [MS-XLSB] 2.4.304 BrtCellBool */\n\n\n  function parse_BrtCellBool(data, length) {\n    var cell = parse_XLSBCell(data);\n    var fBool = data.read_shift(1);\n    return [cell, fBool, 'b'];\n  }\n  /* [MS-XLSB] 2.4.305 BrtCellError */\n\n\n  function parse_BrtCellError(data, length) {\n    var cell = parse_XLSBCell(data);\n    var fBool = data.read_shift(1);\n    return [cell, fBool, 'e'];\n  }\n  /* [MS-XLSB] 2.4.308 BrtCellIsst */\n\n\n  function parse_BrtCellIsst(data, length) {\n    var cell = parse_XLSBCell(data);\n    var isst = data.read_shift(4);\n    return [cell, isst, 's'];\n  }\n  /* [MS-XLSB] 2.4.310 BrtCellReal */\n\n\n  function parse_BrtCellReal(data, length) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_Xnum(data);\n    return [cell, value, 'n'];\n  }\n  /* [MS-XLSB] 2.4.311 BrtCellRk */\n\n\n  function parse_BrtCellRk(data, length) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_RkNumber(data);\n    return [cell, value, 'n'];\n  }\n  /* [MS-XLSB] 2.4.314 BrtCellSt */\n\n\n  function parse_BrtCellSt(data, length) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_XLWideString(data);\n    return [cell, value, 'str'];\n  }\n  /* [MS-XLSB] 2.4.647 BrtFmlaBool */\n\n\n  function parse_BrtFmlaBool(data, length, opts) {\n    var cell = parse_XLSBCell(data);\n    var value = data.read_shift(1);\n    var o = [cell, value, 'b'];\n\n    if (opts.cellFormula) {\n      var formula = parse_XLSBCellParsedFormula(data, length - 9);\n      o[3] = \"\";\n      /* TODO */\n    } else data.l += length - 9;\n\n    return o;\n  }\n  /* [MS-XLSB] 2.4.648 BrtFmlaError */\n\n\n  function parse_BrtFmlaError(data, length, opts) {\n    var cell = parse_XLSBCell(data);\n    var value = data.read_shift(1);\n    var o = [cell, value, 'e'];\n\n    if (opts.cellFormula) {\n      var formula = parse_XLSBCellParsedFormula(data, length - 9);\n      o[3] = \"\";\n      /* TODO */\n    } else data.l += length - 9;\n\n    return o;\n  }\n  /* [MS-XLSB] 2.4.649 BrtFmlaNum */\n\n\n  function parse_BrtFmlaNum(data, length, opts) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_Xnum(data);\n    var o = [cell, value, 'n'];\n\n    if (opts.cellFormula) {\n      var formula = parse_XLSBCellParsedFormula(data, length - 16);\n      o[3] = \"\";\n      /* TODO */\n    } else data.l += length - 16;\n\n    return o;\n  }\n  /* [MS-XLSB] 2.4.650 BrtFmlaString */\n\n\n  function parse_BrtFmlaString(data, length, opts) {\n    var start = data.l;\n    var cell = parse_XLSBCell(data);\n    var value = parse_XLWideString(data);\n    var o = [cell, value, 'str'];\n\n    if (opts.cellFormula) {\n      var formula = parse_XLSBCellParsedFormula(data, start + length - data.l);\n    } else data.l = start + length;\n\n    return o;\n  }\n  /* [MS-XLSB] 2.4.676 BrtMergeCell */\n\n\n  var parse_BrtMergeCell = parse_UncheckedRfX;\n  /* [MS-XLSB] 2.4.656 BrtHLink */\n\n  function parse_BrtHLink(data, length, opts) {\n    var end = data.l + length;\n    var rfx = parse_UncheckedRfX(data, 16);\n    var relId = parse_XLNullableWideString(data);\n    var loc = parse_XLWideString(data);\n    var tooltip = parse_XLWideString(data);\n    var display = parse_XLWideString(data);\n    data.l = end;\n    return {\n      rfx: rfx,\n      relId: relId,\n      loc: loc,\n      tooltip: tooltip,\n      display: display\n    };\n  }\n  /* [MS-XLSB] 2.1.7.61 Worksheet */\n\n\n  function parse_ws_bin(data, opts, rels) {\n    if (!data) return data;\n    if (!rels) rels = {\n      '!id': {}\n    };\n    var s = {};\n    var ref;\n    var refguess = {\n      s: {\n        r: 1000000,\n        c: 1000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var pass = false,\n        end = false;\n    var row, p, cf, R, C, addr, sstr, rr;\n    var mergecells = [];\n    recordhopper(data, function ws_parse(val, R) {\n      if (end) return;\n\n      switch (R.n) {\n        case 'BrtWsDim':\n          ref = val;\n          break;\n\n        case 'BrtRowHdr':\n          row = val;\n          if (opts.sheetRows && opts.sheetRows <= row.r) end = true;\n          rr = encode_row(row.r);\n          break;\n\n        case 'BrtFmlaBool':\n        case 'BrtFmlaError':\n        case 'BrtFmlaNum':\n        case 'BrtFmlaString':\n        case 'BrtCellBool':\n        case 'BrtCellError':\n        case 'BrtCellIsst':\n        case 'BrtCellReal':\n        case 'BrtCellRk':\n        case 'BrtCellSt':\n          p = {\n            t: val[2]\n          };\n\n          switch (val[2]) {\n            case 'n':\n              p.v = val[1];\n              break;\n\n            case 's':\n              sstr = strs[val[1]];\n              p.v = sstr.t;\n              p.r = sstr.r;\n              break;\n\n            case 'b':\n              p.v = val[1] ? true : false;\n              break;\n\n            case 'e':\n              p.v = val[1];\n              p.w = BErr[p.v];\n              break;\n\n            case 'str':\n              p.t = 's';\n              p.v = utf8read(val[1]);\n              break;\n          }\n\n          if (opts.cellFormula && val.length > 3) p.f = val[3];\n          if (cf = styles.CellXf[val[0].iStyleRef]) safe_format(p, cf.ifmt, null, opts);\n          s[encode_col(C = val[0].c) + rr] = p;\n          if (refguess.s.r > row.r) refguess.s.r = row.r;\n          if (refguess.s.c > C) refguess.s.c = C;\n          if (refguess.e.r < row.r) refguess.e.r = row.r;\n          if (refguess.e.c < C) refguess.e.c = C;\n          break;\n\n        case 'BrtCellBlank':\n          if (!opts.sheetStubs) break;\n          p = {\n            t: 's',\n            v: undefined\n          };\n          s[encode_col(C = val[0].c) + rr] = p;\n          if (refguess.s.r > row.r) refguess.s.r = row.r;\n          if (refguess.s.c > C) refguess.s.c = C;\n          if (refguess.e.r < row.r) refguess.e.r = row.r;\n          if (refguess.e.c < C) refguess.e.c = C;\n          break;\n\n        /* Merge Cells */\n\n        case 'BrtBeginMergeCells':\n          break;\n\n        case 'BrtEndMergeCells':\n          break;\n\n        case 'BrtMergeCell':\n          mergecells.push(val);\n          break;\n\n        case 'BrtHLink':\n          var rel = rels['!id'][val.relId];\n\n          if (rel) {\n            val.Target = rel.Target;\n            if (val.loc) val.Target += \"#\" + val.loc;\n            val.Rel = rel;\n          }\n\n          for (R = val.rfx.s.r; R <= val.rfx.e.r; ++R) for (C = val.rfx.s.c; C <= val.rfx.e.c; ++C) {\n            addr = encode_cell({\n              c: C,\n              r: R\n            });\n            if (!s[addr]) s[addr] = {\n              t: 's',\n              v: undefined\n            };\n            s[addr].l = val;\n          }\n\n          break;\n\n        case 'BrtArrFmla':\n          break;\n        // TODO\n\n        case 'BrtShrFmla':\n          break;\n        // TODO\n\n        case 'BrtBeginSheet':\n          break;\n\n        case 'BrtWsProp':\n          break;\n        // TODO\n\n        case 'BrtSheetCalcProp':\n          break;\n        // TODO\n\n        case 'BrtBeginWsViews':\n          break;\n        // TODO\n\n        case 'BrtBeginWsView':\n          break;\n        // TODO\n\n        case 'BrtPane':\n          break;\n        // TODO\n\n        case 'BrtSel':\n          break;\n        // TODO\n\n        case 'BrtEndWsView':\n          break;\n        // TODO\n\n        case 'BrtEndWsViews':\n          break;\n        // TODO\n\n        case 'BrtACBegin':\n          break;\n        // TODO\n\n        case 'BrtRwDescent':\n          break;\n        // TODO\n\n        case 'BrtACEnd':\n          break;\n        // TODO\n\n        case 'BrtWsFmtInfoEx14':\n          break;\n        // TODO\n\n        case 'BrtWsFmtInfo':\n          break;\n        // TODO\n\n        case 'BrtBeginColInfos':\n          break;\n        // TODO\n\n        case 'BrtColInfo':\n          break;\n        // TODO\n\n        case 'BrtEndColInfos':\n          break;\n        // TODO\n\n        case 'BrtBeginSheetData':\n          break;\n        // TODO\n\n        case 'BrtEndSheetData':\n          break;\n        // TODO\n\n        case 'BrtSheetProtection':\n          break;\n        // TODO\n\n        case 'BrtPrintOptions':\n          break;\n        // TODO\n\n        case 'BrtMargins':\n          break;\n        // TODO\n\n        case 'BrtPageSetup':\n          break;\n        // TODO\n\n        case 'BrtFRTBegin':\n          pass = true;\n          break;\n\n        case 'BrtFRTEnd':\n          pass = false;\n          break;\n\n        case 'BrtEndSheet':\n          break;\n        // TODO\n\n        case 'BrtDrawing':\n          break;\n        // TODO\n\n        case 'BrtLegacyDrawing':\n          break;\n        // TODO\n\n        case 'BrtLegacyDrawingHF':\n          break;\n        // TODO\n\n        case 'BrtPhoneticInfo':\n          break;\n        // TODO\n\n        case 'BrtBeginHeaderFooter':\n          break;\n        // TODO\n\n        case 'BrtEndHeaderFooter':\n          break;\n        // TODO\n\n        case 'BrtBrk':\n          break;\n        // TODO\n\n        case 'BrtBeginRwBrk':\n          break;\n        // TODO\n\n        case 'BrtEndRwBrk':\n          break;\n        // TODO\n\n        case 'BrtBeginColBrk':\n          break;\n        // TODO\n\n        case 'BrtEndColBrk':\n          break;\n        // TODO\n\n        case 'BrtBeginUserShViews':\n          break;\n        // TODO\n\n        case 'BrtBeginUserShView':\n          break;\n        // TODO\n\n        case 'BrtEndUserShView':\n          break;\n        // TODO\n\n        case 'BrtEndUserShViews':\n          break;\n        // TODO\n\n        case 'BrtBkHim':\n          break;\n        // TODO\n\n        case 'BrtBeginOleObjects':\n          break;\n        // TODO\n\n        case 'BrtOleObject':\n          break;\n        // TODO\n\n        case 'BrtEndOleObjects':\n          break;\n        // TODO\n\n        case 'BrtBeginListParts':\n          break;\n        // TODO\n\n        case 'BrtListPart':\n          break;\n        // TODO\n\n        case 'BrtEndListParts':\n          break;\n        // TODO\n\n        case 'BrtBeginSortState':\n          break;\n        // TODO\n\n        case 'BrtBeginSortCond':\n          break;\n        // TODO\n\n        case 'BrtEndSortCond':\n          break;\n        // TODO\n\n        case 'BrtEndSortState':\n          break;\n        // TODO\n\n        case 'BrtBeginConditionalFormatting':\n          break;\n        // TODO\n\n        case 'BrtEndConditionalFormatting':\n          break;\n        // TODO\n\n        case 'BrtBeginCFRule':\n          break;\n        // TODO\n\n        case 'BrtEndCFRule':\n          break;\n        // TODO\n\n        case 'BrtBeginDVals':\n          break;\n        // TODO\n\n        case 'BrtDVal':\n          break;\n        // TODO\n\n        case 'BrtEndDVals':\n          break;\n        // TODO\n\n        case 'BrtRangeProtection':\n          break;\n        // TODO\n\n        case 'BrtBeginDCon':\n          break;\n        // TODO\n\n        case 'BrtEndDCon':\n          break;\n        // TODO\n\n        case 'BrtBeginDRefs':\n          break;\n\n        case 'BrtDRef':\n          break;\n\n        case 'BrtEndDRefs':\n          break;\n\n        /* ActiveX */\n\n        case 'BrtBeginActiveXControls':\n          break;\n\n        case 'BrtActiveX':\n          break;\n\n        case 'BrtEndActiveXControls':\n          break;\n\n        /* AutoFilter */\n\n        case 'BrtBeginAFilter':\n          break;\n\n        case 'BrtEndAFilter':\n          break;\n\n        case 'BrtBeginFilterColumn':\n          break;\n\n        case 'BrtBeginFilters':\n          break;\n\n        case 'BrtFilter':\n          break;\n\n        case 'BrtEndFilters':\n          break;\n\n        case 'BrtEndFilterColumn':\n          break;\n\n        case 'BrtDynamicFilter':\n          break;\n\n        case 'BrtTop10Filter':\n          break;\n\n        case 'BrtBeginCustomFilters':\n          break;\n\n        case 'BrtCustomFilter':\n          break;\n\n        case 'BrtEndCustomFilters':\n          break;\n\n        /* Smart Tags */\n\n        case 'BrtBeginSmartTags':\n          break;\n\n        case 'BrtBeginCellSmartTags':\n          break;\n\n        case 'BrtBeginCellSmartTag':\n          break;\n\n        case 'BrtCellSmartTagProperty':\n          break;\n\n        case 'BrtEndCellSmartTag':\n          break;\n\n        case 'BrtEndCellSmartTags':\n          break;\n\n        case 'BrtEndSmartTags':\n          break;\n\n        /* Cell Watch */\n\n        case 'BrtBeginCellWatches':\n          break;\n\n        case 'BrtCellWatch':\n          break;\n\n        case 'BrtEndCellWatches':\n          break;\n\n        /* Table */\n\n        case 'BrtTable':\n          break;\n\n        /* Ignore Cell Errors */\n\n        case 'BrtBeginCellIgnoreECs':\n          break;\n\n        case 'BrtCellIgnoreEC':\n          break;\n\n        case 'BrtEndCellIgnoreECs':\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + R.n);\n      }\n    }, opts);\n    if (!s[\"!ref\"] && (refguess.s.r < 1000000 || ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0)) s[\"!ref\"] = encode_range(ref);\n\n    if (opts.sheetRows && s[\"!ref\"]) {\n      var tmpref = safe_decode_range(s[\"!ref\"]);\n\n      if (opts.sheetRows < +tmpref.e.r) {\n        tmpref.e.r = opts.sheetRows - 1;\n        if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n        if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n        if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n        if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n        s[\"!fullref\"] = s[\"!ref\"];\n        s[\"!ref\"] = encode_range(tmpref);\n      }\n    }\n\n    if (mergecells.length > 0) s[\"!merges\"] = mergecells;\n    return s;\n  }\n  /* TODO: something useful -- this is a stub */\n\n\n  function write_ws_bin_cell(ba, cell, R, C, opts) {\n    if (cell.v === undefined) return \"\";\n    var vv = \"\";\n\n    switch (cell.t) {\n      case 'b':\n        vv = cell.v ? \"1\" : \"0\";\n        break;\n\n      case 'n':\n      case 'e':\n        vv = '' + cell.v;\n        break;\n\n      default:\n        vv = cell.v;\n        break;\n    }\n\n    var o = {\n      r: R,\n      c: C\n    };\n    /* TODO: cell style */\n\n    o.s = get_cell_style(opts.cellXfs, cell, opts);\n\n    switch (cell.t) {\n      case 's':\n      case 'str':\n        if (opts.bookSST) {\n          vv = get_sst_id(opts.Strings, cell.v);\n          o.t = \"s\";\n          break;\n        }\n\n        o.t = \"str\";\n        break;\n\n      case 'n':\n        break;\n\n      case 'b':\n        o.t = \"b\";\n        break;\n\n      case 'e':\n        o.t = \"e\";\n        break;\n    }\n\n    write_record(ba, \"BrtCellBlank\", write_BrtCellBlank(cell, o));\n  }\n\n  function write_CELLTABLE(ba, ws, idx, opts, wb) {\n    var range = safe_decode_range(ws['!ref'] || \"A1\"),\n        ref,\n        rr = \"\",\n        cols = [];\n    write_record(ba, 'BrtBeginSheetData');\n\n    for (var R = range.s.r; R <= range.e.r; ++R) {\n      rr = encode_row(R);\n      /* [ACCELLTABLE] */\n\n      /* BrtRowHdr */\n\n      for (var C = range.s.c; C <= range.e.c; ++C) {\n        /* *16384CELL */\n        if (R === range.s.r) cols[C] = encode_col(C);\n        ref = cols[C] + rr;\n        if (!ws[ref]) continue;\n        /* write cell */\n\n        write_ws_bin_cell(ba, ws[ref], R, C, opts);\n      }\n    }\n\n    write_record(ba, 'BrtEndSheetData');\n  }\n\n  function write_ws_bin(idx, opts, wb) {\n    var ba = buf_array();\n    var s = wb.SheetNames[idx],\n        ws = wb.Sheets[s] || {};\n    var r = safe_decode_range(ws['!ref'] || \"A1\");\n    write_record(ba, \"BrtBeginSheet\");\n    /* [BrtWsProp] */\n\n    write_record(ba, \"BrtWsDim\", write_BrtWsDim(r));\n    /* [WSVIEWS2] */\n\n    /* [WSFMTINFO] */\n\n    /* *COLINFOS */\n\n    write_CELLTABLE(ba, ws, idx, opts, wb);\n    /* [BrtSheetCalcProp] */\n\n    /* [[BrtSheetProtectionIso] BrtSheetProtection] */\n\n    /* *([BrtRangeProtectionIso] BrtRangeProtection) */\n\n    /* [SCENMAN] */\n\n    /* [AUTOFILTER] */\n\n    /* [SORTSTATE] */\n\n    /* [DCON] */\n\n    /* [USERSHVIEWS] */\n\n    /* [MERGECELLS] */\n\n    /* [BrtPhoneticInfo] */\n\n    /* *CONDITIONALFORMATTING */\n\n    /* [DVALS] */\n\n    /* *BrtHLink */\n\n    /* [BrtPrintOptions] */\n\n    /* [BrtMargins] */\n\n    /* [BrtPageSetup] */\n\n    /* [HEADERFOOTER] */\n\n    /* [RWBRK] */\n\n    /* [COLBRK] */\n\n    /* *BrtBigName */\n\n    /* [CELLWATCHES] */\n\n    /* [IGNOREECS] */\n\n    /* [SMARTTAGS] */\n\n    /* [BrtDrawing] */\n\n    /* [BrtLegacyDrawing] */\n\n    /* [BrtLegacyDrawingHF] */\n\n    /* [BrtBkHim] */\n\n    /* [OLEOBJECTS] */\n\n    /* [ACTIVEXCONTROLS] */\n\n    /* [WEBPUBITEMS] */\n\n    /* [LISTPARTS] */\n\n    /* FRTWORKSHEET */\n\n    write_record(ba, \"BrtEndSheet\");\n    return ba.end();\n  }\n  /* 18.2.28 (CT_WorkbookProtection) Defaults */\n\n\n  var WBPropsDef = [['allowRefreshQuery', '0'], ['autoCompressPictures', '1'], ['backupFile', '0'], ['checkCompatibility', '0'], ['codeName', ''], ['date1904', '0'], ['dateCompatibility', '1'], //['defaultThemeVersion', '0'],\n  ['filterPrivacy', '0'], ['hidePivotFieldList', '0'], ['promptedSolutions', '0'], ['publishItems', '0'], ['refreshAllConnections', false], ['saveExternalLinkValues', '1'], ['showBorderUnselectedTables', '1'], ['showInkAnnotation', '1'], ['showObjects', 'all'], ['showPivotChartFilter', '0'] //['updateLinks', 'userSet']\n  ];\n  /* 18.2.30 (CT_BookView) Defaults */\n\n  var WBViewDef = [['activeTab', '0'], ['autoFilterDateGrouping', '1'], ['firstSheet', '0'], ['minimized', '0'], ['showHorizontalScroll', '1'], ['showSheetTabs', '1'], ['showVerticalScroll', '1'], ['tabRatio', '600'], ['visibility', 'visible'] //window{Height,Width}, {x,y}Window\n  ];\n  /* 18.2.19 (CT_Sheet) Defaults */\n\n  var SheetDef = [['state', 'visible']];\n  /* 18.2.2  (CT_CalcPr) Defaults */\n\n  var CalcPrDef = [['calcCompleted', 'true'], ['calcMode', 'auto'], ['calcOnSave', 'true'], ['concurrentCalc', 'true'], ['fullCalcOnLoad', 'false'], ['fullPrecision', 'true'], ['iterate', 'false'], ['iterateCount', '100'], ['iterateDelta', '0.001'], ['refMode', 'A1']];\n  /* 18.2.3 (CT_CustomWorkbookView) Defaults */\n\n  var CustomWBViewDef = [['autoUpdate', 'false'], ['changesSavedWin', 'false'], ['includeHiddenRowCol', 'true'], ['includePrintSettings', 'true'], ['maximized', 'false'], ['minimized', 'false'], ['onlySync', 'false'], ['personalView', 'false'], ['showComments', 'commIndicator'], ['showFormulaBar', 'true'], ['showHorizontalScroll', 'true'], ['showObjects', 'all'], ['showSheetTabs', 'true'], ['showStatusbar', 'true'], ['showVerticalScroll', 'true'], ['tabRatio', '600'], ['xWindow', '0'], ['yWindow', '0']];\n\n  function push_defaults_array(target, defaults) {\n    for (var j = 0; j != target.length; ++j) {\n      var w = target[j];\n\n      for (var i = 0; i != defaults.length; ++i) {\n        var z = defaults[i];\n        if (w[z[0]] == null) w[z[0]] = z[1];\n      }\n    }\n  }\n\n  function push_defaults(target, defaults) {\n    for (var i = 0; i != defaults.length; ++i) {\n      var z = defaults[i];\n      if (target[z[0]] == null) target[z[0]] = z[1];\n    }\n  }\n\n  function parse_wb_defaults(wb) {\n    push_defaults(wb.WBProps, WBPropsDef);\n    push_defaults(wb.CalcPr, CalcPrDef);\n    push_defaults_array(wb.WBView, WBViewDef);\n    push_defaults_array(wb.Sheets, SheetDef);\n    _ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904, 'date1904');\n  }\n  /* 18.2 Workbook */\n\n\n  var wbnsregex = /<\\w+:workbook/;\n\n  function parse_wb_xml(data, opts) {\n    var wb = {\n      AppVersion: {},\n      WBProps: {},\n      WBView: [],\n      Sheets: [],\n      CalcPr: {},\n      xmlns: \"\"\n    };\n    var pass = false,\n        xmlns = \"xmlns\";\n    data.match(tagregex).forEach(function xml_wb(x) {\n      var y = parsexmltag(x);\n\n      switch (strip_ns(y[0])) {\n        case '<?xml':\n          break;\n\n        /* 18.2.27 workbook CT_Workbook 1 */\n\n        case '<workbook':\n          if (x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\n          wb.xmlns = y[xmlns];\n          break;\n\n        case '</workbook>':\n          break;\n\n        /* 18.2.13 fileVersion CT_FileVersion ? */\n\n        case '<fileVersion':\n          delete y[0];\n          wb.AppVersion = y;\n          break;\n\n        case '<fileVersion/>':\n          break;\n\n        /* 18.2.12 fileSharing CT_FileSharing ? */\n\n        case '<fileSharing':\n        case '<fileSharing/>':\n          break;\n\n        /* 18.2.28 workbookPr CT_WorkbookPr ? */\n\n        case '<workbookPr':\n          delete y[0];\n          wb.WBProps = y;\n          break;\n\n        case '<workbookPr/>':\n          delete y[0];\n          wb.WBProps = y;\n          break;\n\n        /* 18.2.29 workbookProtection CT_WorkbookProtection ? */\n\n        case '<workbookProtection':\n          break;\n\n        case '<workbookProtection/>':\n          break;\n\n        /* 18.2.1  bookViews CT_BookViews ? */\n\n        case '<bookViews>':\n        case '</bookViews>':\n          break;\n\n        /* 18.2.30   workbookView CT_BookView + */\n\n        case '<workbookView':\n          delete y[0];\n          wb.WBView.push(y);\n          break;\n\n        /* 18.2.20 sheets CT_Sheets 1 */\n\n        case '<sheets>':\n        case '</sheets>':\n          break;\n        // aggregate sheet\n\n        /* 18.2.19   sheet CT_Sheet + */\n\n        case '<sheet':\n          delete y[0];\n          y.name = utf8read(y.name);\n          wb.Sheets.push(y);\n          break;\n\n        /* 18.2.15 functionGroups CT_FunctionGroups ? */\n\n        case '<functionGroups':\n        case '<functionGroups/>':\n          break;\n\n        /* 18.2.14   functionGroup CT_FunctionGroup + */\n\n        case '<functionGroup':\n          break;\n\n        /* 18.2.9  externalReferences CT_ExternalReferences ? */\n\n        case '<externalReferences':\n        case '</externalReferences>':\n        case '<externalReferences>':\n          break;\n\n        /* 18.2.8    externalReference CT_ExternalReference + */\n\n        case '<externalReference':\n          break;\n\n        /* 18.2.6  definedNames CT_DefinedNames ? */\n\n        case '<definedNames/>':\n          break;\n\n        case '<definedNames>':\n        case '<definedNames':\n          pass = true;\n          break;\n\n        case '</definedNames>':\n          pass = false;\n          break;\n\n        /* 18.2.5    definedName CT_DefinedName + */\n\n        case '<definedName':\n        case '<definedName/>':\n        case '</definedName>':\n          break;\n\n        /* 18.2.2  calcPr CT_CalcPr ? */\n\n        case '<calcPr':\n          delete y[0];\n          wb.CalcPr = y;\n          break;\n\n        case '<calcPr/>':\n          delete y[0];\n          wb.CalcPr = y;\n          break;\n\n        /* 18.2.16 oleSize CT_OleSize ? (ref required) */\n\n        case '<oleSize':\n          break;\n\n        /* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\n\n        case '<customWorkbookViews>':\n        case '</customWorkbookViews>':\n        case '<customWorkbookViews':\n          break;\n\n        /* 18.2.3    customWorkbookView CT_CustomWorkbookView + */\n\n        case '<customWorkbookView':\n        case '</customWorkbookView>':\n          break;\n\n        /* 18.2.18 pivotCaches CT_PivotCaches ? */\n\n        case '<pivotCaches>':\n        case '</pivotCaches>':\n        case '<pivotCaches':\n          break;\n\n        /* 18.2.17 pivotCache CT_PivotCache ? */\n\n        case '<pivotCache':\n          break;\n\n        /* 18.2.21 smartTagPr CT_SmartTagPr ? */\n\n        case '<smartTagPr':\n        case '<smartTagPr/>':\n          break;\n\n        /* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\n\n        case '<smartTagTypes':\n        case '<smartTagTypes>':\n        case '</smartTagTypes>':\n          break;\n\n        /* 18.2.22   smartTagType CT_SmartTagType ? */\n\n        case '<smartTagType':\n          break;\n\n        /* 18.2.24 webPublishing CT_WebPublishing ? */\n\n        case '<webPublishing':\n        case '<webPublishing/>':\n          break;\n\n        /* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\n\n        case '<fileRecoveryPr':\n        case '<fileRecoveryPr/>':\n          break;\n\n        /* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\n\n        case '<webPublishObjects>':\n        case '<webPublishObjects':\n        case '</webPublishObjects>':\n          break;\n\n        /* 18.2.25 webPublishObject CT_WebPublishObject ? */\n\n        case '<webPublishObject':\n          break;\n\n        /* 18.2.10 extLst CT_ExtensionList ? */\n\n        case '<extLst>':\n        case '</extLst>':\n        case '<extLst/>':\n          break;\n\n        /* 18.2.7    ext CT_Extension + */\n\n        case '<ext':\n          pass = true;\n          break;\n        //TODO: check with versions of excel\n\n        case '</ext>':\n          pass = false;\n          break;\n\n        /* Others */\n\n        case '<ArchID':\n          break;\n\n        case '<AlternateContent':\n          pass = true;\n          break;\n\n        case '</AlternateContent>':\n          pass = false;\n          break;\n\n        default:\n          if (!pass && opts.WTF) throw 'unrecognized ' + y[0] + ' in workbook';\n      }\n    });\n    if (XMLNS.main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\n    parse_wb_defaults(wb);\n    return wb;\n  }\n\n  var WB_XML_ROOT = writextag('workbook', null, {\n    'xmlns': XMLNS.main[0],\n    //'xmlns:mx': XMLNS.mx,\n    //'xmlns:s': XMLNS.main[0],\n    'xmlns:r': XMLNS.r\n  });\n\n  function safe1904(wb) {\n    /* TODO: store date1904 somewhere else */\n    try {\n      return parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\";\n    } catch (e) {\n      return \"false\";\n    }\n  }\n\n  function write_wb_xml(wb, opts) {\n    var o = [XML_HEADER];\n    o[o.length] = WB_XML_ROOT;\n    o[o.length] = writextag('workbookPr', null, {\n      date1904: safe1904(wb)\n    });\n    o[o.length] = \"<sheets>\";\n\n    for (var i = 0; i != wb.SheetNames.length; ++i) o[o.length] = writextag('sheet', null, {\n      name: wb.SheetNames[i].substr(0, 31),\n      sheetId: \"\" + (i + 1),\n      \"r:id\": \"rId\" + (i + 1)\n    });\n\n    o[o.length] = \"</sheets>\";\n    var hasPrintHeaders = false;\n\n    for (var i = 0; i != wb.SheetNames.length; ++i) {\n      var sheetName = wb.SheetNames[i];\n      var sheet = wb.Sheets[sheetName];\n\n      if (sheet['!printHeader']) {\n        if (sheet['!printHeader'].length !== 2) {\n          throw \"!printHeaders must be an array of length 2: \" + sheet['!printHeader'];\n        }\n\n        hasPrintHeaders = true;\n      }\n    }\n\n    if (hasPrintHeaders) {\n      o[o.length] = '<definedNames>';\n\n      for (var i = 0; i != wb.SheetNames.length; ++i) {\n        var sheetName = wb.SheetNames[i];\n        var sheet = wb.Sheets[sheetName];\n\n        if (sheet['!printHeader'] || sheet['!printColumns']) {\n          var printHeader = sheet['!printHeader'];\n          var printColumns = sheet['!printColumns']; //Sheet1!$A:$C,Sheet1!$1:$1\n\n          var range = \"\";\n          if (printColumns) range += \"'\" + sheetName + \"'!\" + (\"$\" + printColumns[0] + \":$\" + printColumns[1]);\n          if (printColumns && printHeader) range += \",\";\n          if (printHeader) range += \"'\" + sheetName + \"'!\" + (\"$\" + printHeader[0] + \":$\" + printHeader[1]);\n          console.log(\"-----------------------------\");\n          console.log(range);\n          o[o.length] = writextag('definedName', range, {\n            \"name\": \"_xlnm.Print_Titles\",\n            localSheetId: '' + i\n          });\n        }\n      }\n\n      o[o.length] = '</definedNames>';\n    }\n\n    if (o.length > 2) {\n      o[o.length] = '</workbook>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* [MS-XLSB] 2.4.301 BrtBundleSh */\n\n\n  function parse_BrtBundleSh(data, length) {\n    var z = {};\n    z.hsState = data.read_shift(4); //ST_SheetState\n\n    z.iTabID = data.read_shift(4);\n    z.strRelID = parse_RelID(data, length - 8);\n    z.name = parse_XLWideString(data);\n    return z;\n  }\n\n  function write_BrtBundleSh(data, o) {\n    if (!o) o = new_buf(127);\n    o.write_shift(4, data.hsState);\n    o.write_shift(4, data.iTabID);\n    write_RelID(data.strRelID, o);\n    write_XLWideString(data.name.substr(0, 31), o);\n    return o;\n  }\n  /* [MS-XLSB] 2.4.807 BrtWbProp */\n\n\n  function parse_BrtWbProp(data, length) {\n    data.read_shift(4);\n    var dwThemeVersion = data.read_shift(4);\n    var strName = length > 8 ? parse_XLWideString(data) : \"\";\n    return [dwThemeVersion, strName];\n  }\n\n  function write_BrtWbProp(data, o) {\n    if (!o) o = new_buf(8);\n    o.write_shift(4, 0);\n    o.write_shift(4, 0);\n    return o;\n  }\n\n  function parse_BrtFRTArchID$(data, length) {\n    var o = {};\n    data.read_shift(4);\n    o.ArchID = data.read_shift(4);\n    data.l += length - 8;\n    return o;\n  }\n  /* [MS-XLSB] 2.1.7.60 Workbook */\n\n\n  function parse_wb_bin(data, opts) {\n    var wb = {\n      AppVersion: {},\n      WBProps: {},\n      WBView: [],\n      Sheets: [],\n      CalcPr: {},\n      xmlns: \"\"\n    };\n    var pass = false,\n        z;\n    recordhopper(data, function hopper_wb(val, R) {\n      switch (R.n) {\n        case 'BrtBundleSh':\n          wb.Sheets.push(val);\n          break;\n\n        case 'BrtBeginBook':\n          break;\n\n        case 'BrtFileVersion':\n          break;\n\n        case 'BrtWbProp':\n          break;\n\n        case 'BrtACBegin':\n          break;\n\n        case 'BrtAbsPath15':\n          break;\n\n        case 'BrtACEnd':\n          break;\n\n        case 'BrtWbFactoid':\n          break;\n\n        /*case 'BrtBookProtectionIso': break;*/\n\n        case 'BrtBookProtection':\n          break;\n\n        case 'BrtBeginBookViews':\n          break;\n\n        case 'BrtBookView':\n          break;\n\n        case 'BrtEndBookViews':\n          break;\n\n        case 'BrtBeginBundleShs':\n          break;\n\n        case 'BrtEndBundleShs':\n          break;\n\n        case 'BrtBeginFnGroup':\n          break;\n\n        case 'BrtEndFnGroup':\n          break;\n\n        case 'BrtBeginExternals':\n          break;\n\n        case 'BrtSupSelf':\n          break;\n\n        case 'BrtSupBookSrc':\n          break;\n\n        case 'BrtExternSheet':\n          break;\n\n        case 'BrtEndExternals':\n          break;\n\n        case 'BrtName':\n          break;\n\n        case 'BrtCalcProp':\n          break;\n\n        case 'BrtUserBookView':\n          break;\n\n        case 'BrtBeginPivotCacheIDs':\n          break;\n\n        case 'BrtBeginPivotCacheID':\n          break;\n\n        case 'BrtEndPivotCacheID':\n          break;\n\n        case 'BrtEndPivotCacheIDs':\n          break;\n\n        case 'BrtWebOpt':\n          break;\n\n        case 'BrtFileRecover':\n          break;\n\n        case 'BrtFileSharing':\n          break;\n\n        /*case 'BrtBeginWebPubItems': break;\n        case 'BrtBeginWebPubItem': break;\n        case 'BrtEndWebPubItem': break;\n        case 'BrtEndWebPubItems': break;*/\n\n        /* Smart Tags */\n\n        case 'BrtBeginSmartTagTypes':\n          break;\n\n        case 'BrtSmartTagType':\n          break;\n\n        case 'BrtEndSmartTagTypes':\n          break;\n\n        case 'BrtFRTBegin':\n          pass = true;\n          break;\n\n        case 'BrtFRTArchID$':\n          break;\n\n        case 'BrtWorkBookPr15':\n          break;\n\n        case 'BrtFRTEnd':\n          pass = false;\n          break;\n\n        case 'BrtEndBook':\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + R.n);\n      }\n    });\n    parse_wb_defaults(wb);\n    return wb;\n  }\n  /* [MS-XLSB] 2.1.7.60 Workbook */\n\n\n  function write_BUNDLESHS(ba, wb, opts) {\n    write_record(ba, \"BrtBeginBundleShs\");\n\n    for (var idx = 0; idx != wb.SheetNames.length; ++idx) {\n      var d = {\n        hsState: 0,\n        iTabID: idx + 1,\n        strRelID: 'rId' + (idx + 1),\n        name: wb.SheetNames[idx]\n      };\n      write_record(ba, \"BrtBundleSh\", write_BrtBundleSh(d));\n    }\n\n    write_record(ba, \"BrtEndBundleShs\");\n  }\n  /* [MS-XLSB] 2.4.643 BrtFileVersion */\n\n\n  function write_BrtFileVersion(data, o) {\n    if (!o) o = new_buf(127);\n\n    for (var i = 0; i != 4; ++i) o.write_shift(4, 0);\n\n    write_XLWideString(\"SheetJS\", o);\n    write_XLWideString(XLSX.version, o);\n    write_XLWideString(XLSX.version, o);\n    write_XLWideString(\"7262\", o);\n    o.length = o.l;\n    return o;\n  }\n  /* [MS-XLSB] 2.1.7.60 Workbook */\n\n\n  function write_BOOKVIEWS(ba, wb, opts) {\n    write_record(ba, \"BrtBeginBookViews\");\n    /* 1*(BrtBookView *FRT) */\n\n    write_record(ba, \"BrtEndBookViews\");\n  }\n  /* [MS-XLSB] 2.4.302 BrtCalcProp */\n\n\n  function write_BrtCalcProp(data, o) {\n    if (!o) o = new_buf(26);\n    o.write_shift(4, 0);\n    /* force recalc */\n\n    o.write_shift(4, 1);\n    o.write_shift(4, 0);\n    write_Xnum(0, o);\n    o.write_shift(-4, 1023);\n    o.write_shift(1, 0x33);\n    o.write_shift(1, 0x00);\n    return o;\n  }\n\n  function write_BrtFileRecover(data, o) {\n    if (!o) o = new_buf(1);\n    o.write_shift(1, 0);\n    return o;\n  }\n  /* [MS-XLSB] 2.1.7.60 Workbook */\n\n\n  function write_wb_bin(wb, opts) {\n    var ba = buf_array();\n    write_record(ba, \"BrtBeginBook\");\n    write_record(ba, \"BrtFileVersion\", write_BrtFileVersion());\n    /* [[BrtFileSharingIso] BrtFileSharing] */\n\n    write_record(ba, \"BrtWbProp\", write_BrtWbProp());\n    /* [ACABSPATH] */\n\n    /* [[BrtBookProtectionIso] BrtBookProtection] */\n\n    write_BOOKVIEWS(ba, wb, opts);\n    write_BUNDLESHS(ba, wb, opts);\n    /* [FNGROUP] */\n\n    /* [EXTERNALS] */\n\n    /* *BrtName */\n\n    write_record(ba, \"BrtCalcProp\", write_BrtCalcProp());\n    /* [BrtOleSize] */\n\n    /* *(BrtUserBookView *FRT) */\n\n    /* [PIVOTCACHEIDS] */\n\n    /* [BrtWbFactoid] */\n\n    /* [SMARTTAGTYPES] */\n\n    /* [BrtWebOpt] */\n\n    write_record(ba, \"BrtFileRecover\", write_BrtFileRecover());\n    /* [WEBPUBITEMS] */\n\n    /* [CRERRS] */\n\n    /* FRTWORKBOOK */\n\n    write_record(ba, \"BrtEndBook\");\n    return ba.end();\n  }\n\n  function parse_wb(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? parse_wb_bin : parse_wb_xml)(data, opts);\n  }\n\n  function parse_ws(data, name, opts, rels) {\n    return (name.substr(-4) === \".bin\" ? parse_ws_bin : parse_ws_xml)(data, opts, rels);\n  }\n\n  function parse_sty(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? parse_sty_bin : parse_sty_xml)(data, opts);\n  }\n\n  function parse_theme(data, name, opts) {\n    return parse_theme_xml(data, opts);\n  }\n\n  function parse_sst(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? parse_sst_bin : parse_sst_xml)(data, opts);\n  }\n\n  function parse_cmnt(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? parse_comments_bin : parse_comments_xml)(data, opts);\n  }\n\n  function parse_cc(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? parse_cc_bin : parse_cc_xml)(data, opts);\n  }\n\n  function write_wb(wb, name, opts) {\n    return (name.substr(-4) === \".bin\" ? write_wb_bin : write_wb_xml)(wb, opts);\n  }\n\n  function write_ws(data, name, opts, wb) {\n    return (name.substr(-4) === \".bin\" ? write_ws_bin : write_ws_xml)(data, opts, wb);\n  }\n\n  function write_sty(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? write_sty_bin : write_sty_xml)(data, opts);\n  }\n\n  function write_sst(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? write_sst_bin : write_sst_xml)(data, opts);\n  }\n  /*\n  function write_cmnt(data, name, opts) {\n  \treturn (name.substr(-4)===\".bin\" ? write_comments_bin : write_comments_xml)(data, opts);\n  }\n  \n  function write_cc(data, name, opts) {\n  \treturn (name.substr(-4)===\".bin\" ? write_cc_bin : write_cc_xml)(data, opts);\n  }\n  */\n\n\n  var attregexg2 = /([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\n  var attregex2 = /([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\n\n  var _chr = function (c) {\n    return String.fromCharCode(c);\n  };\n\n  function xlml_parsexmltag(tag, skip_root) {\n    var words = tag.split(/\\s+/);\n    var z = [];\n    if (!skip_root) z[0] = words[0];\n    if (words.length === 1) return z;\n    var m = tag.match(attregexg2),\n        y,\n        j,\n        w,\n        i;\n    if (m) for (i = 0; i != m.length; ++i) {\n      y = m[i].match(attregex2);\n      if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1, y[2].length - 2);else {\n        if (y[1].substr(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].substr(6);else w = y[1].substr(j + 1);\n        z[w] = y[2].substr(1, y[2].length - 2);\n      }\n    }\n    return z;\n  }\n\n  function xlml_parsexmltagobj(tag) {\n    var words = tag.split(/\\s+/);\n    var z = {};\n    if (words.length === 1) return z;\n    var m = tag.match(attregexg2),\n        y,\n        j,\n        w,\n        i;\n    if (m) for (i = 0; i != m.length; ++i) {\n      y = m[i].match(attregex2);\n      if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1, y[2].length - 2);else {\n        if (y[1].substr(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].substr(6);else w = y[1].substr(j + 1);\n        z[w] = y[2].substr(1, y[2].length - 2);\n      }\n    }\n    return z;\n  } // ----\n\n\n  function xlml_format(format, value) {\n    var fmt = XLMLFormatMap[format] || unescapexml(format);\n    if (fmt === \"General\") return SSF._general(value);\n    return SSF.format(fmt, value);\n  }\n\n  function xlml_set_custprop(Custprops, Rn, cp, val) {\n    switch ((cp[0].match(/dt:dt=\"([\\w.]+)\"/) || [\"\", \"\"])[1]) {\n      case \"boolean\":\n        val = parsexmlbool(val);\n        break;\n\n      case \"i2\":\n      case \"int\":\n        val = parseInt(val, 10);\n        break;\n\n      case \"r4\":\n      case \"float\":\n        val = parseFloat(val);\n        break;\n\n      case \"date\":\n      case \"dateTime.tz\":\n        val = new Date(val);\n        break;\n\n      case \"i8\":\n      case \"string\":\n      case \"fixed\":\n      case \"uuid\":\n      case \"bin.base64\":\n        break;\n\n      default:\n        throw \"bad custprop:\" + cp[0];\n    }\n\n    Custprops[unescapexml(Rn[3])] = val;\n  }\n\n  function safe_format_xlml(cell, nf, o) {\n    try {\n      if (cell.t === 'e') {\n        cell.w = cell.w || BErr[cell.v];\n      } else if (nf === \"General\") {\n        if (cell.t === 'n') {\n          if ((cell.v | 0) === cell.v) cell.w = SSF._general_int(cell.v);else cell.w = SSF._general_num(cell.v);\n        } else cell.w = SSF._general(cell.v);\n      } else cell.w = xlml_format(nf || \"General\", cell.v);\n\n      if (o.cellNF) cell.z = XLMLFormatMap[nf] || nf || \"General\";\n    } catch (e) {\n      if (o.WTF) throw e;\n    }\n  }\n\n  function process_style_xlml(styles, stag, opts) {\n    if (opts.cellStyles) {\n      if (stag.Interior) {\n        var I = stag.Interior;\n        if (I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\n      }\n    }\n\n    styles[stag.ID] = stag;\n  }\n  /* TODO: there must exist some form of OSP-blessed spec */\n\n\n  function parse_xlml_data(xml, ss, data, cell, base, styles, csty, row, o) {\n    var nf = \"General\",\n        sid = cell.StyleID,\n        S = {};\n    o = o || {};\n    var interiors = [];\n    if (sid === undefined && row) sid = row.StyleID;\n    if (sid === undefined && csty) sid = csty.StyleID;\n\n    while (styles[sid] !== undefined) {\n      if (styles[sid].nf) nf = styles[sid].nf;\n      if (styles[sid].Interior) interiors.push(styles[sid].Interior);\n      if (!styles[sid].Parent) break;\n      sid = styles[sid].Parent;\n    }\n\n    switch (data.Type) {\n      case 'Boolean':\n        cell.t = 'b';\n        cell.v = parsexmlbool(xml);\n        break;\n\n      case 'String':\n        cell.t = 's';\n        cell.r = xlml_fixstr(unescapexml(xml));\n        cell.v = xml.indexOf(\"<\") > -1 ? ss : cell.r;\n        break;\n\n      case 'DateTime':\n        cell.v = (Date.parse(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n        if (cell.v !== cell.v) cell.v = unescapexml(xml);else if (cell.v >= 1 && cell.v < 60) cell.v = cell.v - 1;\n        if (!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n\n      /* falls through */\n\n      case 'Number':\n        if (cell.v === undefined) cell.v = +xml;\n        if (!cell.t) cell.t = 'n';\n        break;\n\n      case 'Error':\n        cell.t = 'e';\n        cell.v = RBErr[xml];\n        cell.w = xml;\n        break;\n\n      default:\n        cell.t = 's';\n        cell.v = xlml_fixstr(ss);\n        break;\n    }\n\n    safe_format_xlml(cell, nf, o);\n\n    if (o.cellFormula != null && cell.Formula) {\n      cell.f = rc_to_a1(unescapexml(cell.Formula), base);\n      cell.Formula = undefined;\n    }\n\n    if (o.cellStyles) {\n      interiors.forEach(function (x) {\n        if (!S.patternType && x.patternType) S.patternType = x.patternType;\n      });\n      cell.s = S;\n    }\n\n    cell.ixfe = cell.StyleID !== undefined ? cell.StyleID : 'Default';\n  }\n\n  function xlml_clean_comment(comment) {\n    comment.t = comment.v;\n    comment.v = comment.w = comment.ixfe = undefined;\n  }\n\n  function xlml_normalize(d) {\n    if (has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\n    if (typeof d === 'string') return d;\n    throw \"badf\";\n  }\n  /* TODO: Everything */\n\n\n  var xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\n\n  function parse_xlml_xml(d, opts) {\n    var str = xlml_normalize(d);\n    var Rn;\n    var state = [],\n        tmp;\n    var sheets = {},\n        sheetnames = [],\n        cursheet = {},\n        sheetname = \"\";\n    var table = {},\n        cell = {},\n        row = {},\n        dtag,\n        didx;\n    var c = 0,\n        r = 0;\n    var refguess = {\n      s: {\n        r: 1000000,\n        c: 1000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var styles = {},\n        stag = {};\n    var ss = \"\",\n        fidx = 0;\n    var mergecells = [];\n    var Props = {},\n        Custprops = {},\n        pidx = 0,\n        cp = {};\n    var comments = [],\n        comment = {};\n    var cstys = [],\n        csty;\n    xlmlregex.lastIndex = 0;\n\n    while (Rn = xlmlregex.exec(str)) switch (Rn[3]) {\n      case 'Data':\n        if (state[state.length - 1][1]) break;\n        if (Rn[1] === '/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length - 1][0] == \"Comment\" ? comment : cell, {\n          c: c,\n          r: r\n        }, styles, cstys[c], row, opts);else {\n          ss = \"\";\n          dtag = xlml_parsexmltag(Rn[0]);\n          didx = Rn.index + Rn[0].length;\n        }\n        break;\n\n      case 'Cell':\n        if (Rn[1] === '/') {\n          if (comments.length > 0) cell.c = comments;\n          if ((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) cursheet[encode_col(c) + encode_row(r)] = cell;\n\n          if (cell.HRef) {\n            cell.l = {\n              Target: cell.HRef,\n              tooltip: cell.HRefScreenTip\n            };\n            cell.HRef = cell.HRefScreenTip = undefined;\n          }\n\n          if (cell.MergeAcross || cell.MergeDown) {\n            var cc = c + (parseInt(cell.MergeAcross, 10) | 0);\n            var rr = r + (parseInt(cell.MergeDown, 10) | 0);\n            mergecells.push({\n              s: {\n                c: c,\n                r: r\n              },\n              e: {\n                c: cc,\n                r: rr\n              }\n            });\n          }\n\n          ++c;\n          if (cell.MergeAcross) c += +cell.MergeAcross;\n        } else {\n          cell = xlml_parsexmltagobj(Rn[0]);\n          if (cell.Index) c = +cell.Index - 1;\n          if (c < refguess.s.c) refguess.s.c = c;\n          if (c > refguess.e.c) refguess.e.c = c;\n          if (Rn[0].substr(-2) === \"/>\") ++c;\n          comments = [];\n        }\n\n        break;\n\n      case 'Row':\n        if (Rn[1] === '/' || Rn[0].substr(-2) === \"/>\") {\n          if (r < refguess.s.r) refguess.s.r = r;\n          if (r > refguess.e.r) refguess.e.r = r;\n\n          if (Rn[0].substr(-2) === \"/>\") {\n            row = xlml_parsexmltag(Rn[0]);\n            if (row.Index) r = +row.Index - 1;\n          }\n\n          c = 0;\n          ++r;\n        } else {\n          row = xlml_parsexmltag(Rn[0]);\n          if (row.Index) r = +row.Index - 1;\n        }\n\n        break;\n\n      case 'Worksheet':\n        /* TODO: read range from FullRows/FullColumns */\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          sheetnames.push(sheetname);\n          if (refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) cursheet[\"!ref\"] = encode_range(refguess);\n          if (mergecells.length) cursheet[\"!merges\"] = mergecells;\n          sheets[sheetname] = cursheet;\n        } else {\n          refguess = {\n            s: {\n              r: 1000000,\n              c: 1000000\n            },\n            e: {\n              r: 0,\n              c: 0\n            }\n          };\n          r = c = 0;\n          state.push([Rn[3], false]);\n          tmp = xlml_parsexmltag(Rn[0]);\n          sheetname = tmp.Name;\n          cursheet = {};\n          mergecells = [];\n        }\n\n        break;\n\n      case 'Table':\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else if (Rn[0].slice(-2) == \"/>\") break;else {\n          table = xlml_parsexmltag(Rn[0]);\n          state.push([Rn[3], false]);\n          cstys = [];\n        }\n\n        break;\n\n      case 'Style':\n        if (Rn[1] === '/') process_style_xlml(styles, stag, opts);else stag = xlml_parsexmltag(Rn[0]);\n        break;\n\n      case 'NumberFormat':\n        stag.nf = xlml_parsexmltag(Rn[0]).Format || \"General\";\n        break;\n\n      case 'Column':\n        if (state[state.length - 1][0] !== 'Table') break;\n        csty = xlml_parsexmltag(Rn[0]);\n        cstys[csty.Index - 1 || cstys.length] = csty;\n\n        for (var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = csty;\n\n        break;\n\n      case 'NamedRange':\n        break;\n\n      case 'NamedCell':\n        break;\n\n      case 'B':\n        break;\n\n      case 'I':\n        break;\n\n      case 'U':\n        break;\n\n      case 'S':\n        break;\n\n      case 'Sub':\n        break;\n\n      case 'Sup':\n        break;\n\n      case 'Span':\n        break;\n\n      case 'Border':\n        break;\n\n      case 'Alignment':\n        break;\n\n      case 'Borders':\n        break;\n\n      case 'Font':\n        if (Rn[0].substr(-2) === \"/>\") break;else if (Rn[1] === \"/\") ss += str.slice(fidx, Rn.index);else fidx = Rn.index + Rn[0].length;\n        break;\n\n      case 'Interior':\n        if (!opts.cellStyles) break;\n        stag.Interior = xlml_parsexmltag(Rn[0]);\n        break;\n\n      case 'Protection':\n        break;\n\n      case 'Author':\n      case 'Title':\n      case 'Description':\n      case 'Created':\n      case 'Keywords':\n      case 'Subject':\n      case 'Category':\n      case 'Company':\n      case 'LastAuthor':\n      case 'LastSaved':\n      case 'LastPrinted':\n      case 'Version':\n      case 'Revision':\n      case 'TotalTime':\n      case 'HyperlinkBase':\n      case 'Manager':\n        if (Rn[0].substr(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_prop(Props, Rn[3], str.slice(pidx, Rn.index));else pidx = Rn.index + Rn[0].length;\n        break;\n\n      case 'Paragraphs':\n        break;\n\n      case 'Styles':\n      case 'Workbook':\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else state.push([Rn[3], false]);\n\n        break;\n\n      case 'Comment':\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          xlml_clean_comment(comment);\n          comments.push(comment);\n        } else {\n          state.push([Rn[3], false]);\n          tmp = xlml_parsexmltag(Rn[0]);\n          comment = {\n            a: tmp.Author\n          };\n        }\n\n        break;\n\n      case 'Name':\n        break;\n\n      case 'ComponentOptions':\n      case 'DocumentProperties':\n      case 'CustomDocumentProperties':\n      case 'OfficeDocumentSettings':\n      case 'PivotTable':\n      case 'PivotCache':\n      case 'Names':\n      case 'MapInfo':\n      case 'PageBreaks':\n      case 'QueryTable':\n      case 'DataValidation':\n      case 'AutoFilter':\n      case 'Sorting':\n      case 'Schema':\n      case 'data':\n      case 'ConditionalFormatting':\n      case 'SmartTagType':\n      case 'SmartTags':\n      case 'ExcelWorkbook':\n      case 'WorkbookOptions':\n      case 'WorksheetOptions':\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n\n        break;\n\n      default:\n        var seen = true;\n\n        switch (state[state.length - 1][0]) {\n          /* OfficeDocumentSettings */\n          case 'OfficeDocumentSettings':\n            switch (Rn[3]) {\n              case 'AllowPNG':\n                break;\n\n              case 'RemovePersonalInformation':\n                break;\n\n              case 'DownloadComponents':\n                break;\n\n              case 'LocationOfComponents':\n                break;\n\n              case 'Colors':\n                break;\n\n              case 'Color':\n                break;\n\n              case 'Index':\n                break;\n\n              case 'RGB':\n                break;\n\n              case 'PixelsPerInch':\n                break;\n\n              case 'TargetScreenSize':\n                break;\n\n              case 'ReadOnlyRecommended':\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* ComponentOptions */\n\n          case 'ComponentOptions':\n            switch (Rn[3]) {\n              case 'Toolbar':\n                break;\n\n              case 'HideOfficeLogo':\n                break;\n\n              case 'SpreadsheetAutoFit':\n                break;\n\n              case 'Label':\n                break;\n\n              case 'Caption':\n                break;\n\n              case 'MaxHeight':\n                break;\n\n              case 'MaxWidth':\n                break;\n\n              case 'NextSheetNumber':\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* ExcelWorkbook */\n\n          case 'ExcelWorkbook':\n            switch (Rn[3]) {\n              case 'WindowHeight':\n                break;\n\n              case 'WindowWidth':\n                break;\n\n              case 'WindowTopX':\n                break;\n\n              case 'WindowTopY':\n                break;\n\n              case 'TabRatio':\n                break;\n\n              case 'ProtectStructure':\n                break;\n\n              case 'ProtectWindows':\n                break;\n\n              case 'ActiveSheet':\n                break;\n\n              case 'DisplayInkNotes':\n                break;\n\n              case 'FirstVisibleSheet':\n                break;\n\n              case 'SupBook':\n                break;\n\n              case 'SheetName':\n                break;\n\n              case 'SheetIndex':\n                break;\n\n              case 'SheetIndexFirst':\n                break;\n\n              case 'SheetIndexLast':\n                break;\n\n              case 'Dll':\n                break;\n\n              case 'AcceptLabelsInFormulas':\n                break;\n\n              case 'DoNotSaveLinkValues':\n                break;\n\n              case 'Date1904':\n                break;\n\n              case 'Iteration':\n                break;\n\n              case 'MaxIterations':\n                break;\n\n              case 'MaxChange':\n                break;\n\n              case 'Path':\n                break;\n\n              case 'Xct':\n                break;\n\n              case 'Count':\n                break;\n\n              case 'SelectedSheets':\n                break;\n\n              case 'Calculation':\n                break;\n\n              case 'Uncalced':\n                break;\n\n              case 'StartupPrompt':\n                break;\n\n              case 'Crn':\n                break;\n\n              case 'ExternName':\n                break;\n\n              case 'Formula':\n                break;\n\n              case 'ColFirst':\n                break;\n\n              case 'ColLast':\n                break;\n\n              case 'WantAdvise':\n                break;\n\n              case 'Boolean':\n                break;\n\n              case 'Error':\n                break;\n\n              case 'Text':\n                break;\n\n              case 'OLE':\n                break;\n\n              case 'NoAutoRecover':\n                break;\n\n              case 'PublishObjects':\n                break;\n\n              case 'DoNotCalculateBeforeSave':\n                break;\n\n              case 'Number':\n                break;\n\n              case 'RefModeR1C1':\n                break;\n\n              case 'EmbedSaveSmartTags':\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* WorkbookOptions */\n\n          case 'WorkbookOptions':\n            switch (Rn[3]) {\n              case 'OWCVersion':\n                break;\n\n              case 'Height':\n                break;\n\n              case 'Width':\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* WorksheetOptions */\n\n          case 'WorksheetOptions':\n            switch (Rn[3]) {\n              case 'Unsynced':\n                break;\n\n              case 'Visible':\n                break;\n\n              case 'Print':\n                break;\n\n              case 'Panes':\n                break;\n\n              case 'Scale':\n                break;\n\n              case 'Pane':\n                break;\n\n              case 'Number':\n                break;\n\n              case 'Layout':\n                break;\n\n              case 'Header':\n                break;\n\n              case 'Footer':\n                break;\n\n              case 'PageSetup':\n                break;\n\n              case 'PageMargins':\n                break;\n\n              case 'Selected':\n                break;\n\n              case 'ProtectObjects':\n                break;\n\n              case 'EnableSelection':\n                break;\n\n              case 'ProtectScenarios':\n                break;\n\n              case 'ValidPrinterInfo':\n                break;\n\n              case 'HorizontalResolution':\n                break;\n\n              case 'VerticalResolution':\n                break;\n\n              case 'NumberofCopies':\n                break;\n\n              case 'ActiveRow':\n                break;\n\n              case 'ActiveCol':\n                break;\n\n              case 'ActivePane':\n                break;\n\n              case 'TopRowVisible':\n                break;\n\n              case 'TopRowBottomPane':\n                break;\n\n              case 'LeftColumnVisible':\n                break;\n\n              case 'LeftColumnRightPane':\n                break;\n\n              case 'FitToPage':\n                break;\n\n              case 'RangeSelection':\n                break;\n\n              case 'PaperSizeIndex':\n                break;\n\n              case 'PageLayoutZoom':\n                break;\n\n              case 'PageBreakZoom':\n                break;\n\n              case 'FilterOn':\n                break;\n\n              case 'DoNotDisplayGridlines':\n                break;\n\n              case 'SplitHorizontal':\n                break;\n\n              case 'SplitVertical':\n                break;\n\n              case 'FreezePanes':\n                break;\n\n              case 'FrozenNoSplit':\n                break;\n\n              case 'FitWidth':\n                break;\n\n              case 'FitHeight':\n                break;\n\n              case 'CommentsLayout':\n                break;\n\n              case 'Zoom':\n                break;\n\n              case 'LeftToRight':\n                break;\n\n              case 'Gridlines':\n                break;\n\n              case 'AllowSort':\n                break;\n\n              case 'AllowFilter':\n                break;\n\n              case 'AllowInsertRows':\n                break;\n\n              case 'AllowDeleteRows':\n                break;\n\n              case 'AllowInsertCols':\n                break;\n\n              case 'AllowDeleteCols':\n                break;\n\n              case 'AllowInsertHyperlinks':\n                break;\n\n              case 'AllowFormatCells':\n                break;\n\n              case 'AllowSizeCols':\n                break;\n\n              case 'AllowSizeRows':\n                break;\n\n              case 'NoSummaryRowsBelowDetail':\n                break;\n\n              case 'TabColorIndex':\n                break;\n\n              case 'DoNotDisplayHeadings':\n                break;\n\n              case 'ShowPageLayoutZoom':\n                break;\n\n              case 'NoSummaryColumnsRightDetail':\n                break;\n\n              case 'BlackAndWhite':\n                break;\n\n              case 'DoNotDisplayZeros':\n                break;\n\n              case 'DisplayPageBreak':\n                break;\n\n              case 'RowColHeadings':\n                break;\n\n              case 'DoNotDisplayOutline':\n                break;\n\n              case 'NoOrientation':\n                break;\n\n              case 'AllowUsePivotTables':\n                break;\n\n              case 'ZeroHeight':\n                break;\n\n              case 'ViewableRange':\n                break;\n\n              case 'Selection':\n                break;\n\n              case 'ProtectContents':\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* PivotTable */\n\n          case 'PivotTable':\n          case 'PivotCache':\n            switch (Rn[3]) {\n              case 'ImmediateItemsOnDrop':\n                break;\n\n              case 'ShowPageMultipleItemLabel':\n                break;\n\n              case 'CompactRowIndent':\n                break;\n\n              case 'Location':\n                break;\n\n              case 'PivotField':\n                break;\n\n              case 'Orientation':\n                break;\n\n              case 'LayoutForm':\n                break;\n\n              case 'LayoutSubtotalLocation':\n                break;\n\n              case 'LayoutCompactRow':\n                break;\n\n              case 'Position':\n                break;\n\n              case 'PivotItem':\n                break;\n\n              case 'DataType':\n                break;\n\n              case 'DataField':\n                break;\n\n              case 'SourceName':\n                break;\n\n              case 'ParentField':\n                break;\n\n              case 'PTLineItems':\n                break;\n\n              case 'PTLineItem':\n                break;\n\n              case 'CountOfSameItems':\n                break;\n\n              case 'Item':\n                break;\n\n              case 'ItemType':\n                break;\n\n              case 'PTSource':\n                break;\n\n              case 'CacheIndex':\n                break;\n\n              case 'ConsolidationReference':\n                break;\n\n              case 'FileName':\n                break;\n\n              case 'Reference':\n                break;\n\n              case 'NoColumnGrand':\n                break;\n\n              case 'NoRowGrand':\n                break;\n\n              case 'BlankLineAfterItems':\n                break;\n\n              case 'Hidden':\n                break;\n\n              case 'Subtotal':\n                break;\n\n              case 'BaseField':\n                break;\n\n              case 'MapChildItems':\n                break;\n\n              case 'Function':\n                break;\n\n              case 'RefreshOnFileOpen':\n                break;\n\n              case 'PrintSetTitles':\n                break;\n\n              case 'MergeLabels':\n                break;\n\n              case 'DefaultVersion':\n                break;\n\n              case 'RefreshName':\n                break;\n\n              case 'RefreshDate':\n                break;\n\n              case 'RefreshDateCopy':\n                break;\n\n              case 'VersionLastRefresh':\n                break;\n\n              case 'VersionLastUpdate':\n                break;\n\n              case 'VersionUpdateableMin':\n                break;\n\n              case 'VersionRefreshableMin':\n                break;\n\n              case 'Calculation':\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* PageBreaks */\n\n          case 'PageBreaks':\n            switch (Rn[3]) {\n              case 'ColBreaks':\n                break;\n\n              case 'ColBreak':\n                break;\n\n              case 'RowBreaks':\n                break;\n\n              case 'RowBreak':\n                break;\n\n              case 'ColStart':\n                break;\n\n              case 'ColEnd':\n                break;\n\n              case 'RowEnd':\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* AutoFilter */\n\n          case 'AutoFilter':\n            switch (Rn[3]) {\n              case 'AutoFilterColumn':\n                break;\n\n              case 'AutoFilterCondition':\n                break;\n\n              case 'AutoFilterAnd':\n                break;\n\n              case 'AutoFilterOr':\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* QueryTable */\n\n          case 'QueryTable':\n            switch (Rn[3]) {\n              case 'Id':\n                break;\n\n              case 'AutoFormatFont':\n                break;\n\n              case 'AutoFormatPattern':\n                break;\n\n              case 'QuerySource':\n                break;\n\n              case 'QueryType':\n                break;\n\n              case 'EnableRedirections':\n                break;\n\n              case 'RefreshedInXl9':\n                break;\n\n              case 'URLString':\n                break;\n\n              case 'HTMLTables':\n                break;\n\n              case 'Connection':\n                break;\n\n              case 'CommandText':\n                break;\n\n              case 'RefreshInfo':\n                break;\n\n              case 'NoTitles':\n                break;\n\n              case 'NextId':\n                break;\n\n              case 'ColumnInfo':\n                break;\n\n              case 'OverwriteCells':\n                break;\n\n              case 'DoNotPromptForFile':\n                break;\n\n              case 'TextWizardSettings':\n                break;\n\n              case 'Source':\n                break;\n\n              case 'Number':\n                break;\n\n              case 'Decimal':\n                break;\n\n              case 'ThousandSeparator':\n                break;\n\n              case 'TrailingMinusNumbers':\n                break;\n\n              case 'FormatSettings':\n                break;\n\n              case 'FieldType':\n                break;\n\n              case 'Delimiters':\n                break;\n\n              case 'Tab':\n                break;\n\n              case 'Comma':\n                break;\n\n              case 'AutoFormatName':\n                break;\n\n              case 'VersionLastEdit':\n                break;\n\n              case 'VersionLastRefresh':\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* Sorting */\n\n          case 'Sorting':\n          /* ConditionalFormatting */\n\n          case 'ConditionalFormatting':\n          /* DataValidation */\n\n          case 'DataValidation':\n            switch (Rn[3]) {\n              case 'Range':\n                break;\n\n              case 'Type':\n                break;\n\n              case 'Min':\n                break;\n\n              case 'Max':\n                break;\n\n              case 'Sort':\n                break;\n\n              case 'Descending':\n                break;\n\n              case 'Order':\n                break;\n\n              case 'CaseSensitive':\n                break;\n\n              case 'Value':\n                break;\n\n              case 'ErrorStyle':\n                break;\n\n              case 'ErrorMessage':\n                break;\n\n              case 'ErrorTitle':\n                break;\n\n              case 'CellRangeList':\n                break;\n\n              case 'InputMessage':\n                break;\n\n              case 'InputTitle':\n                break;\n\n              case 'ComboHide':\n                break;\n\n              case 'InputHide':\n                break;\n\n              case 'Condition':\n                break;\n\n              case 'Qualifier':\n                break;\n\n              case 'UseBlank':\n                break;\n\n              case 'Value1':\n                break;\n\n              case 'Value2':\n                break;\n\n              case 'Format':\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* MapInfo (schema) */\n\n          case 'MapInfo':\n          case 'Schema':\n          case 'data':\n            switch (Rn[3]) {\n              case 'Map':\n                break;\n\n              case 'Entry':\n                break;\n\n              case 'Range':\n                break;\n\n              case 'XPath':\n                break;\n\n              case 'Field':\n                break;\n\n              case 'XSDType':\n                break;\n\n              case 'FilterOn':\n                break;\n\n              case 'Aggregate':\n                break;\n\n              case 'ElementType':\n                break;\n\n              case 'AttributeType':\n                break;\n\n              /* These are from xsd (XML Schema Definition) */\n\n              case 'schema':\n              case 'element':\n              case 'complexType':\n              case 'datatype':\n              case 'all':\n              case 'attribute':\n              case 'extends':\n                break;\n\n              case 'row':\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* SmartTags (can be anything) */\n\n          case 'SmartTags':\n            break;\n\n          default:\n            seen = false;\n            break;\n        }\n\n        if (seen) break;\n        /* CustomDocumentProperties */\n\n        if (!state[state.length - 1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\n        if (state[state.length - 1][0] === 'CustomDocumentProperties') {\n          if (Rn[0].substr(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_custprop(Custprops, Rn, cp, str.slice(pidx, Rn.index));else {\n            cp = Rn;\n            pidx = Rn.index + Rn[0].length;\n          }\n          break;\n        }\n\n        if (opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n    }\n\n    var out = {};\n    if (!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n    out.SheetNames = sheetnames;\n    out.SSF = SSF.get_table();\n    out.Props = Props;\n    out.Custprops = Custprops;\n    return out;\n  }\n\n  function parse_xlml(data, opts) {\n    fix_read_opts(opts = opts || {});\n\n    switch (opts.type || \"base64\") {\n      case \"base64\":\n        return parse_xlml_xml(Base64.decode(data), opts);\n\n      case \"binary\":\n      case \"buffer\":\n      case \"file\":\n        return parse_xlml_xml(data, opts);\n\n      case \"array\":\n        return parse_xlml_xml(data.map(_chr).join(\"\"), opts);\n    }\n  }\n\n  function write_xlml(wb, opts) {}\n  /* [MS-OLEDS] 2.3.8 CompObjStream */\n\n\n  function parse_compobj(obj) {\n    var v = {};\n    var o = obj.content;\n    /* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n\n    var l = 28,\n        m;\n    m = __lpstr(o, l);\n    l += 4 + __readUInt32LE(o, l);\n    v.UserType = m;\n    /* [MS-OLEDS] 2.3.1 ClipboardFormatOrAnsiString */\n\n    m = __readUInt32LE(o, l);\n    l += 4;\n\n    switch (m) {\n      case 0x00000000:\n        break;\n\n      case 0xffffffff:\n      case 0xfffffffe:\n        l += 4;\n        break;\n\n      default:\n        if (m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n        l += m;\n    }\n\n    m = __lpstr(o, l);\n    l += m.length === 0 ? 0 : 5 + m.length;\n    v.Reserved1 = m;\n    if ((m = __readUInt32LE(o, l)) !== 0x71b2e9f4) return v;\n    throw \"Unsupported Unicode Extension\";\n  }\n  /* 2.4.58 Continue logic */\n\n\n  function slurp(R, blob, length, opts) {\n    var l = length;\n    var bufs = [];\n    var d = blob.slice(blob.l, blob.l + l);\n    if (opts && opts.enc && opts.enc.insitu_decrypt) switch (R.n) {\n      case 'BOF':\n      case 'FilePass':\n      case 'FileLock':\n      case 'InterfaceHdr':\n      case 'RRDInfo':\n      case 'RRDHead':\n      case 'UsrExcl':\n        break;\n\n      default:\n        if (d.length === 0) break;\n        opts.enc.insitu_decrypt(d);\n    }\n    bufs.push(d);\n    blob.l += l;\n\n    var next = XLSRecordEnum[__readUInt16LE(blob, blob.l)];\n\n    while (next != null && next.n === 'Continue') {\n      l = __readUInt16LE(blob, blob.l + 2);\n      bufs.push(blob.slice(blob.l + 4, blob.l + 4 + l));\n      blob.l += 4 + l;\n      next = XLSRecordEnum[__readUInt16LE(blob, blob.l)];\n    }\n\n    var b = bconcat(bufs);\n    prep_blob(b, 0);\n    var ll = 0;\n    b.lens = [];\n\n    for (var j = 0; j < bufs.length; ++j) {\n      b.lens.push(ll);\n      ll += bufs[j].length;\n    }\n\n    return R.f(b, b.length, opts);\n  }\n\n  function safe_format_xf(p, opts, date1904) {\n    if (!p.XF) return;\n\n    try {\n      var fmtid = p.XF.ifmt || 0;\n\n      if (p.t === 'e') {\n        p.w = p.w || BErr[p.v];\n      } else if (fmtid === 0) {\n        if (p.t === 'n') {\n          if ((p.v | 0) === p.v) p.w = SSF._general_int(p.v);else p.w = SSF._general_num(p.v);\n        } else p.w = SSF._general(p.v);\n      } else p.w = SSF.format(fmtid, p.v, {\n        date1904: date1904 || false\n      });\n\n      if (opts.cellNF) p.z = SSF._table[fmtid];\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n  }\n\n  function make_cell(val, ixfe, t) {\n    return {\n      v: val,\n      ixfe: ixfe,\n      t: t\n    };\n  } // 2.3.2\n\n\n  function parse_workbook(blob, options) {\n    var wb = {\n      opts: {}\n    };\n    var Sheets = {};\n    var out = {};\n    var Directory = {};\n    var found_sheet = false;\n    var range = {};\n    var last_formula = null;\n    var sst = [];\n    var cur_sheet = \"\";\n    var Preamble = {};\n    var lastcell, last_cell, cc, cmnt, rng, rngC, rngR;\n    var shared_formulae = {};\n    var array_formulae = [];\n    /* TODO: something more clever */\n\n    var temp_val;\n    var country;\n    var cell_valid = true;\n    var XFs = [];\n    /* XF records */\n\n    var palette = [];\n\n    var get_rgb = function getrgb(icv) {\n      if (icv < 8) return XLSIcv[icv];\n      if (icv < 64) return palette[icv - 8] || XLSIcv[icv];\n      return XLSIcv[icv];\n    };\n\n    var process_cell_style = function pcs(cell, line) {\n      var xfd = line.XF.data;\n      if (!xfd || !xfd.patternType) return;\n      line.s = {};\n      line.s.patternType = xfd.patternType;\n      var t;\n\n      if (t = rgb2Hex(get_rgb(xfd.icvFore))) {\n        line.s.fgColor = {\n          rgb: t\n        };\n      }\n\n      if (t = rgb2Hex(get_rgb(xfd.icvBack))) {\n        line.s.bgColor = {\n          rgb: t\n        };\n      }\n    };\n\n    var addcell = function addcell(cell, line, options) {\n      if (!cell_valid) return;\n      if (options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line);\n      lastcell = cell;\n      last_cell = encode_cell(cell);\n\n      if (range.s) {\n        if (cell.r < range.s.r) range.s.r = cell.r;\n        if (cell.c < range.s.c) range.s.c = cell.c;\n      }\n\n      if (range.e) {\n        if (cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n        if (cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n      }\n\n      if (options.sheetRows && lastcell.r >= options.sheetRows) cell_valid = false;else out[last_cell] = line;\n    };\n\n    var opts = {\n      enc: false,\n      // encrypted\n      sbcch: 0,\n      // cch in the preceding SupBook\n      snames: [],\n      // sheetnames\n      sharedf: shared_formulae,\n      // shared formulae by address\n      arrayf: array_formulae,\n      // array formulae array\n      rrtabid: [],\n      // RRTabId\n      lastuser: \"\",\n      // Last User from WriteAccess\n      biff: 8,\n      // BIFF version\n      codepage: 0,\n      // CP from CodePage record\n      winlocked: 0,\n      // fLockWn from WinProtect\n      wtf: false\n    };\n    if (options.password) opts.password = options.password;\n    var mergecells = [];\n    var objects = [];\n    var supbooks = [[]]; // 1-indexed, will hold extern names\n\n    var sbc = 0,\n        sbci = 0,\n        sbcli = 0;\n    supbooks.SheetNames = opts.snames;\n    supbooks.sharedf = opts.sharedf;\n    supbooks.arrayf = opts.arrayf;\n    var last_Rn = '';\n    var file_depth = 0;\n    /* TODO: make a real stack */\n\n    /* explicit override for some broken writers */\n\n    opts.codepage = 1200;\n    set_cp(1200);\n\n    while (blob.l < blob.length - 1) {\n      var s = blob.l;\n      var RecordType = blob.read_shift(2);\n      if (RecordType === 0 && last_Rn === 'EOF') break;\n      var length = blob.l === blob.length ? 0 : blob.read_shift(2),\n          y;\n      var R = XLSRecordEnum[RecordType];\n\n      if (R && R.f) {\n        if (options.bookSheets) {\n          if (last_Rn === 'BoundSheet8' && R.n !== 'BoundSheet8') break;\n        }\n\n        last_Rn = R.n;\n\n        if (R.r === 2 || R.r == 12) {\n          var rt = blob.read_shift(2);\n          length -= 2;\n          if (!opts.enc && rt !== RecordType) throw \"rt mismatch\";\n\n          if (R.r == 12) {\n            blob.l += 10;\n            length -= 10;\n          } // skip FRT\n\n        } //console.error(R,blob.l,length,blob.length);\n\n\n        var val;\n        if (R.n === 'EOF') val = R.f(blob, length, opts);else val = slurp(R, blob, length, opts);\n        var Rn = R.n;\n        /* BIFF5 overrides */\n\n        if (opts.biff === 5 || opts.biff === 2) switch (Rn) {\n          case 'Lbl':\n            Rn = 'Label';\n            break;\n        }\n        /* nested switch statements to workaround V8 128 limit */\n\n        switch (Rn) {\n          /* Workbook Options */\n          case 'Date1904':\n            wb.opts.Date1904 = val;\n            break;\n\n          case 'WriteProtect':\n            wb.opts.WriteProtect = true;\n            break;\n\n          case 'FilePass':\n            if (!opts.enc) blob.l = 0;\n            opts.enc = val;\n            if (opts.WTF) console.error(val);\n            if (!options.password) throw new Error(\"File is password-protected\");\n            if (val.Type !== 0) throw new Error(\"Encryption scheme unsupported\");\n            if (!val.valid) throw new Error(\"Password is incorrect\");\n            break;\n\n          case 'WriteAccess':\n            opts.lastuser = val;\n            break;\n\n          case 'FileSharing':\n            break;\n          //TODO\n\n          case 'CodePage':\n            /* overrides based on test cases */\n            if (val === 0x5212) val = 1200;else if (val === 0x8001) val = 1252;\n            opts.codepage = val;\n            set_cp(val);\n            break;\n\n          case 'RRTabId':\n            opts.rrtabid = val;\n            break;\n\n          case 'WinProtect':\n            opts.winlocked = val;\n            break;\n\n          case 'Template':\n            break;\n          // TODO\n\n          case 'RefreshAll':\n            wb.opts.RefreshAll = val;\n            break;\n\n          case 'BookBool':\n            break;\n          // TODO\n\n          case 'UsesELFs':\n            /* if(val) console.error(\"Unsupported ELFs\"); */\n            break;\n\n          case 'MTRSettings':\n            {\n              if (val[0] && val[1]) throw \"Unsupported threads: \" + val;\n            }\n            break;\n          // TODO: actually support threads\n\n          case 'CalcCount':\n            wb.opts.CalcCount = val;\n            break;\n\n          case 'CalcDelta':\n            wb.opts.CalcDelta = val;\n            break;\n\n          case 'CalcIter':\n            wb.opts.CalcIter = val;\n            break;\n\n          case 'CalcMode':\n            wb.opts.CalcMode = val;\n            break;\n\n          case 'CalcPrecision':\n            wb.opts.CalcPrecision = val;\n            break;\n\n          case 'CalcSaveRecalc':\n            wb.opts.CalcSaveRecalc = val;\n            break;\n\n          case 'CalcRefMode':\n            opts.CalcRefMode = val;\n            break;\n          // TODO: implement R1C1\n\n          case 'Uncalced':\n            break;\n\n          case 'ForceFullCalculation':\n            wb.opts.FullCalc = val;\n            break;\n\n          case 'WsBool':\n            break;\n          // TODO\n\n          case 'XF':\n            XFs.push(val);\n            break;\n\n          case 'ExtSST':\n            break;\n          // TODO\n\n          case 'BookExt':\n            break;\n          // TODO\n\n          case 'RichTextStream':\n            break;\n\n          case 'BkHim':\n            break;\n\n          case 'SupBook':\n            supbooks[++sbc] = [val];\n            sbci = 0;\n            break;\n\n          case 'ExternName':\n            supbooks[sbc][++sbci] = val;\n            break;\n\n          case 'Index':\n            break;\n          // TODO\n\n          case 'Lbl':\n            supbooks[0][++sbcli] = val;\n            break;\n\n          case 'ExternSheet':\n            supbooks[sbc] = supbooks[sbc].concat(val);\n            sbci += val.length;\n            break;\n\n          case 'Protect':\n            out[\"!protect\"] = val;\n            break;\n\n          /* for sheet or book */\n\n          case 'Password':\n            if (val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val);\n            break;\n\n          case 'Prot4Rev':\n          case 'Prot4RevPass':\n            break;\n\n          /*TODO: Revision Control*/\n\n          case 'BoundSheet8':\n            {\n              Directory[val.pos] = val;\n              opts.snames.push(val.name);\n            }\n            break;\n\n          case 'EOF':\n            {\n              if (--file_depth) break;\n\n              if (range.e) {\n                out[\"!range\"] = range;\n\n                if (range.e.r > 0 && range.e.c > 0) {\n                  range.e.r--;\n                  range.e.c--;\n                  out[\"!ref\"] = encode_range(range);\n                  range.e.r++;\n                  range.e.c++;\n                }\n\n                if (mergecells.length > 0) out[\"!merges\"] = mergecells;\n                if (objects.length > 0) out[\"!objects\"] = objects;\n              }\n\n              if (cur_sheet === \"\") Preamble = out;else Sheets[cur_sheet] = out;\n              out = {};\n            }\n            break;\n\n          case 'BOF':\n            {\n              if (opts.biff !== 8) ;else if (val.BIFFVer === 0x0500) opts.biff = 5;else if (val.BIFFVer === 0x0002) opts.biff = 2;else if (val.BIFFVer === 0x0007) opts.biff = 2;\n              if (file_depth++) break;\n              cell_valid = true;\n              out = {};\n\n              if (opts.biff === 2) {\n                if (cur_sheet === \"\") cur_sheet = \"Sheet1\";\n                range = {\n                  s: {\n                    r: 0,\n                    c: 0\n                  },\n                  e: {\n                    r: 0,\n                    c: 0\n                  }\n                };\n              } else cur_sheet = (Directory[s] || {\n                name: \"\"\n              }).name;\n\n              mergecells = [];\n              objects = [];\n            }\n            break;\n\n          case 'Number':\n          case 'BIFF2NUM':\n            {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                v: val.val,\n                t: 'n'\n              };\n              if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n\n          case 'BoolErr':\n            {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                v: val.val,\n                t: val.t\n              };\n              if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n\n          case 'RK':\n            {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                v: val.rknum,\n                t: 'n'\n              };\n              if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n\n          case 'MulRk':\n            {\n              for (var j = val.c; j <= val.C; ++j) {\n                var ixfe = val.rkrec[j - val.c][0];\n                temp_val = {\n                  ixfe: ixfe,\n                  XF: XFs[ixfe],\n                  v: val.rkrec[j - val.c][1],\n                  t: 'n'\n                };\n                if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n                addcell({\n                  c: j,\n                  r: val.r\n                }, temp_val, options);\n              }\n            }\n            break;\n\n          case 'Formula':\n            {\n              switch (val.val) {\n                case 'String':\n                  last_formula = val;\n                  break;\n\n                case 'Array Formula':\n                  throw \"Array Formula unsupported\";\n\n                default:\n                  temp_val = {\n                    v: val.val,\n                    ixfe: val.cell.ixfe,\n                    t: val.tt\n                  };\n                  temp_val.XF = XFs[temp_val.ixfe];\n                  if (options.cellFormula) temp_val.f = \"=\" + stringify_formula(val.formula, range, val.cell, supbooks, opts);\n                  if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n                  addcell(val.cell, temp_val, options);\n                  last_formula = val;\n              }\n            }\n            break;\n\n          case 'String':\n            {\n              if (last_formula) {\n                last_formula.val = val;\n                temp_val = {\n                  v: last_formula.val,\n                  ixfe: last_formula.cell.ixfe,\n                  t: 's'\n                };\n                temp_val.XF = XFs[temp_val.ixfe];\n                if (options.cellFormula) temp_val.f = \"=\" + stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n                if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n                addcell(last_formula.cell, temp_val, options);\n                last_formula = null;\n              }\n            }\n            break;\n\n          case 'Array':\n            {\n              array_formulae.push(val);\n            }\n            break;\n\n          case 'ShrFmla':\n            {\n              if (!cell_valid) break; //if(options.cellFormula) out[last_cell].f = stringify_formula(val[0], range, lastcell, supbooks, opts);\n\n              /* TODO: capture range */\n\n              shared_formulae[encode_cell(last_formula.cell)] = val[0];\n            }\n            break;\n\n          case 'LabelSst':\n            //temp_val={v:sst[val.isst].t, ixfe:val.ixfe, t:'s'};\n            temp_val = make_cell(sst[val.isst].t, val.ixfe, 's');\n            temp_val.XF = XFs[temp_val.ixfe];\n            if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n            break;\n\n          case 'Label':\n          case 'BIFF2STR':\n            /* Some writers erroneously write Label */\n            temp_val = make_cell(val.val, val.ixfe, 's');\n            temp_val.XF = XFs[temp_val.ixfe];\n            if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n            break;\n\n          case 'Dimensions':\n            {\n              if (file_depth === 1) range = val;\n              /* TODO: stack */\n            }\n            break;\n\n          case 'SST':\n            {\n              sst = val;\n            }\n            break;\n\n          case 'Format':\n            {\n              /* val = [id, fmt] */\n              SSF.load(val[1], val[0]);\n            }\n            break;\n\n          case 'MergeCells':\n            mergecells = mergecells.concat(val);\n            break;\n\n          case 'Obj':\n            objects[val.cmo[0]] = opts.lastobj = val;\n            break;\n\n          case 'TxO':\n            opts.lastobj.TxO = val;\n            break;\n\n          case 'HLink':\n            {\n              for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) if (out[encode_cell({\n                c: rngC,\n                r: rngR\n              })]) out[encode_cell({\n                c: rngC,\n                r: rngR\n              })].l = val[1];\n            }\n            break;\n\n          case 'HLinkTooltip':\n            {\n              for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) if (out[encode_cell({\n                c: rngC,\n                r: rngR\n              })]) out[encode_cell({\n                c: rngC,\n                r: rngR\n              })].l.tooltip = val[1];\n            }\n            break;\n\n          /* Comments */\n\n          case 'Note':\n            {\n              if (opts.biff <= 5 && opts.biff >= 2) break;\n              /* TODO: BIFF5 */\n\n              cc = out[encode_cell(val[0])];\n              var noteobj = objects[val[2]];\n              if (!cc) break;\n              if (!cc.c) cc.c = [];\n              cmnt = {\n                a: val[1],\n                t: noteobj.TxO.t\n              };\n              cc.c.push(cmnt);\n            }\n            break;\n\n          default:\n            switch (R.n) {\n              /* nested */\n              case 'ClrtClient':\n                break;\n\n              case 'XFExt':\n                update_xfext(XFs[val.ixfe], val.ext);\n                break;\n\n              case 'NameCmt':\n                break;\n\n              case 'Header':\n                break;\n              // TODO\n\n              case 'Footer':\n                break;\n              // TODO\n\n              case 'HCenter':\n                break;\n              // TODO\n\n              case 'VCenter':\n                break;\n              // TODO\n\n              case 'Pls':\n                break;\n              // TODO\n\n              case 'Setup':\n                break;\n              // TODO\n\n              case 'DefColWidth':\n                break;\n              // TODO\n\n              case 'GCW':\n                break;\n\n              case 'LHRecord':\n                break;\n\n              case 'ColInfo':\n                break;\n              // TODO\n\n              case 'Row':\n                break;\n              // TODO\n\n              case 'DBCell':\n                break;\n              // TODO\n\n              case 'MulBlank':\n                break;\n              // TODO\n\n              case 'EntExU2':\n                break;\n              // TODO\n\n              case 'SxView':\n                break;\n              // TODO\n\n              case 'Sxvd':\n                break;\n              // TODO\n\n              case 'SXVI':\n                break;\n              // TODO\n\n              case 'SXVDEx':\n                break;\n              // TODO\n\n              case 'SxIvd':\n                break;\n              // TODO\n\n              case 'SXDI':\n                break;\n              // TODO\n\n              case 'SXLI':\n                break;\n              // TODO\n\n              case 'SXEx':\n                break;\n              // TODO\n\n              case 'QsiSXTag':\n                break;\n              // TODO\n\n              case 'Selection':\n                break;\n\n              case 'Feat':\n                break;\n\n              case 'FeatHdr':\n              case 'FeatHdr11':\n                break;\n\n              case 'Feature11':\n              case 'Feature12':\n              case 'List12':\n                break;\n\n              case 'Blank':\n                break;\n\n              case 'Country':\n                country = val;\n                break;\n\n              case 'RecalcId':\n                break;\n\n              case 'DefaultRowHeight':\n              case 'DxGCol':\n                break;\n              // TODO: htmlify\n\n              case 'Fbi':\n              case 'Fbi2':\n              case 'GelFrame':\n                break;\n\n              case 'Font':\n                break;\n              // TODO\n\n              case 'XFCRC':\n                break;\n              // TODO\n\n              case 'Style':\n                break;\n              // TODO\n\n              case 'StyleExt':\n                break;\n              // TODO\n\n              case 'Palette':\n                palette = val;\n                break;\n              // TODO\n\n              case 'Theme':\n                break;\n              // TODO\n\n              /* Protection */\n\n              case 'ScenarioProtect':\n                break;\n\n              case 'ObjProtect':\n                break;\n\n              /* Conditional Formatting */\n\n              case 'CondFmt12':\n                break;\n\n              /* Table */\n\n              case 'Table':\n                break;\n              // TODO\n\n              case 'TableStyles':\n                break;\n              // TODO\n\n              case 'TableStyle':\n                break;\n              // TODO\n\n              case 'TableStyleElement':\n                break;\n              // TODO\n\n              /* PivotTable */\n\n              case 'SXStreamID':\n                break;\n              // TODO\n\n              case 'SXVS':\n                break;\n              // TODO\n\n              case 'DConRef':\n                break;\n              // TODO\n\n              case 'SXAddl':\n                break;\n              // TODO\n\n              case 'DConBin':\n                break;\n              // TODO\n\n              case 'DConName':\n                break;\n              // TODO\n\n              case 'SXPI':\n                break;\n              // TODO\n\n              case 'SxFormat':\n                break;\n              // TODO\n\n              case 'SxSelect':\n                break;\n              // TODO\n\n              case 'SxRule':\n                break;\n              // TODO\n\n              case 'SxFilt':\n                break;\n              // TODO\n\n              case 'SxItm':\n                break;\n              // TODO\n\n              case 'SxDXF':\n                break;\n              // TODO\n\n              /* Scenario Manager */\n\n              case 'ScenMan':\n                break;\n\n              /* Data Consolidation */\n\n              case 'DCon':\n                break;\n\n              /* Watched Cell */\n\n              case 'CellWatch':\n                break;\n\n              /* Print Settings */\n\n              case 'PrintRowCol':\n                break;\n\n              case 'PrintGrid':\n                break;\n\n              case 'PrintSize':\n                break;\n\n              case 'XCT':\n                break;\n\n              case 'CRN':\n                break;\n\n              case 'Scl':\n                {//console.log(\"Zoom Level:\", val[0]/val[1],val);\n                }\n                break;\n\n              case 'SheetExt':\n                {}\n                break;\n\n              case 'SheetExtOptional':\n                {}\n                break;\n\n              /* VBA */\n\n              case 'ObNoMacros':\n                {}\n                break;\n\n              case 'ObProj':\n                {}\n                break;\n\n              case 'CodeName':\n                {}\n                break;\n\n              case 'GUIDTypeLib':\n                {}\n                break;\n\n              case 'WOpt':\n                break;\n              // TODO: WTF?\n\n              case 'PhoneticInfo':\n                break;\n\n              case 'OleObjectSize':\n                break;\n\n              /* Differential Formatting */\n\n              case 'DXF':\n              case 'DXFN':\n              case 'DXFN12':\n              case 'DXFN12List':\n              case 'DXFN12NoCB':\n                break;\n\n              /* Data Validation */\n\n              case 'Dv':\n              case 'DVal':\n                break;\n\n              /* Data Series */\n\n              case 'BRAI':\n              case 'Series':\n              case 'SeriesText':\n                break;\n\n              /* Data Connection */\n\n              case 'DConn':\n                break;\n\n              case 'DbOrParamQry':\n                break;\n\n              case 'DBQueryExt':\n                break;\n\n              /* Formatting */\n\n              case 'IFmtRecord':\n                break;\n\n              case 'CondFmt':\n              case 'CF':\n              case 'CF12':\n              case 'CFEx':\n                break;\n\n              /* Explicitly Ignored */\n\n              case 'Excel9File':\n                break;\n\n              case 'Units':\n                break;\n\n              case 'InterfaceHdr':\n              case 'Mms':\n              case 'InterfaceEnd':\n              case 'DSF':\n              case 'BuiltInFnGroupCount':\n              /* View Stuff */\n\n              case 'Window1':\n              case 'Window2':\n              case 'HideObj':\n              case 'GridSet':\n              case 'Guts':\n              case 'UserBView':\n              case 'UserSViewBegin':\n              case 'UserSViewEnd':\n              case 'Pane':\n                break;\n\n              default:\n                switch (R.n) {\n                  /* nested */\n\n                  /* Chart */\n                  case 'Dat':\n                  case 'Begin':\n                  case 'End':\n                  case 'StartBlock':\n                  case 'EndBlock':\n                  case 'Frame':\n                  case 'Area':\n                  case 'Axis':\n                  case 'AxisLine':\n                  case 'Tick':\n                    break;\n\n                  case 'AxesUsed':\n                  case 'CrtLayout12':\n                  case 'CrtLayout12A':\n                  case 'CrtLink':\n                  case 'CrtLine':\n                  case 'CrtMlFrt':\n                  case 'CrtMlFrtContinue':\n                    break;\n\n                  case 'LineFormat':\n                  case 'AreaFormat':\n                  case 'Chart':\n                  case 'Chart3d':\n                  case 'Chart3DBarShape':\n                  case 'ChartFormat':\n                  case 'ChartFrtInfo':\n                    break;\n\n                  case 'PlotArea':\n                  case 'PlotGrowth':\n                    break;\n\n                  case 'SeriesList':\n                  case 'SerParent':\n                  case 'SerAuxTrend':\n                    break;\n\n                  case 'DataFormat':\n                  case 'SerToCrt':\n                  case 'FontX':\n                    break;\n\n                  case 'CatSerRange':\n                  case 'AxcExt':\n                  case 'SerFmt':\n                    break;\n\n                  case 'ShtProps':\n                    break;\n\n                  case 'DefaultText':\n                  case 'Text':\n                  case 'CatLab':\n                    break;\n\n                  case 'DataLabExtContents':\n                    break;\n\n                  case 'Legend':\n                  case 'LegendException':\n                    break;\n\n                  case 'Pie':\n                  case 'Scatter':\n                    break;\n\n                  case 'PieFormat':\n                  case 'MarkerFormat':\n                    break;\n\n                  case 'StartObject':\n                  case 'EndObject':\n                    break;\n\n                  case 'AlRuns':\n                  case 'ObjectLink':\n                    break;\n\n                  case 'SIIndex':\n                    break;\n\n                  case 'AttachedLabel':\n                  case 'YMult':\n                    break;\n\n                  /* Chart Group */\n\n                  case 'Line':\n                  case 'Bar':\n                    break;\n\n                  case 'Surf':\n                    break;\n\n                  /* Axis Group */\n\n                  case 'AxisParent':\n                    break;\n\n                  case 'Pos':\n                    break;\n\n                  case 'ValueRange':\n                    break;\n\n                  /* Pivot Chart */\n\n                  case 'SXViewEx9':\n                    break;\n                  // TODO\n\n                  case 'SXViewLink':\n                    break;\n\n                  case 'PivotChartBits':\n                    break;\n\n                  case 'SBaseRef':\n                    break;\n\n                  case 'TextPropsStream':\n                    break;\n\n                  /* Chart Misc */\n\n                  case 'LnExt':\n                    break;\n\n                  case 'MkrExt':\n                    break;\n\n                  case 'CrtCoopt':\n                    break;\n\n                  /* Query Table */\n\n                  case 'Qsi':\n                  case 'Qsif':\n                  case 'Qsir':\n                  case 'QsiSXTag':\n                    break;\n\n                  case 'TxtQry':\n                    break;\n\n                  /* Filter */\n\n                  case 'FilterMode':\n                    break;\n\n                  case 'AutoFilter':\n                  case 'AutoFilterInfo':\n                    break;\n\n                  case 'AutoFilter12':\n                    break;\n\n                  case 'DropDownObjIds':\n                    break;\n\n                  case 'Sort':\n                    break;\n\n                  case 'SortData':\n                    break;\n\n                  /* Drawing */\n\n                  case 'ShapePropsStream':\n                    break;\n\n                  case 'MsoDrawing':\n                  case 'MsoDrawingGroup':\n                  case 'MsoDrawingSelection':\n                    break;\n\n                  case 'ImData':\n                    break;\n\n                  /* Pub Stuff */\n\n                  case 'WebPub':\n                  case 'AutoWebPub':\n                  /* Print Stuff */\n\n                  case 'RightMargin':\n                  case 'LeftMargin':\n                  case 'TopMargin':\n                  case 'BottomMargin':\n                  case 'HeaderFooter':\n                  case 'HFPicture':\n                  case 'PLV':\n                  case 'HorizontalPageBreaks':\n                  case 'VerticalPageBreaks':\n                  /* Behavioral */\n\n                  case 'Backup':\n                  case 'CompressPictures':\n                  case 'Compat12':\n                    break;\n\n                  /* Should not Happen */\n\n                  case 'Continue':\n                  case 'ContinueFrt12':\n                    break;\n\n                  /* Future Records */\n\n                  case 'FrtFontList':\n                  case 'FrtWrapper':\n                    break;\n\n                  /* BIFF5 records */\n\n                  case 'ExternCount':\n                    break;\n\n                  case 'RString':\n                    break;\n\n                  case 'TabIdConf':\n                  case 'Radar':\n                  case 'RadarArea':\n                  case 'DropBar':\n                  case 'Intl':\n                  case 'CoordList':\n                  case 'SerAuxErrBar':\n                    break;\n\n                  default:\n                    switch (R.n) {\n                      /* nested */\n\n                      /* Miscellaneous */\n                      case 'SCENARIO':\n                      case 'DConBin':\n                      case 'PicF':\n                      case 'DataLabExt':\n                      case 'Lel':\n                      case 'BopPop':\n                      case 'BopPopCustom':\n                      case 'RealTimeData':\n                      case 'Name':\n                        break;\n\n                      default:\n                        if (options.WTF) throw 'Unrecognized Record ' + R.n;\n                    }\n\n                }\n\n            }\n\n        }\n      } else blob.l += length;\n    }\n\n    var sheetnamesraw = opts.biff === 2 ? ['Sheet1'] : Object.keys(Directory).sort(function (a, b) {\n      return Number(a) - Number(b);\n    }).map(function (x) {\n      return Directory[x].name;\n    });\n    var sheetnames = sheetnamesraw.slice();\n    wb.Directory = sheetnamesraw;\n    wb.SheetNames = sheetnamesraw;\n    if (!options.bookSheets) wb.Sheets = Sheets;\n    wb.Preamble = Preamble;\n    wb.Strings = sst;\n    wb.SSF = SSF.get_table();\n    if (opts.enc) wb.Encryption = opts.enc;\n    wb.Metadata = {};\n    if (country !== undefined) wb.Metadata.Country = country;\n    return wb;\n  }\n\n  function parse_xlscfb(cfb, options) {\n    if (!options) options = {};\n    fix_read_opts(options);\n    reset_cp();\n    var CompObj, Summary, Workbook;\n\n    if (cfb.find) {\n      CompObj = cfb.find('!CompObj');\n      Summary = cfb.find('!SummaryInformation');\n      Workbook = cfb.find('/Workbook');\n    } else {\n      prep_blob(cfb, 0);\n      Workbook = {\n        content: cfb\n      };\n    }\n\n    if (!Workbook) Workbook = cfb.find('/Book');\n    var CompObjP, SummaryP, WorkbookP;\n    if (CompObj) CompObjP = parse_compobj(CompObj);\n    if (options.bookProps && !options.bookSheets) WorkbookP = {};else {\n      if (Workbook) WorkbookP = parse_workbook(Workbook.content, options, !!Workbook.find);else throw new Error(\"Cannot find Workbook stream\");\n    }\n    if (cfb.find) parse_props(cfb);\n    var props = {};\n\n    for (var y in cfb.Summary) props[y] = cfb.Summary[y];\n\n    for (y in cfb.DocSummary) props[y] = cfb.DocSummary[y];\n\n    WorkbookP.Props = WorkbookP.Custprops = props;\n    /* TODO: split up properties */\n\n    if (options.bookFiles) WorkbookP.cfb = cfb;\n    WorkbookP.CompObjP = CompObjP;\n    return WorkbookP;\n  }\n  /* TODO: WTF */\n\n\n  function parse_props(cfb) {\n    /* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n    var DSI = cfb.find('!DocumentSummaryInformation');\n    if (DSI) try {\n      cfb.DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI);\n    } catch (e) {}\n    /* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n\n    var SI = cfb.find('!SummaryInformation');\n    if (SI) try {\n      cfb.Summary = parse_PropertySetStream(SI, SummaryPIDSI);\n    } catch (e) {}\n  }\n  /* [MS-XLSB] 2.3 Record Enumeration */\n\n\n  var XLSBRecordEnum = {\n    0x0000: {\n      n: \"BrtRowHdr\",\n      f: parse_BrtRowHdr\n    },\n    0x0001: {\n      n: \"BrtCellBlank\",\n      f: parse_BrtCellBlank\n    },\n    0x0002: {\n      n: \"BrtCellRk\",\n      f: parse_BrtCellRk\n    },\n    0x0003: {\n      n: \"BrtCellError\",\n      f: parse_BrtCellError\n    },\n    0x0004: {\n      n: \"BrtCellBool\",\n      f: parse_BrtCellBool\n    },\n    0x0005: {\n      n: \"BrtCellReal\",\n      f: parse_BrtCellReal\n    },\n    0x0006: {\n      n: \"BrtCellSt\",\n      f: parse_BrtCellSt\n    },\n    0x0007: {\n      n: \"BrtCellIsst\",\n      f: parse_BrtCellIsst\n    },\n    0x0008: {\n      n: \"BrtFmlaString\",\n      f: parse_BrtFmlaString\n    },\n    0x0009: {\n      n: \"BrtFmlaNum\",\n      f: parse_BrtFmlaNum\n    },\n    0x000A: {\n      n: \"BrtFmlaBool\",\n      f: parse_BrtFmlaBool\n    },\n    0x000B: {\n      n: \"BrtFmlaError\",\n      f: parse_BrtFmlaError\n    },\n    0x0010: {\n      n: \"BrtFRTArchID$\",\n      f: parse_BrtFRTArchID$\n    },\n    0x0013: {\n      n: \"BrtSSTItem\",\n      f: parse_RichStr\n    },\n    0x0014: {\n      n: \"BrtPCDIMissing\",\n      f: parsenoop\n    },\n    0x0015: {\n      n: \"BrtPCDINumber\",\n      f: parsenoop\n    },\n    0x0016: {\n      n: \"BrtPCDIBoolean\",\n      f: parsenoop\n    },\n    0x0017: {\n      n: \"BrtPCDIError\",\n      f: parsenoop\n    },\n    0x0018: {\n      n: \"BrtPCDIString\",\n      f: parsenoop\n    },\n    0x0019: {\n      n: \"BrtPCDIDatetime\",\n      f: parsenoop\n    },\n    0x001A: {\n      n: \"BrtPCDIIndex\",\n      f: parsenoop\n    },\n    0x001B: {\n      n: \"BrtPCDIAMissing\",\n      f: parsenoop\n    },\n    0x001C: {\n      n: \"BrtPCDIANumber\",\n      f: parsenoop\n    },\n    0x001D: {\n      n: \"BrtPCDIABoolean\",\n      f: parsenoop\n    },\n    0x001E: {\n      n: \"BrtPCDIAError\",\n      f: parsenoop\n    },\n    0x001F: {\n      n: \"BrtPCDIAString\",\n      f: parsenoop\n    },\n    0x0020: {\n      n: \"BrtPCDIADatetime\",\n      f: parsenoop\n    },\n    0x0021: {\n      n: \"BrtPCRRecord\",\n      f: parsenoop\n    },\n    0x0022: {\n      n: \"BrtPCRRecordDt\",\n      f: parsenoop\n    },\n    0x0023: {\n      n: \"BrtFRTBegin\",\n      f: parsenoop\n    },\n    0x0024: {\n      n: \"BrtFRTEnd\",\n      f: parsenoop\n    },\n    0x0025: {\n      n: \"BrtACBegin\",\n      f: parsenoop\n    },\n    0x0026: {\n      n: \"BrtACEnd\",\n      f: parsenoop\n    },\n    0x0027: {\n      n: \"BrtName\",\n      f: parsenoop\n    },\n    0x0028: {\n      n: \"BrtIndexRowBlock\",\n      f: parsenoop\n    },\n    0x002A: {\n      n: \"BrtIndexBlock\",\n      f: parsenoop\n    },\n    0x002B: {\n      n: \"BrtFont\",\n      f: parse_BrtFont\n    },\n    0x002C: {\n      n: \"BrtFmt\",\n      f: parse_BrtFmt\n    },\n    0x002D: {\n      n: \"BrtFill\",\n      f: parsenoop\n    },\n    0x002E: {\n      n: \"BrtBorder\",\n      f: parsenoop\n    },\n    0x002F: {\n      n: \"BrtXF\",\n      f: parse_BrtXF\n    },\n    0x0030: {\n      n: \"BrtStyle\",\n      f: parsenoop\n    },\n    0x0031: {\n      n: \"BrtCellMeta\",\n      f: parsenoop\n    },\n    0x0032: {\n      n: \"BrtValueMeta\",\n      f: parsenoop\n    },\n    0x0033: {\n      n: \"BrtMdb\",\n      f: parsenoop\n    },\n    0x0034: {\n      n: \"BrtBeginFmd\",\n      f: parsenoop\n    },\n    0x0035: {\n      n: \"BrtEndFmd\",\n      f: parsenoop\n    },\n    0x0036: {\n      n: \"BrtBeginMdx\",\n      f: parsenoop\n    },\n    0x0037: {\n      n: \"BrtEndMdx\",\n      f: parsenoop\n    },\n    0x0038: {\n      n: \"BrtBeginMdxTuple\",\n      f: parsenoop\n    },\n    0x0039: {\n      n: \"BrtEndMdxTuple\",\n      f: parsenoop\n    },\n    0x003A: {\n      n: \"BrtMdxMbrIstr\",\n      f: parsenoop\n    },\n    0x003B: {\n      n: \"BrtStr\",\n      f: parsenoop\n    },\n    0x003C: {\n      n: \"BrtColInfo\",\n      f: parsenoop\n    },\n    0x003E: {\n      n: \"BrtCellRString\",\n      f: parsenoop\n    },\n    0x003F: {\n      n: \"BrtCalcChainItem$\",\n      f: parse_BrtCalcChainItem$\n    },\n    0x0040: {\n      n: \"BrtDVal\",\n      f: parsenoop\n    },\n    0x0041: {\n      n: \"BrtSxvcellNum\",\n      f: parsenoop\n    },\n    0x0042: {\n      n: \"BrtSxvcellStr\",\n      f: parsenoop\n    },\n    0x0043: {\n      n: \"BrtSxvcellBool\",\n      f: parsenoop\n    },\n    0x0044: {\n      n: \"BrtSxvcellErr\",\n      f: parsenoop\n    },\n    0x0045: {\n      n: \"BrtSxvcellDate\",\n      f: parsenoop\n    },\n    0x0046: {\n      n: \"BrtSxvcellNil\",\n      f: parsenoop\n    },\n    0x0080: {\n      n: \"BrtFileVersion\",\n      f: parsenoop\n    },\n    0x0081: {\n      n: \"BrtBeginSheet\",\n      f: parsenoop\n    },\n    0x0082: {\n      n: \"BrtEndSheet\",\n      f: parsenoop\n    },\n    0x0083: {\n      n: \"BrtBeginBook\",\n      f: parsenoop,\n      p: 0\n    },\n    0x0084: {\n      n: \"BrtEndBook\",\n      f: parsenoop\n    },\n    0x0085: {\n      n: \"BrtBeginWsViews\",\n      f: parsenoop\n    },\n    0x0086: {\n      n: \"BrtEndWsViews\",\n      f: parsenoop\n    },\n    0x0087: {\n      n: \"BrtBeginBookViews\",\n      f: parsenoop\n    },\n    0x0088: {\n      n: \"BrtEndBookViews\",\n      f: parsenoop\n    },\n    0x0089: {\n      n: \"BrtBeginWsView\",\n      f: parsenoop\n    },\n    0x008A: {\n      n: \"BrtEndWsView\",\n      f: parsenoop\n    },\n    0x008B: {\n      n: \"BrtBeginCsViews\",\n      f: parsenoop\n    },\n    0x008C: {\n      n: \"BrtEndCsViews\",\n      f: parsenoop\n    },\n    0x008D: {\n      n: \"BrtBeginCsView\",\n      f: parsenoop\n    },\n    0x008E: {\n      n: \"BrtEndCsView\",\n      f: parsenoop\n    },\n    0x008F: {\n      n: \"BrtBeginBundleShs\",\n      f: parsenoop\n    },\n    0x0090: {\n      n: \"BrtEndBundleShs\",\n      f: parsenoop\n    },\n    0x0091: {\n      n: \"BrtBeginSheetData\",\n      f: parsenoop\n    },\n    0x0092: {\n      n: \"BrtEndSheetData\",\n      f: parsenoop\n    },\n    0x0093: {\n      n: \"BrtWsProp\",\n      f: parse_BrtWsProp\n    },\n    0x0094: {\n      n: \"BrtWsDim\",\n      f: parse_BrtWsDim,\n      p: 16\n    },\n    0x0097: {\n      n: \"BrtPane\",\n      f: parsenoop\n    },\n    0x0098: {\n      n: \"BrtSel\",\n      f: parsenoop\n    },\n    0x0099: {\n      n: \"BrtWbProp\",\n      f: parse_BrtWbProp\n    },\n    0x009A: {\n      n: \"BrtWbFactoid\",\n      f: parsenoop\n    },\n    0x009B: {\n      n: \"BrtFileRecover\",\n      f: parsenoop\n    },\n    0x009C: {\n      n: \"BrtBundleSh\",\n      f: parse_BrtBundleSh\n    },\n    0x009D: {\n      n: \"BrtCalcProp\",\n      f: parsenoop\n    },\n    0x009E: {\n      n: \"BrtBookView\",\n      f: parsenoop\n    },\n    0x009F: {\n      n: \"BrtBeginSst\",\n      f: parse_BrtBeginSst\n    },\n    0x00A0: {\n      n: \"BrtEndSst\",\n      f: parsenoop\n    },\n    0x00A1: {\n      n: \"BrtBeginAFilter\",\n      f: parsenoop\n    },\n    0x00A2: {\n      n: \"BrtEndAFilter\",\n      f: parsenoop\n    },\n    0x00A3: {\n      n: \"BrtBeginFilterColumn\",\n      f: parsenoop\n    },\n    0x00A4: {\n      n: \"BrtEndFilterColumn\",\n      f: parsenoop\n    },\n    0x00A5: {\n      n: \"BrtBeginFilters\",\n      f: parsenoop\n    },\n    0x00A6: {\n      n: \"BrtEndFilters\",\n      f: parsenoop\n    },\n    0x00A7: {\n      n: \"BrtFilter\",\n      f: parsenoop\n    },\n    0x00A8: {\n      n: \"BrtColorFilter\",\n      f: parsenoop\n    },\n    0x00A9: {\n      n: \"BrtIconFilter\",\n      f: parsenoop\n    },\n    0x00AA: {\n      n: \"BrtTop10Filter\",\n      f: parsenoop\n    },\n    0x00AB: {\n      n: \"BrtDynamicFilter\",\n      f: parsenoop\n    },\n    0x00AC: {\n      n: \"BrtBeginCustomFilters\",\n      f: parsenoop\n    },\n    0x00AD: {\n      n: \"BrtEndCustomFilters\",\n      f: parsenoop\n    },\n    0x00AE: {\n      n: \"BrtCustomFilter\",\n      f: parsenoop\n    },\n    0x00AF: {\n      n: \"BrtAFilterDateGroupItem\",\n      f: parsenoop\n    },\n    0x00B0: {\n      n: \"BrtMergeCell\",\n      f: parse_BrtMergeCell\n    },\n    0x00B1: {\n      n: \"BrtBeginMergeCells\",\n      f: parsenoop\n    },\n    0x00B2: {\n      n: \"BrtEndMergeCells\",\n      f: parsenoop\n    },\n    0x00B3: {\n      n: \"BrtBeginPivotCacheDef\",\n      f: parsenoop\n    },\n    0x00B4: {\n      n: \"BrtEndPivotCacheDef\",\n      f: parsenoop\n    },\n    0x00B5: {\n      n: \"BrtBeginPCDFields\",\n      f: parsenoop\n    },\n    0x00B6: {\n      n: \"BrtEndPCDFields\",\n      f: parsenoop\n    },\n    0x00B7: {\n      n: \"BrtBeginPCDField\",\n      f: parsenoop\n    },\n    0x00B8: {\n      n: \"BrtEndPCDField\",\n      f: parsenoop\n    },\n    0x00B9: {\n      n: \"BrtBeginPCDSource\",\n      f: parsenoop\n    },\n    0x00BA: {\n      n: \"BrtEndPCDSource\",\n      f: parsenoop\n    },\n    0x00BB: {\n      n: \"BrtBeginPCDSRange\",\n      f: parsenoop\n    },\n    0x00BC: {\n      n: \"BrtEndPCDSRange\",\n      f: parsenoop\n    },\n    0x00BD: {\n      n: \"BrtBeginPCDFAtbl\",\n      f: parsenoop\n    },\n    0x00BE: {\n      n: \"BrtEndPCDFAtbl\",\n      f: parsenoop\n    },\n    0x00BF: {\n      n: \"BrtBeginPCDIRun\",\n      f: parsenoop\n    },\n    0x00C0: {\n      n: \"BrtEndPCDIRun\",\n      f: parsenoop\n    },\n    0x00C1: {\n      n: \"BrtBeginPivotCacheRecords\",\n      f: parsenoop\n    },\n    0x00C2: {\n      n: \"BrtEndPivotCacheRecords\",\n      f: parsenoop\n    },\n    0x00C3: {\n      n: \"BrtBeginPCDHierarchies\",\n      f: parsenoop\n    },\n    0x00C4: {\n      n: \"BrtEndPCDHierarchies\",\n      f: parsenoop\n    },\n    0x00C5: {\n      n: \"BrtBeginPCDHierarchy\",\n      f: parsenoop\n    },\n    0x00C6: {\n      n: \"BrtEndPCDHierarchy\",\n      f: parsenoop\n    },\n    0x00C7: {\n      n: \"BrtBeginPCDHFieldsUsage\",\n      f: parsenoop\n    },\n    0x00C8: {\n      n: \"BrtEndPCDHFieldsUsage\",\n      f: parsenoop\n    },\n    0x00C9: {\n      n: \"BrtBeginExtConnection\",\n      f: parsenoop\n    },\n    0x00CA: {\n      n: \"BrtEndExtConnection\",\n      f: parsenoop\n    },\n    0x00CB: {\n      n: \"BrtBeginECDbProps\",\n      f: parsenoop\n    },\n    0x00CC: {\n      n: \"BrtEndECDbProps\",\n      f: parsenoop\n    },\n    0x00CD: {\n      n: \"BrtBeginECOlapProps\",\n      f: parsenoop\n    },\n    0x00CE: {\n      n: \"BrtEndECOlapProps\",\n      f: parsenoop\n    },\n    0x00CF: {\n      n: \"BrtBeginPCDSConsol\",\n      f: parsenoop\n    },\n    0x00D0: {\n      n: \"BrtEndPCDSConsol\",\n      f: parsenoop\n    },\n    0x00D1: {\n      n: \"BrtBeginPCDSCPages\",\n      f: parsenoop\n    },\n    0x00D2: {\n      n: \"BrtEndPCDSCPages\",\n      f: parsenoop\n    },\n    0x00D3: {\n      n: \"BrtBeginPCDSCPage\",\n      f: parsenoop\n    },\n    0x00D4: {\n      n: \"BrtEndPCDSCPage\",\n      f: parsenoop\n    },\n    0x00D5: {\n      n: \"BrtBeginPCDSCPItem\",\n      f: parsenoop\n    },\n    0x00D6: {\n      n: \"BrtEndPCDSCPItem\",\n      f: parsenoop\n    },\n    0x00D7: {\n      n: \"BrtBeginPCDSCSets\",\n      f: parsenoop\n    },\n    0x00D8: {\n      n: \"BrtEndPCDSCSets\",\n      f: parsenoop\n    },\n    0x00D9: {\n      n: \"BrtBeginPCDSCSet\",\n      f: parsenoop\n    },\n    0x00DA: {\n      n: \"BrtEndPCDSCSet\",\n      f: parsenoop\n    },\n    0x00DB: {\n      n: \"BrtBeginPCDFGroup\",\n      f: parsenoop\n    },\n    0x00DC: {\n      n: \"BrtEndPCDFGroup\",\n      f: parsenoop\n    },\n    0x00DD: {\n      n: \"BrtBeginPCDFGItems\",\n      f: parsenoop\n    },\n    0x00DE: {\n      n: \"BrtEndPCDFGItems\",\n      f: parsenoop\n    },\n    0x00DF: {\n      n: \"BrtBeginPCDFGRange\",\n      f: parsenoop\n    },\n    0x00E0: {\n      n: \"BrtEndPCDFGRange\",\n      f: parsenoop\n    },\n    0x00E1: {\n      n: \"BrtBeginPCDFGDiscrete\",\n      f: parsenoop\n    },\n    0x00E2: {\n      n: \"BrtEndPCDFGDiscrete\",\n      f: parsenoop\n    },\n    0x00E3: {\n      n: \"BrtBeginPCDSDTupleCache\",\n      f: parsenoop\n    },\n    0x00E4: {\n      n: \"BrtEndPCDSDTupleCache\",\n      f: parsenoop\n    },\n    0x00E5: {\n      n: \"BrtBeginPCDSDTCEntries\",\n      f: parsenoop\n    },\n    0x00E6: {\n      n: \"BrtEndPCDSDTCEntries\",\n      f: parsenoop\n    },\n    0x00E7: {\n      n: \"BrtBeginPCDSDTCEMembers\",\n      f: parsenoop\n    },\n    0x00E8: {\n      n: \"BrtEndPCDSDTCEMembers\",\n      f: parsenoop\n    },\n    0x00E9: {\n      n: \"BrtBeginPCDSDTCEMember\",\n      f: parsenoop\n    },\n    0x00EA: {\n      n: \"BrtEndPCDSDTCEMember\",\n      f: parsenoop\n    },\n    0x00EB: {\n      n: \"BrtBeginPCDSDTCQueries\",\n      f: parsenoop\n    },\n    0x00EC: {\n      n: \"BrtEndPCDSDTCQueries\",\n      f: parsenoop\n    },\n    0x00ED: {\n      n: \"BrtBeginPCDSDTCQuery\",\n      f: parsenoop\n    },\n    0x00EE: {\n      n: \"BrtEndPCDSDTCQuery\",\n      f: parsenoop\n    },\n    0x00EF: {\n      n: \"BrtBeginPCDSDTCSets\",\n      f: parsenoop\n    },\n    0x00F0: {\n      n: \"BrtEndPCDSDTCSets\",\n      f: parsenoop\n    },\n    0x00F1: {\n      n: \"BrtBeginPCDSDTCSet\",\n      f: parsenoop\n    },\n    0x00F2: {\n      n: \"BrtEndPCDSDTCSet\",\n      f: parsenoop\n    },\n    0x00F3: {\n      n: \"BrtBeginPCDCalcItems\",\n      f: parsenoop\n    },\n    0x00F4: {\n      n: \"BrtEndPCDCalcItems\",\n      f: parsenoop\n    },\n    0x00F5: {\n      n: \"BrtBeginPCDCalcItem\",\n      f: parsenoop\n    },\n    0x00F6: {\n      n: \"BrtEndPCDCalcItem\",\n      f: parsenoop\n    },\n    0x00F7: {\n      n: \"BrtBeginPRule\",\n      f: parsenoop\n    },\n    0x00F8: {\n      n: \"BrtEndPRule\",\n      f: parsenoop\n    },\n    0x00F9: {\n      n: \"BrtBeginPRFilters\",\n      f: parsenoop\n    },\n    0x00FA: {\n      n: \"BrtEndPRFilters\",\n      f: parsenoop\n    },\n    0x00FB: {\n      n: \"BrtBeginPRFilter\",\n      f: parsenoop\n    },\n    0x00FC: {\n      n: \"BrtEndPRFilter\",\n      f: parsenoop\n    },\n    0x00FD: {\n      n: \"BrtBeginPNames\",\n      f: parsenoop\n    },\n    0x00FE: {\n      n: \"BrtEndPNames\",\n      f: parsenoop\n    },\n    0x00FF: {\n      n: \"BrtBeginPName\",\n      f: parsenoop\n    },\n    0x0100: {\n      n: \"BrtEndPName\",\n      f: parsenoop\n    },\n    0x0101: {\n      n: \"BrtBeginPNPairs\",\n      f: parsenoop\n    },\n    0x0102: {\n      n: \"BrtEndPNPairs\",\n      f: parsenoop\n    },\n    0x0103: {\n      n: \"BrtBeginPNPair\",\n      f: parsenoop\n    },\n    0x0104: {\n      n: \"BrtEndPNPair\",\n      f: parsenoop\n    },\n    0x0105: {\n      n: \"BrtBeginECWebProps\",\n      f: parsenoop\n    },\n    0x0106: {\n      n: \"BrtEndECWebProps\",\n      f: parsenoop\n    },\n    0x0107: {\n      n: \"BrtBeginEcWpTables\",\n      f: parsenoop\n    },\n    0x0108: {\n      n: \"BrtEndECWPTables\",\n      f: parsenoop\n    },\n    0x0109: {\n      n: \"BrtBeginECParams\",\n      f: parsenoop\n    },\n    0x010A: {\n      n: \"BrtEndECParams\",\n      f: parsenoop\n    },\n    0x010B: {\n      n: \"BrtBeginECParam\",\n      f: parsenoop\n    },\n    0x010C: {\n      n: \"BrtEndECParam\",\n      f: parsenoop\n    },\n    0x010D: {\n      n: \"BrtBeginPCDKPIs\",\n      f: parsenoop\n    },\n    0x010E: {\n      n: \"BrtEndPCDKPIs\",\n      f: parsenoop\n    },\n    0x010F: {\n      n: \"BrtBeginPCDKPI\",\n      f: parsenoop\n    },\n    0x0110: {\n      n: \"BrtEndPCDKPI\",\n      f: parsenoop\n    },\n    0x0111: {\n      n: \"BrtBeginDims\",\n      f: parsenoop\n    },\n    0x0112: {\n      n: \"BrtEndDims\",\n      f: parsenoop\n    },\n    0x0113: {\n      n: \"BrtBeginDim\",\n      f: parsenoop\n    },\n    0x0114: {\n      n: \"BrtEndDim\",\n      f: parsenoop\n    },\n    0x0115: {\n      n: \"BrtIndexPartEnd\",\n      f: parsenoop\n    },\n    0x0116: {\n      n: \"BrtBeginStyleSheet\",\n      f: parsenoop\n    },\n    0x0117: {\n      n: \"BrtEndStyleSheet\",\n      f: parsenoop\n    },\n    0x0118: {\n      n: \"BrtBeginSXView\",\n      f: parsenoop\n    },\n    0x0119: {\n      n: \"BrtEndSXVI\",\n      f: parsenoop\n    },\n    0x011A: {\n      n: \"BrtBeginSXVI\",\n      f: parsenoop\n    },\n    0x011B: {\n      n: \"BrtBeginSXVIs\",\n      f: parsenoop\n    },\n    0x011C: {\n      n: \"BrtEndSXVIs\",\n      f: parsenoop\n    },\n    0x011D: {\n      n: \"BrtBeginSXVD\",\n      f: parsenoop\n    },\n    0x011E: {\n      n: \"BrtEndSXVD\",\n      f: parsenoop\n    },\n    0x011F: {\n      n: \"BrtBeginSXVDs\",\n      f: parsenoop\n    },\n    0x0120: {\n      n: \"BrtEndSXVDs\",\n      f: parsenoop\n    },\n    0x0121: {\n      n: \"BrtBeginSXPI\",\n      f: parsenoop\n    },\n    0x0122: {\n      n: \"BrtEndSXPI\",\n      f: parsenoop\n    },\n    0x0123: {\n      n: \"BrtBeginSXPIs\",\n      f: parsenoop\n    },\n    0x0124: {\n      n: \"BrtEndSXPIs\",\n      f: parsenoop\n    },\n    0x0125: {\n      n: \"BrtBeginSXDI\",\n      f: parsenoop\n    },\n    0x0126: {\n      n: \"BrtEndSXDI\",\n      f: parsenoop\n    },\n    0x0127: {\n      n: \"BrtBeginSXDIs\",\n      f: parsenoop\n    },\n    0x0128: {\n      n: \"BrtEndSXDIs\",\n      f: parsenoop\n    },\n    0x0129: {\n      n: \"BrtBeginSXLI\",\n      f: parsenoop\n    },\n    0x012A: {\n      n: \"BrtEndSXLI\",\n      f: parsenoop\n    },\n    0x012B: {\n      n: \"BrtBeginSXLIRws\",\n      f: parsenoop\n    },\n    0x012C: {\n      n: \"BrtEndSXLIRws\",\n      f: parsenoop\n    },\n    0x012D: {\n      n: \"BrtBeginSXLICols\",\n      f: parsenoop\n    },\n    0x012E: {\n      n: \"BrtEndSXLICols\",\n      f: parsenoop\n    },\n    0x012F: {\n      n: \"BrtBeginSXFormat\",\n      f: parsenoop\n    },\n    0x0130: {\n      n: \"BrtEndSXFormat\",\n      f: parsenoop\n    },\n    0x0131: {\n      n: \"BrtBeginSXFormats\",\n      f: parsenoop\n    },\n    0x0132: {\n      n: \"BrtEndSxFormats\",\n      f: parsenoop\n    },\n    0x0133: {\n      n: \"BrtBeginSxSelect\",\n      f: parsenoop\n    },\n    0x0134: {\n      n: \"BrtEndSxSelect\",\n      f: parsenoop\n    },\n    0x0135: {\n      n: \"BrtBeginISXVDRws\",\n      f: parsenoop\n    },\n    0x0136: {\n      n: \"BrtEndISXVDRws\",\n      f: parsenoop\n    },\n    0x0137: {\n      n: \"BrtBeginISXVDCols\",\n      f: parsenoop\n    },\n    0x0138: {\n      n: \"BrtEndISXVDCols\",\n      f: parsenoop\n    },\n    0x0139: {\n      n: \"BrtEndSXLocation\",\n      f: parsenoop\n    },\n    0x013A: {\n      n: \"BrtBeginSXLocation\",\n      f: parsenoop\n    },\n    0x013B: {\n      n: \"BrtEndSXView\",\n      f: parsenoop\n    },\n    0x013C: {\n      n: \"BrtBeginSXTHs\",\n      f: parsenoop\n    },\n    0x013D: {\n      n: \"BrtEndSXTHs\",\n      f: parsenoop\n    },\n    0x013E: {\n      n: \"BrtBeginSXTH\",\n      f: parsenoop\n    },\n    0x013F: {\n      n: \"BrtEndSXTH\",\n      f: parsenoop\n    },\n    0x0140: {\n      n: \"BrtBeginISXTHRws\",\n      f: parsenoop\n    },\n    0x0141: {\n      n: \"BrtEndISXTHRws\",\n      f: parsenoop\n    },\n    0x0142: {\n      n: \"BrtBeginISXTHCols\",\n      f: parsenoop\n    },\n    0x0143: {\n      n: \"BrtEndISXTHCols\",\n      f: parsenoop\n    },\n    0x0144: {\n      n: \"BrtBeginSXTDMPS\",\n      f: parsenoop\n    },\n    0x0145: {\n      n: \"BrtEndSXTDMPs\",\n      f: parsenoop\n    },\n    0x0146: {\n      n: \"BrtBeginSXTDMP\",\n      f: parsenoop\n    },\n    0x0147: {\n      n: \"BrtEndSXTDMP\",\n      f: parsenoop\n    },\n    0x0148: {\n      n: \"BrtBeginSXTHItems\",\n      f: parsenoop\n    },\n    0x0149: {\n      n: \"BrtEndSXTHItems\",\n      f: parsenoop\n    },\n    0x014A: {\n      n: \"BrtBeginSXTHItem\",\n      f: parsenoop\n    },\n    0x014B: {\n      n: \"BrtEndSXTHItem\",\n      f: parsenoop\n    },\n    0x014C: {\n      n: \"BrtBeginMetadata\",\n      f: parsenoop\n    },\n    0x014D: {\n      n: \"BrtEndMetadata\",\n      f: parsenoop\n    },\n    0x014E: {\n      n: \"BrtBeginEsmdtinfo\",\n      f: parsenoop\n    },\n    0x014F: {\n      n: \"BrtMdtinfo\",\n      f: parsenoop\n    },\n    0x0150: {\n      n: \"BrtEndEsmdtinfo\",\n      f: parsenoop\n    },\n    0x0151: {\n      n: \"BrtBeginEsmdb\",\n      f: parsenoop\n    },\n    0x0152: {\n      n: \"BrtEndEsmdb\",\n      f: parsenoop\n    },\n    0x0153: {\n      n: \"BrtBeginEsfmd\",\n      f: parsenoop\n    },\n    0x0154: {\n      n: \"BrtEndEsfmd\",\n      f: parsenoop\n    },\n    0x0155: {\n      n: \"BrtBeginSingleCells\",\n      f: parsenoop\n    },\n    0x0156: {\n      n: \"BrtEndSingleCells\",\n      f: parsenoop\n    },\n    0x0157: {\n      n: \"BrtBeginList\",\n      f: parsenoop\n    },\n    0x0158: {\n      n: \"BrtEndList\",\n      f: parsenoop\n    },\n    0x0159: {\n      n: \"BrtBeginListCols\",\n      f: parsenoop\n    },\n    0x015A: {\n      n: \"BrtEndListCols\",\n      f: parsenoop\n    },\n    0x015B: {\n      n: \"BrtBeginListCol\",\n      f: parsenoop\n    },\n    0x015C: {\n      n: \"BrtEndListCol\",\n      f: parsenoop\n    },\n    0x015D: {\n      n: \"BrtBeginListXmlCPr\",\n      f: parsenoop\n    },\n    0x015E: {\n      n: \"BrtEndListXmlCPr\",\n      f: parsenoop\n    },\n    0x015F: {\n      n: \"BrtListCCFmla\",\n      f: parsenoop\n    },\n    0x0160: {\n      n: \"BrtListTrFmla\",\n      f: parsenoop\n    },\n    0x0161: {\n      n: \"BrtBeginExternals\",\n      f: parsenoop\n    },\n    0x0162: {\n      n: \"BrtEndExternals\",\n      f: parsenoop\n    },\n    0x0163: {\n      n: \"BrtSupBookSrc\",\n      f: parsenoop\n    },\n    0x0165: {\n      n: \"BrtSupSelf\",\n      f: parsenoop\n    },\n    0x0166: {\n      n: \"BrtSupSame\",\n      f: parsenoop\n    },\n    0x0167: {\n      n: \"BrtSupTabs\",\n      f: parsenoop\n    },\n    0x0168: {\n      n: \"BrtBeginSupBook\",\n      f: parsenoop\n    },\n    0x0169: {\n      n: \"BrtPlaceholderName\",\n      f: parsenoop\n    },\n    0x016A: {\n      n: \"BrtExternSheet\",\n      f: parsenoop\n    },\n    0x016B: {\n      n: \"BrtExternTableStart\",\n      f: parsenoop\n    },\n    0x016C: {\n      n: \"BrtExternTableEnd\",\n      f: parsenoop\n    },\n    0x016E: {\n      n: \"BrtExternRowHdr\",\n      f: parsenoop\n    },\n    0x016F: {\n      n: \"BrtExternCellBlank\",\n      f: parsenoop\n    },\n    0x0170: {\n      n: \"BrtExternCellReal\",\n      f: parsenoop\n    },\n    0x0171: {\n      n: \"BrtExternCellBool\",\n      f: parsenoop\n    },\n    0x0172: {\n      n: \"BrtExternCellError\",\n      f: parsenoop\n    },\n    0x0173: {\n      n: \"BrtExternCellString\",\n      f: parsenoop\n    },\n    0x0174: {\n      n: \"BrtBeginEsmdx\",\n      f: parsenoop\n    },\n    0x0175: {\n      n: \"BrtEndEsmdx\",\n      f: parsenoop\n    },\n    0x0176: {\n      n: \"BrtBeginMdxSet\",\n      f: parsenoop\n    },\n    0x0177: {\n      n: \"BrtEndMdxSet\",\n      f: parsenoop\n    },\n    0x0178: {\n      n: \"BrtBeginMdxMbrProp\",\n      f: parsenoop\n    },\n    0x0179: {\n      n: \"BrtEndMdxMbrProp\",\n      f: parsenoop\n    },\n    0x017A: {\n      n: \"BrtBeginMdxKPI\",\n      f: parsenoop\n    },\n    0x017B: {\n      n: \"BrtEndMdxKPI\",\n      f: parsenoop\n    },\n    0x017C: {\n      n: \"BrtBeginEsstr\",\n      f: parsenoop\n    },\n    0x017D: {\n      n: \"BrtEndEsstr\",\n      f: parsenoop\n    },\n    0x017E: {\n      n: \"BrtBeginPRFItem\",\n      f: parsenoop\n    },\n    0x017F: {\n      n: \"BrtEndPRFItem\",\n      f: parsenoop\n    },\n    0x0180: {\n      n: \"BrtBeginPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0181: {\n      n: \"BrtEndPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0182: {\n      n: \"BrtBeginPivotCacheID\",\n      f: parsenoop\n    },\n    0x0183: {\n      n: \"BrtEndPivotCacheID\",\n      f: parsenoop\n    },\n    0x0184: {\n      n: \"BrtBeginISXVIs\",\n      f: parsenoop\n    },\n    0x0185: {\n      n: \"BrtEndISXVIs\",\n      f: parsenoop\n    },\n    0x0186: {\n      n: \"BrtBeginColInfos\",\n      f: parsenoop\n    },\n    0x0187: {\n      n: \"BrtEndColInfos\",\n      f: parsenoop\n    },\n    0x0188: {\n      n: \"BrtBeginRwBrk\",\n      f: parsenoop\n    },\n    0x0189: {\n      n: \"BrtEndRwBrk\",\n      f: parsenoop\n    },\n    0x018A: {\n      n: \"BrtBeginColBrk\",\n      f: parsenoop\n    },\n    0x018B: {\n      n: \"BrtEndColBrk\",\n      f: parsenoop\n    },\n    0x018C: {\n      n: \"BrtBrk\",\n      f: parsenoop\n    },\n    0x018D: {\n      n: \"BrtUserBookView\",\n      f: parsenoop\n    },\n    0x018E: {\n      n: \"BrtInfo\",\n      f: parsenoop\n    },\n    0x018F: {\n      n: \"BrtCUsr\",\n      f: parsenoop\n    },\n    0x0190: {\n      n: \"BrtUsr\",\n      f: parsenoop\n    },\n    0x0191: {\n      n: \"BrtBeginUsers\",\n      f: parsenoop\n    },\n    0x0193: {\n      n: \"BrtEOF\",\n      f: parsenoop\n    },\n    0x0194: {\n      n: \"BrtUCR\",\n      f: parsenoop\n    },\n    0x0195: {\n      n: \"BrtRRInsDel\",\n      f: parsenoop\n    },\n    0x0196: {\n      n: \"BrtRREndInsDel\",\n      f: parsenoop\n    },\n    0x0197: {\n      n: \"BrtRRMove\",\n      f: parsenoop\n    },\n    0x0198: {\n      n: \"BrtRREndMove\",\n      f: parsenoop\n    },\n    0x0199: {\n      n: \"BrtRRChgCell\",\n      f: parsenoop\n    },\n    0x019A: {\n      n: \"BrtRREndChgCell\",\n      f: parsenoop\n    },\n    0x019B: {\n      n: \"BrtRRHeader\",\n      f: parsenoop\n    },\n    0x019C: {\n      n: \"BrtRRUserView\",\n      f: parsenoop\n    },\n    0x019D: {\n      n: \"BrtRRRenSheet\",\n      f: parsenoop\n    },\n    0x019E: {\n      n: \"BrtRRInsertSh\",\n      f: parsenoop\n    },\n    0x019F: {\n      n: \"BrtRRDefName\",\n      f: parsenoop\n    },\n    0x01A0: {\n      n: \"BrtRRNote\",\n      f: parsenoop\n    },\n    0x01A1: {\n      n: \"BrtRRConflict\",\n      f: parsenoop\n    },\n    0x01A2: {\n      n: \"BrtRRTQSIF\",\n      f: parsenoop\n    },\n    0x01A3: {\n      n: \"BrtRRFormat\",\n      f: parsenoop\n    },\n    0x01A4: {\n      n: \"BrtRREndFormat\",\n      f: parsenoop\n    },\n    0x01A5: {\n      n: \"BrtRRAutoFmt\",\n      f: parsenoop\n    },\n    0x01A6: {\n      n: \"BrtBeginUserShViews\",\n      f: parsenoop\n    },\n    0x01A7: {\n      n: \"BrtBeginUserShView\",\n      f: parsenoop\n    },\n    0x01A8: {\n      n: \"BrtEndUserShView\",\n      f: parsenoop\n    },\n    0x01A9: {\n      n: \"BrtEndUserShViews\",\n      f: parsenoop\n    },\n    0x01AA: {\n      n: \"BrtArrFmla\",\n      f: parsenoop\n    },\n    0x01AB: {\n      n: \"BrtShrFmla\",\n      f: parsenoop\n    },\n    0x01AC: {\n      n: \"BrtTable\",\n      f: parsenoop\n    },\n    0x01AD: {\n      n: \"BrtBeginExtConnections\",\n      f: parsenoop\n    },\n    0x01AE: {\n      n: \"BrtEndExtConnections\",\n      f: parsenoop\n    },\n    0x01AF: {\n      n: \"BrtBeginPCDCalcMems\",\n      f: parsenoop\n    },\n    0x01B0: {\n      n: \"BrtEndPCDCalcMems\",\n      f: parsenoop\n    },\n    0x01B1: {\n      n: \"BrtBeginPCDCalcMem\",\n      f: parsenoop\n    },\n    0x01B2: {\n      n: \"BrtEndPCDCalcMem\",\n      f: parsenoop\n    },\n    0x01B3: {\n      n: \"BrtBeginPCDHGLevels\",\n      f: parsenoop\n    },\n    0x01B4: {\n      n: \"BrtEndPCDHGLevels\",\n      f: parsenoop\n    },\n    0x01B5: {\n      n: \"BrtBeginPCDHGLevel\",\n      f: parsenoop\n    },\n    0x01B6: {\n      n: \"BrtEndPCDHGLevel\",\n      f: parsenoop\n    },\n    0x01B7: {\n      n: \"BrtBeginPCDHGLGroups\",\n      f: parsenoop\n    },\n    0x01B8: {\n      n: \"BrtEndPCDHGLGroups\",\n      f: parsenoop\n    },\n    0x01B9: {\n      n: \"BrtBeginPCDHGLGroup\",\n      f: parsenoop\n    },\n    0x01BA: {\n      n: \"BrtEndPCDHGLGroup\",\n      f: parsenoop\n    },\n    0x01BB: {\n      n: \"BrtBeginPCDHGLGMembers\",\n      f: parsenoop\n    },\n    0x01BC: {\n      n: \"BrtEndPCDHGLGMembers\",\n      f: parsenoop\n    },\n    0x01BD: {\n      n: \"BrtBeginPCDHGLGMember\",\n      f: parsenoop\n    },\n    0x01BE: {\n      n: \"BrtEndPCDHGLGMember\",\n      f: parsenoop\n    },\n    0x01BF: {\n      n: \"BrtBeginQSI\",\n      f: parsenoop\n    },\n    0x01C0: {\n      n: \"BrtEndQSI\",\n      f: parsenoop\n    },\n    0x01C1: {\n      n: \"BrtBeginQSIR\",\n      f: parsenoop\n    },\n    0x01C2: {\n      n: \"BrtEndQSIR\",\n      f: parsenoop\n    },\n    0x01C3: {\n      n: \"BrtBeginDeletedNames\",\n      f: parsenoop\n    },\n    0x01C4: {\n      n: \"BrtEndDeletedNames\",\n      f: parsenoop\n    },\n    0x01C5: {\n      n: \"BrtBeginDeletedName\",\n      f: parsenoop\n    },\n    0x01C6: {\n      n: \"BrtEndDeletedName\",\n      f: parsenoop\n    },\n    0x01C7: {\n      n: \"BrtBeginQSIFs\",\n      f: parsenoop\n    },\n    0x01C8: {\n      n: \"BrtEndQSIFs\",\n      f: parsenoop\n    },\n    0x01C9: {\n      n: \"BrtBeginQSIF\",\n      f: parsenoop\n    },\n    0x01CA: {\n      n: \"BrtEndQSIF\",\n      f: parsenoop\n    },\n    0x01CB: {\n      n: \"BrtBeginAutoSortScope\",\n      f: parsenoop\n    },\n    0x01CC: {\n      n: \"BrtEndAutoSortScope\",\n      f: parsenoop\n    },\n    0x01CD: {\n      n: \"BrtBeginConditionalFormatting\",\n      f: parsenoop\n    },\n    0x01CE: {\n      n: \"BrtEndConditionalFormatting\",\n      f: parsenoop\n    },\n    0x01CF: {\n      n: \"BrtBeginCFRule\",\n      f: parsenoop\n    },\n    0x01D0: {\n      n: \"BrtEndCFRule\",\n      f: parsenoop\n    },\n    0x01D1: {\n      n: \"BrtBeginIconSet\",\n      f: parsenoop\n    },\n    0x01D2: {\n      n: \"BrtEndIconSet\",\n      f: parsenoop\n    },\n    0x01D3: {\n      n: \"BrtBeginDatabar\",\n      f: parsenoop\n    },\n    0x01D4: {\n      n: \"BrtEndDatabar\",\n      f: parsenoop\n    },\n    0x01D5: {\n      n: \"BrtBeginColorScale\",\n      f: parsenoop\n    },\n    0x01D6: {\n      n: \"BrtEndColorScale\",\n      f: parsenoop\n    },\n    0x01D7: {\n      n: \"BrtCFVO\",\n      f: parsenoop\n    },\n    0x01D8: {\n      n: \"BrtExternValueMeta\",\n      f: parsenoop\n    },\n    0x01D9: {\n      n: \"BrtBeginColorPalette\",\n      f: parsenoop\n    },\n    0x01DA: {\n      n: \"BrtEndColorPalette\",\n      f: parsenoop\n    },\n    0x01DB: {\n      n: \"BrtIndexedColor\",\n      f: parsenoop\n    },\n    0x01DC: {\n      n: \"BrtMargins\",\n      f: parsenoop\n    },\n    0x01DD: {\n      n: \"BrtPrintOptions\",\n      f: parsenoop\n    },\n    0x01DE: {\n      n: \"BrtPageSetup\",\n      f: parsenoop\n    },\n    0x01DF: {\n      n: \"BrtBeginHeaderFooter\",\n      f: parsenoop\n    },\n    0x01E0: {\n      n: \"BrtEndHeaderFooter\",\n      f: parsenoop\n    },\n    0x01E1: {\n      n: \"BrtBeginSXCrtFormat\",\n      f: parsenoop\n    },\n    0x01E2: {\n      n: \"BrtEndSXCrtFormat\",\n      f: parsenoop\n    },\n    0x01E3: {\n      n: \"BrtBeginSXCrtFormats\",\n      f: parsenoop\n    },\n    0x01E4: {\n      n: \"BrtEndSXCrtFormats\",\n      f: parsenoop\n    },\n    0x01E5: {\n      n: \"BrtWsFmtInfo\",\n      f: parsenoop\n    },\n    0x01E6: {\n      n: \"BrtBeginMgs\",\n      f: parsenoop\n    },\n    0x01E7: {\n      n: \"BrtEndMGs\",\n      f: parsenoop\n    },\n    0x01E8: {\n      n: \"BrtBeginMGMaps\",\n      f: parsenoop\n    },\n    0x01E9: {\n      n: \"BrtEndMGMaps\",\n      f: parsenoop\n    },\n    0x01EA: {\n      n: \"BrtBeginMG\",\n      f: parsenoop\n    },\n    0x01EB: {\n      n: \"BrtEndMG\",\n      f: parsenoop\n    },\n    0x01EC: {\n      n: \"BrtBeginMap\",\n      f: parsenoop\n    },\n    0x01ED: {\n      n: \"BrtEndMap\",\n      f: parsenoop\n    },\n    0x01EE: {\n      n: \"BrtHLink\",\n      f: parse_BrtHLink\n    },\n    0x01EF: {\n      n: \"BrtBeginDCon\",\n      f: parsenoop\n    },\n    0x01F0: {\n      n: \"BrtEndDCon\",\n      f: parsenoop\n    },\n    0x01F1: {\n      n: \"BrtBeginDRefs\",\n      f: parsenoop\n    },\n    0x01F2: {\n      n: \"BrtEndDRefs\",\n      f: parsenoop\n    },\n    0x01F3: {\n      n: \"BrtDRef\",\n      f: parsenoop\n    },\n    0x01F4: {\n      n: \"BrtBeginScenMan\",\n      f: parsenoop\n    },\n    0x01F5: {\n      n: \"BrtEndScenMan\",\n      f: parsenoop\n    },\n    0x01F6: {\n      n: \"BrtBeginSct\",\n      f: parsenoop\n    },\n    0x01F7: {\n      n: \"BrtEndSct\",\n      f: parsenoop\n    },\n    0x01F8: {\n      n: \"BrtSlc\",\n      f: parsenoop\n    },\n    0x01F9: {\n      n: \"BrtBeginDXFs\",\n      f: parsenoop\n    },\n    0x01FA: {\n      n: \"BrtEndDXFs\",\n      f: parsenoop\n    },\n    0x01FB: {\n      n: \"BrtDXF\",\n      f: parsenoop\n    },\n    0x01FC: {\n      n: \"BrtBeginTableStyles\",\n      f: parsenoop\n    },\n    0x01FD: {\n      n: \"BrtEndTableStyles\",\n      f: parsenoop\n    },\n    0x01FE: {\n      n: \"BrtBeginTableStyle\",\n      f: parsenoop\n    },\n    0x01FF: {\n      n: \"BrtEndTableStyle\",\n      f: parsenoop\n    },\n    0x0200: {\n      n: \"BrtTableStyleElement\",\n      f: parsenoop\n    },\n    0x0201: {\n      n: \"BrtTableStyleClient\",\n      f: parsenoop\n    },\n    0x0202: {\n      n: \"BrtBeginVolDeps\",\n      f: parsenoop\n    },\n    0x0203: {\n      n: \"BrtEndVolDeps\",\n      f: parsenoop\n    },\n    0x0204: {\n      n: \"BrtBeginVolType\",\n      f: parsenoop\n    },\n    0x0205: {\n      n: \"BrtEndVolType\",\n      f: parsenoop\n    },\n    0x0206: {\n      n: \"BrtBeginVolMain\",\n      f: parsenoop\n    },\n    0x0207: {\n      n: \"BrtEndVolMain\",\n      f: parsenoop\n    },\n    0x0208: {\n      n: \"BrtBeginVolTopic\",\n      f: parsenoop\n    },\n    0x0209: {\n      n: \"BrtEndVolTopic\",\n      f: parsenoop\n    },\n    0x020A: {\n      n: \"BrtVolSubtopic\",\n      f: parsenoop\n    },\n    0x020B: {\n      n: \"BrtVolRef\",\n      f: parsenoop\n    },\n    0x020C: {\n      n: \"BrtVolNum\",\n      f: parsenoop\n    },\n    0x020D: {\n      n: \"BrtVolErr\",\n      f: parsenoop\n    },\n    0x020E: {\n      n: \"BrtVolStr\",\n      f: parsenoop\n    },\n    0x020F: {\n      n: \"BrtVolBool\",\n      f: parsenoop\n    },\n    0x0210: {\n      n: \"BrtBeginCalcChain$\",\n      f: parsenoop\n    },\n    0x0211: {\n      n: \"BrtEndCalcChain$\",\n      f: parsenoop\n    },\n    0x0212: {\n      n: \"BrtBeginSortState\",\n      f: parsenoop\n    },\n    0x0213: {\n      n: \"BrtEndSortState\",\n      f: parsenoop\n    },\n    0x0214: {\n      n: \"BrtBeginSortCond\",\n      f: parsenoop\n    },\n    0x0215: {\n      n: \"BrtEndSortCond\",\n      f: parsenoop\n    },\n    0x0216: {\n      n: \"BrtBookProtection\",\n      f: parsenoop\n    },\n    0x0217: {\n      n: \"BrtSheetProtection\",\n      f: parsenoop\n    },\n    0x0218: {\n      n: \"BrtRangeProtection\",\n      f: parsenoop\n    },\n    0x0219: {\n      n: \"BrtPhoneticInfo\",\n      f: parsenoop\n    },\n    0x021A: {\n      n: \"BrtBeginECTxtWiz\",\n      f: parsenoop\n    },\n    0x021B: {\n      n: \"BrtEndECTxtWiz\",\n      f: parsenoop\n    },\n    0x021C: {\n      n: \"BrtBeginECTWFldInfoLst\",\n      f: parsenoop\n    },\n    0x021D: {\n      n: \"BrtEndECTWFldInfoLst\",\n      f: parsenoop\n    },\n    0x021E: {\n      n: \"BrtBeginECTwFldInfo\",\n      f: parsenoop\n    },\n    0x0224: {\n      n: \"BrtFileSharing\",\n      f: parsenoop\n    },\n    0x0225: {\n      n: \"BrtOleSize\",\n      f: parsenoop\n    },\n    0x0226: {\n      n: \"BrtDrawing\",\n      f: parsenoop\n    },\n    0x0227: {\n      n: \"BrtLegacyDrawing\",\n      f: parsenoop\n    },\n    0x0228: {\n      n: \"BrtLegacyDrawingHF\",\n      f: parsenoop\n    },\n    0x0229: {\n      n: \"BrtWebOpt\",\n      f: parsenoop\n    },\n    0x022A: {\n      n: \"BrtBeginWebPubItems\",\n      f: parsenoop\n    },\n    0x022B: {\n      n: \"BrtEndWebPubItems\",\n      f: parsenoop\n    },\n    0x022C: {\n      n: \"BrtBeginWebPubItem\",\n      f: parsenoop\n    },\n    0x022D: {\n      n: \"BrtEndWebPubItem\",\n      f: parsenoop\n    },\n    0x022E: {\n      n: \"BrtBeginSXCondFmt\",\n      f: parsenoop\n    },\n    0x022F: {\n      n: \"BrtEndSXCondFmt\",\n      f: parsenoop\n    },\n    0x0230: {\n      n: \"BrtBeginSXCondFmts\",\n      f: parsenoop\n    },\n    0x0231: {\n      n: \"BrtEndSXCondFmts\",\n      f: parsenoop\n    },\n    0x0232: {\n      n: \"BrtBkHim\",\n      f: parsenoop\n    },\n    0x0234: {\n      n: \"BrtColor\",\n      f: parsenoop\n    },\n    0x0235: {\n      n: \"BrtBeginIndexedColors\",\n      f: parsenoop\n    },\n    0x0236: {\n      n: \"BrtEndIndexedColors\",\n      f: parsenoop\n    },\n    0x0239: {\n      n: \"BrtBeginMRUColors\",\n      f: parsenoop\n    },\n    0x023A: {\n      n: \"BrtEndMRUColors\",\n      f: parsenoop\n    },\n    0x023C: {\n      n: \"BrtMRUColor\",\n      f: parsenoop\n    },\n    0x023D: {\n      n: \"BrtBeginDVals\",\n      f: parsenoop\n    },\n    0x023E: {\n      n: \"BrtEndDVals\",\n      f: parsenoop\n    },\n    0x0241: {\n      n: \"BrtSupNameStart\",\n      f: parsenoop\n    },\n    0x0242: {\n      n: \"BrtSupNameValueStart\",\n      f: parsenoop\n    },\n    0x0243: {\n      n: \"BrtSupNameValueEnd\",\n      f: parsenoop\n    },\n    0x0244: {\n      n: \"BrtSupNameNum\",\n      f: parsenoop\n    },\n    0x0245: {\n      n: \"BrtSupNameErr\",\n      f: parsenoop\n    },\n    0x0246: {\n      n: \"BrtSupNameSt\",\n      f: parsenoop\n    },\n    0x0247: {\n      n: \"BrtSupNameNil\",\n      f: parsenoop\n    },\n    0x0248: {\n      n: \"BrtSupNameBool\",\n      f: parsenoop\n    },\n    0x0249: {\n      n: \"BrtSupNameFmla\",\n      f: parsenoop\n    },\n    0x024A: {\n      n: \"BrtSupNameBits\",\n      f: parsenoop\n    },\n    0x024B: {\n      n: \"BrtSupNameEnd\",\n      f: parsenoop\n    },\n    0x024C: {\n      n: \"BrtEndSupBook\",\n      f: parsenoop\n    },\n    0x024D: {\n      n: \"BrtCellSmartTagProperty\",\n      f: parsenoop\n    },\n    0x024E: {\n      n: \"BrtBeginCellSmartTag\",\n      f: parsenoop\n    },\n    0x024F: {\n      n: \"BrtEndCellSmartTag\",\n      f: parsenoop\n    },\n    0x0250: {\n      n: \"BrtBeginCellSmartTags\",\n      f: parsenoop\n    },\n    0x0251: {\n      n: \"BrtEndCellSmartTags\",\n      f: parsenoop\n    },\n    0x0252: {\n      n: \"BrtBeginSmartTags\",\n      f: parsenoop\n    },\n    0x0253: {\n      n: \"BrtEndSmartTags\",\n      f: parsenoop\n    },\n    0x0254: {\n      n: \"BrtSmartTagType\",\n      f: parsenoop\n    },\n    0x0255: {\n      n: \"BrtBeginSmartTagTypes\",\n      f: parsenoop\n    },\n    0x0256: {\n      n: \"BrtEndSmartTagTypes\",\n      f: parsenoop\n    },\n    0x0257: {\n      n: \"BrtBeginSXFilters\",\n      f: parsenoop\n    },\n    0x0258: {\n      n: \"BrtEndSXFilters\",\n      f: parsenoop\n    },\n    0x0259: {\n      n: \"BrtBeginSXFILTER\",\n      f: parsenoop\n    },\n    0x025A: {\n      n: \"BrtEndSXFilter\",\n      f: parsenoop\n    },\n    0x025B: {\n      n: \"BrtBeginFills\",\n      f: parsenoop\n    },\n    0x025C: {\n      n: \"BrtEndFills\",\n      f: parsenoop\n    },\n    0x025D: {\n      n: \"BrtBeginCellWatches\",\n      f: parsenoop\n    },\n    0x025E: {\n      n: \"BrtEndCellWatches\",\n      f: parsenoop\n    },\n    0x025F: {\n      n: \"BrtCellWatch\",\n      f: parsenoop\n    },\n    0x0260: {\n      n: \"BrtBeginCRErrs\",\n      f: parsenoop\n    },\n    0x0261: {\n      n: \"BrtEndCRErrs\",\n      f: parsenoop\n    },\n    0x0262: {\n      n: \"BrtCrashRecErr\",\n      f: parsenoop\n    },\n    0x0263: {\n      n: \"BrtBeginFonts\",\n      f: parsenoop\n    },\n    0x0264: {\n      n: \"BrtEndFonts\",\n      f: parsenoop\n    },\n    0x0265: {\n      n: \"BrtBeginBorders\",\n      f: parsenoop\n    },\n    0x0266: {\n      n: \"BrtEndBorders\",\n      f: parsenoop\n    },\n    0x0267: {\n      n: \"BrtBeginFmts\",\n      f: parsenoop\n    },\n    0x0268: {\n      n: \"BrtEndFmts\",\n      f: parsenoop\n    },\n    0x0269: {\n      n: \"BrtBeginCellXFs\",\n      f: parsenoop\n    },\n    0x026A: {\n      n: \"BrtEndCellXFs\",\n      f: parsenoop\n    },\n    0x026B: {\n      n: \"BrtBeginStyles\",\n      f: parsenoop\n    },\n    0x026C: {\n      n: \"BrtEndStyles\",\n      f: parsenoop\n    },\n    0x0271: {\n      n: \"BrtBigName\",\n      f: parsenoop\n    },\n    0x0272: {\n      n: \"BrtBeginCellStyleXFs\",\n      f: parsenoop\n    },\n    0x0273: {\n      n: \"BrtEndCellStyleXFs\",\n      f: parsenoop\n    },\n    0x0274: {\n      n: \"BrtBeginComments\",\n      f: parsenoop\n    },\n    0x0275: {\n      n: \"BrtEndComments\",\n      f: parsenoop\n    },\n    0x0276: {\n      n: \"BrtBeginCommentAuthors\",\n      f: parsenoop\n    },\n    0x0277: {\n      n: \"BrtEndCommentAuthors\",\n      f: parsenoop\n    },\n    0x0278: {\n      n: \"BrtCommentAuthor\",\n      f: parse_BrtCommentAuthor\n    },\n    0x0279: {\n      n: \"BrtBeginCommentList\",\n      f: parsenoop\n    },\n    0x027A: {\n      n: \"BrtEndCommentList\",\n      f: parsenoop\n    },\n    0x027B: {\n      n: \"BrtBeginComment\",\n      f: parse_BrtBeginComment\n    },\n    0x027C: {\n      n: \"BrtEndComment\",\n      f: parsenoop\n    },\n    0x027D: {\n      n: \"BrtCommentText\",\n      f: parse_BrtCommentText\n    },\n    0x027E: {\n      n: \"BrtBeginOleObjects\",\n      f: parsenoop\n    },\n    0x027F: {\n      n: \"BrtOleObject\",\n      f: parsenoop\n    },\n    0x0280: {\n      n: \"BrtEndOleObjects\",\n      f: parsenoop\n    },\n    0x0281: {\n      n: \"BrtBeginSxrules\",\n      f: parsenoop\n    },\n    0x0282: {\n      n: \"BrtEndSxRules\",\n      f: parsenoop\n    },\n    0x0283: {\n      n: \"BrtBeginActiveXControls\",\n      f: parsenoop\n    },\n    0x0284: {\n      n: \"BrtActiveX\",\n      f: parsenoop\n    },\n    0x0285: {\n      n: \"BrtEndActiveXControls\",\n      f: parsenoop\n    },\n    0x0286: {\n      n: \"BrtBeginPCDSDTCEMembersSortBy\",\n      f: parsenoop\n    },\n    0x0288: {\n      n: \"BrtBeginCellIgnoreECs\",\n      f: parsenoop\n    },\n    0x0289: {\n      n: \"BrtCellIgnoreEC\",\n      f: parsenoop\n    },\n    0x028A: {\n      n: \"BrtEndCellIgnoreECs\",\n      f: parsenoop\n    },\n    0x028B: {\n      n: \"BrtCsProp\",\n      f: parsenoop\n    },\n    0x028C: {\n      n: \"BrtCsPageSetup\",\n      f: parsenoop\n    },\n    0x028D: {\n      n: \"BrtBeginUserCsViews\",\n      f: parsenoop\n    },\n    0x028E: {\n      n: \"BrtEndUserCsViews\",\n      f: parsenoop\n    },\n    0x028F: {\n      n: \"BrtBeginUserCsView\",\n      f: parsenoop\n    },\n    0x0290: {\n      n: \"BrtEndUserCsView\",\n      f: parsenoop\n    },\n    0x0291: {\n      n: \"BrtBeginPcdSFCIEntries\",\n      f: parsenoop\n    },\n    0x0292: {\n      n: \"BrtEndPCDSFCIEntries\",\n      f: parsenoop\n    },\n    0x0293: {\n      n: \"BrtPCDSFCIEntry\",\n      f: parsenoop\n    },\n    0x0294: {\n      n: \"BrtBeginListParts\",\n      f: parsenoop\n    },\n    0x0295: {\n      n: \"BrtListPart\",\n      f: parsenoop\n    },\n    0x0296: {\n      n: \"BrtEndListParts\",\n      f: parsenoop\n    },\n    0x0297: {\n      n: \"BrtSheetCalcProp\",\n      f: parsenoop\n    },\n    0x0298: {\n      n: \"BrtBeginFnGroup\",\n      f: parsenoop\n    },\n    0x0299: {\n      n: \"BrtFnGroup\",\n      f: parsenoop\n    },\n    0x029A: {\n      n: \"BrtEndFnGroup\",\n      f: parsenoop\n    },\n    0x029B: {\n      n: \"BrtSupAddin\",\n      f: parsenoop\n    },\n    0x029C: {\n      n: \"BrtSXTDMPOrder\",\n      f: parsenoop\n    },\n    0x029D: {\n      n: \"BrtCsProtection\",\n      f: parsenoop\n    },\n    0x029F: {\n      n: \"BrtBeginWsSortMap\",\n      f: parsenoop\n    },\n    0x02A0: {\n      n: \"BrtEndWsSortMap\",\n      f: parsenoop\n    },\n    0x02A1: {\n      n: \"BrtBeginRRSort\",\n      f: parsenoop\n    },\n    0x02A2: {\n      n: \"BrtEndRRSort\",\n      f: parsenoop\n    },\n    0x02A3: {\n      n: \"BrtRRSortItem\",\n      f: parsenoop\n    },\n    0x02A4: {\n      n: \"BrtFileSharingIso\",\n      f: parsenoop\n    },\n    0x02A5: {\n      n: \"BrtBookProtectionIso\",\n      f: parsenoop\n    },\n    0x02A6: {\n      n: \"BrtSheetProtectionIso\",\n      f: parsenoop\n    },\n    0x02A7: {\n      n: \"BrtCsProtectionIso\",\n      f: parsenoop\n    },\n    0x02A8: {\n      n: \"BrtRangeProtectionIso\",\n      f: parsenoop\n    },\n    0x0400: {\n      n: \"BrtRwDescent\",\n      f: parsenoop\n    },\n    0x0401: {\n      n: \"BrtKnownFonts\",\n      f: parsenoop\n    },\n    0x0402: {\n      n: \"BrtBeginSXTupleSet\",\n      f: parsenoop\n    },\n    0x0403: {\n      n: \"BrtEndSXTupleSet\",\n      f: parsenoop\n    },\n    0x0404: {\n      n: \"BrtBeginSXTupleSetHeader\",\n      f: parsenoop\n    },\n    0x0405: {\n      n: \"BrtEndSXTupleSetHeader\",\n      f: parsenoop\n    },\n    0x0406: {\n      n: \"BrtSXTupleSetHeaderItem\",\n      f: parsenoop\n    },\n    0x0407: {\n      n: \"BrtBeginSXTupleSetData\",\n      f: parsenoop\n    },\n    0x0408: {\n      n: \"BrtEndSXTupleSetData\",\n      f: parsenoop\n    },\n    0x0409: {\n      n: \"BrtBeginSXTupleSetRow\",\n      f: parsenoop\n    },\n    0x040A: {\n      n: \"BrtEndSXTupleSetRow\",\n      f: parsenoop\n    },\n    0x040B: {\n      n: \"BrtSXTupleSetRowItem\",\n      f: parsenoop\n    },\n    0x040C: {\n      n: \"BrtNameExt\",\n      f: parsenoop\n    },\n    0x040D: {\n      n: \"BrtPCDH14\",\n      f: parsenoop\n    },\n    0x040E: {\n      n: \"BrtBeginPCDCalcMem14\",\n      f: parsenoop\n    },\n    0x040F: {\n      n: \"BrtEndPCDCalcMem14\",\n      f: parsenoop\n    },\n    0x0410: {\n      n: \"BrtSXTH14\",\n      f: parsenoop\n    },\n    0x0411: {\n      n: \"BrtBeginSparklineGroup\",\n      f: parsenoop\n    },\n    0x0412: {\n      n: \"BrtEndSparklineGroup\",\n      f: parsenoop\n    },\n    0x0413: {\n      n: \"BrtSparkline\",\n      f: parsenoop\n    },\n    0x0414: {\n      n: \"BrtSXDI14\",\n      f: parsenoop\n    },\n    0x0415: {\n      n: \"BrtWsFmtInfoEx14\",\n      f: parsenoop\n    },\n    0x0416: {\n      n: \"BrtBeginConditionalFormatting14\",\n      f: parsenoop\n    },\n    0x0417: {\n      n: \"BrtEndConditionalFormatting14\",\n      f: parsenoop\n    },\n    0x0418: {\n      n: \"BrtBeginCFRule14\",\n      f: parsenoop\n    },\n    0x0419: {\n      n: \"BrtEndCFRule14\",\n      f: parsenoop\n    },\n    0x041A: {\n      n: \"BrtCFVO14\",\n      f: parsenoop\n    },\n    0x041B: {\n      n: \"BrtBeginDatabar14\",\n      f: parsenoop\n    },\n    0x041C: {\n      n: \"BrtBeginIconSet14\",\n      f: parsenoop\n    },\n    0x041D: {\n      n: \"BrtDVal14\",\n      f: parsenoop\n    },\n    0x041E: {\n      n: \"BrtBeginDVals14\",\n      f: parsenoop\n    },\n    0x041F: {\n      n: \"BrtColor14\",\n      f: parsenoop\n    },\n    0x0420: {\n      n: \"BrtBeginSparklines\",\n      f: parsenoop\n    },\n    0x0421: {\n      n: \"BrtEndSparklines\",\n      f: parsenoop\n    },\n    0x0422: {\n      n: \"BrtBeginSparklineGroups\",\n      f: parsenoop\n    },\n    0x0423: {\n      n: \"BrtEndSparklineGroups\",\n      f: parsenoop\n    },\n    0x0425: {\n      n: \"BrtSXVD14\",\n      f: parsenoop\n    },\n    0x0426: {\n      n: \"BrtBeginSxview14\",\n      f: parsenoop\n    },\n    0x0427: {\n      n: \"BrtEndSxview14\",\n      f: parsenoop\n    },\n    0x042A: {\n      n: \"BrtBeginPCD14\",\n      f: parsenoop\n    },\n    0x042B: {\n      n: \"BrtEndPCD14\",\n      f: parsenoop\n    },\n    0x042C: {\n      n: \"BrtBeginExtConn14\",\n      f: parsenoop\n    },\n    0x042D: {\n      n: \"BrtEndExtConn14\",\n      f: parsenoop\n    },\n    0x042E: {\n      n: \"BrtBeginSlicerCacheIDs\",\n      f: parsenoop\n    },\n    0x042F: {\n      n: \"BrtEndSlicerCacheIDs\",\n      f: parsenoop\n    },\n    0x0430: {\n      n: \"BrtBeginSlicerCacheID\",\n      f: parsenoop\n    },\n    0x0431: {\n      n: \"BrtEndSlicerCacheID\",\n      f: parsenoop\n    },\n    0x0433: {\n      n: \"BrtBeginSlicerCache\",\n      f: parsenoop\n    },\n    0x0434: {\n      n: \"BrtEndSlicerCache\",\n      f: parsenoop\n    },\n    0x0435: {\n      n: \"BrtBeginSlicerCacheDef\",\n      f: parsenoop\n    },\n    0x0436: {\n      n: \"BrtEndSlicerCacheDef\",\n      f: parsenoop\n    },\n    0x0437: {\n      n: \"BrtBeginSlicersEx\",\n      f: parsenoop\n    },\n    0x0438: {\n      n: \"BrtEndSlicersEx\",\n      f: parsenoop\n    },\n    0x0439: {\n      n: \"BrtBeginSlicerEx\",\n      f: parsenoop\n    },\n    0x043A: {\n      n: \"BrtEndSlicerEx\",\n      f: parsenoop\n    },\n    0x043B: {\n      n: \"BrtBeginSlicer\",\n      f: parsenoop\n    },\n    0x043C: {\n      n: \"BrtEndSlicer\",\n      f: parsenoop\n    },\n    0x043D: {\n      n: \"BrtSlicerCachePivotTables\",\n      f: parsenoop\n    },\n    0x043E: {\n      n: \"BrtBeginSlicerCacheOlapImpl\",\n      f: parsenoop\n    },\n    0x043F: {\n      n: \"BrtEndSlicerCacheOlapImpl\",\n      f: parsenoop\n    },\n    0x0440: {\n      n: \"BrtBeginSlicerCacheLevelsData\",\n      f: parsenoop\n    },\n    0x0441: {\n      n: \"BrtEndSlicerCacheLevelsData\",\n      f: parsenoop\n    },\n    0x0442: {\n      n: \"BrtBeginSlicerCacheLevelData\",\n      f: parsenoop\n    },\n    0x0443: {\n      n: \"BrtEndSlicerCacheLevelData\",\n      f: parsenoop\n    },\n    0x0444: {\n      n: \"BrtBeginSlicerCacheSiRanges\",\n      f: parsenoop\n    },\n    0x0445: {\n      n: \"BrtEndSlicerCacheSiRanges\",\n      f: parsenoop\n    },\n    0x0446: {\n      n: \"BrtBeginSlicerCacheSiRange\",\n      f: parsenoop\n    },\n    0x0447: {\n      n: \"BrtEndSlicerCacheSiRange\",\n      f: parsenoop\n    },\n    0x0448: {\n      n: \"BrtSlicerCacheOlapItem\",\n      f: parsenoop\n    },\n    0x0449: {\n      n: \"BrtBeginSlicerCacheSelections\",\n      f: parsenoop\n    },\n    0x044A: {\n      n: \"BrtSlicerCacheSelection\",\n      f: parsenoop\n    },\n    0x044B: {\n      n: \"BrtEndSlicerCacheSelections\",\n      f: parsenoop\n    },\n    0x044C: {\n      n: \"BrtBeginSlicerCacheNative\",\n      f: parsenoop\n    },\n    0x044D: {\n      n: \"BrtEndSlicerCacheNative\",\n      f: parsenoop\n    },\n    0x044E: {\n      n: \"BrtSlicerCacheNativeItem\",\n      f: parsenoop\n    },\n    0x044F: {\n      n: \"BrtRangeProtection14\",\n      f: parsenoop\n    },\n    0x0450: {\n      n: \"BrtRangeProtectionIso14\",\n      f: parsenoop\n    },\n    0x0451: {\n      n: \"BrtCellIgnoreEC14\",\n      f: parsenoop\n    },\n    0x0457: {\n      n: \"BrtList14\",\n      f: parsenoop\n    },\n    0x0458: {\n      n: \"BrtCFIcon\",\n      f: parsenoop\n    },\n    0x0459: {\n      n: \"BrtBeginSlicerCachesPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x045A: {\n      n: \"BrtEndSlicerCachesPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x045B: {\n      n: \"BrtBeginSlicers\",\n      f: parsenoop\n    },\n    0x045C: {\n      n: \"BrtEndSlicers\",\n      f: parsenoop\n    },\n    0x045D: {\n      n: \"BrtWbProp14\",\n      f: parsenoop\n    },\n    0x045E: {\n      n: \"BrtBeginSXEdit\",\n      f: parsenoop\n    },\n    0x045F: {\n      n: \"BrtEndSXEdit\",\n      f: parsenoop\n    },\n    0x0460: {\n      n: \"BrtBeginSXEdits\",\n      f: parsenoop\n    },\n    0x0461: {\n      n: \"BrtEndSXEdits\",\n      f: parsenoop\n    },\n    0x0462: {\n      n: \"BrtBeginSXChange\",\n      f: parsenoop\n    },\n    0x0463: {\n      n: \"BrtEndSXChange\",\n      f: parsenoop\n    },\n    0x0464: {\n      n: \"BrtBeginSXChanges\",\n      f: parsenoop\n    },\n    0x0465: {\n      n: \"BrtEndSXChanges\",\n      f: parsenoop\n    },\n    0x0466: {\n      n: \"BrtSXTupleItems\",\n      f: parsenoop\n    },\n    0x0468: {\n      n: \"BrtBeginSlicerStyle\",\n      f: parsenoop\n    },\n    0x0469: {\n      n: \"BrtEndSlicerStyle\",\n      f: parsenoop\n    },\n    0x046A: {\n      n: \"BrtSlicerStyleElement\",\n      f: parsenoop\n    },\n    0x046B: {\n      n: \"BrtBeginStyleSheetExt14\",\n      f: parsenoop\n    },\n    0x046C: {\n      n: \"BrtEndStyleSheetExt14\",\n      f: parsenoop\n    },\n    0x046D: {\n      n: \"BrtBeginSlicerCachesPivotCacheID\",\n      f: parsenoop\n    },\n    0x046E: {\n      n: \"BrtEndSlicerCachesPivotCacheID\",\n      f: parsenoop\n    },\n    0x046F: {\n      n: \"BrtBeginConditionalFormattings\",\n      f: parsenoop\n    },\n    0x0470: {\n      n: \"BrtEndConditionalFormattings\",\n      f: parsenoop\n    },\n    0x0471: {\n      n: \"BrtBeginPCDCalcMemExt\",\n      f: parsenoop\n    },\n    0x0472: {\n      n: \"BrtEndPCDCalcMemExt\",\n      f: parsenoop\n    },\n    0x0473: {\n      n: \"BrtBeginPCDCalcMemsExt\",\n      f: parsenoop\n    },\n    0x0474: {\n      n: \"BrtEndPCDCalcMemsExt\",\n      f: parsenoop\n    },\n    0x0475: {\n      n: \"BrtPCDField14\",\n      f: parsenoop\n    },\n    0x0476: {\n      n: \"BrtBeginSlicerStyles\",\n      f: parsenoop\n    },\n    0x0477: {\n      n: \"BrtEndSlicerStyles\",\n      f: parsenoop\n    },\n    0x0478: {\n      n: \"BrtBeginSlicerStyleElements\",\n      f: parsenoop\n    },\n    0x0479: {\n      n: \"BrtEndSlicerStyleElements\",\n      f: parsenoop\n    },\n    0x047A: {\n      n: \"BrtCFRuleExt\",\n      f: parsenoop\n    },\n    0x047B: {\n      n: \"BrtBeginSXCondFmt14\",\n      f: parsenoop\n    },\n    0x047C: {\n      n: \"BrtEndSXCondFmt14\",\n      f: parsenoop\n    },\n    0x047D: {\n      n: \"BrtBeginSXCondFmts14\",\n      f: parsenoop\n    },\n    0x047E: {\n      n: \"BrtEndSXCondFmts14\",\n      f: parsenoop\n    },\n    0x0480: {\n      n: \"BrtBeginSortCond14\",\n      f: parsenoop\n    },\n    0x0481: {\n      n: \"BrtEndSortCond14\",\n      f: parsenoop\n    },\n    0x0482: {\n      n: \"BrtEndDVals14\",\n      f: parsenoop\n    },\n    0x0483: {\n      n: \"BrtEndIconSet14\",\n      f: parsenoop\n    },\n    0x0484: {\n      n: \"BrtEndDatabar14\",\n      f: parsenoop\n    },\n    0x0485: {\n      n: \"BrtBeginColorScale14\",\n      f: parsenoop\n    },\n    0x0486: {\n      n: \"BrtEndColorScale14\",\n      f: parsenoop\n    },\n    0x0487: {\n      n: \"BrtBeginSxrules14\",\n      f: parsenoop\n    },\n    0x0488: {\n      n: \"BrtEndSxrules14\",\n      f: parsenoop\n    },\n    0x0489: {\n      n: \"BrtBeginPRule14\",\n      f: parsenoop\n    },\n    0x048A: {\n      n: \"BrtEndPRule14\",\n      f: parsenoop\n    },\n    0x048B: {\n      n: \"BrtBeginPRFilters14\",\n      f: parsenoop\n    },\n    0x048C: {\n      n: \"BrtEndPRFilters14\",\n      f: parsenoop\n    },\n    0x048D: {\n      n: \"BrtBeginPRFilter14\",\n      f: parsenoop\n    },\n    0x048E: {\n      n: \"BrtEndPRFilter14\",\n      f: parsenoop\n    },\n    0x048F: {\n      n: \"BrtBeginPRFItem14\",\n      f: parsenoop\n    },\n    0x0490: {\n      n: \"BrtEndPRFItem14\",\n      f: parsenoop\n    },\n    0x0491: {\n      n: \"BrtBeginCellIgnoreECs14\",\n      f: parsenoop\n    },\n    0x0492: {\n      n: \"BrtEndCellIgnoreECs14\",\n      f: parsenoop\n    },\n    0x0493: {\n      n: \"BrtDxf14\",\n      f: parsenoop\n    },\n    0x0494: {\n      n: \"BrtBeginDxF14s\",\n      f: parsenoop\n    },\n    0x0495: {\n      n: \"BrtEndDxf14s\",\n      f: parsenoop\n    },\n    0x0499: {\n      n: \"BrtFilter14\",\n      f: parsenoop\n    },\n    0x049A: {\n      n: \"BrtBeginCustomFilters14\",\n      f: parsenoop\n    },\n    0x049C: {\n      n: \"BrtCustomFilter14\",\n      f: parsenoop\n    },\n    0x049D: {\n      n: \"BrtIconFilter14\",\n      f: parsenoop\n    },\n    0x049E: {\n      n: \"BrtPivotCacheConnectionName\",\n      f: parsenoop\n    },\n    0x0800: {\n      n: \"BrtBeginDecoupledPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0801: {\n      n: \"BrtEndDecoupledPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0802: {\n      n: \"BrtDecoupledPivotCacheID\",\n      f: parsenoop\n    },\n    0x0803: {\n      n: \"BrtBeginPivotTableRefs\",\n      f: parsenoop\n    },\n    0x0804: {\n      n: \"BrtEndPivotTableRefs\",\n      f: parsenoop\n    },\n    0x0805: {\n      n: \"BrtPivotTableRef\",\n      f: parsenoop\n    },\n    0x0806: {\n      n: \"BrtSlicerCacheBookPivotTables\",\n      f: parsenoop\n    },\n    0x0807: {\n      n: \"BrtBeginSxvcells\",\n      f: parsenoop\n    },\n    0x0808: {\n      n: \"BrtEndSxvcells\",\n      f: parsenoop\n    },\n    0x0809: {\n      n: \"BrtBeginSxRow\",\n      f: parsenoop\n    },\n    0x080A: {\n      n: \"BrtEndSxRow\",\n      f: parsenoop\n    },\n    0x080C: {\n      n: \"BrtPcdCalcMem15\",\n      f: parsenoop\n    },\n    0x0813: {\n      n: \"BrtQsi15\",\n      f: parsenoop\n    },\n    0x0814: {\n      n: \"BrtBeginWebExtensions\",\n      f: parsenoop\n    },\n    0x0815: {\n      n: \"BrtEndWebExtensions\",\n      f: parsenoop\n    },\n    0x0816: {\n      n: \"BrtWebExtension\",\n      f: parsenoop\n    },\n    0x0817: {\n      n: \"BrtAbsPath15\",\n      f: parsenoop\n    },\n    0x0818: {\n      n: \"BrtBeginPivotTableUISettings\",\n      f: parsenoop\n    },\n    0x0819: {\n      n: \"BrtEndPivotTableUISettings\",\n      f: parsenoop\n    },\n    0x081B: {\n      n: \"BrtTableSlicerCacheIDs\",\n      f: parsenoop\n    },\n    0x081C: {\n      n: \"BrtTableSlicerCacheID\",\n      f: parsenoop\n    },\n    0x081D: {\n      n: \"BrtBeginTableSlicerCache\",\n      f: parsenoop\n    },\n    0x081E: {\n      n: \"BrtEndTableSlicerCache\",\n      f: parsenoop\n    },\n    0x081F: {\n      n: \"BrtSxFilter15\",\n      f: parsenoop\n    },\n    0x0820: {\n      n: \"BrtBeginTimelineCachePivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0821: {\n      n: \"BrtEndTimelineCachePivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0822: {\n      n: \"BrtTimelineCachePivotCacheID\",\n      f: parsenoop\n    },\n    0x0823: {\n      n: \"BrtBeginTimelineCacheIDs\",\n      f: parsenoop\n    },\n    0x0824: {\n      n: \"BrtEndTimelineCacheIDs\",\n      f: parsenoop\n    },\n    0x0825: {\n      n: \"BrtBeginTimelineCacheID\",\n      f: parsenoop\n    },\n    0x0826: {\n      n: \"BrtEndTimelineCacheID\",\n      f: parsenoop\n    },\n    0x0827: {\n      n: \"BrtBeginTimelinesEx\",\n      f: parsenoop\n    },\n    0x0828: {\n      n: \"BrtEndTimelinesEx\",\n      f: parsenoop\n    },\n    0x0829: {\n      n: \"BrtBeginTimelineEx\",\n      f: parsenoop\n    },\n    0x082A: {\n      n: \"BrtEndTimelineEx\",\n      f: parsenoop\n    },\n    0x082B: {\n      n: \"BrtWorkBookPr15\",\n      f: parsenoop\n    },\n    0x082C: {\n      n: \"BrtPCDH15\",\n      f: parsenoop\n    },\n    0x082D: {\n      n: \"BrtBeginTimelineStyle\",\n      f: parsenoop\n    },\n    0x082E: {\n      n: \"BrtEndTimelineStyle\",\n      f: parsenoop\n    },\n    0x082F: {\n      n: \"BrtTimelineStyleElement\",\n      f: parsenoop\n    },\n    0x0830: {\n      n: \"BrtBeginTimelineStylesheetExt15\",\n      f: parsenoop\n    },\n    0x0831: {\n      n: \"BrtEndTimelineStylesheetExt15\",\n      f: parsenoop\n    },\n    0x0832: {\n      n: \"BrtBeginTimelineStyles\",\n      f: parsenoop\n    },\n    0x0833: {\n      n: \"BrtEndTimelineStyles\",\n      f: parsenoop\n    },\n    0x0834: {\n      n: \"BrtBeginTimelineStyleElements\",\n      f: parsenoop\n    },\n    0x0835: {\n      n: \"BrtEndTimelineStyleElements\",\n      f: parsenoop\n    },\n    0x0836: {\n      n: \"BrtDxf15\",\n      f: parsenoop\n    },\n    0x0837: {\n      n: \"BrtBeginDxfs15\",\n      f: parsenoop\n    },\n    0x0838: {\n      n: \"brtEndDxfs15\",\n      f: parsenoop\n    },\n    0x0839: {\n      n: \"BrtSlicerCacheHideItemsWithNoData\",\n      f: parsenoop\n    },\n    0x083A: {\n      n: \"BrtBeginItemUniqueNames\",\n      f: parsenoop\n    },\n    0x083B: {\n      n: \"BrtEndItemUniqueNames\",\n      f: parsenoop\n    },\n    0x083C: {\n      n: \"BrtItemUniqueName\",\n      f: parsenoop\n    },\n    0x083D: {\n      n: \"BrtBeginExtConn15\",\n      f: parsenoop\n    },\n    0x083E: {\n      n: \"BrtEndExtConn15\",\n      f: parsenoop\n    },\n    0x083F: {\n      n: \"BrtBeginOledbPr15\",\n      f: parsenoop\n    },\n    0x0840: {\n      n: \"BrtEndOledbPr15\",\n      f: parsenoop\n    },\n    0x0841: {\n      n: \"BrtBeginDataFeedPr15\",\n      f: parsenoop\n    },\n    0x0842: {\n      n: \"BrtEndDataFeedPr15\",\n      f: parsenoop\n    },\n    0x0843: {\n      n: \"BrtTextPr15\",\n      f: parsenoop\n    },\n    0x0844: {\n      n: \"BrtRangePr15\",\n      f: parsenoop\n    },\n    0x0845: {\n      n: \"BrtDbCommand15\",\n      f: parsenoop\n    },\n    0x0846: {\n      n: \"BrtBeginDbTables15\",\n      f: parsenoop\n    },\n    0x0847: {\n      n: \"BrtEndDbTables15\",\n      f: parsenoop\n    },\n    0x0848: {\n      n: \"BrtDbTable15\",\n      f: parsenoop\n    },\n    0x0849: {\n      n: \"BrtBeginDataModel\",\n      f: parsenoop\n    },\n    0x084A: {\n      n: \"BrtEndDataModel\",\n      f: parsenoop\n    },\n    0x084B: {\n      n: \"BrtBeginModelTables\",\n      f: parsenoop\n    },\n    0x084C: {\n      n: \"BrtEndModelTables\",\n      f: parsenoop\n    },\n    0x084D: {\n      n: \"BrtModelTable\",\n      f: parsenoop\n    },\n    0x084E: {\n      n: \"BrtBeginModelRelationships\",\n      f: parsenoop\n    },\n    0x084F: {\n      n: \"BrtEndModelRelationships\",\n      f: parsenoop\n    },\n    0x0850: {\n      n: \"BrtModelRelationship\",\n      f: parsenoop\n    },\n    0x0851: {\n      n: \"BrtBeginECTxtWiz15\",\n      f: parsenoop\n    },\n    0x0852: {\n      n: \"BrtEndECTxtWiz15\",\n      f: parsenoop\n    },\n    0x0853: {\n      n: \"BrtBeginECTWFldInfoLst15\",\n      f: parsenoop\n    },\n    0x0854: {\n      n: \"BrtEndECTWFldInfoLst15\",\n      f: parsenoop\n    },\n    0x0855: {\n      n: \"BrtBeginECTWFldInfo15\",\n      f: parsenoop\n    },\n    0x0856: {\n      n: \"BrtFieldListActiveItem\",\n      f: parsenoop\n    },\n    0x0857: {\n      n: \"BrtPivotCacheIdVersion\",\n      f: parsenoop\n    },\n    0x0858: {\n      n: \"BrtSXDI15\",\n      f: parsenoop\n    },\n    0xFFFF: {\n      n: \"\",\n      f: parsenoop\n    }\n  };\n  var evert_RE = evert_key(XLSBRecordEnum, 'n');\n  /* [MS-XLS] 2.3 Record Enumeration */\n\n  var XLSRecordEnum = {\n    0x0003: {\n      n: \"BIFF2NUM\",\n      f: parse_BIFF2NUM\n    },\n    0x0004: {\n      n: \"BIFF2STR\",\n      f: parse_BIFF2STR\n    },\n    0x0006: {\n      n: \"Formula\",\n      f: parse_Formula\n    },\n    0x0009: {\n      n: 'BOF',\n      f: parse_BOF\n    },\n    0x000a: {\n      n: 'EOF',\n      f: parse_EOF\n    },\n    0x000c: {\n      n: \"CalcCount\",\n      f: parse_CalcCount\n    },\n    0x000d: {\n      n: \"CalcMode\",\n      f: parse_CalcMode\n    },\n    0x000e: {\n      n: \"CalcPrecision\",\n      f: parse_CalcPrecision\n    },\n    0x000f: {\n      n: \"CalcRefMode\",\n      f: parse_CalcRefMode\n    },\n    0x0010: {\n      n: \"CalcDelta\",\n      f: parse_CalcDelta\n    },\n    0x0011: {\n      n: \"CalcIter\",\n      f: parse_CalcIter\n    },\n    0x0012: {\n      n: \"Protect\",\n      f: parse_Protect\n    },\n    0x0013: {\n      n: \"Password\",\n      f: parse_Password\n    },\n    0x0014: {\n      n: \"Header\",\n      f: parse_Header\n    },\n    0x0015: {\n      n: \"Footer\",\n      f: parse_Footer\n    },\n    0x0017: {\n      n: \"ExternSheet\",\n      f: parse_ExternSheet\n    },\n    0x0018: {\n      n: \"Lbl\",\n      f: parse_Lbl\n    },\n    0x0019: {\n      n: \"WinProtect\",\n      f: parse_WinProtect\n    },\n    0x001a: {\n      n: \"VerticalPageBreaks\",\n      f: parse_VerticalPageBreaks\n    },\n    0x001b: {\n      n: \"HorizontalPageBreaks\",\n      f: parse_HorizontalPageBreaks\n    },\n    0x001c: {\n      n: \"Note\",\n      f: parse_Note\n    },\n    0x001d: {\n      n: \"Selection\",\n      f: parse_Selection\n    },\n    0x0022: {\n      n: \"Date1904\",\n      f: parse_Date1904\n    },\n    0x0023: {\n      n: \"ExternName\",\n      f: parse_ExternName\n    },\n    0x0026: {\n      n: \"LeftMargin\",\n      f: parse_LeftMargin\n    },\n    0x0027: {\n      n: \"RightMargin\",\n      f: parse_RightMargin\n    },\n    0x0028: {\n      n: \"TopMargin\",\n      f: parse_TopMargin\n    },\n    0x0029: {\n      n: \"BottomMargin\",\n      f: parse_BottomMargin\n    },\n    0x002a: {\n      n: \"PrintRowCol\",\n      f: parse_PrintRowCol\n    },\n    0x002b: {\n      n: \"PrintGrid\",\n      f: parse_PrintGrid\n    },\n    0x002f: {\n      n: \"FilePass\",\n      f: parse_FilePass\n    },\n    0x0031: {\n      n: \"Font\",\n      f: parse_Font\n    },\n    0x0033: {\n      n: \"PrintSize\",\n      f: parse_PrintSize\n    },\n    0x003c: {\n      n: \"Continue\",\n      f: parse_Continue\n    },\n    0x003d: {\n      n: \"Window1\",\n      f: parse_Window1\n    },\n    0x0040: {\n      n: \"Backup\",\n      f: parse_Backup\n    },\n    0x0041: {\n      n: \"Pane\",\n      f: parse_Pane\n    },\n    0x0042: {\n      n: 'CodePage',\n      f: parse_CodePage\n    },\n    0x004d: {\n      n: \"Pls\",\n      f: parse_Pls\n    },\n    0x0050: {\n      n: \"DCon\",\n      f: parse_DCon\n    },\n    0x0051: {\n      n: \"DConRef\",\n      f: parse_DConRef\n    },\n    0x0052: {\n      n: \"DConName\",\n      f: parse_DConName\n    },\n    0x0055: {\n      n: \"DefColWidth\",\n      f: parse_DefColWidth\n    },\n    0x0059: {\n      n: \"XCT\",\n      f: parse_XCT\n    },\n    0x005a: {\n      n: \"CRN\",\n      f: parse_CRN\n    },\n    0x005b: {\n      n: \"FileSharing\",\n      f: parse_FileSharing\n    },\n    0x005c: {\n      n: 'WriteAccess',\n      f: parse_WriteAccess\n    },\n    0x005d: {\n      n: \"Obj\",\n      f: parse_Obj\n    },\n    0x005e: {\n      n: \"Uncalced\",\n      f: parse_Uncalced\n    },\n    0x005f: {\n      n: \"CalcSaveRecalc\",\n      f: parse_CalcSaveRecalc\n    },\n    0x0060: {\n      n: \"Template\",\n      f: parse_Template\n    },\n    0x0061: {\n      n: \"Intl\",\n      f: parse_Intl\n    },\n    0x0063: {\n      n: \"ObjProtect\",\n      f: parse_ObjProtect\n    },\n    0x007d: {\n      n: \"ColInfo\",\n      f: parse_ColInfo\n    },\n    0x0080: {\n      n: \"Guts\",\n      f: parse_Guts\n    },\n    0x0081: {\n      n: \"WsBool\",\n      f: parse_WsBool\n    },\n    0x0082: {\n      n: \"GridSet\",\n      f: parse_GridSet\n    },\n    0x0083: {\n      n: \"HCenter\",\n      f: parse_HCenter\n    },\n    0x0084: {\n      n: \"VCenter\",\n      f: parse_VCenter\n    },\n    0x0085: {\n      n: 'BoundSheet8',\n      f: parse_BoundSheet8\n    },\n    0x0086: {\n      n: \"WriteProtect\",\n      f: parse_WriteProtect\n    },\n    0x008c: {\n      n: \"Country\",\n      f: parse_Country\n    },\n    0x008d: {\n      n: \"HideObj\",\n      f: parse_HideObj\n    },\n    0x0090: {\n      n: \"Sort\",\n      f: parse_Sort\n    },\n    0x0092: {\n      n: \"Palette\",\n      f: parse_Palette\n    },\n    0x0097: {\n      n: \"Sync\",\n      f: parse_Sync\n    },\n    0x0098: {\n      n: \"LPr\",\n      f: parse_LPr\n    },\n    0x0099: {\n      n: \"DxGCol\",\n      f: parse_DxGCol\n    },\n    0x009a: {\n      n: \"FnGroupName\",\n      f: parse_FnGroupName\n    },\n    0x009b: {\n      n: \"FilterMode\",\n      f: parse_FilterMode\n    },\n    0x009c: {\n      n: \"BuiltInFnGroupCount\",\n      f: parse_BuiltInFnGroupCount\n    },\n    0x009d: {\n      n: \"AutoFilterInfo\",\n      f: parse_AutoFilterInfo\n    },\n    0x009e: {\n      n: \"AutoFilter\",\n      f: parse_AutoFilter\n    },\n    0x00a0: {\n      n: \"Scl\",\n      f: parse_Scl\n    },\n    0x00a1: {\n      n: \"Setup\",\n      f: parse_Setup\n    },\n    0x00ae: {\n      n: \"ScenMan\",\n      f: parse_ScenMan\n    },\n    0x00af: {\n      n: \"SCENARIO\",\n      f: parse_SCENARIO\n    },\n    0x00b0: {\n      n: \"SxView\",\n      f: parse_SxView\n    },\n    0x00b1: {\n      n: \"Sxvd\",\n      f: parse_Sxvd\n    },\n    0x00b2: {\n      n: \"SXVI\",\n      f: parse_SXVI\n    },\n    0x00b4: {\n      n: \"SxIvd\",\n      f: parse_SxIvd\n    },\n    0x00b5: {\n      n: \"SXLI\",\n      f: parse_SXLI\n    },\n    0x00b6: {\n      n: \"SXPI\",\n      f: parse_SXPI\n    },\n    0x00b8: {\n      n: \"DocRoute\",\n      f: parse_DocRoute\n    },\n    0x00b9: {\n      n: \"RecipName\",\n      f: parse_RecipName\n    },\n    0x00bd: {\n      n: \"MulRk\",\n      f: parse_MulRk\n    },\n    0x00be: {\n      n: \"MulBlank\",\n      f: parse_MulBlank\n    },\n    0x00c1: {\n      n: 'Mms',\n      f: parse_Mms\n    },\n    0x00c5: {\n      n: \"SXDI\",\n      f: parse_SXDI\n    },\n    0x00c6: {\n      n: \"SXDB\",\n      f: parse_SXDB\n    },\n    0x00c7: {\n      n: \"SXFDB\",\n      f: parse_SXFDB\n    },\n    0x00c8: {\n      n: \"SXDBB\",\n      f: parse_SXDBB\n    },\n    0x00c9: {\n      n: \"SXNum\",\n      f: parse_SXNum\n    },\n    0x00ca: {\n      n: \"SxBool\",\n      f: parse_SxBool\n    },\n    0x00cb: {\n      n: \"SxErr\",\n      f: parse_SxErr\n    },\n    0x00cc: {\n      n: \"SXInt\",\n      f: parse_SXInt\n    },\n    0x00cd: {\n      n: \"SXString\",\n      f: parse_SXString\n    },\n    0x00ce: {\n      n: \"SXDtr\",\n      f: parse_SXDtr\n    },\n    0x00cf: {\n      n: \"SxNil\",\n      f: parse_SxNil\n    },\n    0x00d0: {\n      n: \"SXTbl\",\n      f: parse_SXTbl\n    },\n    0x00d1: {\n      n: \"SXTBRGIITM\",\n      f: parse_SXTBRGIITM\n    },\n    0x00d2: {\n      n: \"SxTbpg\",\n      f: parse_SxTbpg\n    },\n    0x00d3: {\n      n: \"ObProj\",\n      f: parse_ObProj\n    },\n    0x00d5: {\n      n: \"SXStreamID\",\n      f: parse_SXStreamID\n    },\n    0x00d7: {\n      n: \"DBCell\",\n      f: parse_DBCell\n    },\n    0x00d8: {\n      n: \"SXRng\",\n      f: parse_SXRng\n    },\n    0x00d9: {\n      n: \"SxIsxoper\",\n      f: parse_SxIsxoper\n    },\n    0x00da: {\n      n: \"BookBool\",\n      f: parse_BookBool\n    },\n    0x00dc: {\n      n: \"DbOrParamQry\",\n      f: parse_DbOrParamQry\n    },\n    0x00dd: {\n      n: \"ScenarioProtect\",\n      f: parse_ScenarioProtect\n    },\n    0x00de: {\n      n: \"OleObjectSize\",\n      f: parse_OleObjectSize\n    },\n    0x00e0: {\n      n: \"XF\",\n      f: parse_XF\n    },\n    0x00e1: {\n      n: 'InterfaceHdr',\n      f: parse_InterfaceHdr\n    },\n    0x00e2: {\n      n: 'InterfaceEnd',\n      f: parse_InterfaceEnd\n    },\n    0x00e3: {\n      n: \"SXVS\",\n      f: parse_SXVS\n    },\n    0x00e5: {\n      n: \"MergeCells\",\n      f: parse_MergeCells\n    },\n    0x00e9: {\n      n: \"BkHim\",\n      f: parse_BkHim\n    },\n    0x00eb: {\n      n: \"MsoDrawingGroup\",\n      f: parse_MsoDrawingGroup\n    },\n    0x00ec: {\n      n: \"MsoDrawing\",\n      f: parse_MsoDrawing\n    },\n    0x00ed: {\n      n: \"MsoDrawingSelection\",\n      f: parse_MsoDrawingSelection\n    },\n    0x00ef: {\n      n: \"PhoneticInfo\",\n      f: parse_PhoneticInfo\n    },\n    0x00f0: {\n      n: \"SxRule\",\n      f: parse_SxRule\n    },\n    0x00f1: {\n      n: \"SXEx\",\n      f: parse_SXEx\n    },\n    0x00f2: {\n      n: \"SxFilt\",\n      f: parse_SxFilt\n    },\n    0x00f4: {\n      n: \"SxDXF\",\n      f: parse_SxDXF\n    },\n    0x00f5: {\n      n: \"SxItm\",\n      f: parse_SxItm\n    },\n    0x00f6: {\n      n: \"SxName\",\n      f: parse_SxName\n    },\n    0x00f7: {\n      n: \"SxSelect\",\n      f: parse_SxSelect\n    },\n    0x00f8: {\n      n: \"SXPair\",\n      f: parse_SXPair\n    },\n    0x00f9: {\n      n: \"SxFmla\",\n      f: parse_SxFmla\n    },\n    0x00fb: {\n      n: \"SxFormat\",\n      f: parse_SxFormat\n    },\n    0x00fc: {\n      n: \"SST\",\n      f: parse_SST\n    },\n    0x00fd: {\n      n: \"LabelSst\",\n      f: parse_LabelSst\n    },\n    0x00ff: {\n      n: \"ExtSST\",\n      f: parse_ExtSST\n    },\n    0x0100: {\n      n: \"SXVDEx\",\n      f: parse_SXVDEx\n    },\n    0x0103: {\n      n: \"SXFormula\",\n      f: parse_SXFormula\n    },\n    0x0122: {\n      n: \"SXDBEx\",\n      f: parse_SXDBEx\n    },\n    0x0137: {\n      n: \"RRDInsDel\",\n      f: parse_RRDInsDel\n    },\n    0x0138: {\n      n: \"RRDHead\",\n      f: parse_RRDHead\n    },\n    0x013b: {\n      n: \"RRDChgCell\",\n      f: parse_RRDChgCell\n    },\n    0x013d: {\n      n: \"RRTabId\",\n      f: parse_RRTabId\n    },\n    0x013e: {\n      n: \"RRDRenSheet\",\n      f: parse_RRDRenSheet\n    },\n    0x013f: {\n      n: \"RRSort\",\n      f: parse_RRSort\n    },\n    0x0140: {\n      n: \"RRDMove\",\n      f: parse_RRDMove\n    },\n    0x014a: {\n      n: \"RRFormat\",\n      f: parse_RRFormat\n    },\n    0x014b: {\n      n: \"RRAutoFmt\",\n      f: parse_RRAutoFmt\n    },\n    0x014d: {\n      n: \"RRInsertSh\",\n      f: parse_RRInsertSh\n    },\n    0x014e: {\n      n: \"RRDMoveBegin\",\n      f: parse_RRDMoveBegin\n    },\n    0x014f: {\n      n: \"RRDMoveEnd\",\n      f: parse_RRDMoveEnd\n    },\n    0x0150: {\n      n: \"RRDInsDelBegin\",\n      f: parse_RRDInsDelBegin\n    },\n    0x0151: {\n      n: \"RRDInsDelEnd\",\n      f: parse_RRDInsDelEnd\n    },\n    0x0152: {\n      n: \"RRDConflict\",\n      f: parse_RRDConflict\n    },\n    0x0153: {\n      n: \"RRDDefName\",\n      f: parse_RRDDefName\n    },\n    0x0154: {\n      n: \"RRDRstEtxp\",\n      f: parse_RRDRstEtxp\n    },\n    0x015f: {\n      n: \"LRng\",\n      f: parse_LRng\n    },\n    0x0160: {\n      n: \"UsesELFs\",\n      f: parse_UsesELFs\n    },\n    0x0161: {\n      n: \"DSF\",\n      f: parse_DSF\n    },\n    0x0191: {\n      n: \"CUsr\",\n      f: parse_CUsr\n    },\n    0x0192: {\n      n: \"CbUsr\",\n      f: parse_CbUsr\n    },\n    0x0193: {\n      n: \"UsrInfo\",\n      f: parse_UsrInfo\n    },\n    0x0194: {\n      n: \"UsrExcl\",\n      f: parse_UsrExcl\n    },\n    0x0195: {\n      n: \"FileLock\",\n      f: parse_FileLock\n    },\n    0x0196: {\n      n: \"RRDInfo\",\n      f: parse_RRDInfo\n    },\n    0x0197: {\n      n: \"BCUsrs\",\n      f: parse_BCUsrs\n    },\n    0x0198: {\n      n: \"UsrChk\",\n      f: parse_UsrChk\n    },\n    0x01a9: {\n      n: \"UserBView\",\n      f: parse_UserBView\n    },\n    0x01aa: {\n      n: \"UserSViewBegin\",\n      f: parse_UserSViewBegin\n    },\n    0x01ab: {\n      n: \"UserSViewEnd\",\n      f: parse_UserSViewEnd\n    },\n    0x01ac: {\n      n: \"RRDUserView\",\n      f: parse_RRDUserView\n    },\n    0x01ad: {\n      n: \"Qsi\",\n      f: parse_Qsi\n    },\n    0x01ae: {\n      n: \"SupBook\",\n      f: parse_SupBook\n    },\n    0x01af: {\n      n: \"Prot4Rev\",\n      f: parse_Prot4Rev\n    },\n    0x01b0: {\n      n: \"CondFmt\",\n      f: parse_CondFmt\n    },\n    0x01b1: {\n      n: \"CF\",\n      f: parse_CF\n    },\n    0x01b2: {\n      n: \"DVal\",\n      f: parse_DVal\n    },\n    0x01b5: {\n      n: \"DConBin\",\n      f: parse_DConBin\n    },\n    0x01b6: {\n      n: \"TxO\",\n      f: parse_TxO\n    },\n    0x01b7: {\n      n: \"RefreshAll\",\n      f: parse_RefreshAll\n    },\n    0x01b8: {\n      n: \"HLink\",\n      f: parse_HLink\n    },\n    0x01b9: {\n      n: \"Lel\",\n      f: parse_Lel\n    },\n    0x01ba: {\n      n: \"CodeName\",\n      f: parse_XLSCodeName\n    },\n    0x01bb: {\n      n: \"SXFDBType\",\n      f: parse_SXFDBType\n    },\n    0x01bc: {\n      n: \"Prot4RevPass\",\n      f: parse_Prot4RevPass\n    },\n    0x01bd: {\n      n: \"ObNoMacros\",\n      f: parse_ObNoMacros\n    },\n    0x01be: {\n      n: \"Dv\",\n      f: parse_Dv\n    },\n    0x01c0: {\n      n: \"Excel9File\",\n      f: parse_Excel9File\n    },\n    0x01c1: {\n      n: \"RecalcId\",\n      f: parse_RecalcId,\n      r: 2\n    },\n    0x01c2: {\n      n: \"EntExU2\",\n      f: parse_EntExU2\n    },\n    0x0200: {\n      n: \"Dimensions\",\n      f: parse_Dimensions\n    },\n    0x0201: {\n      n: \"Blank\",\n      f: parse_Blank\n    },\n    0x0203: {\n      n: \"Number\",\n      f: parse_Number\n    },\n    0x0204: {\n      n: \"Label\",\n      f: parse_Label\n    },\n    0x0205: {\n      n: \"BoolErr\",\n      f: parse_BoolErr\n    },\n    0x0207: {\n      n: \"String\",\n      f: parse_String\n    },\n    0x0208: {\n      n: 'Row',\n      f: parse_Row\n    },\n    0x020b: {\n      n: \"Index\",\n      f: parse_Index\n    },\n    0x0221: {\n      n: \"Array\",\n      f: parse_Array\n    },\n    0x0225: {\n      n: \"DefaultRowHeight\",\n      f: parse_DefaultRowHeight\n    },\n    0x0236: {\n      n: \"Table\",\n      f: parse_Table\n    },\n    0x023e: {\n      n: \"Window2\",\n      f: parse_Window2\n    },\n    0x027e: {\n      n: \"RK\",\n      f: parse_RK\n    },\n    0x0293: {\n      n: \"Style\",\n      f: parse_Style\n    },\n    0x0418: {\n      n: \"BigName\",\n      f: parse_BigName\n    },\n    0x041e: {\n      n: \"Format\",\n      f: parse_Format\n    },\n    0x043c: {\n      n: \"ContinueBigName\",\n      f: parse_ContinueBigName\n    },\n    0x04bc: {\n      n: \"ShrFmla\",\n      f: parse_ShrFmla\n    },\n    0x0800: {\n      n: \"HLinkTooltip\",\n      f: parse_HLinkTooltip\n    },\n    0x0801: {\n      n: \"WebPub\",\n      f: parse_WebPub\n    },\n    0x0802: {\n      n: \"QsiSXTag\",\n      f: parse_QsiSXTag\n    },\n    0x0803: {\n      n: \"DBQueryExt\",\n      f: parse_DBQueryExt\n    },\n    0x0804: {\n      n: \"ExtString\",\n      f: parse_ExtString\n    },\n    0x0805: {\n      n: \"TxtQry\",\n      f: parse_TxtQry\n    },\n    0x0806: {\n      n: \"Qsir\",\n      f: parse_Qsir\n    },\n    0x0807: {\n      n: \"Qsif\",\n      f: parse_Qsif\n    },\n    0x0808: {\n      n: \"RRDTQSIF\",\n      f: parse_RRDTQSIF\n    },\n    0x0809: {\n      n: 'BOF',\n      f: parse_BOF\n    },\n    0x080a: {\n      n: \"OleDbConn\",\n      f: parse_OleDbConn\n    },\n    0x080b: {\n      n: \"WOpt\",\n      f: parse_WOpt\n    },\n    0x080c: {\n      n: \"SXViewEx\",\n      f: parse_SXViewEx\n    },\n    0x080d: {\n      n: \"SXTH\",\n      f: parse_SXTH\n    },\n    0x080e: {\n      n: \"SXPIEx\",\n      f: parse_SXPIEx\n    },\n    0x080f: {\n      n: \"SXVDTEx\",\n      f: parse_SXVDTEx\n    },\n    0x0810: {\n      n: \"SXViewEx9\",\n      f: parse_SXViewEx9\n    },\n    0x0812: {\n      n: \"ContinueFrt\",\n      f: parse_ContinueFrt\n    },\n    0x0813: {\n      n: \"RealTimeData\",\n      f: parse_RealTimeData\n    },\n    0x0850: {\n      n: \"ChartFrtInfo\",\n      f: parse_ChartFrtInfo\n    },\n    0x0851: {\n      n: \"FrtWrapper\",\n      f: parse_FrtWrapper\n    },\n    0x0852: {\n      n: \"StartBlock\",\n      f: parse_StartBlock\n    },\n    0x0853: {\n      n: \"EndBlock\",\n      f: parse_EndBlock\n    },\n    0x0854: {\n      n: \"StartObject\",\n      f: parse_StartObject\n    },\n    0x0855: {\n      n: \"EndObject\",\n      f: parse_EndObject\n    },\n    0x0856: {\n      n: \"CatLab\",\n      f: parse_CatLab\n    },\n    0x0857: {\n      n: \"YMult\",\n      f: parse_YMult\n    },\n    0x0858: {\n      n: \"SXViewLink\",\n      f: parse_SXViewLink\n    },\n    0x0859: {\n      n: \"PivotChartBits\",\n      f: parse_PivotChartBits\n    },\n    0x085a: {\n      n: \"FrtFontList\",\n      f: parse_FrtFontList\n    },\n    0x0862: {\n      n: \"SheetExt\",\n      f: parse_SheetExt\n    },\n    0x0863: {\n      n: \"BookExt\",\n      f: parse_BookExt,\n      r: 12\n    },\n    0x0864: {\n      n: \"SXAddl\",\n      f: parse_SXAddl\n    },\n    0x0865: {\n      n: \"CrErr\",\n      f: parse_CrErr\n    },\n    0x0866: {\n      n: \"HFPicture\",\n      f: parse_HFPicture\n    },\n    0x0867: {\n      n: 'FeatHdr',\n      f: parse_FeatHdr\n    },\n    0x0868: {\n      n: \"Feat\",\n      f: parse_Feat\n    },\n    0x086a: {\n      n: \"DataLabExt\",\n      f: parse_DataLabExt\n    },\n    0x086b: {\n      n: \"DataLabExtContents\",\n      f: parse_DataLabExtContents\n    },\n    0x086c: {\n      n: \"CellWatch\",\n      f: parse_CellWatch\n    },\n    0x0871: {\n      n: \"FeatHdr11\",\n      f: parse_FeatHdr11\n    },\n    0x0872: {\n      n: \"Feature11\",\n      f: parse_Feature11\n    },\n    0x0874: {\n      n: \"DropDownObjIds\",\n      f: parse_DropDownObjIds\n    },\n    0x0875: {\n      n: \"ContinueFrt11\",\n      f: parse_ContinueFrt11\n    },\n    0x0876: {\n      n: \"DConn\",\n      f: parse_DConn\n    },\n    0x0877: {\n      n: \"List12\",\n      f: parse_List12\n    },\n    0x0878: {\n      n: \"Feature12\",\n      f: parse_Feature12\n    },\n    0x0879: {\n      n: \"CondFmt12\",\n      f: parse_CondFmt12\n    },\n    0x087a: {\n      n: \"CF12\",\n      f: parse_CF12\n    },\n    0x087b: {\n      n: \"CFEx\",\n      f: parse_CFEx\n    },\n    0x087c: {\n      n: \"XFCRC\",\n      f: parse_XFCRC,\n      r: 12\n    },\n    0x087d: {\n      n: \"XFExt\",\n      f: parse_XFExt,\n      r: 12\n    },\n    0x087e: {\n      n: \"AutoFilter12\",\n      f: parse_AutoFilter12\n    },\n    0x087f: {\n      n: \"ContinueFrt12\",\n      f: parse_ContinueFrt12\n    },\n    0x0884: {\n      n: \"MDTInfo\",\n      f: parse_MDTInfo\n    },\n    0x0885: {\n      n: \"MDXStr\",\n      f: parse_MDXStr\n    },\n    0x0886: {\n      n: \"MDXTuple\",\n      f: parse_MDXTuple\n    },\n    0x0887: {\n      n: \"MDXSet\",\n      f: parse_MDXSet\n    },\n    0x0888: {\n      n: \"MDXProp\",\n      f: parse_MDXProp\n    },\n    0x0889: {\n      n: \"MDXKPI\",\n      f: parse_MDXKPI\n    },\n    0x088a: {\n      n: \"MDB\",\n      f: parse_MDB\n    },\n    0x088b: {\n      n: \"PLV\",\n      f: parse_PLV\n    },\n    0x088c: {\n      n: \"Compat12\",\n      f: parse_Compat12,\n      r: 12\n    },\n    0x088d: {\n      n: \"DXF\",\n      f: parse_DXF\n    },\n    0x088e: {\n      n: \"TableStyles\",\n      f: parse_TableStyles,\n      r: 12\n    },\n    0x088f: {\n      n: \"TableStyle\",\n      f: parse_TableStyle\n    },\n    0x0890: {\n      n: \"TableStyleElement\",\n      f: parse_TableStyleElement\n    },\n    0x0892: {\n      n: \"StyleExt\",\n      f: parse_StyleExt\n    },\n    0x0893: {\n      n: \"NamePublish\",\n      f: parse_NamePublish\n    },\n    0x0894: {\n      n: \"NameCmt\",\n      f: parse_NameCmt\n    },\n    0x0895: {\n      n: \"SortData\",\n      f: parse_SortData\n    },\n    0x0896: {\n      n: \"Theme\",\n      f: parse_Theme,\n      r: 12\n    },\n    0x0897: {\n      n: \"GUIDTypeLib\",\n      f: parse_GUIDTypeLib\n    },\n    0x0898: {\n      n: \"FnGrp12\",\n      f: parse_FnGrp12\n    },\n    0x0899: {\n      n: \"NameFnGrp12\",\n      f: parse_NameFnGrp12\n    },\n    0x089a: {\n      n: \"MTRSettings\",\n      f: parse_MTRSettings,\n      r: 12\n    },\n    0x089b: {\n      n: \"CompressPictures\",\n      f: parse_CompressPictures\n    },\n    0x089c: {\n      n: \"HeaderFooter\",\n      f: parse_HeaderFooter\n    },\n    0x089d: {\n      n: \"CrtLayout12\",\n      f: parse_CrtLayout12\n    },\n    0x089e: {\n      n: \"CrtMlFrt\",\n      f: parse_CrtMlFrt\n    },\n    0x089f: {\n      n: \"CrtMlFrtContinue\",\n      f: parse_CrtMlFrtContinue\n    },\n    0x08a3: {\n      n: \"ForceFullCalculation\",\n      f: parse_ForceFullCalculation\n    },\n    0x08a4: {\n      n: \"ShapePropsStream\",\n      f: parse_ShapePropsStream\n    },\n    0x08a5: {\n      n: \"TextPropsStream\",\n      f: parse_TextPropsStream\n    },\n    0x08a6: {\n      n: \"RichTextStream\",\n      f: parse_RichTextStream\n    },\n    0x08a7: {\n      n: \"CrtLayout12A\",\n      f: parse_CrtLayout12A\n    },\n    0x1001: {\n      n: \"Units\",\n      f: parse_Units\n    },\n    0x1002: {\n      n: \"Chart\",\n      f: parse_Chart\n    },\n    0x1003: {\n      n: \"Series\",\n      f: parse_Series\n    },\n    0x1006: {\n      n: \"DataFormat\",\n      f: parse_DataFormat\n    },\n    0x1007: {\n      n: \"LineFormat\",\n      f: parse_LineFormat\n    },\n    0x1009: {\n      n: \"MarkerFormat\",\n      f: parse_MarkerFormat\n    },\n    0x100a: {\n      n: \"AreaFormat\",\n      f: parse_AreaFormat\n    },\n    0x100b: {\n      n: \"PieFormat\",\n      f: parse_PieFormat\n    },\n    0x100c: {\n      n: \"AttachedLabel\",\n      f: parse_AttachedLabel\n    },\n    0x100d: {\n      n: \"SeriesText\",\n      f: parse_SeriesText\n    },\n    0x1014: {\n      n: \"ChartFormat\",\n      f: parse_ChartFormat\n    },\n    0x1015: {\n      n: \"Legend\",\n      f: parse_Legend\n    },\n    0x1016: {\n      n: \"SeriesList\",\n      f: parse_SeriesList\n    },\n    0x1017: {\n      n: \"Bar\",\n      f: parse_Bar\n    },\n    0x1018: {\n      n: \"Line\",\n      f: parse_Line\n    },\n    0x1019: {\n      n: \"Pie\",\n      f: parse_Pie\n    },\n    0x101a: {\n      n: \"Area\",\n      f: parse_Area\n    },\n    0x101b: {\n      n: \"Scatter\",\n      f: parse_Scatter\n    },\n    0x101c: {\n      n: \"CrtLine\",\n      f: parse_CrtLine\n    },\n    0x101d: {\n      n: \"Axis\",\n      f: parse_Axis\n    },\n    0x101e: {\n      n: \"Tick\",\n      f: parse_Tick\n    },\n    0x101f: {\n      n: \"ValueRange\",\n      f: parse_ValueRange\n    },\n    0x1020: {\n      n: \"CatSerRange\",\n      f: parse_CatSerRange\n    },\n    0x1021: {\n      n: \"AxisLine\",\n      f: parse_AxisLine\n    },\n    0x1022: {\n      n: \"CrtLink\",\n      f: parse_CrtLink\n    },\n    0x1024: {\n      n: \"DefaultText\",\n      f: parse_DefaultText\n    },\n    0x1025: {\n      n: \"Text\",\n      f: parse_Text\n    },\n    0x1026: {\n      n: \"FontX\",\n      f: parse_FontX\n    },\n    0x1027: {\n      n: \"ObjectLink\",\n      f: parse_ObjectLink\n    },\n    0x1032: {\n      n: \"Frame\",\n      f: parse_Frame\n    },\n    0x1033: {\n      n: \"Begin\",\n      f: parse_Begin\n    },\n    0x1034: {\n      n: \"End\",\n      f: parse_End\n    },\n    0x1035: {\n      n: \"PlotArea\",\n      f: parse_PlotArea\n    },\n    0x103a: {\n      n: \"Chart3d\",\n      f: parse_Chart3d\n    },\n    0x103c: {\n      n: \"PicF\",\n      f: parse_PicF\n    },\n    0x103d: {\n      n: \"DropBar\",\n      f: parse_DropBar\n    },\n    0x103e: {\n      n: \"Radar\",\n      f: parse_Radar\n    },\n    0x103f: {\n      n: \"Surf\",\n      f: parse_Surf\n    },\n    0x1040: {\n      n: \"RadarArea\",\n      f: parse_RadarArea\n    },\n    0x1041: {\n      n: \"AxisParent\",\n      f: parse_AxisParent\n    },\n    0x1043: {\n      n: \"LegendException\",\n      f: parse_LegendException\n    },\n    0x1044: {\n      n: \"ShtProps\",\n      f: parse_ShtProps\n    },\n    0x1045: {\n      n: \"SerToCrt\",\n      f: parse_SerToCrt\n    },\n    0x1046: {\n      n: \"AxesUsed\",\n      f: parse_AxesUsed\n    },\n    0x1048: {\n      n: \"SBaseRef\",\n      f: parse_SBaseRef\n    },\n    0x104a: {\n      n: \"SerParent\",\n      f: parse_SerParent\n    },\n    0x104b: {\n      n: \"SerAuxTrend\",\n      f: parse_SerAuxTrend\n    },\n    0x104e: {\n      n: \"IFmtRecord\",\n      f: parse_IFmtRecord\n    },\n    0x104f: {\n      n: \"Pos\",\n      f: parse_Pos\n    },\n    0x1050: {\n      n: \"AlRuns\",\n      f: parse_AlRuns\n    },\n    0x1051: {\n      n: \"BRAI\",\n      f: parse_BRAI\n    },\n    0x105b: {\n      n: \"SerAuxErrBar\",\n      f: parse_SerAuxErrBar\n    },\n    0x105c: {\n      n: \"ClrtClient\",\n      f: parse_ClrtClient\n    },\n    0x105d: {\n      n: \"SerFmt\",\n      f: parse_SerFmt\n    },\n    0x105f: {\n      n: \"Chart3DBarShape\",\n      f: parse_Chart3DBarShape\n    },\n    0x1060: {\n      n: \"Fbi\",\n      f: parse_Fbi\n    },\n    0x1061: {\n      n: \"BopPop\",\n      f: parse_BopPop\n    },\n    0x1062: {\n      n: \"AxcExt\",\n      f: parse_AxcExt\n    },\n    0x1063: {\n      n: \"Dat\",\n      f: parse_Dat\n    },\n    0x1064: {\n      n: \"PlotGrowth\",\n      f: parse_PlotGrowth\n    },\n    0x1065: {\n      n: \"SIIndex\",\n      f: parse_SIIndex\n    },\n    0x1066: {\n      n: \"GelFrame\",\n      f: parse_GelFrame\n    },\n    0x1067: {\n      n: \"BopPopCustom\",\n      f: parse_BopPopCustom\n    },\n    0x1068: {\n      n: \"Fbi2\",\n      f: parse_Fbi2\n    },\n\n    /* These are specified in an older version of the spec */\n    0x0016: {\n      n: \"ExternCount\",\n      f: parsenoop\n    },\n    0x007e: {\n      n: \"RK\",\n      f: parsenoop\n    },\n\n    /* Not necessarily same as 0x027e */\n    0x007f: {\n      n: \"ImData\",\n      f: parsenoop\n    },\n    0x0087: {\n      n: \"Addin\",\n      f: parsenoop\n    },\n    0x0088: {\n      n: \"Edg\",\n      f: parsenoop\n    },\n    0x0089: {\n      n: \"Pub\",\n      f: parsenoop\n    },\n    0x0091: {\n      n: \"Sub\",\n      f: parsenoop\n    },\n    0x0094: {\n      n: \"LHRecord\",\n      f: parsenoop\n    },\n    0x0095: {\n      n: \"LHNGraph\",\n      f: parsenoop\n    },\n    0x0096: {\n      n: \"Sound\",\n      f: parsenoop\n    },\n    0x00a9: {\n      n: \"CoordList\",\n      f: parsenoop\n    },\n    0x00ab: {\n      n: \"GCW\",\n      f: parsenoop\n    },\n    0x00bc: {\n      n: \"ShrFmla\",\n      f: parsenoop\n    },\n\n    /* Not necessarily same as 0x04bc */\n    0x00c2: {\n      n: \"AddMenu\",\n      f: parsenoop\n    },\n    0x00c3: {\n      n: \"DelMenu\",\n      f: parsenoop\n    },\n    0x00d6: {\n      n: \"RString\",\n      f: parsenoop\n    },\n    0x00df: {\n      n: \"UDDesc\",\n      f: parsenoop\n    },\n    0x00ea: {\n      n: \"TabIdConf\",\n      f: parsenoop\n    },\n    0x0162: {\n      n: \"XL5Modify\",\n      f: parsenoop\n    },\n    0x01a5: {\n      n: \"FileSharing2\",\n      f: parsenoop\n    },\n    0x0218: {\n      n: \"Name\",\n      f: parsenoop\n    },\n    0x0223: {\n      n: \"ExternName\",\n      f: parse_ExternName\n    },\n    0x0231: {\n      n: \"Font\",\n      f: parsenoop\n    },\n    0x0406: {\n      n: \"Formula\",\n      f: parse_Formula\n    },\n    0x086d: {\n      n: \"FeatInfo\",\n      f: parsenoop\n    },\n    0x0873: {\n      n: \"FeatInfo11\",\n      f: parsenoop\n    },\n    0x0881: {\n      n: \"SXAddl12\",\n      f: parsenoop\n    },\n    0x08c0: {\n      n: \"AutoWebPub\",\n      f: parsenoop\n    },\n    0x08c1: {\n      n: \"ListObj\",\n      f: parsenoop\n    },\n    0x08c2: {\n      n: \"ListField\",\n      f: parsenoop\n    },\n    0x08c3: {\n      n: \"ListDV\",\n      f: parsenoop\n    },\n    0x08c4: {\n      n: \"ListCondFmt\",\n      f: parsenoop\n    },\n    0x08c5: {\n      n: \"ListCF\",\n      f: parsenoop\n    },\n    0x08c6: {\n      n: \"FMQry\",\n      f: parsenoop\n    },\n    0x08c7: {\n      n: \"FMSQry\",\n      f: parsenoop\n    },\n    0x08c8: {\n      n: \"PLV\",\n      f: parsenoop\n    },\n\n    /* supposedly PLV for Excel 11 */\n    0x08c9: {\n      n: \"LnExt\",\n      f: parsenoop\n    },\n    0x08ca: {\n      n: \"MkrExt\",\n      f: parsenoop\n    },\n    0x08cb: {\n      n: \"CrtCoopt\",\n      f: parsenoop\n    },\n    0x0000: {}\n  };\n  /* Helper function to call out to ODS parser */\n\n  function parse_ods(zip, opts) {\n    if (typeof module !== \"undefined\" && typeof require !== 'undefined' && typeof ODS === 'undefined') ODS = require('./od' + 's');\n    if (typeof ODS === 'undefined' || !ODS.parse_ods) throw new Error(\"Unsupported ODS\");\n    return ODS.parse_ods(zip, opts);\n  }\n\n  function fix_opts_func(defaults) {\n    return function fix_opts(opts) {\n      for (var i = 0; i != defaults.length; ++i) {\n        var d = defaults[i];\n        if (opts[d[0]] === undefined) opts[d[0]] = d[1];\n        if (d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n      }\n    };\n  }\n\n  var fix_read_opts = fix_opts_func([['cellNF', false],\n  /* emit cell number format string as .z */\n  ['cellHTML', true],\n  /* emit html string as .h */\n  ['cellFormula', true],\n  /* emit formulae as .f */\n  ['cellStyles', false],\n  /* emits style/theme as .s */\n  ['cellDates', false],\n  /* emit date cells with type `d` */\n  ['sheetStubs', false],\n  /* emit empty cells */\n  ['sheetRows', 0, 'n'],\n  /* read n rows (0 = read all rows) */\n  ['bookDeps', false],\n  /* parse calculation chains */\n  ['bookSheets', false],\n  /* only try to get sheet names (no Sheets) */\n  ['bookProps', false],\n  /* only try to get properties (no Sheets) */\n  ['bookFiles', false],\n  /* include raw file structure (keys, files, cfb) */\n  ['bookVBA', false],\n  /* include vba raw data (vbaraw) */\n  ['password', ''],\n  /* password */\n  ['WTF', false]\n  /* WTF mode (throws errors) */\n  ]);\n  var fix_write_opts = fix_opts_func([['cellDates', false],\n  /* write date cells with type `d` */\n  ['bookSST', false],\n  /* Generate Shared String Table */\n  ['bookType', 'xlsx'],\n  /* Type of workbook (xlsx/m/b) */\n  ['WTF', false]\n  /* WTF mode (throws errors) */\n  ]);\n\n  function safe_parse_wbrels(wbrels, sheets) {\n    if (!wbrels) return 0;\n\n    try {\n      wbrels = sheets.map(function pwbr(w) {\n        return [w.name, wbrels['!id'][w.id].Target];\n      });\n    } catch (e) {\n      return null;\n    }\n\n    return !wbrels || wbrels.length === 0 ? null : wbrels;\n  }\n\n  function safe_parse_ws(zip, path, relsPath, sheet, sheetRels, sheets, opts) {\n    try {\n      sheetRels[sheet] = parse_rels(getzipdata(zip, relsPath, true), path);\n      sheets[sheet] = parse_ws(getzipdata(zip, path), path, opts, sheetRels[sheet]);\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n  }\n\n  var nodirs = function nodirs(x) {\n    return x.substr(-1) != '/';\n  };\n\n  function parse_zip(zip, opts) {\n    make_ssf(SSF);\n    opts = opts || {};\n    fix_read_opts(opts);\n    reset_cp();\n    /* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\n\n    if (safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\n    var entries = keys(zip.files).filter(nodirs).sort();\n    var dir = parse_ct(getzipdata(zip, '[Content_Types].xml'), opts);\n    var xlsb = false;\n    var sheets, binname;\n\n    if (dir.workbooks.length === 0) {\n      binname = \"xl/workbook.xml\";\n      if (getzipdata(zip, binname, true)) dir.workbooks.push(binname);\n    }\n\n    if (dir.workbooks.length === 0) {\n      binname = \"xl/workbook.bin\";\n      if (!getzipfile(zip, binname, true)) throw new Error(\"Could not find workbook\");\n      dir.workbooks.push(binname);\n      xlsb = true;\n    }\n\n    if (dir.workbooks[0].substr(-3) == \"bin\") xlsb = true;\n    if (xlsb) set_cp(1200);\n\n    if (!opts.bookSheets && !opts.bookProps) {\n      strs = [];\n      if (dir.sst) strs = parse_sst(getzipdata(zip, dir.sst.replace(/^\\//, '')), dir.sst, opts); // parse themes before styles so that we can reliably decode theme/tint into rgb when parsing styles\n\n      themes = {};\n      if (opts.cellStyles && dir.themes.length) themes = parse_theme(getzipdata(zip, dir.themes[0].replace(/^\\//, ''), true), dir.themes[0], opts);\n      styles = {};\n      if (dir.style) styles = parse_sty(getzipdata(zip, dir.style.replace(/^\\//, '')), dir.style, opts);\n    }\n\n    var wb = parse_wb(getzipdata(zip, dir.workbooks[0].replace(/^\\//, '')), dir.workbooks[0], opts);\n    var props = {},\n        propdata = \"\";\n\n    if (dir.coreprops.length !== 0) {\n      propdata = getzipdata(zip, dir.coreprops[0].replace(/^\\//, ''), true);\n      if (propdata) props = parse_core_props(propdata);\n\n      if (dir.extprops.length !== 0) {\n        propdata = getzipdata(zip, dir.extprops[0].replace(/^\\//, ''), true);\n        if (propdata) parse_ext_props(propdata, props);\n      }\n    }\n\n    var custprops = {};\n\n    if (!opts.bookSheets || opts.bookProps) {\n      if (dir.custprops.length !== 0) {\n        propdata = getzipdata(zip, dir.custprops[0].replace(/^\\//, ''), true);\n        if (propdata) custprops = parse_cust_props(propdata, opts);\n      }\n    }\n\n    var out = {};\n\n    if (opts.bookSheets || opts.bookProps) {\n      if (props.Worksheets && props.SheetNames.length > 0) sheets = props.SheetNames;else if (wb.Sheets) sheets = wb.Sheets.map(function pluck(x) {\n        return x.name;\n      });\n\n      if (opts.bookProps) {\n        out.Props = props;\n        out.Custprops = custprops;\n      }\n\n      if (typeof sheets !== 'undefined') out.SheetNames = sheets;\n      if (opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\n    }\n\n    sheets = {};\n    var deps = {};\n    if (opts.bookDeps && dir.calcchain) deps = parse_cc(getzipdata(zip, dir.calcchain.replace(/^\\//, '')), dir.calcchain, opts);\n    var i = 0;\n    var sheetRels = {};\n    var path, relsPath;\n\n    if (!props.Worksheets) {\n      var wbsheets = wb.Sheets;\n      props.Worksheets = wbsheets.length;\n      props.SheetNames = [];\n\n      for (var j = 0; j != wbsheets.length; ++j) {\n        props.SheetNames[j] = wbsheets[j].name;\n      }\n    }\n\n    var wbext = xlsb ? \"bin\" : \"xml\";\n    var wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\n    var wbrels = parse_rels(getzipdata(zip, wbrelsfile, true), wbrelsfile);\n    if (wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\n    /* Numbers iOS hack */\n\n    var nmode = getzipdata(zip, \"xl/worksheets/sheet.xml\", true) ? 1 : 0;\n\n    for (i = 0; i != props.Worksheets; ++i) {\n      if (wbrels) path = 'xl/' + wbrels[i][1].replace(/[\\/]?xl\\//, \"\");else {\n        path = 'xl/worksheets/sheet' + (i + 1 - nmode) + \".\" + wbext;\n        path = path.replace(/sheet0\\./, \"sheet.\");\n      }\n      relsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\n      safe_parse_ws(zip, path, relsPath, props.SheetNames[i], sheetRels, sheets, opts);\n    }\n\n    if (dir.comments) parse_comments(zip, dir.comments, sheets, sheetRels, opts);\n    out = {\n      Directory: dir,\n      Workbook: wb,\n      Props: props,\n      Custprops: custprops,\n      Deps: deps,\n      Sheets: sheets,\n      SheetNames: props.SheetNames,\n      Strings: strs,\n      Styles: styles,\n      Themes: themes,\n      SSF: SSF.get_table()\n    };\n\n    if (opts.bookFiles) {\n      out.keys = entries;\n      out.files = zip.files;\n    }\n\n    if (opts.bookVBA) {\n      if (dir.vba.length > 0) out.vbaraw = getzipdata(zip, dir.vba[0], true);else if (dir.defaults.bin === 'application/vnd.ms-office.vbaProject') out.vbaraw = getzipdata(zip, 'xl/vbaProject.bin', true);\n    }\n\n    return out;\n  }\n\n  function add_rels(rels, rId, f, type, relobj) {\n    if (!relobj) relobj = {};\n    if (!rels['!id']) rels['!id'] = {};\n    relobj.Id = 'rId' + rId;\n    relobj.Type = type;\n    relobj.Target = f;\n    if (rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\n    rels['!id'][relobj.Id] = relobj;\n    rels[('/' + relobj.Target).replace(\"//\", \"/\")] = relobj;\n  }\n\n  function write_zip(wb, opts) {\n    if (wb && !wb.SSF) {\n      wb.SSF = SSF.get_table();\n    }\n\n    if (wb && wb.SSF) {\n      make_ssf(SSF);\n      SSF.load_table(wb.SSF);\n      opts.revssf = evert_num(wb.SSF);\n      opts.revssf[wb.SSF[65535]] = 0;\n    }\n\n    opts.rels = {};\n    opts.wbrels = {};\n    opts.Strings = [];\n    opts.Strings.Count = 0;\n    opts.Strings.Unique = 0;\n    var wbext = opts.bookType == \"xlsb\" ? \"bin\" : \"xml\";\n    var ct = {\n      workbooks: [],\n      sheets: [],\n      calcchains: [],\n      themes: [],\n      styles: [],\n      coreprops: [],\n      extprops: [],\n      custprops: [],\n      strs: [],\n      comments: [],\n      vba: [],\n      TODO: [],\n      rels: [],\n      xmlns: \"\"\n    };\n    fix_write_opts(opts = opts || {});\n    if (typeof jszip === 'undefined') jszip = require('js' + 'zip');\n    var zip = new jszip();\n    var f = \"\",\n        rId = 0;\n    opts.cellXfs = [];\n    get_cell_style(opts.cellXfs, {}, {\n      revssf: {\n        \"General\": 0\n      }\n    });\n    f = \"docProps/core.xml\";\n    zip.file(f, write_core_props(wb.Props, opts));\n    ct.coreprops.push(f);\n    add_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n    f = \"docProps/app.xml\";\n    if (!wb.Props) wb.Props = {};\n    wb.Props.SheetNames = wb.SheetNames;\n    wb.Props.Worksheets = wb.SheetNames.length;\n    zip.file(f, write_ext_props(wb.Props, opts));\n    ct.extprops.push(f);\n    add_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n    if (wb.Custprops !== wb.Props && keys(wb.Custprops || {}).length > 0) {\n      f = \"docProps/custom.xml\";\n      zip.file(f, write_cust_props(wb.Custprops, opts));\n      ct.custprops.push(f);\n      add_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n    }\n\n    f = \"xl/workbook.\" + wbext;\n    zip.file(f, write_wb(wb, f, opts));\n    ct.workbooks.push(f);\n    add_rels(opts.rels, 1, f, RELS.WB);\n\n    for (rId = 1; rId <= wb.SheetNames.length; ++rId) {\n      f = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n      zip.file(f, write_ws(rId - 1, f, opts, wb));\n      ct.sheets.push(f);\n      add_rels(opts.wbrels, rId, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS);\n    }\n\n    if (opts.Strings != null && opts.Strings.length > 0) {\n      f = \"xl/sharedStrings.\" + wbext;\n      zip.file(f, write_sst(opts.Strings, f, opts));\n      ct.strs.push(f);\n      add_rels(opts.wbrels, ++rId, \"sharedStrings.\" + wbext, RELS.SST);\n    }\n    /* TODO: something more intelligent with themes */\n\n\n    f = \"xl/theme/theme1.xml\";\n    zip.file(f, write_theme(opts));\n    ct.themes.push(f);\n    add_rels(opts.wbrels, ++rId, \"theme/theme1.xml\", RELS.THEME);\n    /* TODO: something more intelligent with styles */\n\n    f = \"xl/styles.\" + wbext;\n    zip.file(f, write_sty(wb, f, opts));\n    ct.styles.push(f);\n    add_rels(opts.wbrels, ++rId, \"styles.\" + wbext, RELS.STY);\n    zip.file(\"[Content_Types].xml\", write_ct(ct, opts));\n    zip.file('_rels/.rels', write_rels(opts.rels));\n    zip.file('xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n    return zip;\n  }\n\n  function firstbyte(f, o) {\n    switch ((o || {}).type || \"base64\") {\n      case 'buffer':\n        return f[0];\n\n      case 'base64':\n        return Base64.decode(f.substr(0, 12)).charCodeAt(0);\n\n      case 'binary':\n        return f.charCodeAt(0);\n\n      case 'array':\n        return f[0];\n\n      default:\n        throw new Error(\"Unrecognized type \" + o.type);\n    }\n  }\n\n  function read_zip(data, opts) {\n    var zip,\n        d = data;\n    var o = opts || {};\n    if (!o.type) o.type = has_buf && Buffer.isBuffer(data) ? \"buffer\" : \"base64\";\n\n    switch (o.type) {\n      case \"base64\":\n        zip = new jszip(d, {\n          base64: true\n        });\n        break;\n\n      case \"binary\":\n      case \"array\":\n        zip = new jszip(d, {\n          base64: false\n        });\n        break;\n\n      case \"buffer\":\n        zip = new jszip(d);\n        break;\n\n      case \"file\":\n        zip = new jszip(d = _fs.readFileSync(data));\n        break;\n\n      default:\n        throw new Error(\"Unrecognized type \" + o.type);\n    }\n\n    return parse_zip(zip, o);\n  }\n\n  function readSync(data, opts) {\n    var zip,\n        d = data,\n        isfile = false,\n        n;\n    var o = opts || {};\n    if (!o.type) o.type = has_buf && Buffer.isBuffer(data) ? \"buffer\" : \"base64\";\n\n    if (o.type == \"file\") {\n      isfile = true;\n      o.type = \"buffer\";\n      d = _fs.readFileSync(data);\n    }\n\n    switch (n = firstbyte(d, o)) {\n      case 0xD0:\n        if (isfile) o.type = \"file\";\n        return parse_xlscfb(CFB.read(data, o), o);\n\n      case 0x09:\n        return parse_xlscfb(s2a(o.type === 'base64' ? Base64.decode(data) : data), o);\n\n      case 0x3C:\n        return parse_xlml(d, o);\n\n      case 0x50:\n        if (isfile) o.type = \"file\";\n        return read_zip(data, opts);\n\n      default:\n        throw new Error(\"Unsupported file \" + n);\n    }\n  }\n\n  function readFileSync(data, opts) {\n    var o = opts || {};\n    o.type = 'file';\n    var wb = readSync(data, o);\n    wb.FILENAME = data;\n    return wb;\n  }\n\n  function write_zip_type(wb, opts) {\n    var o = opts || {};\n    style_builder = new StyleBuilder(opts);\n    var z = write_zip(wb, o);\n\n    switch (o.type) {\n      case \"base64\":\n        return z.generate({\n          type: \"base64\"\n        });\n\n      case \"binary\":\n        return z.generate({\n          type: \"string\"\n        });\n\n      case \"buffer\":\n        return z.generate({\n          type: \"nodebuffer\"\n        });\n\n      case \"file\":\n        return _fs.writeFileSync(o.file, z.generate({\n          type: \"nodebuffer\"\n        }));\n\n      default:\n        throw new Error(\"Unrecognized type \" + o.type);\n    }\n  }\n\n  function writeSync(wb, opts) {\n    var o = opts || {};\n\n    switch (o.bookType) {\n      case 'xml':\n        return write_xlml(wb, o);\n\n      default:\n        return write_zip_type(wb, o);\n    }\n  }\n\n  function writeFileSync(wb, filename, opts) {\n    var o = opts || {};\n    o.type = 'file';\n    o.file = filename;\n\n    switch (o.file.substr(-5).toLowerCase()) {\n      case '.xlsx':\n        o.bookType = 'xlsx';\n        break;\n\n      case '.xlsm':\n        o.bookType = 'xlsm';\n        break;\n\n      case '.xlsb':\n        o.bookType = 'xlsb';\n        break;\n\n      default:\n        switch (o.file.substr(-4).toLowerCase()) {\n          case '.xls':\n            o.bookType = 'xls';\n            break;\n\n          case '.xml':\n            o.bookType = 'xml';\n            break;\n        }\n\n    }\n\n    return writeSync(wb, o);\n  }\n\n  function decode_row(rowstr) {\n    return parseInt(unfix_row(rowstr), 10) - 1;\n  }\n\n  function encode_row(row) {\n    return \"\" + (row + 1);\n  }\n\n  function fix_row(cstr) {\n    return cstr.replace(/([A-Z]|^)(\\d+)$/, \"$1$$$2\");\n  }\n\n  function unfix_row(cstr) {\n    return cstr.replace(/\\$(\\d+)$/, \"$1\");\n  }\n\n  function decode_col(colstr) {\n    var c = unfix_col(colstr),\n        d = 0,\n        i = 0;\n\n    for (; i !== c.length; ++i) d = 26 * d + c.charCodeAt(i) - 64;\n\n    return d - 1;\n  }\n\n  function encode_col(col) {\n    var s = \"\";\n\n    for (++col; col; col = Math.floor((col - 1) / 26)) s = String.fromCharCode((col - 1) % 26 + 65) + s;\n\n    return s;\n  }\n\n  function fix_col(cstr) {\n    return cstr.replace(/^([A-Z])/, \"$$$1\");\n  }\n\n  function unfix_col(cstr) {\n    return cstr.replace(/^\\$([A-Z])/, \"$1\");\n  }\n\n  function split_cell(cstr) {\n    return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/, \"$1,$2\").split(\",\");\n  }\n\n  function decode_cell(cstr) {\n    var splt = split_cell(cstr);\n    return {\n      c: decode_col(splt[0]),\n      r: decode_row(splt[1])\n    };\n  }\n\n  function encode_cell(cell) {\n    return encode_col(cell.c) + encode_row(cell.r);\n  }\n\n  function fix_cell(cstr) {\n    return fix_col(fix_row(cstr));\n  }\n\n  function unfix_cell(cstr) {\n    return unfix_col(unfix_row(cstr));\n  }\n\n  function decode_range(range) {\n    var x = range.split(\":\").map(decode_cell);\n    return {\n      s: x[0],\n      e: x[x.length - 1]\n    };\n  }\n\n  function encode_range(cs, ce) {\n    if (ce === undefined || typeof ce === 'number') return encode_range(cs.s, cs.e);\n    if (typeof cs !== 'string') cs = encode_cell(cs);\n    if (typeof ce !== 'string') ce = encode_cell(ce);\n    return cs == ce ? cs : cs + \":\" + ce;\n  }\n\n  function safe_decode_range(range) {\n    var o = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: 0\n      }\n    };\n    var idx = 0,\n        i = 0,\n        cc = 0;\n    var len = range.length;\n\n    for (idx = 0; i < len; ++i) {\n      if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n      idx = 26 * idx + cc;\n    }\n\n    o.s.c = --idx;\n\n    for (idx = 0; i < len; ++i) {\n      if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n      idx = 10 * idx + cc;\n    }\n\n    o.s.r = --idx;\n\n    if (i === len || range.charCodeAt(++i) === 58) {\n      o.e.c = o.s.c;\n      o.e.r = o.s.r;\n      return o;\n    }\n\n    for (idx = 0; i != len; ++i) {\n      if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n      idx = 26 * idx + cc;\n    }\n\n    o.e.c = --idx;\n\n    for (idx = 0; i != len; ++i) {\n      if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n      idx = 10 * idx + cc;\n    }\n\n    o.e.r = --idx;\n    return o;\n  }\n\n  function safe_format_cell(cell, v) {\n    if (cell.z !== undefined) try {\n      return cell.w = SSF.format(cell.z, v);\n    } catch (e) {}\n    if (!cell.XF) return v;\n\n    try {\n      return cell.w = SSF.format(cell.XF.ifmt || 0, v);\n    } catch (e) {\n      return '' + v;\n    }\n  }\n\n  function format_cell(cell, v) {\n    if (cell == null || cell.t == null) return \"\";\n    if (cell.w !== undefined) return cell.w;\n    if (v === undefined) return safe_format_cell(cell, cell.v);\n    return safe_format_cell(cell, v);\n  }\n\n  function sheet_to_json(sheet, opts) {\n    var val,\n        row,\n        range,\n        header = 0,\n        offset = 1,\n        r,\n        hdr = [],\n        isempty,\n        R,\n        C,\n        v;\n    var o = opts != null ? opts : {};\n    var raw = o.raw;\n    if (sheet == null || sheet[\"!ref\"] == null) return [];\n    range = o.range !== undefined ? o.range : sheet[\"!ref\"];\n    if (o.header === 1) header = 1;else if (o.header === \"A\") header = 2;else if (Array.isArray(o.header)) header = 3;\n\n    switch (typeof range) {\n      case 'string':\n        r = safe_decode_range(range);\n        break;\n\n      case 'number':\n        r = safe_decode_range(sheet[\"!ref\"]);\n        r.s.r = range;\n        break;\n\n      default:\n        r = range;\n    }\n\n    if (header > 0) offset = 0;\n    var rr = encode_row(r.s.r);\n    var cols = new Array(r.e.c - r.s.c + 1);\n    var out = new Array(r.e.r - r.s.r - offset + 1);\n    var outi = 0;\n\n    for (C = r.s.c; C <= r.e.c; ++C) {\n      cols[C] = encode_col(C);\n      val = sheet[cols[C] + rr];\n\n      switch (header) {\n        case 1:\n          hdr[C] = C;\n          break;\n\n        case 2:\n          hdr[C] = cols[C];\n          break;\n\n        case 3:\n          hdr[C] = o.header[C - r.s.c];\n          break;\n\n        default:\n          if (val === undefined) continue;\n          hdr[C] = format_cell(val);\n      }\n    }\n\n    for (R = r.s.r + offset; R <= r.e.r; ++R) {\n      rr = encode_row(R);\n      isempty = true;\n      if (header === 1) row = [];else {\n        row = {};\n        if (Object.defineProperty) Object.defineProperty(row, '__rowNum__', {\n          value: R,\n          enumerable: false\n        });else row.__rowNum__ = R;\n      }\n\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        val = sheet[cols[C] + rr];\n        if (val === undefined || val.t === undefined) continue;\n        v = val.v;\n\n        switch (val.t) {\n          case 'e':\n            continue;\n\n          case 's':\n            break;\n\n          case 'b':\n          case 'n':\n            break;\n\n          default:\n            throw 'unrecognized type ' + val.t;\n        }\n\n        if (v !== undefined) {\n          row[hdr[C]] = raw ? v : format_cell(val, v);\n          isempty = false;\n        }\n      }\n\n      if (isempty === false || header === 1) out[outi++] = row;\n    }\n\n    out.length = outi;\n    return out;\n  }\n\n  function sheet_to_row_object_array(sheet, opts) {\n    return sheet_to_json(sheet, opts != null ? opts : {});\n  }\n\n  function sheet_to_csv(sheet, opts) {\n    var out = \"\",\n        txt = \"\",\n        qreg = /\"/g;\n    var o = opts == null ? {} : opts;\n    if (sheet == null || sheet[\"!ref\"] == null) return \"\";\n    var r = safe_decode_range(sheet[\"!ref\"]);\n    var FS = o.FS !== undefined ? o.FS : \",\",\n        fs = FS.charCodeAt(0);\n    var RS = o.RS !== undefined ? o.RS : \"\\n\",\n        rs = RS.charCodeAt(0);\n    var row = \"\",\n        rr = \"\",\n        cols = [];\n    var i = 0,\n        cc = 0,\n        val;\n    var R = 0,\n        C = 0;\n\n    for (C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\n    for (R = r.s.r; R <= r.e.r; ++R) {\n      row = \"\";\n      rr = encode_row(R);\n\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        val = sheet[cols[C] + rr];\n        txt = val !== undefined ? '' + format_cell(val) : \"\";\n\n        for (i = 0, cc = 0; i !== txt.length; ++i) if ((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34) {\n          txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\";\n          break;\n        }\n\n        row += (C === r.s.c ? \"\" : FS) + txt;\n      }\n\n      out += row + RS;\n    }\n\n    return out;\n  }\n\n  var make_csv = sheet_to_csv;\n\n  function sheet_to_formulae(sheet) {\n    var cmds,\n        y = \"\",\n        x,\n        val = \"\";\n    if (sheet == null || sheet[\"!ref\"] == null) return \"\";\n    var r = safe_decode_range(sheet['!ref']),\n        rr = \"\",\n        cols = [],\n        C;\n    cmds = new Array((r.e.r - r.s.r + 1) * (r.e.c - r.s.c + 1));\n    var i = 0;\n\n    for (C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      rr = encode_row(R);\n\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        y = cols[C] + rr;\n        x = sheet[y];\n        val = \"\";\n        if (x === undefined) continue;\n        if (x.f != null) val = x.f;else if (x.w !== undefined) val = \"'\" + x.w;else if (x.v === undefined) continue;else val = \"\" + x.v;\n        cmds[i++] = y + \"=\" + val;\n      }\n    }\n\n    cmds.length = i;\n    return cmds;\n  }\n\n  var utils = {\n    encode_col: encode_col,\n    encode_row: encode_row,\n    encode_cell: encode_cell,\n    encode_range: encode_range,\n    decode_col: decode_col,\n    decode_row: decode_row,\n    split_cell: split_cell,\n    decode_cell: decode_cell,\n    decode_range: decode_range,\n    format_cell: format_cell,\n    get_formulae: sheet_to_formulae,\n    make_csv: sheet_to_csv,\n    make_json: sheet_to_json,\n    make_formulae: sheet_to_formulae,\n    sheet_to_csv: sheet_to_csv,\n    sheet_to_json: sheet_to_json,\n    sheet_to_formulae: sheet_to_formulae,\n    sheet_to_row_object_array: sheet_to_row_object_array\n  }; /////////////////////////////////////////////////////////////////////////////////////////////////////\n\n  var XmlNode = function () {\n    function XmlNode(tagName, attributes, children) {\n      if (!(this instanceof XmlNode)) {\n        return new XmlNode(tagName, attributes, children);\n      }\n\n      this.tagName = tagName;\n      this._attributes = attributes || {};\n      this._children = children || [];\n      this._prefix = '';\n      return this;\n    }\n\n    XmlNode.prototype.createElement = function () {\n      return new XmlNode(arguments);\n    };\n\n    XmlNode.prototype.children = function () {\n      return this._children;\n    };\n\n    XmlNode.prototype.append = function (node) {\n      this._children.push(node);\n\n      return this;\n    };\n\n    XmlNode.prototype.prefix = function (prefix) {\n      if (arguments.length == 0) {\n        return this._prefix;\n      }\n\n      this._prefix = prefix;\n      return this;\n    };\n\n    XmlNode.prototype.attr = function (attr, value) {\n      if (value == undefined) {\n        delete this._attributes[attr];\n        return this;\n      }\n\n      if (arguments.length == 0) {\n        return this._attributes;\n      } else if (typeof attr == 'string' && arguments.length == 1) {\n        return this._attributes.attr[attr];\n      }\n\n      if (typeof attr == 'object' && arguments.length == 1) {\n        for (var key in attr) {\n          this._attributes[key] = attr[key];\n        }\n      } else if (arguments.length == 2 && typeof attr == 'string') {\n        this._attributes[attr] = value;\n      }\n\n      return this;\n    };\n\n    var APOS = \"'\";\n    QUOTE = '\"';\n    var ESCAPED_QUOTE = {};\n    ESCAPED_QUOTE[QUOTE] = '&quot;';\n    ESCAPED_QUOTE[APOS] = '&apos;';\n\n    XmlNode.prototype.escapeAttributeValue = function (att_value) {\n      return '\"' + att_value.replace(/\\\"/g, '&quot;') + '\"'; // TODO Extend with four other codes\n    };\n\n    XmlNode.prototype.toXml = function (node) {\n      if (!node) node = this;\n      var xml = node._prefix;\n      xml += '<' + node.tagName;\n\n      if (node._attributes) {\n        for (var key in node._attributes) {\n          xml += ' ' + key + '=' + this.escapeAttributeValue('' + node._attributes[key]) + '';\n        }\n      }\n\n      if (node._children && node._children.length > 0) {\n        xml += \">\";\n\n        for (var i = 0; i < node._children.length; i++) {\n          xml += this.toXml(node._children[i]);\n        }\n\n        xml += '</' + node.tagName + '>';\n      } else {\n        xml += '/>';\n      }\n\n      return xml;\n    };\n\n    return XmlNode;\n  }(); /////////////////////////////////////////////////////////////////////////////////////////////////////\n\n\n  var StyleBuilder = function (options) {\n    var customNumFmtId = 164;\n    var table_fmt = {\n      0: 'General',\n      1: '0',\n      2: '0.00',\n      3: '#,##0',\n      4: '#,##0.00',\n      9: '0%',\n      10: '0.00%',\n      11: '0.00E+00',\n      12: '# ?/?',\n      13: '# ??/??',\n      14: 'm/d/yy',\n      15: 'd-mmm-yy',\n      16: 'd-mmm',\n      17: 'mmm-yy',\n      18: 'h:mm AM/PM',\n      19: 'h:mm:ss AM/PM',\n      20: 'h:mm',\n      21: 'h:mm:ss',\n      22: 'm/d/yy h:mm',\n      37: '#,##0 ;(#,##0)',\n      38: '#,##0 ;[Red](#,##0)',\n      39: '#,##0.00;(#,##0.00)',\n      40: '#,##0.00;[Red](#,##0.00)',\n      45: 'mm:ss',\n      46: '[h]:mm:ss',\n      47: 'mmss.0',\n      48: '##0.0E+0',\n      49: '@',\n      56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'\n    };\n    var fmt_table = {};\n\n    for (var idx in table_fmt) {\n      fmt_table[table_fmt[idx]] = idx;\n    } // cache style specs to avoid excessive duplication\n\n\n    _hashIndex = {};\n    _listIndex = [];\n    return {\n      initialize: function (options) {\n        this.$fonts = XmlNode('fonts').attr('count', 0).attr(\"x14ac:knownFonts\", \"1\");\n        this.$fills = XmlNode('fills').attr('count', 0);\n        this.$borders = XmlNode('borders').attr('count', 0);\n        this.$numFmts = XmlNode('numFmts').attr('count', 0);\n        this.$cellStyleXfs = XmlNode('cellStyleXfs');\n        this.$xf = XmlNode('xf').attr('numFmtId', 0).attr('fontId', 0).attr('fillId', 0).attr('borderId', 0);\n        this.$cellXfs = XmlNode('cellXfs').attr('count', 0);\n        this.$cellStyles = XmlNode('cellStyles').append(XmlNode('cellStyle').attr('name', 'Normal').attr('xfId', 0).attr('builtinId', 0));\n        this.$dxfs = XmlNode('dxfs').attr('count', \"0\");\n        this.$tableStyles = XmlNode('tableStyles').attr('count', '0').attr('defaultTableStyle', 'TableStyleMedium9').attr('defaultPivotStyle', 'PivotStyleMedium4');\n        this.$styles = XmlNode('styleSheet').attr('xmlns:mc', 'http://schemas.openxmlformats.org/markup-compatibility/2006').attr('xmlns:x14ac', 'http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac').attr('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main').attr('mc:Ignorable', 'x14ac').prefix('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles); // need to specify styles at index 0 and 1.\n        // the second style MUST be gray125 for some reason\n\n        var defaultStyle = options.defaultCellStyle || {};\n        if (!defaultStyle.font) defaultStyle.font = {\n          name: 'Calibri',\n          sz: '12'\n        };\n        if (!defaultStyle.font.name) defaultStyle.font.name = 'Calibri';\n        if (!defaultStyle.font.sz) defaultStyle.font.sz = 11;\n        if (!defaultStyle.fill) defaultStyle.fill = {\n          patternType: \"none\",\n          fgColor: {}\n        };\n        if (!defaultStyle.border) defaultStyle.border = {};\n        if (!defaultStyle.numFmt) defaultStyle.numFmt = 0;\n        this.defaultStyle = defaultStyle;\n        var gray125Style = JSON.parse(JSON.stringify(defaultStyle));\n        gray125Style.fill = {\n          patternType: \"gray125\",\n          fgColor: {}\n        };\n        this.addStyles([defaultStyle, gray125Style]);\n        return this;\n      },\n      // create a style entry and returns an integer index that can be used in the cell .s property\n      // these format of this object follows the emerging Common Spreadsheet Format\n      addStyle: function (attributes) {\n        var hashKey = JSON.stringify(attributes);\n        var index = _hashIndex[hashKey];\n\n        if (index == undefined) {\n          index = this._addXf(attributes); //_listIndex.push(attributes) -1;\n\n          _hashIndex[hashKey] = index;\n        } else {\n          index = _hashIndex[hashKey];\n        }\n\n        return index;\n      },\n      // create style entries and returns array of integer indexes that can be used in cell .s property\n      addStyles: function (styles) {\n        var self = this;\n        return styles.map(function (style) {\n          return self.addStyle(style);\n        });\n      },\n      _duckTypeStyle: function (attributes) {\n        if (typeof attributes == 'object' && (attributes.patternFill || attributes.fgColor)) {\n          return {\n            fill: attributes\n          }; // this must be read via XLSX.parseFile(...)\n        } else if (attributes.font || attributes.numFmt || attributes.border || attributes.fill) {\n          return attributes;\n        } else {\n          return this._getStyleCSS(attributes);\n        }\n      },\n      _getStyleCSS: function (css) {\n        return css; //TODO\n      },\n      // Create an <xf> record for the style as well as corresponding <font>, <fill>, <border>, <numfmts>\n      // Right now this is simple and creates a <font>, <fill>, <border>, <numfmts> for every <xf>\n      // We could perhaps get fancier and avoid duplicating  auxiliary entries as Excel presumably intended, but bother.\n      _addXf: function (attributes) {\n        var fontId = this._addFont(attributes.font);\n\n        var fillId = this._addFill(attributes.fill);\n\n        var borderId = this._addBorder(attributes.border);\n\n        var numFmtId = this._addNumFmt(attributes.numFmt);\n\n        var $xf = XmlNode('xf').attr(\"numFmtId\", numFmtId).attr(\"fontId\", fontId).attr(\"fillId\", fillId).attr(\"borderId\", borderId).attr(\"xfId\", \"0\");\n\n        if (fontId > 0) {\n          $xf.attr('applyFont', \"1\");\n        }\n\n        if (fillId > 0) {\n          $xf.attr('applyFill', \"1\");\n        }\n\n        if (borderId > 0) {\n          $xf.attr('applyBorder', \"1\");\n        }\n\n        if (numFmtId > 0) {\n          $xf.attr('applyNumberFormat', \"1\");\n        }\n\n        if (attributes.alignment) {\n          var $alignment = XmlNode('alignment');\n\n          if (attributes.alignment.horizontal) {\n            $alignment.attr('horizontal', attributes.alignment.horizontal);\n          }\n\n          if (attributes.alignment.vertical) {\n            $alignment.attr('vertical', attributes.alignment.vertical);\n          }\n\n          if (attributes.alignment.indent) {\n            $alignment.attr('indent', attributes.alignment.indent);\n          }\n\n          if (attributes.alignment.readingOrder) {\n            $alignment.attr('readingOrder', attributes.alignment.readingOrder);\n          }\n\n          if (attributes.alignment.wrapText) {\n            $alignment.attr('wrapText', attributes.alignment.wrapText);\n          }\n\n          if (attributes.alignment.textRotation != undefined) {\n            $alignment.attr('textRotation', attributes.alignment.textRotation);\n          }\n\n          $xf.append($alignment).attr('applyAlignment', 1);\n        }\n\n        this.$cellXfs.append($xf);\n        var count = +this.$cellXfs.children().length;\n        this.$cellXfs.attr('count', count);\n        return count - 1;\n      },\n      _addFont: function (attributes) {\n        if (!attributes) {\n          return 0;\n        }\n\n        var $font = XmlNode('font').append(XmlNode('sz').attr('val', attributes.sz || this.defaultStyle.font.sz)).append(XmlNode('name').attr('val', attributes.name || this.defaultStyle.font.name));\n        if (attributes.bold) $font.append(XmlNode('b'));\n        if (attributes.underline) $font.append(XmlNode('u'));\n        if (attributes.italic) $font.append(XmlNode('i'));\n        if (attributes.strike) $font.append(XmlNode('strike'));\n        if (attributes.outline) $font.append(XmlNode('outline'));\n        if (attributes.shadow) $font.append(XmlNode('shadow'));\n\n        if (attributes.vertAlign) {\n          $font.append(XmlNode('vertAlign').attr('val', attributes.vertAlign));\n        }\n\n        if (attributes.color) {\n          if (attributes.color.theme) {\n            $font.append(XmlNode('color').attr('theme', attributes.color.theme));\n\n            if (attributes.color.tint) {\n              //tint only if theme\n              $font.append(XmlNode('tint').attr('theme', attributes.color.tint));\n            }\n          } else if (attributes.color.rgb) {\n            // not both rgb and theme\n            $font.append(XmlNode('color').attr('rgb', attributes.color.rgb));\n          }\n        }\n\n        this.$fonts.append($font);\n        var count = this.$fonts.children().length;\n        this.$fonts.attr('count', count);\n        return count - 1;\n      },\n      _addNumFmt: function (numFmt) {\n        if (!numFmt) {\n          return 0;\n        }\n\n        if (typeof numFmt == 'string') {\n          var numFmtIdx = fmt_table[numFmt];\n\n          if (numFmtIdx >= 0) {\n            return numFmtIdx; // we found a match against built in formats\n          }\n        }\n\n        if (/^[0-9]+$/.exec(numFmt)) {\n          return numFmt; // we're matching an integer against some known code\n        }\n\n        numFmt = numFmt.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/'/g, '&apos;');\n        var $numFmt = XmlNode('numFmt').attr('numFmtId', ++customNumFmtId).attr('formatCode', numFmt);\n        this.$numFmts.append($numFmt);\n        var count = this.$numFmts.children().length;\n        this.$numFmts.attr('count', count);\n        return customNumFmtId;\n      },\n      _addFill: function (attributes) {\n        if (!attributes) {\n          return 0;\n        }\n\n        var $patternFill = XmlNode('patternFill').attr('patternType', attributes.patternType || 'solid');\n\n        if (attributes.fgColor) {\n          var $fgColor = XmlNode('fgColor'); //Excel doesn't like it when we set both rgb and theme+tint, but xlsx.parseFile() sets both\n          //var $fgColor = createElement('<fgColor/>', null, null, {xmlMode: true}).attr(attributes.fgColor)\n\n          if (attributes.fgColor.rgb) {\n            if (attributes.fgColor.rgb.length == 6) {\n              attributes.fgColor.rgb = \"FF\" + attributes.fgColor.rgb; /// add alpha to an RGB as Excel expects aRGB\n            }\n\n            $fgColor.attr('rgb', attributes.fgColor.rgb);\n            $patternFill.append($fgColor);\n          } else if (attributes.fgColor.theme) {\n            $fgColor.attr('theme', attributes.fgColor.theme);\n\n            if (attributes.fgColor.tint) {\n              $fgColor.attr('tint', attributes.fgColor.tint);\n            }\n\n            $patternFill.append($fgColor);\n          }\n\n          if (!attributes.bgColor) {\n            attributes.bgColor = {\n              \"indexed\": \"64\"\n            };\n          }\n        }\n\n        if (attributes.bgColor) {\n          var $bgColor = XmlNode('bgColor').attr(attributes.bgColor);\n          $patternFill.append($bgColor);\n        }\n\n        var $fill = XmlNode('fill').append($patternFill);\n        this.$fills.append($fill);\n        var count = this.$fills.children().length;\n        this.$fills.attr('count', count);\n        return count - 1;\n      },\n      _getSubBorder: function (direction, spec) {\n        var $direction = XmlNode(direction);\n\n        if (spec) {\n          if (spec.style) $direction.attr('style', spec.style);\n\n          if (spec.color) {\n            var $color = XmlNode('color');\n\n            if (spec.color.auto) {\n              $color.attr('auto', spec.color.auto);\n            } else if (spec.color.rgb) {\n              $color.attr('rgb', spec.color.rgb);\n            } else if (spec.color.theme || spec.color.tint) {\n              $color.attr('theme', spec.color.theme || \"1\");\n              $color.attr('tint', spec.color.tint || \"0\");\n            }\n\n            $direction.append($color);\n          }\n        }\n\n        return $direction;\n      },\n      _addBorder: function (attributes) {\n        if (!attributes) {\n          return 0;\n        }\n\n        var self = this;\n        var $border = XmlNode('border').attr(\"diagonalUp\", attributes.diagonalUp).attr(\"diagonalDown\", attributes.diagonalDown);\n        var directions = [\"left\", \"right\", \"top\", \"bottom\", \"diagonal\"];\n        directions.forEach(function (direction) {\n          $border.append(self._getSubBorder(direction, attributes[direction]));\n        });\n        this.$borders.append($border);\n        var count = this.$borders.children().length;\n        this.$borders.attr('count', count);\n        return count - 1;\n      },\n      toXml: function () {\n        return this.$styles.toXml();\n      }\n    }.initialize(options || {});\n  };\n\n  XLSX.parse_xlscfb = parse_xlscfb;\n  XLSX.parse_zip = parse_zip;\n  XLSX.read = readSync; //xlsread\n\n  XLSX.readFile = readFileSync; //readFile\n\n  XLSX.readFileSync = readFileSync;\n  XLSX.write = writeSync;\n  XLSX.writeFile = writeFileSync;\n  XLSX.writeFileSync = writeFileSync;\n  XLSX.utils = utils;\n  XLSX.CFB = CFB;\n  XLSX.SSF = SSF;\n})(typeof exports !== 'undefined' ? exports : XLSX);\n\nvar XLS = XLSX;","map":{"version":3,"names":["XLSX","make_xlsx","version","current_codepage","current_cptable","module","require","cptable","reset_cp","set_cp","cp","char_codes","data","o","i","len","length","charCodeAt","debom_xml","_getchar","_gc1","x","String","fromCharCode","utils","decode","substr","_gc2","Base64","make_b64","map","encode","input","utf8","c1","c2","c3","e1","e2","e3","e4","isNaN","charAt","b64_decode","replace","indexOf","has_buf","Buffer","new_raw_buf","Array","s2a","s","split","bconcat","bufs","concat","apply","chr0","chr1","SSF","make_ssf","_strrev","fill","c","l","pad0","v","d","t","pad_","rpad_","pad0r1","Math","round","pad0r2","p2_32","pow","pad0r","isgeneral","opts_fmt","fixopts","y","undefined","opts","table_fmt","days","months","frac","D","mixed","sgn","B","P_2","P_1","P","Q_2","Q_1","Q","A","floor","q","general_fmt_int","_general_int","general_fmt_num","make_general_fmt_num","gnr1","gnr2","gnr4","gnr5","gnr6","gfn2","w","gfn5","toFixed","toPrecision","toExponential","gfn3","gfn4","V","log","abs","LOG10E","_general_num","general_fmt","Error","_general","fix_hijri","date","parse_date_code","b2","time","dow","dout","out","T","u","m","H","M","S","date1904","Date","setDate","getDate","getFullYear","getMonth","getDay","write_date","type","fmt","val","ss0","ss","tt","outl","commaify","j","write_num","make_write_num","pct1","write_num_pct","sfmt","mul","write_num_cm","idx","write_num_exp","match","period","ee","fakee","$$","$1","$2","$3","frac1","write_num_f1","r","aval","sign","den","parseInt","rr","base","myn","myd","write_num_f2","dec1","closeparen","phone","hashq","str","cc","rnd","dd","dec","flr","write_num_flt","ffmt","oo","ri","ff","oa","min","max","lres","rres","write_num_cm2","write_num_pct2","write_num_exp2","write_num_int","split_fmt","in_str","_split","abstime","eval_fmt","flen","lst","dt","hr","toLowerCase","bt","ssm","nstr","jj","vv","myv","ostr","decpt","lasti","retval","_eval","cfregex","cfregex2","chkcond","thresh","parseFloat","choose_fmt","f","lat","m1","m2","format","table","_table","load","load_entry","get_table","load_table","tbl","XLMLFormatMap","DO_NOT_EXPORT_CFB","CFB","_CFB","exports","parse","file","mver","ssz","nmfs","ndfs","dir_start","minifat_start","difat_start","fat_addrs","blob","slice","prep_blob","mv","check_get_mver","header","check_shifts","nds","read_shift","chk","sectors","sectorify","sleuth_fat","sector_list","make_sector_list","name","ENDOFCHAIN","files","Paths","FileIndex","FullPaths","FullPathDir","read_directory","build_full_paths","root_name","shift","root","find_path","make_find_path","raw","find","HEADER_SIGNATURE","HEADER_CLSID","nsectors","ceil","FI","FPD","FP","L","R","C","pl","dad","push","UCFullPaths","UCPaths","toUpperCase","path","k","UCPath","cnt","sector","__readInt32LE","get_sector_list","start","chkd","sl","buf","buf_chain","modulus","addr","nodes","__toBuffer","minifat_store","namelen","ctime","mtime","__utf16le","color","clsid","state","ct","read_date","mt","size","storage","content","MSSZ","offset","__readUInt32LE","fs","readFileSync","filename","options","readSync","consts","MAXREGSECT","DIFSECT","FATSECT","FREESECT","HEADER_MINOR_VERSION","MAXREGSID","NOSTREAM","EntryTypes","read","ReadShift","CheckField","isval","keys","Object","evert_key","obj","key","K","evert","evert_num","evert_arr","datenum","epoch","cc2str","arr","getdata","asNodeBuffer","_data","getContent","prototype","call","toString","asBinary","safegetzipfile","zip","lowerCaseFiles","getzipfile","getzipdata","safe","e","_fs","jszip","JSZip","attregexg","tagregex","nsregex","nsregex2","parsexmltag","tag","skip_root","z","eq","substring","strip_ns","encodings","rencoding","rencstr","unescapexml","encregex","coderegex","text","decregex","charegex","escapexml","xlml_fixstr","entregex","entrepl","parsexmlbool","value","utf8read","utf8reada","orig","utf8readb","ww","corpus","utf8readc","matchtag","mtcache","g","RegExp","vtregex","vt_cache","vt_regex","vtvregex","vtmregex","parseVector","h","matches","baseType","res","forEach","wtregex","writetag","wxt_helper","join","writextag","write_w3cdtf","toISOString","write_vt","XML_HEADER","XMLNS","main","readIEEE754","isLE","nl","ml","el","eMax","eBias","bits","NaN","Infinity","___toBuffer","toBuffer_","___utf16le","utf16le_","b","__readUInt16LE","__hexlify","___hexlify","hexlify_","__utf8","___utf8","__readUInt8","__lpstr","___lpstr","lpstr_","__lpwstr","___lpwstr","lpwstr_","__double","___double","is_buf","is_buf_a","a","isArray","utf16le_b","isBuffer","lpstr_b","readUInt32LE","lpwstr_b","utf8_b","double_","readDoubleLE","is_buf_b","__readInt16LE","___unhexlify","__unhexlify","oI","oR","loc","lens","WriteShift","writeUInt16LE","writeUInt32LE","writeDoubleLE","writeInt32LE","hexstr","fld","pos","write_shift","parsenoop","writenoop","new_buf","sz","recordhopper","cb","tmpbyte","cntbyte","RT","XLSBRecordEnum","buf_array","blksz","newblk","ba_newblk","curbuf","endbuf","ba_endbuf","next","ba_next","end","ba_end","ba_push","_bufs","write_record","ba","payload","evert_RE","p","shift_cell_xls","cell","tgt","cRel","rRel","shift_range_xls","range","OFFCRYPTO","make_offcrypto","O","_crypto","crypto","rc4","md5","hex","createHash","update","digest","parse_StrRun","ich","ifnt","parse_RichStr","flags","parse_XLWideString","rgsStrRun","dwSizeStrRun","write_RichStr","write_XLWideString","parse_XLSBCell","col","iStyleRef","fPhShow","write_XLSBCell","parse_XLSBCodeName","parse_XLNullableWideString","cchCharacters","write_XLNullableWideString","parse_RelID","write_RelID","parse_RkNumber","fX100","fInt","RK","parse_UncheckedRfX","write_UncheckedRfX","parse_Xnum","write_Xnum","BErr","RBErr","parse_BrtColor","fValidRGB","xColorType","index","nTintAndShade","bRed","bGreen","bBlue","bAlpha","parse_FontFlags","fItalic","fStrikeout","fOutline","fShadow","fCondense","fExtend","VT_EMPTY","VT_NULL","VT_I2","VT_I4","VT_R4","VT_R8","VT_CY","VT_DATE","VT_BSTR","VT_ERROR","VT_BOOL","VT_VARIANT","VT_DECIMAL","VT_I1","VT_UI1","VT_UI2","VT_UI4","VT_I8","VT_UI8","VT_INT","VT_UINT","VT_LPSTR","VT_LPWSTR","VT_FILETIME","VT_BLOB","VT_STREAM","VT_STORAGE","VT_STREAMED_Object","VT_STORED_Object","VT_BLOB_Object","VT_CF","VT_CLSID","VT_VERSIONED_STREAM","VT_VECTOR","VT_ARRAY","VT_STRING","VT_USTR","VT_CUSTOM","DocSummaryPIDDSI","n","SummaryPIDSI","SpecialProperties","hasOwnProperty","CountryEnum","XLSFillPattern","rgbify","XLSIcv","ct2type","CT_LIST","workbooks","xlsx","xlsm","xlsb","xltx","strs","sheets","styles","type2ct","CT","parse_ct","ctext","calcchains","themes","coreprops","extprops","custprops","comments","vba","TODO","rels","xmlns","Extension","ContentType","PartName","WTF","console","error","calcchain","sst","style","defaults","CTYPE_XML_ROOT","xsd","xsi","CTYPE_DEFAULTS","write_ct","f1","bookType","f2","f3","RELS","WB","SHEET","parse_rels","currentFilePath","hash","resolveRelativePathIntoAbsolute","to","toksFrom","pop","toksTo","reversed","tokTo","rel","Type","Target","Id","TargetMode","canonictarget","RELS_ROOT","write_rels","rid","CORE_PROPS","CORE_PROPS_REGEX","parse_core_props","cur","CORE_PROPS_XML_ROOT","dc","dcterms","dcmitype","cp_doit","write_core_props","Props","title","subject","creator","keywords","description","CreatedDate","ModifiedDate","EXT_PROPS","parse_ext_props","HeadingPairs","TitlesOfParts","widx","Worksheets","parts","SheetNames","EXT_PROPS_XML_ROOT","vt","write_ext_props","W","Application","CUST_PROPS","custregex","parse_cust_props","xmlnsvt","toks","warn","CUST_PROPS_XML_ROOT","write_cust_props","pid","custprop","xlml_set_prop","parse_FILETIME","dwLowDateTime","dwHighDateTime","parse_lpstr","pad","parse_lpwstr","parse_VtStringBase","stringType","parse_VtString","parse_VtUnalignedString","parse_VtVecUnalignedLpstrValue","ret","parse_VtVecUnalignedLpstr","parse_VtHeadingPair","headingString","parse_TypedPropertyValue","headerParts","parse_VtVecHeadingPairValue","cElements","parse_VtVecHeadingPair","parse_dictionary","CodePage","dict","parse_BLOB","bytes","parse_ClipboardData","Size","parse_VtVector","_opts","parse_PropertySet","PIDSI","start_addr","NumProps","Dictionary","DictObj","PropID","Offset","PropH","fail","piddsi","oldpos","parsebool","parse_PropertySetStream","NumSets","FMTID0","FMTID1","Offset0","Offset1","vers","SystemIdentifier","PSet0","rval","FMTID","PSet1","parsenoop2","parslurp","target","parslurp2","parseuint16","parseuint16a","parse_Boolean","parse_Bes","parse_ShortXLUnicodeString","cch","width","encoding","biff","fHighByte","parse_XLUnicodeRichExtendedString","fExtSt","fRichSt","cRun","cbExtRst","msg","parse_XLUnicodeStringNoCch","parse_XLUnicodeString","parse_XLUnicodeString2","parse_ControlInfo","parse_URLMoniker","extra","url","parse_FileMoniker","cAnti","ansiLength","ansiPath","endServer","versionNumber","cbUnicodePathSize","cbUnicodePathBytes","usKeyValue","unicodePath","parse_HyperlinkMoniker","parse_HyperlinkString","parse_Hyperlink","sVer","displayName","targetFrameName","moniker","oleMoniker","location","guid","fileTime","parse_LongRGBA","parse_LongRGB","parse_XLSCell","rw","ixfe","parse_frtHeader","rt","parse_OptXLUnicodeString","HIDEOBJENUM","parse_HideObjEnum","parse_XTI","iSupBook","itabFirst","itabLast","parse_RkRec","parse_AddinUdf","udfName","parse_Ref8U","rwFirst","rwLast","colFirst","colLast","parse_RefU","parse_Ref","parse_FtCmo","ot","id","parse_FtNts","fSharedNote","parse_FtCf","cf","FtTab","parse_FtArray","fts","ft","parse_FontIndex","parse_BOF","BIFFVer","parse_InterfaceHdr","parse_WriteAccess","enc","UserName","parse_BoundSheet8","hidden","hs","parse_SST","ucnt","Count","Unique","parse_ExtSST","extsst","dsst","parse_Row","Col","rht","parse_ForceFullCalculation","fullcalc","parse_CompressPictures","parse_RecalcId","parse_DefaultRowHeight","miyRw","fl","Unsynced","DyZero","ExAsc","ExDsc","parse_Window1","xWn","yWn","dxWn","dyWn","iTabCur","iTabFirst","ctabSel","wTabRatio","Pos","Dim","Flags","CurTab","FirstTab","Selected","TabRatio","parse_Font","parse_LabelSst","isst","parse_Label","parse_Format","ifmt","fmtstr","parse_Dimensions","parse_RK","rkrec","rknum","parse_MulRk","rkrecs","lastcol","parse_CellStyleXF","patternType","icvFore","icvBack","parse_CellXF","parse_StyleXF","parse_XF","fStyle","parse_Guts","parse_BoolErr","parse_Number","xnum","parse_XLHeaderFooter","parse_SupBook","ctab","virtPath","rgst","sbcch","parse_ExternName","body","fBuiltIn","fWantAdvise","fWantPict","fOle","fOleLink","fIcon","parse_Lbl","chKey","cce","itab","rgce","parse_NameParsedFormula","Name","parse_ExternSheet","snames","parse_ShrFmla","ref","cUse","parse_SharedParsedFormula","parse_Array","parse_ArrayParsedFormula","parse_MTRSettings","fMTREnabled","fUserSetThreadCount","cUserThreadCount","parse_NoteSh","row","idObj","stAuthor","parse_Note","parse_MergeCells","merges","cmcs","parse_Obj","cmo","parse_TxO","lastobj","controlInfo","cchText","cbRuns","ifntEmpty","texts","hdr","parse_HLink","hlink","parse_HLinkTooltip","wzTooltip","parse_Country","parse_ClrtClient","ccv","parse_Palette","parse_XFCRC","cxfs","crc","parse_Style","parse_StyleExt","parse_ColInfo","parse_Window2","parse_Backup","parse_Blank","parse_BottomMargin","parse_BuiltInFnGroupCount","parse_CalcCount","parse_CalcDelta","parse_CalcIter","parse_CalcMode","parse_CalcPrecision","parse_CalcRefMode","parse_CalcSaveRecalc","parse_CodePage","parse_Compat12","parse_Date1904","parse_DefColWidth","parse_DSF","parse_EntExU2","parse_EOF","parse_Excel9File","parse_FeatHdr","parse_FontX","parse_Footer","parse_GridSet","parse_HCenter","parse_Header","parse_HideObj","parse_InterfaceEnd","parse_LeftMargin","parse_Mms","parse_ObjProtect","parse_Password","parse_PrintGrid","parse_PrintRowCol","parse_PrintSize","parse_Prot4Rev","parse_Prot4RevPass","parse_Protect","parse_RefreshAll","parse_RightMargin","parse_RRTabId","parse_ScenarioProtect","parse_Scl","parse_String","parse_SxBool","parse_TopMargin","parse_UsesELFs","parse_VCenter","parse_WinProtect","parse_WriteProtect","parse_VerticalPageBreaks","parse_HorizontalPageBreaks","parse_Selection","parse_Continue","parse_Pane","parse_Pls","parse_DCon","parse_DConRef","parse_DConName","parse_XCT","parse_CRN","parse_FileSharing","parse_Uncalced","parse_Template","parse_Intl","parse_WsBool","parse_Sort","parse_Sync","parse_LPr","parse_DxGCol","parse_FnGroupName","parse_FilterMode","parse_AutoFilterInfo","parse_AutoFilter","parse_Setup","parse_ScenMan","parse_SCENARIO","parse_SxView","parse_Sxvd","parse_SXVI","parse_SxIvd","parse_SXLI","parse_SXPI","parse_DocRoute","parse_RecipName","parse_MulBlank","parse_SXDI","parse_SXDB","parse_SXFDB","parse_SXDBB","parse_SXNum","parse_SxErr","parse_SXInt","parse_SXString","parse_SXDtr","parse_SxNil","parse_SXTbl","parse_SXTBRGIITM","parse_SxTbpg","parse_ObProj","parse_SXStreamID","parse_DBCell","parse_SXRng","parse_SxIsxoper","parse_BookBool","parse_DbOrParamQry","parse_OleObjectSize","parse_SXVS","parse_BkHim","parse_MsoDrawingGroup","parse_MsoDrawing","parse_MsoDrawingSelection","parse_PhoneticInfo","parse_SxRule","parse_SXEx","parse_SxFilt","parse_SxDXF","parse_SxItm","parse_SxName","parse_SxSelect","parse_SXPair","parse_SxFmla","parse_SxFormat","parse_SXVDEx","parse_SXFormula","parse_SXDBEx","parse_RRDInsDel","parse_RRDHead","parse_RRDChgCell","parse_RRDRenSheet","parse_RRSort","parse_RRDMove","parse_RRFormat","parse_RRAutoFmt","parse_RRInsertSh","parse_RRDMoveBegin","parse_RRDMoveEnd","parse_RRDInsDelBegin","parse_RRDInsDelEnd","parse_RRDConflict","parse_RRDDefName","parse_RRDRstEtxp","parse_LRng","parse_CUsr","parse_CbUsr","parse_UsrInfo","parse_UsrExcl","parse_FileLock","parse_RRDInfo","parse_BCUsrs","parse_UsrChk","parse_UserBView","parse_UserSViewBegin","parse_UserSViewEnd","parse_RRDUserView","parse_Qsi","parse_CondFmt","parse_CF","parse_DVal","parse_DConBin","parse_Lel","parse_XLSCodeName","parse_SXFDBType","parse_ObNoMacros","parse_Dv","parse_Index","parse_Table","parse_BigName","parse_ContinueBigName","parse_WebPub","parse_QsiSXTag","parse_DBQueryExt","parse_ExtString","parse_TxtQry","parse_Qsir","parse_Qsif","parse_RRDTQSIF","parse_OleDbConn","parse_WOpt","parse_SXViewEx","parse_SXTH","parse_SXPIEx","parse_SXVDTEx","parse_SXViewEx9","parse_ContinueFrt","parse_RealTimeData","parse_ChartFrtInfo","parse_FrtWrapper","parse_StartBlock","parse_EndBlock","parse_StartObject","parse_EndObject","parse_CatLab","parse_YMult","parse_SXViewLink","parse_PivotChartBits","parse_FrtFontList","parse_SheetExt","parse_BookExt","parse_SXAddl","parse_CrErr","parse_HFPicture","parse_Feat","parse_DataLabExt","parse_DataLabExtContents","parse_CellWatch","parse_FeatHdr11","parse_Feature11","parse_DropDownObjIds","parse_ContinueFrt11","parse_DConn","parse_List12","parse_Feature12","parse_CondFmt12","parse_CF12","parse_CFEx","parse_AutoFilter12","parse_ContinueFrt12","parse_MDTInfo","parse_MDXStr","parse_MDXTuple","parse_MDXSet","parse_MDXProp","parse_MDXKPI","parse_MDB","parse_PLV","parse_DXF","parse_TableStyles","parse_TableStyle","parse_TableStyleElement","parse_NamePublish","parse_NameCmt","parse_SortData","parse_GUIDTypeLib","parse_FnGrp12","parse_NameFnGrp12","parse_HeaderFooter","parse_CrtLayout12","parse_CrtMlFrt","parse_CrtMlFrtContinue","parse_ShapePropsStream","parse_TextPropsStream","parse_RichTextStream","parse_CrtLayout12A","parse_Units","parse_Chart","parse_Series","parse_DataFormat","parse_LineFormat","parse_MarkerFormat","parse_AreaFormat","parse_PieFormat","parse_AttachedLabel","parse_SeriesText","parse_ChartFormat","parse_Legend","parse_SeriesList","parse_Bar","parse_Line","parse_Pie","parse_Area","parse_Scatter","parse_CrtLine","parse_Axis","parse_Tick","parse_ValueRange","parse_CatSerRange","parse_AxisLine","parse_CrtLink","parse_DefaultText","parse_Text","parse_ObjectLink","parse_Frame","parse_Begin","parse_End","parse_PlotArea","parse_Chart3d","parse_PicF","parse_DropBar","parse_Radar","parse_Surf","parse_RadarArea","parse_AxisParent","parse_LegendException","parse_ShtProps","parse_SerToCrt","parse_AxesUsed","parse_SBaseRef","parse_SerParent","parse_SerAuxTrend","parse_IFmtRecord","parse_Pos","parse_AlRuns","parse_BRAI","parse_SerAuxErrBar","parse_SerFmt","parse_Chart3DBarShape","parse_Fbi","parse_BopPop","parse_AxcExt","parse_Dat","parse_PlotGrowth","parse_SIIndex","parse_GelFrame","parse_BopPopCustom","parse_Fbi2","parse_BIFF5String","parse_BIFF2STR","parse_BIFF2NUM","num","CS2CP","parse_rs","parse_rs_factory","tregex","rpregex","rregex","rend","nlregex","parse_rpr","rpr","intro","outro","font","strike","rgb","family","parse_r","terms","rs","sitregex","sirregex","parse_si","html","cellHTML","sstr0","sstr1","sstr2","parse_sst_xml","count","uniqueCount","SST","straywsregex","write_sst_xml","bookSST","sitag","parse_BrtBeginSst","parse_sst_bin","pass","hopper_sst","write_BrtBeginSst","write_BrtSSTItem","write_sst_bin","_JS2ANSI","parse_Version","Major","Minor","parse_EncryptionHeader","tmp","AlgID","parse_EncryptionVerifier","parse_RC4CryptoHeader","EncryptionVersionInfo","EncryptionHeader","EncryptionVerifier","parse_RC4Header","Salt","EncryptedVerifier","EncryptedVerifierHash","crypto_CreatePasswordVerifier_Method1","Password","Verifier","PasswordArray","PasswordDecoded","PasswordByte","Intermediate1","Intermediate2","Intermediate3","crypto_CreateXorArray_Method1","PadArray","InitialCode","XorMatrix","Ror","Byte","XorRor","byte1","byte2","CreateXorKey_Method1","XorKey","CurrentElement","Char","password","Index","ObfuscationArray","Temp","PasswordLastChar","PadIndex","crypto_DecryptData_Method1","Data","XorArrayIndex","XorArray","Value","crypto_MakeXorDecryptor","parse_XORObfuscation","verificationBytes","verifier","valid","insitu_decrypt","parse_FilePassHeader","Info","parse_FilePass","hex2RGB","rgb2Hex","rgb2HSL","G","H6","L2","hsl2RGB","hsl","h6","X","rgb_tint","tint","rev","DEF_MDW","MAX_MDW","MIN_MDW","MDW","width2px","px2char","px","char2width","chr","cycle_width","collw","find_mdw","coll","XLMLPatternTypeMap","parse_fills","Fills","bgColor","indexed","theme","themeElements","clrScheme","raw_rgb","fgColor","parse_fonts","Fonts","bold","underline","italic","outline","shadow","vertAlign","parse_borders","Borders","border","sub_border","diagonalUp","diagonalDown","left","right","top","bottom","diagonal","auto","parse_numFmts","NumberFmt","formatCode","numFmtId","write_numFmts","NF","parse_cellXfs","CellXf","xf","fillId","alignment","vertical","horizontal","textRotation","indent","wrapText","write_cellXfs","cellXfs","parse_sty_xml","make_pstyx","numFmtRegex","cellXfRegex","fillsRegex","bordersRegex","STYLES_XML_ROOT","STY","write_sty_xml","wb","style_builder","toXml","parse_BrtFmt","stFmtCode","parse_BrtFont","dyHeight","grbit","bls","sss","uls","bFamily","bCharSet","brtColor","bFontScheme","Bold","Italic","Strikeout","Outline","Shadow","Condense","Extend","Sub","Sup","parse_BrtXF","ixfeParent","parse_sty_bin","hopper_sty","write_sty_bin","THEME","parse_clrScheme","lastClr","parse_fontScheme","parse_fmtScheme","clrsregex","fntsregex","fmtsregex","parse_themeElements","themeltregex","parse_theme_xml","write_theme","themeXml","parse_Theme","dwThemeVersion","parse_ColorTheme","parse_FullColorExt","xclrType","nTintShade","xclrValue","parse_IcvXF","parse_XFExtGradient","parse_ExtProp","extType","parse_XFExt","cexts","ext","update_xfext","xfext","xfe","parse_cc_xml","write_cc_xml","parse_BrtCalcChainItem$","encode_cell","parse_cc_bin","hopper_cc","write_cc_bin","parse_comments","dirComments","sheetRels","canonicalpath","parse_cmnt","sheetNames","sheetName","insertCommentsIntoSheet","sheet","comment","safe_decode_range","thisCell","decode_cell","encoded","encode_range","author","parse_comments_xml","authors","commentList","trim","authorId","sheetRows","textMatch","write_comments_xml","parse_BrtBeginComment","iauthor","rfx","parse_BrtCommentAuthor","parse_BrtCommentText","parse_comments_bin","hopper_cmnt","write_comments_bin","rc_to_a1","rcregex","rcbase","rcfunc","$4","$5","encode_col","encode_row","fstr","parseread","parseread1","parse_ColRelU","parse_RgceArea","parse_RgceAreaRel","parse_RgceLoc","parse_RgceLocRel","cl","parse_PtgArea","area","parse_PtgArea3d","ixti","parse_PtgAreaErr","parse_PtgAreaErr3d","parse_PtgAreaN","parse_PtgArray","parse_PtgAttrBaxcel","bitSemi","bitBaxcel","parse_PtgAttrChoose","parse_PtgAttrGoto","bitGoto","parse_PtgAttrIf","bitIf","parse_PtgAttrSemi","parse_PtgAttrSpaceType","parse_PtgAttrSpace","parse_PtgAttrSpaceSemi","parse_PtgRef","ptg","parse_PtgRefN","parse_PtgRef3d","parse_PtgFunc","iftab","FtabArgc","Ftab","parse_PtgFuncVar","cparams","tab","parsetab","Cetab","parse_PtgAttrSum","parse_PtgConcat","parse_PtgExp","parse_PtgErr","parse_PtgInt","parse_PtgBool","parse_PtgNum","parse_PtgStr","parse_SerAr","parse_PtgExtraMem","parse_PtgExtraArray","cols","rows","parse_PtgName","nameindex","parse_PtgNameX","parse_PtgMemArea","parse_PtgMemFunc","parse_PtgRefErr","parse_PtgAdd","parse_PtgDiv","parse_PtgEq","parse_PtgGe","parse_PtgGt","parse_PtgIsect","parse_PtgLe","parse_PtgLt","parse_PtgMissArg","parse_PtgMul","parse_PtgNe","parse_PtgParen","parse_PtgPercent","parse_PtgPower","parse_PtgRange","parse_PtgSub","parse_PtgUminus","parse_PtgUnion","parse_PtgUplus","parse_PtgMemErr","parse_PtgMemNoMem","parse_PtgRefErr3d","parse_PtgTbl","PtgTypes","PtgDupes","Ptg18","Ptg19","parse_Formula","parse_FormulaValue","chn","cbf","parse_XLSCellParsedFormula","formula","shared","parse_RgbExtra","parse_Rgce","rgcb","ptgs","mapper","stringify_formula","supbooks","_range","stack","nameidx","fflen","argc","func","args","lbl","XLSXFutureFunctions","bookidx","externbook","sharedf","parsedf","fnd","arrayf","parse_XLSBCellParsedFormula","PtgDataType","_ssfopts","WS","get_sst_id","get_cell_style","exec","numFmt","addStyle","revssf","fontId","borderId","xfId","applyNumberFormat","get_cell_style_csf","cellXf","applyAlignment","JSON","stringify","safe_format","fmtid","fillid","cellNF","parse_ws_xml_dim","ws","mergecregex","sheetdataregex","hlinkregex","dimregex","colregex","parse_ws_xml","ridx","mergecells","columns","cellStyles","parse_ws_xml_cols","refguess","mtch","parse_ws_xml_data","parse_ws_xml_hlinks","tmpref","write_ws_xml_merges","write_ws_xml_pagesetup","setup","pageSetup","scale","orientation","horizontalDpi","verticalDpi","Rel","rng","seencol","coli","colm","colM","wpx","wch","write_ws_xml_cols","customWidth","write_ws_xml_cell","oldt","oldv","cellDates","os","Strings","parse_ws_xml_data_factory","cellregex","rowregex","isregex","match_v","match_f","sdata","guess","cells","cref","tagr","tagc","sstr","do_format","marr","marrlen","xlen","cellFormula","sheetStubs","write_ws_xml_data","WS_XML_ROOT","write_ws_xml","sidx","rdata","Sheets","kids","pane","selection","activeCell","sqref","sheetView","showGridLines","tabSelected","workbookViewId","write_ws_xml_row_breaks","write_ws_xml_col_breaks","breaks","brk","thisBreak","nextBreak","man","manualBreakCount","parse_BrtRowHdr","parse_BrtWsDim","write_BrtWsDim","parse_BrtWsProp","parse_BrtCellBlank","write_BrtCellBlank","parse_BrtCellBool","fBool","parse_BrtCellError","parse_BrtCellIsst","parse_BrtCellReal","parse_BrtCellRk","parse_BrtCellSt","parse_BrtFmlaBool","parse_BrtFmlaError","parse_BrtFmlaNum","parse_BrtFmlaString","parse_BrtMergeCell","parse_BrtHLink","relId","tooltip","display","parse_ws_bin","ws_parse","write_ws_bin_cell","write_CELLTABLE","write_ws_bin","WBPropsDef","WBViewDef","SheetDef","CalcPrDef","CustomWBViewDef","push_defaults_array","push_defaults","parse_wb_defaults","WBProps","CalcPr","WBView","wbnsregex","parse_wb_xml","AppVersion","xml_wb","WB_XML_ROOT","safe1904","Workbook","write_wb_xml","sheetId","hasPrintHeaders","printHeader","printColumns","localSheetId","parse_BrtBundleSh","hsState","iTabID","strRelID","write_BrtBundleSh","parse_BrtWbProp","strName","write_BrtWbProp","parse_BrtFRTArchID$","ArchID","parse_wb_bin","hopper_wb","write_BUNDLESHS","write_BrtFileVersion","write_BOOKVIEWS","write_BrtCalcProp","write_BrtFileRecover","write_wb_bin","parse_wb","parse_ws","parse_sty","parse_theme","parse_sst","parse_cc","write_wb","write_ws","write_sty","write_sst","attregexg2","attregex2","_chr","xlml_parsexmltag","words","xlml_parsexmltagobj","xlml_format","xlml_set_custprop","Custprops","Rn","safe_format_xlml","nf","process_style_xlml","stag","Interior","I","Pattern","ID","parse_xlml_data","xml","csty","sid","StyleID","interiors","Parent","UTC","Formula","xlml_clean_comment","xlml_normalize","xlmlregex","parse_xlml_xml","sheetnames","cursheet","sheetname","dtag","didx","fidx","pidx","cstys","lastIndex","HRef","HRefScreenTip","MergeAcross","MergeDown","Format","Span","Author","seen","bookSheets","bookProps","parse_xlml","fix_read_opts","write_xlml","parse_compobj","UserType","Reserved1","slurp","XLSRecordEnum","ll","safe_format_xf","XF","make_cell","parse_workbook","Directory","found_sheet","last_formula","cur_sheet","Preamble","lastcell","last_cell","cmnt","rngC","rngR","shared_formulae","array_formulae","temp_val","country","cell_valid","XFs","palette","get_rgb","getrgb","icv","process_cell_style","pcs","line","xfd","addcell","rrtabid","lastuser","codepage","winlocked","wtf","objects","sbc","sbci","sbcli","last_Rn","file_depth","RecordType","Date1904","WriteProtect","RefreshAll","CalcCount","CalcDelta","CalcIter","CalcMode","CalcPrecision","CalcSaveRecalc","CalcRefMode","FullCalc","TxO","noteobj","sheetnamesraw","sort","Number","Encryption","Metadata","Country","parse_xlscfb","cfb","CompObj","Summary","CompObjP","SummaryP","WorkbookP","parse_props","props","DocSummary","bookFiles","DSI","SI","parse_ods","ODS","fix_opts_func","fix_opts","fix_write_opts","safe_parse_wbrels","wbrels","pwbr","safe_parse_ws","relsPath","nodirs","parse_zip","entries","filter","dir","binname","propdata","pluck","deps","bookDeps","wbsheets","wbext","wbrelsfile","nmode","Deps","Styles","Themes","bookVBA","vbaraw","bin","add_rels","rId","relobj","write_zip","firstbyte","read_zip","base64","isfile","FILENAME","write_zip_type","StyleBuilder","generate","writeFileSync","writeSync","decode_row","rowstr","unfix_row","fix_row","cstr","decode_col","colstr","unfix_col","fix_col","split_cell","splt","fix_cell","unfix_cell","decode_range","cs","ce","safe_format_cell","format_cell","sheet_to_json","isempty","outi","defineProperty","enumerable","__rowNum__","sheet_to_row_object_array","sheet_to_csv","txt","qreg","FS","RS","make_csv","sheet_to_formulae","cmds","get_formulae","make_json","make_formulae","XmlNode","tagName","attributes","children","_attributes","_children","_prefix","createElement","arguments","append","node","prefix","attr","APOS","QUOTE","ESCAPED_QUOTE","escapeAttributeValue","att_value","customNumFmtId","fmt_table","_hashIndex","_listIndex","initialize","$fonts","$fills","$borders","$numFmts","$cellStyleXfs","$xf","$cellXfs","$cellStyles","$dxfs","$tableStyles","$styles","defaultStyle","defaultCellStyle","gray125Style","addStyles","hashKey","_addXf","self","_duckTypeStyle","patternFill","_getStyleCSS","css","_addFont","_addFill","_addBorder","_addNumFmt","$alignment","readingOrder","$font","numFmtIdx","$numFmt","$patternFill","$fgColor","$bgColor","$fill","_getSubBorder","direction","spec","$direction","$color","$border","directions","readFile","write","writeFile","XLS"],"sources":["/Users/contactaisoft/Documents/GitHub/REACT_LANGUAGE/tcsmgmt/node_modules/xlsx/xlsx.js"],"sourcesContent":["/* xlsx.js (C) 2013-2015 SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*jshint -W041 */\n/*jshint funcscope:true, eqnull:true */\nvar XLSX = {};\n(function make_xlsx(XLSX){\nXLSX.version = '0.8.20';\nvar current_codepage = 1200, current_cptable;\nif(typeof module !== \"undefined\" && typeof require !== 'undefined') {\n\tif(typeof cptable === 'undefined') cptable = require('./dist/cpexcel');\n\tcurrent_cptable = cptable[current_codepage];\n}\nfunction reset_cp() { set_cp(1200); }\nvar set_cp = function(cp) { current_codepage = cp; };\n\nfunction char_codes(data) { var o = []; for(var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i); return o; }\nvar debom_xml = function(data) { return data; };\n\nvar _getchar = function _gc1(x) { return String.fromCharCode(x); };\nif(typeof cptable !== 'undefined') {\n\tset_cp = function(cp) { current_codepage = cp; current_cptable = cptable[cp]; };\n\tdebom_xml = function(data) {\n\t\tif(data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) { return cptable.utils.decode(1200, char_codes(data.substr(2))); }\n\t\treturn data;\n\t};\n\t_getchar = function _gc2(x) {\n\t\tif(current_codepage === 1200) return String.fromCharCode(x);\n\t\treturn cptable.utils.decode(current_codepage, [x&255,x>>8])[0];\n\t};\n}\nvar Base64 = (function make_b64(){\n\tvar map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\treturn {\n\t\tencode: function(input, utf8) {\n\t\t\tvar o = \"\";\n\t\t\tvar c1, c2, c3, e1, e2, e3, e4;\n\t\t\tfor(var i = 0; i < input.length; ) {\n\t\t\t\tc1 = input.charCodeAt(i++);\n\t\t\t\tc2 = input.charCodeAt(i++);\n\t\t\t\tc3 = input.charCodeAt(i++);\n\t\t\t\te1 = c1 >> 2;\n\t\t\t\te2 = (c1 & 3) << 4 | c2 >> 4;\n\t\t\t\te3 = (c2 & 15) << 2 | c3 >> 6;\n\t\t\t\te4 = c3 & 63;\n\t\t\t\tif (isNaN(c2)) { e3 = e4 = 64; }\n\t\t\t\telse if (isNaN(c3)) { e4 = 64; }\n\t\t\t\to += map.charAt(e1) + map.charAt(e2) + map.charAt(e3) + map.charAt(e4);\n\t\t\t}\n\t\t\treturn o;\n\t\t},\n\t\tdecode: function b64_decode(input, utf8) {\n\t\t\tvar o = \"\";\n\t\t\tvar c1, c2, c3;\n\t\t\tvar e1, e2, e3, e4;\n\t\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\t\t\tfor(var i = 0; i < input.length;) {\n\t\t\t\te1 = map.indexOf(input.charAt(i++));\n\t\t\t\te2 = map.indexOf(input.charAt(i++));\n\t\t\t\te3 = map.indexOf(input.charAt(i++));\n\t\t\t\te4 = map.indexOf(input.charAt(i++));\n\t\t\t\tc1 = e1 << 2 | e2 >> 4;\n\t\t\t\tc2 = (e2 & 15) << 4 | e3 >> 2;\n\t\t\t\tc3 = (e3 & 3) << 6 | e4;\n\t\t\t\to += String.fromCharCode(c1);\n\t\t\t\tif (e3 != 64) { o += String.fromCharCode(c2); }\n\t\t\t\tif (e4 != 64) { o += String.fromCharCode(c3); }\n\t\t\t}\n\t\t\treturn o;\n\t\t}\n\t};\n})();\nvar has_buf = (typeof Buffer !== 'undefined');\n\nfunction new_raw_buf(len) {\n\t/* jshint -W056 */\n\treturn new (has_buf ? Buffer : Array)(len);\n\t/* jshint +W056 */\n}\n\nfunction s2a(s) {\n\tif(has_buf) return new Buffer(s, \"binary\");\n\treturn s.split(\"\").map(function(x){ return x.charCodeAt(0) & 0xff; });\n}\n\nvar bconcat = function(bufs) { return [].concat.apply([], bufs); };\n\nvar chr0 = /\\u0000/g, chr1 = /[\\u0001-\\u0006]/;\n/* ssf.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\n/*jshint -W041 */\nvar SSF = {};\nvar make_ssf = function make_ssf(SSF){\nSSF.version = '0.8.1';\nfunction _strrev(x) { var o = \"\", i = x.length-1; while(i>=0) o += x.charAt(i--); return o; }\nfunction fill(c,l) { var o = \"\"; while(o.length < l) o+=c; return o; }\nfunction pad0(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad_(v,d){var t=\"\"+v;return t.length>=d?t:fill(' ',d-t.length)+t;}\nfunction rpad_(v,d){var t=\"\"+v; return t.length>=d?t:t+fill(' ',d-t.length);}\nfunction pad0r1(v,d){var t=\"\"+Math.round(v); return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad0r2(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nvar p2_32 = Math.pow(2,32);\nfunction pad0r(v,d){if(v>p2_32||v<-p2_32) return pad0r1(v,d); var i = Math.round(v); return pad0r2(i,d); }\nfunction isgeneral(s, i) { return s.length >= 7 + i && (s.charCodeAt(i)|32) === 103 && (s.charCodeAt(i+1)|32) === 101 && (s.charCodeAt(i+2)|32) === 110 && (s.charCodeAt(i+3)|32) === 101 && (s.charCodeAt(i+4)|32) === 114 && (s.charCodeAt(i+5)|32) === 97 && (s.charCodeAt(i+6)|32) === 108; }\n/* Options */\nvar opts_fmt = [\n\t[\"date1904\", 0],\n\t[\"output\", \"\"],\n\t[\"WTF\", false]\n];\nfunction fixopts(o){\n\tfor(var y = 0; y != opts_fmt.length; ++y) if(o[opts_fmt[y][0]]===undefined) o[opts_fmt[y][0]]=opts_fmt[y][1];\n}\nSSF.opts = opts_fmt;\nvar table_fmt = {\n\t0:  'General',\n\t1:  '0',\n\t2:  '0.00',\n\t3:  '#,##0',\n\t4:  '#,##0.00',\n\t9:  '0%',\n\t10: '0.00%',\n\t11: '0.00E+00',\n\t12: '# ?/?',\n\t13: '# ??/??',\n\t14: 'm/d/yy',\n\t15: 'd-mmm-yy',\n\t16: 'd-mmm',\n\t17: 'mmm-yy',\n\t18: 'h:mm AM/PM',\n\t19: 'h:mm:ss AM/PM',\n\t20: 'h:mm',\n\t21: 'h:mm:ss',\n\t22: 'm/d/yy h:mm',\n\t37: '#,##0 ;(#,##0)',\n\t38: '#,##0 ;[Red](#,##0)',\n\t39: '#,##0.00;(#,##0.00)',\n\t40: '#,##0.00;[Red](#,##0.00)',\n\t45: 'mm:ss',\n\t46: '[h]:mm:ss',\n\t47: 'mmss.0',\n\t48: '##0.0E+0',\n\t49: '@',\n\t56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"',\n\t65535: 'General'\n};\nvar days = [\n\t['Sun', 'Sunday'],\n\t['Mon', 'Monday'],\n\t['Tue', 'Tuesday'],\n\t['Wed', 'Wednesday'],\n\t['Thu', 'Thursday'],\n\t['Fri', 'Friday'],\n\t['Sat', 'Saturday']\n];\nvar months = [\n\t['J', 'Jan', 'January'],\n\t['F', 'Feb', 'February'],\n\t['M', 'Mar', 'March'],\n\t['A', 'Apr', 'April'],\n\t['M', 'May', 'May'],\n\t['J', 'Jun', 'June'],\n\t['J', 'Jul', 'July'],\n\t['A', 'Aug', 'August'],\n\t['S', 'Sep', 'September'],\n\t['O', 'Oct', 'October'],\n\t['N', 'Nov', 'November'],\n\t['D', 'Dec', 'December']\n];\nfunction frac(x, D, mixed) {\n\tvar sgn = x < 0 ? -1 : 1;\n\tvar B = x * sgn;\n\tvar P_2 = 0, P_1 = 1, P = 0;\n\tvar Q_2 = 1, Q_1 = 0, Q = 0;\n\tvar A = Math.floor(B);\n\twhile(Q_1 < D) {\n\t\tA = Math.floor(B);\n\t\tP = A * P_1 + P_2;\n\t\tQ = A * Q_1 + Q_2;\n\t\tif((B - A) < 0.0000000005) break;\n\t\tB = 1 / (B - A);\n\t\tP_2 = P_1; P_1 = P;\n\t\tQ_2 = Q_1; Q_1 = Q;\n\t}\n\tif(Q > D) { Q = Q_1; P = P_1; }\n\tif(Q > D) { Q = Q_2; P = P_2; }\n\tif(!mixed) return [0, sgn * P, Q];\n\tif(Q===0) throw \"Unexpected state: \"+P+\" \"+P_1+\" \"+P_2+\" \"+Q+\" \"+Q_1+\" \"+Q_2;\n\tvar q = Math.floor(sgn * P/Q);\n\treturn [q, sgn*P - q*Q, Q];\n}\nfunction general_fmt_int(v, opts) { return \"\"+v; }\nSSF._general_int = general_fmt_int;\nvar general_fmt_num = (function make_general_fmt_num() {\nvar gnr1 = /\\.(\\d*[1-9])0+$/, gnr2 = /\\.0*$/, gnr4 = /\\.(\\d*[1-9])0+/, gnr5 = /\\.0*[Ee]/, gnr6 = /(E[+-])(\\d)$/;\nfunction gfn2(v) {\n\tvar w = (v<0?12:11);\n\tvar o = gfn5(v.toFixed(12)); if(o.length <= w) return o;\n\to = v.toPrecision(10); if(o.length <= w) return o;\n\treturn v.toExponential(5);\n}\nfunction gfn3(v) {\n\tvar o = v.toFixed(11).replace(gnr1,\".$1\");\n\tif(o.length > (v<0?12:11)) o = v.toPrecision(6);\n\treturn o;\n}\nfunction gfn4(o) {\n\tfor(var i = 0; i != o.length; ++i) if((o.charCodeAt(i) | 0x20) === 101) return o.replace(gnr4,\".$1\").replace(gnr5,\"E\").replace(\"e\",\"E\").replace(gnr6,\"$10$2\");\n\treturn o;\n}\nfunction gfn5(o) {\n\t//for(var i = 0; i != o.length; ++i) if(o.charCodeAt(i) === 46) return o.replace(gnr2,\"\").replace(gnr1,\".$1\");\n\t//return o;\n\treturn o.indexOf(\".\") > -1 ? o.replace(gnr2,\"\").replace(gnr1,\".$1\") : o;\n}\nreturn function general_fmt_num(v, opts) {\n\tvar V = Math.floor(Math.log(Math.abs(v))*Math.LOG10E), o;\n\tif(V >= -4 && V <= -1) o = v.toPrecision(10+V);\n\telse if(Math.abs(V) <= 9) o = gfn2(v);\n\telse if(V === 10) o = v.toFixed(10).substr(0,12);\n\telse o = gfn3(v);\n\treturn gfn5(gfn4(o));\n};})();\nSSF._general_num = general_fmt_num;\nfunction general_fmt(v, opts) {\n\tswitch(typeof v) {\n\t\tcase 'string': return v;\n\t\tcase 'boolean': return v ? \"TRUE\" : \"FALSE\";\n\t\tcase 'number': return (v|0) === v ? general_fmt_int(v, opts) : general_fmt_num(v, opts);\n\t}\n\tthrow new Error(\"unsupported value in General format: \" + v);\n}\nSSF._general = general_fmt;\nfunction fix_hijri(date, o) { return 0; }\nfunction parse_date_code(v,opts,b2) {\n\tif(v > 2958465 || v < 0) return null;\n\tvar date = (v|0), time = Math.floor(86400 * (v - date)), dow=0;\n\tvar dout=[];\n\tvar out={D:date, T:time, u:86400*(v-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};\n\tif(Math.abs(out.u) < 1e-6) out.u = 0;\n\tfixopts(opts != null ? opts : (opts=[]));\n\tif(opts.date1904) date += 1462;\n\tif(out.u > 0.999) {\n\t\tout.u = 0;\n\t\tif(++time == 86400) { time = 0; ++date; }\n\t}\n\tif(date === 60) {dout = b2 ? [1317,10,29] : [1900,2,29]; dow=3;}\n\telse if(date === 0) {dout = b2 ? [1317,8,29] : [1900,1,0]; dow=6;}\n\telse {\n\t\tif(date > 60) --date;\n\t\t/* 1 = Jan 1 1900 */\n\t\tvar d = new Date(1900,0,1);\n\t\td.setDate(d.getDate() + date - 1);\n\t\tdout = [d.getFullYear(), d.getMonth()+1,d.getDate()];\n\t\tdow = d.getDay();\n\t\tif(date < 60) dow = (dow + 6) % 7;\n\t\tif(b2) dow = fix_hijri(d, dout);\n\t}\n\tout.y = dout[0]; out.m = dout[1]; out.d = dout[2];\n\tout.S = time % 60; time = Math.floor(time / 60);\n\tout.M = time % 60; time = Math.floor(time / 60);\n\tout.H = time;\n\tout.q = dow;\n\treturn out;\n}\nSSF.parse_date_code = parse_date_code;\n/*jshint -W086 */\nfunction write_date(type, fmt, val, ss0) {\n\tvar o=\"\", ss=0, tt=0, y = val.y, out, outl = 0;\n\tswitch(type) {\n\t\tcase 98: /* 'b' buddhist year */\n\t\t\ty = val.y + 543;\n\t\t\t/* falls through */\n\t\tcase 121: /* 'y' year */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = y % 100; outl = 2; break;\n\t\t\tdefault: out = y % 10000; outl = 4; break;\n\t\t} break;\n\t\tcase 109: /* 'm' month */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.m; outl = fmt.length; break;\n\t\t\tcase 3: return months[val.m-1][1];\n\t\t\tcase 5: return months[val.m-1][0];\n\t\t\tdefault: return months[val.m-1][2];\n\t\t} break;\n\t\tcase 100: /* 'd' day */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.d; outl = fmt.length; break;\n\t\t\tcase 3: return days[val.q][0];\n\t\t\tdefault: return days[val.q][1];\n\t\t} break;\n\t\tcase 104: /* 'h' 12-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = 1+(val.H+11)%12; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 72: /* 'H' 24-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.H; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 77: /* 'M' minutes */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.M; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad minute format: ' + fmt;\n\t\t} break;\n\t\tcase 115: /* 's' seconds */\n\t\tif(val.u === 0) switch(fmt) {\n\t\t\tcase 's': case 'ss': return pad0(val.S, fmt.length);\n\t\t\tcase '.0': case '.00': case '.000':\n\t\t}\n\t\tswitch(fmt) {\n\t\t\tcase 's': case 'ss': case '.0': case '.00': case '.000':\n\t\t\t\tif(ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;\n\t\t\t\telse tt = ss0 === 1 ? 10 : 1;\n\t\t\t\tss = Math.round((tt)*(val.S + val.u));\n\t\t\t\tif(ss >= 60*tt) ss = 0;\n\t\t\t\tif(fmt === 's') return ss === 0 ? \"0\" : \"\"+ss/tt;\n\t\t\t\to = pad0(ss,2 + ss0);\n\t\t\t\tif(fmt === 'ss') return o.substr(0,2);\n\t\t\t\treturn \".\" + o.substr(2,fmt.length-1);\n\t\t\tdefault: throw 'bad second format: ' + fmt;\n\t\t}\n\t\tcase 90: /* 'Z' absolute time */\n\t\tswitch(fmt) {\n\t\t\tcase '[h]': case '[hh]': out = val.D*24+val.H; break;\n\t\t\tcase '[m]': case '[mm]': out = (val.D*24+val.H)*60+val.M; break;\n\t\t\tcase '[s]': case '[ss]': out = ((val.D*24+val.H)*60+val.M)*60+Math.round(val.S+val.u); break;\n\t\t\tdefault: throw 'bad abstime format: ' + fmt;\n\t\t} outl = fmt.length === 3 ? 1 : 2; break;\n\t\tcase 101: /* 'e' era */\n\t\t\tout = y; outl = 1;\n\t}\n\tif(outl > 0) return pad0(out, outl); else return \"\";\n}\n/*jshint +W086 */\nfunction commaify(s) {\n\tif(s.length <= 3) return s;\n\tvar j = (s.length % 3), o = s.substr(0,j);\n\tfor(; j!=s.length; j+=3) o+=(o.length > 0 ? \",\" : \"\") + s.substr(j,3);\n\treturn o;\n}\nvar write_num = (function make_write_num(){\nvar pct1 = /%/g;\nfunction write_num_pct(type, fmt, val){\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\nfunction write_num_cm(type, fmt, val){\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\nfunction write_num_exp(fmt, val){\n\tvar o;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(o.indexOf(\"e\") === -1) {\n\t\t\tvar fakee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\twhile(o.substr(0,2) === \"0.\") {\n\t\t\t\to = o[0] + o.substr(2,period) + \".\" + o.substr(2+period);\n\t\t\t\to = o.replace(/^0+([1-9])/,\"$1\").replace(/^0+\\./,\"0.\");\n\t\t\t}\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o[o.length-1];\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nvar frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\nfunction write_num_f1(r, aval, sign) {\n\tvar den = parseInt(r[4]), rr = Math.round(aval * den), base = Math.floor(rr/den);\n\tvar myn = (rr - base*den), myd = den;\n\treturn sign + (base === 0 ? \"\" : \"\"+base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn,r[1].length) + r[2] + \"/\" + r[3] + pad0(myd,r[4].length));\n}\nfunction write_num_f2(r, aval, sign) {\n\treturn sign + (aval === 0 ? \"\" : \"\"+aval) + fill(\" \", r[1].length + 2 + r[4].length);\n}\nvar dec1 = /^#*0*\\.(0+)/;\nvar closeparen = /\\).*[0#]/;\nvar phone = /\\(###\\) ###\\\\?-####/;\nfunction hashq(str) {\n\tvar o = \"\", cc;\n\tfor(var i = 0; i != str.length; ++i) switch((cc=str.charCodeAt(i))) {\n\t\tcase 35: break;\n\t\tcase 63: o+= \" \"; break;\n\t\tcase 48: o+= \"0\"; break;\n\t\tdefault: o+= String.fromCharCode(cc);\n\t}\n\treturn o;\n}\nfunction rnd(val, d) { var dd = Math.pow(10,d); return \"\"+(Math.round(val * dd)/dd); }\nfunction dec(val, d) { return Math.round((val-Math.floor(val))*Math.pow(10,d)); }\nfunction flr(val) { if(val < 2147483647 && val > -2147483648) return \"\"+(val >= 0 ? (val|0) : (val-1|0)); return \"\"+Math.floor(val); }\nfunction write_num_flt(type, fmt, val) {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_flt('n', ffmt, val);\n\t\treturn '(' + write_num_flt('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_flt(type,fmt.substr(fmt[1]==' '?2:1),val);\n\tvar o, oo;\n\tvar r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0r(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = pad0r(val,0); if(o === \"0\") o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1)) !== null) return write_num_f1(r, aval, sign);\n\tif(fmt.match(/^#+0+$/) !== null) return sign + pad0r(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1)) !== null) {\n\t\to = rnd(val, r[1].length).replace(/^([^\\.]+)$/,\"$1.\"+r[1]).replace(/\\.$/,\".\"+r[1]).replace(/\\.(\\d*)$/,function($$, $1) { return \".\" + $1 + fill(\"0\", r[1].length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\n\t\treturn sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify(pad0r(aval,0));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\"+(Math.floor(val))) + \".\" + pad0(dec(val, r[1].length),r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_flt(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\n\t\to = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o[ri++]:x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone) !== null) {\n\t\to = write_num_flt(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n\t\tri = Math.min(r[4].length,7);\n\t\tff = frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", r[1], ff[1]);\n\t\tif(oa[oa.length-1] == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + r[2] + \"/\" + r[3];\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/)) !== null) {\n\t\to = pad0r(val, 0);\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n  if((r = fmt.match(/^([#0?]+)\\.([#0]+)$/)) !== null) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\n\t\tri = dec(val, r[1].length);\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(ri,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"#,###\": var x = commaify(pad0r(aval,0)); return x !== \"0\" ? sign + x : \"\";\n\t\tdefault:\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nfunction write_num_cm2(type, fmt, val){\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\nfunction write_num_pct2(type, fmt, val){\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\nfunction write_num_exp2(fmt, val){\n\tvar o;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(!o.match(/[Ee]/)) {\n\t\t\tvar fakee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o[o.length-1];\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nfunction write_num_int(type, fmt, val) {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_int('n', ffmt, val);\n\t\treturn '(' + write_num_int('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_int(type,fmt.substr(fmt[1]==' '?2:1),val);\n\tvar o;\n\tvar r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = (\"\"+val); if(val === 0) o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1)) !== null) return write_num_f2(r, aval, sign);\n\tif(fmt.match(/^#+0+$/) !== null) return sign + pad0(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1)) !== null) {\n\t\to = (\"\"+val).replace(/^([^\\.]+)$/,\"$1.\"+r[1]).replace(/\\.$/,\".\"+r[1]).replace(/\\.(\\d*)$/,function($$, $1) { return \".\" + $1 + fill(\"0\", r[1].length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\n\t\treturn sign + (\"\"+aval).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify((\"\"+aval));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify((\"\"+val)) + \".\" + fill('0',r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_int(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\n\t\to = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o[ri++]:x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone) !== null) {\n\t\to = write_num_int(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n\t\tri = Math.min(r[4].length,7);\n\t\tff = frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", r[1], ff[1]);\n\t\tif(oa[oa.length-1] == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + r[2] + \"/\" + r[3];\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/)) !== null) {\n\t\to = \"\" + val;\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(/^([#0]+)\\.([#0]+)$/)) !== null) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\"+val).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(0,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"#,###\": var x = commaify(\"\"+aval); return x !== \"0\" ? sign + x : \"\";\n\t\tdefault:\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nreturn function write_num(type, fmt, val) {\n\treturn (val|0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n};})();\nfunction split_fmt(fmt) {\n\tvar out = [];\n\tvar in_str = false, cc;\n\tfor(var i = 0, j = 0; i < fmt.length; ++i) switch((cc=fmt.charCodeAt(i))) {\n\t\tcase 34: /* '\"' */\n\t\t\tin_str = !in_str; break;\n\t\tcase 95: case 42: case 92: /* '_' '*' '\\\\' */\n\t\t\t++i; break;\n\t\tcase 59: /* ';' */\n\t\t\tout[out.length] = fmt.substr(j,i-j);\n\t\t\tj = i+1;\n\t}\n\tout[out.length] = fmt.substr(j);\n\tif(in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n\treturn out;\n}\nSSF._split = split_fmt;\nvar abstime = /\\[[HhMmSs]*\\]/;\nfunction eval_fmt(fmt, v, opts, flen) {\n\tvar out = [], o = \"\", i = 0, c = \"\", lst='t', q, dt, j, cc;\n\tvar hr='H';\n\t/* Tokenize */\n\twhile(i < fmt.length) {\n\t\tswitch((c = fmt[i])) {\n\t\t\tcase 'G': /* General */\n\t\t\t\tif(!isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' +fmt);\n\t\t\t\tout[out.length] = {t:'G', v:'General'}; i+=7; break;\n\t\t\tcase '\"': /* Literal text */\n\t\t\t\tfor(o=\"\";(cc=fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\n\t\t\t\tout[out.length] = {t:'t', v:o}; ++i; break;\n\t\t\tcase '\\\\': var w = fmt[++i], t = (w === \"(\" || w === \")\") ? w : 't';\n\t\t\t\tout[out.length] = {t:t, v:w}; ++i; break;\n\t\t\tcase '_': out[out.length] = {t:'t', v:\" \"}; i+=2; break;\n\t\t\tcase '@': /* Text Placeholder */\n\t\t\t\tout[out.length] = {t:'T', v:v}; ++i; break;\n\t\t\tcase 'B': case 'b':\n\t\t\t\tif(fmt[i+1] === \"1\" || fmt[i+1] === \"2\") {\n          if(dt==null) { dt=parse_date_code(v, opts, fmt[i+1] === \"2\"); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'X', v:fmt.substr(i,2)}; lst = c; i+=2; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\n\t\t\t\tc = c.toLowerCase();\n\t\t\t\t/* falls through */\n\t\t\tcase 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g':\n\t\t\t\tif(v < 0) return \"\";\n\t\t\t\tif(dt==null) { dt=parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\to = c; while(++i<fmt.length && fmt[i].toLowerCase() === c) o+=c;\n\t\t\t\tif(c === 'm' && lst.toLowerCase() === 'h') c = 'M'; /* m = minute */\n\t\t\t\tif(c === 'h') c = hr;\n\t\t\t\tout[out.length] = {t:c, v:o}; lst = c; break;\n\t\t\tcase 'A':\n\t\t\t\tq={t:c, v:\"A\"};\n\t\t\t\tif(dt==null) dt=parse_date_code(v, opts);\n        if(fmt.substr(i, 3) === \"A/P\") { if(dt!=null) q.v = dt.H >= 12 ? \"P\" : \"A\"; q.t = 'T'; hr='h';i+=3;}\n        else if(fmt.substr(i,5) === \"AM/PM\") { if(dt!=null) q.v = dt.H >= 12 ? \"PM\" : \"AM\"; q.t = 'T'; i+=5; hr='h'; }\n\t\t\t\telse { q.t = \"t\"; ++i; }\n\t\t\t\tif(dt==null && q.t === 'T') return \"\";\n\t\t\t\tout[out.length] = q; lst = c; break;\n\t\t\tcase '[':\n\t\t\t\to = c;\n\t\t\t\twhile(fmt[i++] !== ']' && i < fmt.length) o += fmt[i];\n\t\t\t\tif(o.substr(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n\t\t\t\tif(o.match(abstime)) {\n\t\t\t\t\tif(dt==null) { dt=parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'Z', v:o.toLowerCase()};\n\t\t\t\t} else { o=\"\"; }\n\t\t\t\tbreak;\n\t\t\t/* Numbers */\n\t\t\tcase '.':\n\t\t\t\tif(dt != null) {\n\t\t\t\t\to = c; while((c=fmt[++i]) === \"0\") o += c;\n\t\t\t\t\tout[out.length] = {t:'s', v:o}; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase '0': case '#':\n\t\t\t\to = c; while(\"0#?.,E+-%\".indexOf(c=fmt[++i]) > -1 || c=='\\\\' && fmt[i+1] == \"-\" && \"0#\".indexOf(fmt[i+2])>-1) o += c;\n\t\t\t\tout[out.length] = {t:'n', v:o}; break;\n\t\t\tcase '?':\n\t\t\t\to = c; while(fmt[++i] === c) o+=c;\n\t\t\t\tq={t:c, v:o}; out[out.length] = q; lst = c; break;\n\t\t\tcase '*': ++i; if(fmt[i] == ' ' || fmt[i] == '*') ++i; break; // **\n\t\t\tcase '(': case ')': out[out.length] = {t:(flen===1?'t':c), v:c}; ++i; break;\n\t\t\tcase '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\n\t\t\t\to = c; while(\"0123456789\".indexOf(fmt[++i]) > -1) o+=fmt[i];\n\t\t\t\tout[out.length] = {t:'D', v:o}; break;\n\t\t\tcase ' ': out[out.length] = {t:c, v:c}; ++i; break;\n\t\t\tdefault:\n\t\t\t\tif(\",$-+/():!^&'~{}<>=€acfijklopqrtuvwxz\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n\t\t\t\tout[out.length] = {t:'t', v:c}; ++i; break;\n\t\t}\n\t}\n\tvar bt = 0, ss0 = 0, ssm;\n\tfor(i=out.length-1, lst='t'; i >= 0; --i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 'h': case 'H': out[i].t = hr; lst='h'; if(bt < 1) bt = 1; break;\n\t\t\tcase 's':\n\t\t\t\tif((ssm=out[i].v.match(/\\.0+$/))) ss0=Math.max(ss0,ssm[0].length-1);\n\t\t\t\tif(bt < 3) bt = 3;\n\t\t\t/* falls through */\n\t\t\tcase 'd': case 'y': case 'M': case 'e': lst=out[i].t; break;\n\t\t\tcase 'm': if(lst === 's') { out[i].t = 'M'; if(bt < 2) bt = 2; } break;\n\t\t\tcase 'X': if(out[i].v === \"B2\");\n\t\t\t\tbreak;\n\t\t\tcase 'Z':\n\t\t\t\tif(bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n\t\t\t\tif(bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n\t\t\t\tif(bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n\t\t}\n\t}\n\tswitch(bt) {\n\t\tcase 0: break;\n\t\tcase 1:\n\t\t\tif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tif(dt.M >=  60) { dt.M = 0; ++dt.H; }\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tbreak;\n\t}\n\t/* replace fields */\n\tvar nstr = \"\", jj;\n\tfor(i=0; i < out.length; ++i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 't': case 'T': case ' ': case 'D': break;\n\t\t\tcase 'X': out[i] = undefined; break;\n\t\t\tcase 'd': case 'm': case 'y': case 'h': case 'H': case 'M': case 's': case 'e': case 'b': case 'Z':\n\t\t\t\tout[i].v = write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n\t\t\t\tout[i].t = 't'; break;\n\t\t\tcase 'n': case '(': case '?':\n\t\t\t\tjj = i+1;\n\t\t\t\twhile(out[jj] != null && (\n\t\t\t\t\t(c=out[jj].t) === \"?\" || c === \"D\" ||\n\t\t\t\t\t(c === \" \" || c === \"t\") && out[jj+1] != null && (out[jj+1].t === '?' || out[jj+1].t === \"t\" && out[jj+1].v === '/') ||\n\t\t\t\t\tout[i].t === '(' && (c === ' ' || c === 'n' || c === ')') ||\n\t\t\t\t\tc === 't' && (out[jj].v === '/' || '$€'.indexOf(out[jj].v) > -1 || out[jj].v === ' ' && out[jj+1] != null && out[jj+1].t == '?')\n\t\t\t\t)) {\n\t\t\t\t\tout[i].v += out[jj].v;\n\t\t\t\t\tout[jj] = undefined; ++jj;\n\t\t\t\t}\n\t\t\t\tnstr += out[i].v;\n\t\t\t\ti = jj-1; break;\n\t\t\tcase 'G': out[i].t = 't'; out[i].v = general_fmt(v,opts); break;\n\t\t}\n\t}\n\tvar vv = \"\", myv, ostr;\n\tif(nstr.length > 0) {\n\t\tmyv = (v<0&&nstr.charCodeAt(0) === 45 ? -v : v); /* '-' */\n\t\tostr = write_num(nstr.charCodeAt(0) === 40 ? '(' : 'n', nstr, myv); /* '(' */\n\t\tjj=ostr.length-1;\n\t\tvar decpt = out.length;\n\t\tfor(i=0; i < out.length; ++i) if(out[i] != null && out[i].v.indexOf(\".\") > -1) { decpt = i; break; }\n\t\tvar lasti=out.length;\n\t\tif(decpt === out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tfor(i=out.length-1; i>= 0;--i) {\n\t\t\t\tif(out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\n\t\t\t\tif(jj>=out[i].v.length-1) { jj -= out[i].v.length; out[i].v = ostr.substr(jj+1, out[i].v.length); }\n\t\t\t\telse if(jj < 0) out[i].v = \"\";\n\t\t\t\telse { out[i].v = ostr.substr(0, jj+1); jj = -1; }\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t}\n\t\telse if(decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tjj = ostr.indexOf(\".\")-1;\n\t\t\tfor(i=decpt; i>= 0; --i) {\n\t\t\t\tif(out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")-1:out[i].v.length-1;\n\t\t\t\tvv = out[i].v.substr(j+1);\n\t\t\t\tfor(; j>=0; --j) {\n\t\t\t\t\tif(jj>=0 && (out[i].v[j] === \"0\" || out[i].v[j] === \"#\")) vv = ostr[jj--] + vv;\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t\tjj = ostr.indexOf(\".\")+1;\n\t\t\tfor(i=decpt; i<out.length; ++i) {\n\t\t\t\tif(out[i] == null || 'n?('.indexOf(out[i].t) === -1 && i !== decpt ) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")+1:0;\n\t\t\t\tvv = out[i].v.substr(0,j);\n\t\t\t\tfor(; j<out[i].v.length; ++j) {\n\t\t\t\t\tif(jj<ostr.length) vv += ostr[jj++];\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t}\n\t}\n\tfor(i=0; i<out.length; ++i) if(out[i] != null && 'n(?'.indexOf(out[i].t)>-1) {\n\t\tmyv = (flen >1 && v < 0 && i>0 && out[i-1].v === \"-\" ? -v:v);\n\t\tout[i].v = write_num(out[i].t, out[i].v, myv);\n\t\tout[i].t = 't';\n\t}\n\tvar retval = \"\";\n\tfor(i=0; i !== out.length; ++i) if(out[i] != null) retval += out[i].v;\n\treturn retval;\n}\nSSF._eval = eval_fmt;\nvar cfregex = /\\[[=<>]/;\nvar cfregex2 = /\\[([=<>]*)(-?\\d+\\.?\\d*)\\]/;\nfunction chkcond(v, rr) {\n\tif(rr == null) return false;\n\tvar thresh = parseFloat(rr[2]);\n\tswitch(rr[1]) {\n\t\tcase \"=\":  if(v == thresh) return true; break;\n\t\tcase \">\":  if(v >  thresh) return true; break;\n\t\tcase \"<\":  if(v <  thresh) return true; break;\n\t\tcase \"<>\": if(v != thresh) return true; break;\n\t\tcase \">=\": if(v >= thresh) return true; break;\n\t\tcase \"<=\": if(v <= thresh) return true; break;\n\t}\n\treturn false;\n}\nfunction choose_fmt(f, v) {\n\tvar fmt = split_fmt(f);\n\tvar l = fmt.length, lat = fmt[l-1].indexOf(\"@\");\n\tif(l<4 && lat>-1) --l;\n\tif(fmt.length > 4) throw \"cannot find right format for |\" + fmt + \"|\";\n\tif(typeof v !== \"number\") return [4, fmt.length === 4 || lat>-1?fmt[fmt.length-1]:\"@\"];\n\tswitch(fmt.length) {\n\t\tcase 1: fmt = lat>-1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"]; break;\n\t\tcase 2: fmt = lat>-1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"]; break;\n\t\tcase 3: fmt = lat>-1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"]; break;\n\t\tcase 4: break;\n\t}\n\tvar ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n\tif(fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n\tif(fmt[0].match(cfregex) != null || fmt[1].match(cfregex) != null) {\n\t\tvar m1 = fmt[0].match(cfregex2);\n\t\tvar m2 = fmt[1].match(cfregex2);\n\t\treturn chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n\t}\n\treturn [l, ff];\n}\nfunction format(fmt,v,o) {\n\tfixopts(o != null ? o : (o=[]));\n\tvar sfmt = \"\";\n\tswitch(typeof fmt) {\n\t\tcase \"string\": sfmt = fmt; break;\n\t\tcase \"number\": sfmt = (o.table != null ? o.table : table_fmt)[fmt]; break;\n\t}\n\tif(isgeneral(sfmt,0)) return general_fmt(v, o);\n\tvar f = choose_fmt(sfmt, v);\n\tif(isgeneral(f[1])) return general_fmt(v, o);\n\tif(v === true) v = \"TRUE\"; else if(v === false) v = \"FALSE\";\n\telse if(v === \"\" || v == null) return \"\";\n\treturn eval_fmt(f[1], v, o, f[0]);\n}\nSSF._table = table_fmt;\nSSF.load = function load_entry(fmt, idx) { table_fmt[idx] = fmt; };\nSSF.format = format;\nSSF.get_table = function get_table() { return table_fmt; };\nSSF.load_table = function load_table(tbl) { for(var i=0; i!=0x0188; ++i) if(tbl[i] !== undefined) SSF.load(tbl[i], i); };\n};\nmake_ssf(SSF);\n/* map from xlml named formats to SSF TODO: localize */\nvar XLMLFormatMap = {\n\t\"General Number\": \"General\",\n\t\"General Date\": SSF._table[22],\n\t\"Long Date\": \"dddd, mmmm dd, yyyy\",\n\t\"Medium Date\": SSF._table[15],\n\t\"Short Date\": SSF._table[14],\n\t\"Long Time\": SSF._table[19],\n\t\"Medium Time\": SSF._table[18],\n\t\"Short Time\": SSF._table[20],\n\t\"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\"Fixed\": SSF._table[2],\n\t\"Standard\": SSF._table[4],\n\t\"Percent\": SSF._table[10],\n\t\"Scientific\": SSF._table[11],\n\t\"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n\t\"True/False\": '\"True\";\"True\";\"False\";@',\n\t\"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n};\n\nvar DO_NOT_EXPORT_CFB = true;\n/* cfb.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*jshint eqnull:true */\n\n/* [MS-CFB] v20130118 */\nvar CFB = (function _CFB(){\nvar exports = {};\nexports.version = '0.10.2';\nfunction parse(file) {\nvar mver = 3; // major version\nvar ssz = 512; // sector size\nvar nmfs = 0; // number of mini FAT sectors\nvar ndfs = 0; // number of DIFAT sectors\nvar dir_start = 0; // first directory sector location\nvar minifat_start = 0; // first mini FAT sector location\nvar difat_start = 0; // first mini FAT sector location\n\nvar fat_addrs = []; // locations of FAT sectors\n\n/* [MS-CFB] 2.2 Compound File Header */\nvar blob = file.slice(0,512);\nprep_blob(blob, 0);\n\n/* major version */\nvar mv = check_get_mver(blob);\nmver = mv[0];\nswitch(mver) {\n\tcase 3: ssz = 512; break; case 4: ssz = 4096; break;\n\tdefault: throw \"Major Version: Expected 3 or 4 saw \" + mver;\n}\n\n/* reprocess header */\nif(ssz !== 512) { blob = file.slice(0,ssz); prep_blob(blob, 28 /* blob.l */); }\n/* Save header for final object */\nvar header = file.slice(0,ssz);\n\ncheck_shifts(blob, mver);\n\n// Number of Directory Sectors\nvar nds = blob.read_shift(4, 'i');\nif(mver === 3 && nds !== 0) throw '# Directory Sectors: Expected 0 saw ' + nds;\n\n// Number of FAT Sectors\n//var nfs = blob.read_shift(4, 'i');\nblob.l += 4;\n\n// First Directory Sector Location\ndir_start = blob.read_shift(4, 'i');\n\n// Transaction Signature\nblob.l += 4;\n\n// Mini Stream Cutoff Size\nblob.chk('00100000', 'Mini Stream Cutoff Size: ');\n\n// First Mini FAT Sector Location\nminifat_start = blob.read_shift(4, 'i');\n\n// Number of Mini FAT Sectors\nnmfs = blob.read_shift(4, 'i');\n\n// First DIFAT sector location\ndifat_start = blob.read_shift(4, 'i');\n\n// Number of DIFAT Sectors\nndfs = blob.read_shift(4, 'i');\n\n// Grab FAT Sector Locations\nfor(var q, j = 0; j < 109; ++j) { /* 109 = (512 - blob.l)>>>2; */\n\tq = blob.read_shift(4, 'i');\n\tif(q<0) break;\n\tfat_addrs[j] = q;\n}\n\n/** Break the file up into sectors */\nvar sectors = sectorify(file, ssz);\n\nsleuth_fat(difat_start, ndfs, sectors, ssz, fat_addrs);\n\n/** Chains */\nvar sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n\nsector_list[dir_start].name = \"!Directory\";\nif(nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\nsector_list[fat_addrs[0]].name = \"!FAT\";\nsector_list.fat_addrs = fat_addrs;\nsector_list.ssz = ssz;\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nvar files = {}, Paths = [], FileIndex = [], FullPaths = [], FullPathDir = {};\nread_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex);\n\nbuild_full_paths(FileIndex, FullPathDir, FullPaths, Paths);\n\nvar root_name = Paths.shift();\nPaths.root = root_name;\n\n/* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\nvar find_path = make_find_path(FullPaths, Paths, FileIndex, files, root_name);\n\nreturn {\n\traw: {header: header, sectors: sectors},\n\tFileIndex: FileIndex,\n\tFullPaths: FullPaths,\n\tFullPathDir: FullPathDir,\n\tfind: find_path\n};\n} // parse\n\n/* [MS-CFB] 2.2 Compound File Header -- read up to major version */\nfunction check_get_mver(blob) {\n\t// header signature 8\n\tblob.chk(HEADER_SIGNATURE, 'Header Signature: ');\n\n\t// clsid 16\n\tblob.chk(HEADER_CLSID, 'CLSID: ');\n\n\t// minor version 2\n\tvar mver = blob.read_shift(2, 'u');\n\n\treturn [blob.read_shift(2,'u'), mver];\n}\nfunction check_shifts(blob, mver) {\n\tvar shift = 0x09;\n\n\t// Byte Order\n\tblob.chk('feff', 'Byte Order: ');\n\n\t// Sector Shift\n\tswitch((shift = blob.read_shift(2))) {\n\t\tcase 0x09: if(mver !== 3) throw 'MajorVersion/SectorShift Mismatch'; break;\n\t\tcase 0x0c: if(mver !== 4) throw 'MajorVersion/SectorShift Mismatch'; break;\n\t\tdefault: throw 'Sector Shift: Expected 9 or 12 saw ' + shift;\n\t}\n\n\t// Mini Sector Shift\n\tblob.chk('0600', 'Mini Sector Shift: ');\n\n\t// Reserved\n\tblob.chk('000000000000', 'Reserved: ');\n}\n\n/** Break the file up into sectors */\nfunction sectorify(file, ssz) {\n\tvar nsectors = Math.ceil(file.length/ssz)-1;\n\tvar sectors = new Array(nsectors);\n\tfor(var i=1; i < nsectors; ++i) sectors[i-1] = file.slice(i*ssz,(i+1)*ssz);\n\tsectors[nsectors-1] = file.slice(nsectors*ssz);\n\treturn sectors;\n}\n\n/* [MS-CFB] 2.6.4 Red-Black Tree */\nfunction build_full_paths(FI, FPD, FP, Paths) {\n\tvar i = 0, L = 0, R = 0, C = 0, j = 0, pl = Paths.length;\n\tvar dad = new Array(pl), q = new Array(pl);\n\n\tfor(; i < pl; ++i) { dad[i]=q[i]=i; FP[i]=Paths[i]; }\n\n\tfor(; j < q.length; ++j) {\n\t\ti = q[j];\n\t\tL = FI[i].L; R = FI[i].R; C = FI[i].C;\n\t\tif(dad[i] === i) {\n\t\t\tif(L !== -1 /*NOSTREAM*/ && dad[L] !== L) dad[i] = dad[L];\n\t\t\tif(R !== -1 && dad[R] !== R) dad[i] = dad[R];\n\t\t}\n\t\tif(C !== -1 /*NOSTREAM*/) dad[C] = i;\n\t\tif(L !== -1) { dad[L] = dad[i]; q.push(L); }\n\t\tif(R !== -1) { dad[R] = dad[i]; q.push(R); }\n\t}\n\tfor(i=1; i !== pl; ++i) if(dad[i] === i) {\n\t\tif(R !== -1 /*NOSTREAM*/ && dad[R] !== R) dad[i] = dad[R];\n\t\telse if(L !== -1 && dad[L] !== L) dad[i] = dad[L];\n\t}\n\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type === 0 /* unknown */) continue;\n\t\tj = dad[i];\n\t\tif(j === 0) FP[i] = FP[0] + \"/\" + FP[i];\n\t\telse while(j !== 0) {\n\t\t\tFP[i] = FP[j] + \"/\" + FP[i];\n\t\t\tj = dad[j];\n\t\t}\n\t\tdad[i] = 0;\n\t}\n\n\tFP[0] += \"/\";\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type !== 2 /* stream */) FP[i] += \"/\";\n\t\tFPD[FP[i]] = FI[i];\n\t}\n}\n\n/* [MS-CFB] 2.6.4 */\nfunction make_find_path(FullPaths, Paths, FileIndex, files, root_name) {\n\tvar UCFullPaths = new Array(FullPaths.length);\n\tvar UCPaths = new Array(Paths.length), i;\n\tfor(i = 0; i < FullPaths.length; ++i) UCFullPaths[i] = FullPaths[i].toUpperCase().replace(chr0,'').replace(chr1,'!');\n\tfor(i = 0; i < Paths.length; ++i) UCPaths[i] = Paths[i].toUpperCase().replace(chr0,'').replace(chr1,'!');\n\treturn function find_path(path) {\n\t\tvar k;\n\t\tif(path.charCodeAt(0) === 47 /* \"/\" */) { k=true; path = root_name + path; }\n\t\telse k = path.indexOf(\"/\") !== -1;\n\t\tvar UCPath = path.toUpperCase().replace(chr0,'').replace(chr1,'!');\n\t\tvar w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n\t\tif(w === -1) return null;\n\t\treturn k === true ? FileIndex[w] : files[Paths[w]];\n\t};\n}\n\n/** Chase down the rest of the DIFAT chain to build a comprehensive list\n    DIFAT chains by storing the next sector number as the last 32 bytes */\nfunction sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {\n\tvar q;\n\tif(idx === ENDOFCHAIN) {\n\t\tif(cnt !== 0) throw \"DIFAT chain shorter than expected\";\n\t} else if(idx !== -1 /*FREESECT*/) {\n\t\tvar sector = sectors[idx], m = (ssz>>>2)-1;\n\t\tfor(var i = 0; i < m; ++i) {\n\t\t\tif((q = __readInt32LE(sector,i*4)) === ENDOFCHAIN) break;\n\t\t\tfat_addrs.push(q);\n\t\t}\n\t\tsleuth_fat(__readInt32LE(sector,ssz-4),cnt - 1, sectors, ssz, fat_addrs);\n\t}\n}\n\n/** Follow the linked list of sectors for a given starting point */\nfunction get_sector_list(sectors, start, fat_addrs, ssz, chkd) {\n\tvar sl = sectors.length;\n\tvar buf, buf_chain;\n\tif(!chkd) chkd = new Array(sl);\n\tvar modulus = ssz - 1, j, jj;\n\tbuf = [];\n\tbuf_chain = [];\n\tfor(j=start; j>=0;) {\n\t\tchkd[j] = true;\n\t\tbuf[buf.length] = j;\n\t\tbuf_chain.push(sectors[j]);\n\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\n\t\tjj = ((j*4) & modulus);\n\t\tif(ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \"+ssz;\n\t\tj = __readInt32LE(sectors[addr], jj);\n\t}\n\treturn {nodes: buf, data:__toBuffer([buf_chain])};\n}\n\n/** Chase down the sector linked lists */\nfunction make_sector_list(sectors, dir_start, fat_addrs, ssz) {\n\tvar sl = sectors.length, sector_list = new Array(sl);\n\tvar chkd = new Array(sl), buf, buf_chain;\n\tvar modulus = ssz - 1, i, j, k, jj;\n\tfor(i=0; i < sl; ++i) {\n\t\tbuf = [];\n\t\tk = (i + dir_start); if(k >= sl) k-=sl;\n\t\tif(chkd[k] === true) continue;\n\t\tbuf_chain = [];\n\t\tfor(j=k; j>=0;) {\n\t\t\tchkd[j] = true;\n\t\t\tbuf[buf.length] = j;\n\t\t\tbuf_chain.push(sectors[j]);\n\t\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\n\t\t\tjj = ((j*4) & modulus);\n\t\t\tif(ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \"+ssz;\n\t\t\tj = __readInt32LE(sectors[addr], jj);\n\t\t}\n\t\tsector_list[k] = {nodes: buf, data:__toBuffer([buf_chain])};\n\t}\n\treturn sector_list;\n}\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nfunction read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex) {\n\tvar blob;\n\tvar minifat_store = 0, pl = (Paths.length?2:0);\n\tvar sector = sector_list[dir_start].data;\n\tvar i = 0, namelen = 0, name, o, ctime, mtime;\n\tfor(; i < sector.length; i+= 128) {\n\t\tblob = sector.slice(i, i+128);\n\t\tprep_blob(blob, 64);\n\t\tnamelen = blob.read_shift(2);\n\t\tif(namelen === 0) continue;\n\t\tname = __utf16le(blob,0,namelen-pl);\n\t\tPaths.push(name);\n\t\to = {\n\t\t\tname:  name,\n\t\t\ttype:  blob.read_shift(1),\n\t\t\tcolor: blob.read_shift(1),\n\t\t\tL:     blob.read_shift(4, 'i'),\n\t\t\tR:     blob.read_shift(4, 'i'),\n\t\t\tC:     blob.read_shift(4, 'i'),\n\t\t\tclsid: blob.read_shift(16),\n\t\t\tstate: blob.read_shift(4, 'i')\n\t\t};\n\t\tctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(ctime !== 0) {\n\t\t\to.ctime = ctime; o.ct = read_date(blob, blob.l-8);\n\t\t}\n\t\tmtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(mtime !== 0) {\n\t\t\to.mtime = mtime; o.mt = read_date(blob, blob.l-8);\n\t\t}\n\t\to.start = blob.read_shift(4, 'i');\n\t\to.size = blob.read_shift(4, 'i');\n\t\tif(o.type === 5) { /* root */\n\t\t\tminifat_store = o.start;\n\t\t\tif(nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n\t\t\t/*minifat_size = o.size;*/\n\t\t} else if(o.size >= 4096 /* MSCSZ */) {\n\t\t\to.storage = 'fat';\n\t\t\tif(sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n\t\t\tsector_list[o.start].name = o.name;\n\t\t\to.content = sector_list[o.start].data.slice(0,o.size);\n\t\t\tprep_blob(o.content, 0);\n\t\t} else {\n\t\t\to.storage = 'minifat';\n\t\t\tif(minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN) {\n\t\t\t\to.content = sector_list[minifat_store].data.slice(o.start*MSSZ,o.start*MSSZ+o.size);\n\t\t\t\tprep_blob(o.content, 0);\n\t\t\t}\n\t\t}\n\t\tfiles[name] = o;\n\t\tFileIndex.push(o);\n\t}\n}\n\nfunction read_date(blob, offset) {\n\treturn new Date(( ( (__readUInt32LE(blob,offset+4)/1e7)*Math.pow(2,32)+__readUInt32LE(blob,offset)/1e7 ) - 11644473600)*1000);\n}\n\nvar fs;\nfunction readFileSync(filename, options) {\n\tif(fs === undefined) fs = require('fs');\n\treturn parse(fs.readFileSync(filename), options);\n}\n\nfunction readSync(blob, options) {\n\tswitch(options !== undefined && options.type !== undefined ? options.type : \"base64\") {\n\t\tcase \"file\": return readFileSync(blob, options);\n\t\tcase \"base64\": return parse(s2a(Base64.decode(blob)), options);\n\t\tcase \"binary\": return parse(s2a(blob), options);\n\t}\n\treturn parse(blob);\n}\n\n/** CFB Constants */\nvar MSSZ = 64; /* Mini Sector Size = 1<<6 */\n//var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n/* 2.1 Compound File Sector Numbers and Types */\nvar ENDOFCHAIN = -2;\n/* 2.2 Compound File Header */\nvar HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\nvar HEADER_CLSID = '00000000000000000000000000000000';\nvar consts = {\n\t/* 2.1 Compund File Sector Numbers and Types */\n\tMAXREGSECT: -6,\n\tDIFSECT: -4,\n\tFATSECT: -3,\n\tENDOFCHAIN: ENDOFCHAIN,\n\tFREESECT: -1,\n\t/* 2.2 Compound File Header */\n\tHEADER_SIGNATURE: HEADER_SIGNATURE,\n\tHEADER_MINOR_VERSION: '3e00',\n\tMAXREGSID: -6,\n\tNOSTREAM: -1,\n\tHEADER_CLSID: HEADER_CLSID,\n\t/* 2.6.1 Compound File Directory Entry */\n\tEntryTypes: ['unknown','storage','stream','lockbytes','property','root']\n};\n\nexports.read = readSync;\nexports.parse = parse;\nexports.utils = {\n\tReadShift: ReadShift,\n\tCheckField: CheckField,\n\tprep_blob: prep_blob,\n\tbconcat: bconcat,\n\tconsts: consts\n};\n\nreturn exports;\n})();\n\nif(typeof require !== 'undefined' && typeof module !== 'undefined' && typeof DO_NOT_EXPORT_CFB === 'undefined') { module.exports = CFB; }\nfunction isval(x) { return x !== undefined && x !== null; }\n\nfunction keys(o) { return Object.keys(o); }\n\nfunction evert_key(obj, key) {\n\tvar o = [], K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]][key]] = K[i];\n\treturn o;\n}\n\nfunction evert(obj) {\n\tvar o = [], K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];\n\treturn o;\n}\n\nfunction evert_num(obj) {\n\tvar o = [], K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i],10);\n\treturn o;\n}\n\nfunction evert_arr(obj) {\n\tvar o = [], K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) {\n\t\tif(o[obj[K[i]]] == null) o[obj[K[i]]] = [];\n\t\to[obj[K[i]]].push(K[i]);\n\t}\n\treturn o;\n}\n\n/* TODO: date1904 logic */\nfunction datenum(v, date1904) {\n\tif(date1904) v+=1462;\n\tvar epoch = Date.parse(v);\n\treturn (epoch + 2209161600000) / (24 * 60 * 60 * 1000);\n}\n\nfunction cc2str(arr) {\n\tvar o = \"\";\n\tfor(var i = 0; i != arr.length; ++i) o += String.fromCharCode(arr[i]);\n\treturn o;\n}\n\nfunction getdata(data) {\n\tif(!data) return null;\n\tif(data.name.substr(-4) === \".bin\") {\n\t\tif(data.data) return char_codes(data.data);\n\t\tif(data.asNodeBuffer && has_buf) return data.asNodeBuffer();\n\t\tif(data._data && data._data.getContent) return Array.prototype.slice.call(data._data.getContent());\n\t} else {\n\t\tif(data.data) return data.name.substr(-4) !== \".bin\" ? debom_xml(data.data) : char_codes(data.data);\n\t\tif(data.asNodeBuffer && has_buf) return debom_xml(data.asNodeBuffer().toString('binary'));\n\t\tif(data.asBinary) return debom_xml(data.asBinary());\n\t\tif(data._data && data._data.getContent) return debom_xml(cc2str(Array.prototype.slice.call(data._data.getContent(),0)));\n\t}\n\treturn null;\n}\n\nfunction safegetzipfile(zip, file) {\n\tvar f = file; if(zip.files[f]) return zip.files[f];\n\n\tvar lowerCaseFiles = {};\n\tfor (var key in zip.files) {\n\t\tlowerCaseFiles[key.toLowerCase()] = zip.files[key];\n\t}\n\n\tf = file.toLowerCase(); if(lowerCaseFiles[f]) return lowerCaseFiles[f];\n\tf = f.replace(/\\//g,'\\\\'); if(lowerCaseFiles[f]) return lowerCaseFiles[f];\n\treturn null;\n}\n\nfunction getzipfile(zip, file) {\n\tvar o = safegetzipfile(zip, file);\n\tif(o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n\treturn o;\n}\n\nfunction getzipdata(zip, file, safe) {\n\tif(!safe) return getdata(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipdata(zip, file); } catch(e) { return null; }\n}\n\nvar _fs, jszip;\nif(typeof JSZip !== 'undefined') jszip = JSZip;\nif (typeof exports !== 'undefined') {\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tif(has_buf && typeof jszip === 'undefined') jszip = require('js'+'zip');\n\t\tif(typeof jszip === 'undefined') jszip = require('./js'+'zip').JSZip;\n\t\t_fs = require('f'+'s');\n\t}\n}\nvar attregexg=/([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\nvar tagregex=/<[^>]*>/g;\nvar nsregex=/<\\w*:/, nsregex2 = /<(\\/?)\\w+:/;\nfunction parsexmltag(tag, skip_root) {\n\tvar z = [];\n\tvar eq = 0, c = 0;\n\tfor(; eq !== tag.length; ++eq) if((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n\tif(!skip_root) z[0] = tag.substr(0, eq);\n\tif(eq === tag.length) return z;\n\tvar m = tag.match(attregexg), j=0, w=\"\", v=\"\", i=0, q=\"\", cc=\"\";\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\tcc = m[i];\n\t\tfor(c=0; c != cc.length; ++c) if(cc.charCodeAt(c) === 61) break;\n\t\tq = cc.substr(0,c); v = cc.substring(c+2, cc.length-1);\n\t\tfor(j=0;j!=q.length;++j) if(q.charCodeAt(j) === 58) break;\n\t\tif(j===q.length) z[q] = v;\n\t\telse z[(j===5 && q.substr(0,5)===\"xmlns\"?\"xmlns\":\"\")+q.substr(j+1)] = v;\n\t}\n\treturn z;\n}\nfunction strip_ns(x) { return x.replace(nsregex2, \"<$1\"); }\n\nvar encodings = {\n\t'&quot;': '\"',\n\t'&apos;': \"'\",\n\t'&gt;': '>',\n\t'&lt;': '<',\n\t'&amp;': '&'\n};\nvar rencoding = evert(encodings);\nvar rencstr = \"&<>'\\\"\".split(\"\");\n\n// TODO: CP remap (need to read file version to determine OS)\nvar unescapexml = (function() {\n\tvar encregex = /&[a-z]*;/g, coderegex = /_x([\\da-fA-F]+)_/g;\n\treturn function unescapexml(text){\n\t\tvar s = text + '';\n\t\treturn s.replace(encregex, function($$) { return encodings[$$]; }).replace(coderegex,function(m,c) {return String.fromCharCode(parseInt(c,16));});\n\t};\n})();\n\nvar decregex=/[&<>'\"]/g, charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\nfunction escapexml(text){\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(charegex,function(s) { return \"_x\" + (\"000\"+s.charCodeAt(0).toString(16)).substr(-4) + \"_\";});\n}\n\n/* TODO: handle codepages */\nvar xlml_fixstr = (function() {\n\tvar entregex = /&#(\\d+);/g;\n\tfunction entrepl($$,$1) { return String.fromCharCode(parseInt($1,10)); }\n\treturn function xlml_fixstr(str) { return str.replace(entregex,entrepl); };\n})();\n\nfunction parsexmlbool(value, tag) {\n\tswitch(value) {\n\t\tcase '1': case 'true': case 'TRUE': return true;\n\t\t/* case '0': case 'false': case 'FALSE':*/\n\t\tdefault: return false;\n\t}\n}\n\nvar utf8read = function utf8reada(orig) {\n\tvar out = \"\", i = 0, c = 0, d = 0, e = 0, f = 0, w = 0;\n\twhile (i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tif (c < 128) { out += String.fromCharCode(c); continue; }\n\t\td = orig.charCodeAt(i++);\n\t\tif (c>191 && c<224) { out += String.fromCharCode(((c & 31) << 6) | (d & 63)); continue; }\n\t\te = orig.charCodeAt(i++);\n\t\tif (c < 240) { out += String.fromCharCode(((c & 15) << 12) | ((d & 63) << 6) | (e & 63)); continue; }\n\t\tf = orig.charCodeAt(i++);\n\t\tw = (((c & 7) << 18) | ((d & 63) << 12) | ((e & 63) << 6) | (f & 63))-65536;\n\t\tout += String.fromCharCode(0xD800 + ((w>>>10)&1023));\n\t\tout += String.fromCharCode(0xDC00 + (w&1023));\n\t}\n\treturn out;\n};\n\n\nif(has_buf) {\n\tvar utf8readb = function utf8readb(data) {\n\t\tvar out = new Buffer(2*data.length), w, i, j = 1, k = 0, ww=0, c;\n\t\tfor(i = 0; i < data.length; i+=j) {\n\t\t\tj = 1;\n\t\t\tif((c=data.charCodeAt(i)) < 128) w = c;\n\t\t\telse if(c < 224) { w = (c&31)*64+(data.charCodeAt(i+1)&63); j=2; }\n\t\t\telse if(c < 240) { w=(c&15)*4096+(data.charCodeAt(i+1)&63)*64+(data.charCodeAt(i+2)&63); j=3; }\n\t\t\telse { j = 4;\n\t\t\t\tw = (c & 7)*262144+(data.charCodeAt(i+1)&63)*4096+(data.charCodeAt(i+2)&63)*64+(data.charCodeAt(i+3)&63);\n\t\t\t\tw -= 65536; ww = 0xD800 + ((w>>>10)&1023); w = 0xDC00 + (w&1023);\n\t\t\t}\n\t\t\tif(ww !== 0) { out[k++] = ww&255; out[k++] = ww>>>8; ww = 0; }\n\t\t\tout[k++] = w%256; out[k++] = w>>>8;\n\t\t}\n\t\tout.length = k;\n\t\treturn out.toString('ucs2');\n\t};\n\tvar corpus = \"foo bar baz\\u00e2\\u0098\\u0083\\u00f0\\u009f\\u008d\\u00a3\";\n\tif(utf8read(corpus) == utf8readb(corpus)) utf8read = utf8readb;\n\tvar utf8readc = function utf8readc(data) { return Buffer(data, 'binary').toString('utf8'); };\n\tif(utf8read(corpus) == utf8readc(corpus)) utf8read = utf8readc;\n}\n\n// matches <foo>...</foo> extracts content\nvar matchtag = (function() {\n\tvar mtcache = {};\n\treturn function matchtag(f,g) {\n\t\tvar t = f+\"|\"+g;\n\t\tif(mtcache[t] !== undefined) return mtcache[t];\n\t\treturn (mtcache[t] = new RegExp('<(?:\\\\w+:)?'+f+'(?: xml:space=\"preserve\")?(?:[^>]*)>([^\\u2603]*)</(?:\\\\w+:)?'+f+'>',(g||\"\")));\n\t};\n})();\n\nvar vtregex = (function(){ var vt_cache = {};\n\treturn function vt_regex(bt) {\n\t\tif(vt_cache[bt] !== undefined) return vt_cache[bt];\n\t\treturn (vt_cache[bt] = new RegExp(\"<vt:\" + bt + \">(.*?)</vt:\" + bt + \">\", 'g') );\n};})();\nvar vtvregex = /<\\/?vt:variant>/g, vtmregex = /<vt:([^>]*)>(.*)</;\nfunction parseVector(data) {\n\tvar h = parsexmltag(data);\n\n\tvar matches = data.match(vtregex(h.baseType))||[];\n\tif(matches.length != h.size) throw \"unexpected vector length \" + matches.length + \" != \" + h.size;\n\tvar res = [];\n\tmatches.forEach(function(x) {\n\t\tvar v = x.replace(vtvregex,\"\").match(vtmregex);\n\t\tres.push({v:v[2], t:v[1]});\n\t});\n\treturn res;\n}\n\nvar wtregex = /(^\\s|\\s$|\\n)/;\nfunction writetag(f,g) {return '<' + f + (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>';}\n\nfunction wxt_helper(h) { return keys(h).map(function(k) { return \" \" + k + '=\"' + h[k] + '\"';}).join(\"\"); }\nfunction writextag(f,g,h) { return '<' + f + (isval(h) ? wxt_helper(h) : \"\") + (isval(g) ? (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';}\n\nfunction write_w3cdtf(d, t) { try { return d.toISOString().replace(/\\.\\d*/,\"\"); } catch(e) { if(t) throw e; } }\n\nfunction write_vt(s) {\n\tswitch(typeof s) {\n\t\tcase 'string': return writextag('vt:lpwstr', s);\n\t\tcase 'number': return writextag((s|0)==s?'vt:i4':'vt:r8', String(s));\n\t\tcase 'boolean': return writextag('vt:bool',s?'true':'false');\n\t}\n\tif(s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\n\tthrow new Error(\"Unable to serialize \" + s);\n}\n\nvar XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\nvar XMLNS = {\n\t'dc': 'http://purl.org/dc/elements/1.1/',\n\t'dcterms': 'http://purl.org/dc/terms/',\n\t'dcmitype': 'http://purl.org/dc/dcmitype/',\n\t'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\n\t'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n\t'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\n\t'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n\t'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n\t'xsd': 'http://www.w3.org/2001/XMLSchema'\n};\n\nXMLNS.main = [\n\t'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\n\t'http://purl.oclc.org/ooxml/spreadsheetml/main',\n\t'http://schemas.microsoft.com/office/excel/2006/main',\n\t'http://schemas.microsoft.com/office/excel/2006/2'\n];\n\nfunction readIEEE754(buf, idx, isLE, nl, ml) {\n\tif(isLE === undefined) isLE = true;\n\tif(!nl) nl = 8;\n\tif(!ml && nl === 8) ml = 52;\n\tvar e, m, el = nl * 8 - ml - 1, eMax = (1 << el) - 1, eBias = eMax >> 1;\n\tvar bits = -7, d = isLE ? -1 : 1, i = isLE ? (nl - 1) : 0, s = buf[idx + i];\n\n\ti += d;\n\te = s & ((1 << (-bits)) - 1); s >>>= (-bits); bits += el;\n\tfor (; bits > 0; e = e * 256 + buf[idx + i], i += d, bits -= 8);\n\tm = e & ((1 << (-bits)) - 1); e >>>= (-bits); bits += ml;\n\tfor (; bits > 0; m = m * 256 + buf[idx + i], i += d, bits -= 8);\n\tif (e === eMax) return m ? NaN : ((s ? -1 : 1) * Infinity);\n\telse if (e === 0) e = 1 - eBias;\n\telse { m = m + Math.pow(2, ml); e = e - eBias; }\n\treturn (s ? -1 : 1) * m * Math.pow(2, e - ml);\n}\n\nvar __toBuffer, ___toBuffer;\n__toBuffer = ___toBuffer = function toBuffer_(bufs) { var x = []; for(var i = 0; i < bufs[0].length; ++i) { x.push.apply(x, bufs[0][i]); } return x; };\nvar __utf16le, ___utf16le;\n__utf16le = ___utf16le = function utf16le_(b,s,e) { var ss=[]; for(var i=s; i<e; i+=2) ss.push(String.fromCharCode(__readUInt16LE(b,i))); return ss.join(\"\"); };\nvar __hexlify, ___hexlify;\n__hexlify = ___hexlify = function hexlify_(b,s,l) { return b.slice(s,(s+l)).map(function(x){return (x<16?\"0\":\"\") + x.toString(16);}).join(\"\"); };\nvar __utf8, ___utf8;\n__utf8 = ___utf8 = function(b,s,e) { var ss=[]; for(var i=s; i<e; i++) ss.push(String.fromCharCode(__readUInt8(b,i))); return ss.join(\"\"); };\nvar __lpstr, ___lpstr;\n__lpstr = ___lpstr = function lpstr_(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __lpwstr, ___lpwstr;\n__lpwstr = ___lpwstr = function lpwstr_(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __double, ___double;\n__double = ___double = function(b, idx) { return readIEEE754(b, idx);};\n\nvar is_buf = function is_buf_a(a) { return Array.isArray(a); };\nif(has_buf) {\n\t__utf16le = function utf16le_b(b,s,e) { if(!Buffer.isBuffer(b)) return ___utf16le(b,s,e); return b.toString('utf16le',s,e); };\n\t__hexlify = function(b,s,l) { return Buffer.isBuffer(b) ? b.toString('hex',s,s+l) : ___hexlify(b,s,l); };\n\t__lpstr = function lpstr_b(b,i) { if(!Buffer.isBuffer(b)) return ___lpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\n\t__lpwstr = function lpwstr_b(b,i) { if(!Buffer.isBuffer(b)) return ___lpwstr(b, i); var len = 2*b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len-1);};\n\t__utf8 = function utf8_b(s,e) { return this.toString('utf8',s,e); };\n\t__toBuffer = function(bufs) { return (bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0])) ? Buffer.concat(bufs[0]) : ___toBuffer(bufs);};\n\tbconcat = function(bufs) { return Buffer.isBuffer(bufs[0]) ? Buffer.concat(bufs) : [].concat.apply([], bufs); };\n\t__double = function double_(b,i) { if(Buffer.isBuffer(b)) return b.readDoubleLE(i); return ___double(b,i); };\n\tis_buf = function is_buf_b(a) { return Buffer.isBuffer(a) || Array.isArray(a); };\n}\n\n/* from js-xls */\nif(typeof cptable !== 'undefined') {\n\t__utf16le = function(b,s,e) { return cptable.utils.decode(1200, b.slice(s,e)); };\n\t__utf8 = function(b,s,e) { return cptable.utils.decode(65001, b.slice(s,e)); };\n\t__lpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? cptable.utils.decode(current_codepage, b.slice(i+4, i+4+len-1)) : \"\";};\n\t__lpwstr = function(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? cptable.utils.decode(1200, b.slice(i+4,i+4+len-1)) : \"\";};\n}\n\nvar __readUInt8 = function(b, idx) { return b[idx]; };\nvar __readUInt16LE = function(b, idx) { return b[idx+1]*(1<<8)+b[idx]; };\nvar __readInt16LE = function(b, idx) { var u = b[idx+1]*(1<<8)+b[idx]; return (u < 0x8000) ? u : (0xffff - u + 1) * -1; };\nvar __readUInt32LE = function(b, idx) { return b[idx+3]*(1<<24)+(b[idx+2]<<16)+(b[idx+1]<<8)+b[idx]; };\nvar __readInt32LE = function(b, idx) { return (b[idx+3]<<24)|(b[idx+2]<<16)|(b[idx+1]<<8)|b[idx]; };\n\nvar ___unhexlify = function(s) { return s.match(/../g).map(function(x) { return parseInt(x,16);}); };\nvar __unhexlify = typeof Buffer !== \"undefined\" ? function(s) { return Buffer.isBuffer(s) ? new Buffer(s, 'hex') : ___unhexlify(s); } : ___unhexlify;\n\nfunction ReadShift(size, t) {\n\tvar o=\"\", oI, oR, oo=[], w, vv, i, loc;\n\tswitch(t) {\n\t\tcase 'dbcs':\n\t\t\tloc = this.l;\n\t\t\tif(has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l+2*size).toString(\"utf16le\");\n\t\t\telse for(i = 0; i != size; ++i) { o+=String.fromCharCode(__readUInt16LE(this, loc)); loc+=2; }\n\t\t\tsize *= 2;\n\t\t\tbreak;\n\n\t\tcase 'utf8': o = __utf8(this, this.l, this.l + size); break;\n\t\tcase 'utf16le': size *= 2; o = __utf16le(this, this.l, this.l + size); break;\n\n\t\t/* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n\t\tcase 'lpstr': o = __lpstr(this, this.l); size = 5 + o.length; break;\n\t\t/* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n\t\tcase 'lpwstr': o = __lpwstr(this, this.l); size = 5 + o.length; if(o[o.length-1] == '\\u0000') size += 2; break;\n\n\t\tcase 'cstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt8(this, this.l + size++))!==0) oo.push(_getchar(w));\n\t\t\to = oo.join(\"\"); break;\n\t\tcase 'wstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt16LE(this,this.l +size))!==0){oo.push(_getchar(w));size+=2;}\n\t\t\tsize+=2; o = oo.join(\"\"); break;\n\n\t\t/* sbcs and dbcs support continue records in the SST way TODO codepages */\n\t\tcase 'dbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i != size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt16LE(this, loc)));\n\t\t\t\tloc+=2;\n\t\t\t} o = oo.join(\"\"); size *= 2; break;\n\n\t\tcase 'sbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i != size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt8(this, loc)));\n\t\t\t\tloc+=1;\n\t\t\t} o = oo.join(\"\"); break;\n\n\t\tdefault:\n\tswitch(size) {\n\t\tcase 1: oI = __readUInt8(this, this.l); this.l++; return oI;\n\t\tcase 2: oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l); this.l += 2; return oI;\n\t\tcase 4:\n\t\t\tif(t === 'i' || (this[this.l+3] & 0x80)===0) { oI = __readInt32LE(this, this.l); this.l += 4; return oI; }\n\t\t\telse { oR = __readUInt32LE(this, this.l); this.l += 4; return oR; } break;\n\t\tcase 8: if(t === 'f') { oR = __double(this, this.l); this.l += 8; return oR; }\n\t\t/* falls through */\n\t\tcase 16: o = __hexlify(this, this.l, size); break;\n\t}}\n\tthis.l+=size; return o;\n}\n\nfunction WriteShift(t, val, f) {\n\tvar size, i;\n\tif(f === 'dbcs') {\n\t\tfor(i = 0; i != val.length; ++i) this.writeUInt16LE(val.charCodeAt(i), this.l + 2 * i);\n\t\tsize = 2 * val.length;\n\t} else switch(t) {\n\t\tcase  1: size = 1; this[this.l] = val&255; break;\n\t\tcase  3: size = 3; this[this.l+2] = val & 255; val >>>= 8; this[this.l+1] = val&255; val >>>= 8; this[this.l] = val&255; break;\n\t\tcase  4: size = 4; this.writeUInt32LE(val, this.l); break;\n\t\tcase  8: size = 8; if(f === 'f') { this.writeDoubleLE(val, this.l); break; }\n\t\t/* falls through */\n\t\tcase 16: break;\n\t\tcase -4: size = 4; this.writeInt32LE(val, this.l); break;\n\t}\n\tthis.l += size; return this;\n}\n\nfunction CheckField(hexstr, fld) {\n\tvar m = __hexlify(this,this.l,hexstr.length>>1);\n\tif(m !== hexstr) throw fld + 'Expected ' + hexstr + ' saw ' + m;\n\tthis.l += hexstr.length>>1;\n}\n\nfunction prep_blob(blob, pos) {\n\tblob.l = pos;\n\tblob.read_shift = ReadShift;\n\tblob.chk = CheckField;\n\tblob.write_shift = WriteShift;\n}\n\nfunction parsenoop(blob, length) { blob.l += length; }\n\nfunction writenoop(blob, length) { blob.l += length; }\n\nfunction new_buf(sz) {\n\tvar o = new_raw_buf(sz);\n\tprep_blob(o, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.1.4 Record */\nfunction recordhopper(data, cb, opts) {\n\tvar tmpbyte, cntbyte, length;\n\tprep_blob(data, data.l || 0);\n\twhile(data.l < data.length) {\n\t\tvar RT = data.read_shift(1);\n\t\tif(RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F)<<7);\n\t\tvar R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\n\t\ttmpbyte = data.read_shift(1);\n\t\tlength = tmpbyte & 0x7F;\n\t\tfor(cntbyte = 1; cntbyte <4 && (tmpbyte & 0x80); ++cntbyte) length += ((tmpbyte = data.read_shift(1)) & 0x7F)<<(7*cntbyte);\n\t\tvar d = R.f(data, length, opts);\n\t\tif(cb(d, R, RT)) return;\n\t}\n}\n\n/* control buffer usage for fixed-length buffers */\nfunction buf_array() {\n\tvar bufs = [], blksz = 2048;\n\tvar newblk = function ba_newblk(sz) {\n\t\tvar o = new_buf(sz);\n\t\tprep_blob(o, 0);\n\t\treturn o;\n\t};\n\n\tvar curbuf = newblk(blksz);\n\n\tvar endbuf = function ba_endbuf() {\n\t\tcurbuf.length = curbuf.l;\n\t\tif(curbuf.length > 0) bufs.push(curbuf);\n\t\tcurbuf = null;\n\t};\n\n\tvar next = function ba_next(sz) {\n\t\tif(sz < curbuf.length - curbuf.l) return curbuf;\n\t\tendbuf();\n\t\treturn (curbuf = newblk(Math.max(sz+1, blksz)));\n\t};\n\n\tvar end = function ba_end() {\n\t\tendbuf();\n\t\treturn __toBuffer([bufs]);\n\t};\n\n\tvar push = function ba_push(buf) { endbuf(); curbuf = buf; next(blksz); };\n\n\treturn { next:next, push:push, end:end, _bufs:bufs };\n}\n\nfunction write_record(ba, type, payload, length) {\n\tvar t = evert_RE[type], l;\n\tif(!length) length = XLSBRecordEnum[t].p || (payload||[]).length || 0;\n\tl = 1 + (t >= 0x80 ? 1 : 0) + 1 + length;\n\tif(length >= 0x80) ++l; if(length >= 0x4000) ++l; if(length >= 0x200000) ++l;\n\tvar o = ba.next(l);\n\tif(t <= 0x7F) o.write_shift(1, t);\n\telse {\n\t\to.write_shift(1, (t & 0x7F) + 0x80);\n\t\to.write_shift(1, (t >> 7));\n\t}\n\tfor(var i = 0; i != 4; ++i) {\n\t\tif(length >= 0x80) { o.write_shift(1, (length & 0x7F)+0x80); length >>= 7; }\n\t\telse { o.write_shift(1, length); break; }\n\t}\n\tif(length > 0 && is_buf(payload)) ba.push(payload);\n}\n/* XLS ranges enforced */\nfunction shift_cell_xls(cell, tgt) {\n\tif(tgt.s) {\n\t\tif(cell.cRel) cell.c += tgt.s.c;\n\t\tif(cell.rRel) cell.r += tgt.s.r;\n\t} else {\n\t\tcell.c += tgt.c;\n\t\tcell.r += tgt.r;\n\t}\n\tcell.cRel = cell.rRel = 0;\n\twhile(cell.c >= 0x100) cell.c -= 0x100;\n\twhile(cell.r >= 0x10000) cell.r -= 0x10000;\n\treturn cell;\n}\n\nfunction shift_range_xls(cell, range) {\n\tcell.s = shift_cell_xls(cell.s, range.s);\n\tcell.e = shift_cell_xls(cell.e, range.s);\n\treturn cell;\n}\n\nvar OFFCRYPTO = {};\nvar make_offcrypto = function(O, _crypto) {\n\tvar crypto;\n\tif(typeof _crypto !== 'undefined') crypto = _crypto;\n\telse if(typeof require !== 'undefined') {\n\t\ttry { crypto = require('cry'+'pto'); }\n\t\tcatch(e) { crypto = null; }\n\t}\n\n\tO.rc4 = function(key, data) {\n\t\tvar S = new Array(256);\n\t\tvar c = 0, i = 0, j = 0, t = 0;\n\t\tfor(i = 0; i != 256; ++i) S[i] = i;\n\t\tfor(i = 0; i != 256; ++i) {\n\t\t\tj = (j + S[i] + (key[i%key.length]).charCodeAt(0))&255;\n\t\t\tt = S[i]; S[i] = S[j]; S[j] = t;\n\t\t}\n\t\ti = j = 0; out = Buffer(data.length);\n\t\tfor(c = 0; c != data.length; ++c) {\n\t\t\ti = (i + 1)&255;\n\t\t\tj = (j + S[i])%256;\n\t\t\tt = S[i]; S[i] = S[j]; S[j] = t;\n\t\t\tout[c] = (data[c] ^ S[(S[i]+S[j])&255]);\n\t\t}\n\t\treturn out;\n\t};\n\n\tif(crypto) {\n\t\tO.md5 = function(hex) { return crypto.createHash('md5').update(hex).digest('hex'); };\n\t} else {\n\t\tO.md5 = function(hex) { throw \"unimplemented\"; };\n\t}\n};\nmake_offcrypto(OFFCRYPTO, typeof crypto !== \"undefined\" ? crypto : undefined);\n\n\n/* [MS-XLSB] 2.5.143 */\nfunction parse_StrRun(data, length) {\n\treturn { ich: data.read_shift(2), ifnt: data.read_shift(2) };\n}\n\n/* [MS-XLSB] 2.1.7.121 */\nfunction parse_RichStr(data, length) {\n\tvar start = data.l;\n\tvar flags = data.read_shift(1);\n\tvar str = parse_XLWideString(data);\n\tvar rgsStrRun = [];\n\tvar z = { t: str, h: str };\n\tif((flags & 1) !== 0) { /* fRichStr */\n\t\t/* TODO: formatted string */\n\t\tvar dwSizeStrRun = data.read_shift(4);\n\t\tfor(var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));\n\t\tz.r = rgsStrRun;\n\t}\n\telse z.r = \"<t>\" + escapexml(str) + \"</t>\";\n\tif((flags & 2) !== 0) { /* fExtStr */\n\t\t/* TODO: phonetic string */\n\t}\n\tdata.l = start + length;\n\treturn z;\n}\nfunction write_RichStr(str, o) {\n\t/* TODO: formatted string */\n\tif(o == null) o = new_buf(5+2*str.t.length);\n\to.write_shift(1,0);\n\twrite_XLWideString(str.t, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.9 */\nfunction parse_XLSBCell(data) {\n\tvar col = data.read_shift(4);\n\tvar iStyleRef = data.read_shift(2);\n\tiStyleRef += data.read_shift(1) <<16;\n\tvar fPhShow = data.read_shift(1);\n\treturn { c:col, iStyleRef: iStyleRef };\n}\nfunction write_XLSBCell(cell, o) {\n\tif(o == null) o = new_buf(8);\n\to.write_shift(-4, cell.c);\n\to.write_shift(3, cell.iStyleRef === undefined ? cell.iStyleRef : cell.s);\n\to.write_shift(1, 0); /* fPhShow */\n\treturn o;\n}\n\n\n/* [MS-XLSB] 2.5.21 */\nfunction parse_XLSBCodeName (data, length) { return parse_XLWideString(data, length); }\n\n/* [MS-XLSB] 2.5.166 */\nfunction parse_XLNullableWideString(data) {\n\tvar cchCharacters = data.read_shift(4);\n\treturn cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\nfunction write_XLNullableWideString(data, o) {\n\tif(!o) o = new_buf(127);\n\to.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\n\tif(data.length > 0) o.write_shift(0, data, 'dbcs');\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.168 */\nfunction parse_XLWideString(data) {\n\tvar cchCharacters = data.read_shift(4);\n\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\nfunction write_XLWideString(data, o) {\n\tif(o == null) o = new_buf(4+2*data.length);\n\to.write_shift(4, data.length);\n\tif(data.length > 0) o.write_shift(0, data, 'dbcs');\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.114 */\nvar parse_RelID = parse_XLNullableWideString;\nvar write_RelID = write_XLNullableWideString;\n\n\n/* [MS-XLSB] 2.5.122 */\n/* [MS-XLS] 2.5.217 */\nfunction parse_RkNumber(data) {\n\tvar b = data.slice(data.l, data.l+4);\n\tvar fX100 = b[0] & 1, fInt = b[0] & 2;\n\tdata.l+=4;\n\tb[0] &= 0xFC; // b[0] &= ~3;\n\tvar RK = fInt === 0 ? __double([0,0,0,0,b[0],b[1],b[2],b[3]],0) : __readInt32LE(b,0)>>2;\n\treturn fX100 ? RK/100 : RK;\n}\n\n/* [MS-XLSB] 2.5.153 */\nfunction parse_UncheckedRfX(data) {\n\tvar cell = {s: {}, e: {}};\n\tcell.s.r = data.read_shift(4);\n\tcell.e.r = data.read_shift(4);\n\tcell.s.c = data.read_shift(4);\n\tcell.e.c = data.read_shift(4);\n\treturn cell;\n}\n\nfunction write_UncheckedRfX(r, o) {\n\tif(!o) o = new_buf(16);\n\to.write_shift(4, r.s.r);\n\to.write_shift(4, r.e.r);\n\to.write_shift(4, r.s.c);\n\to.write_shift(4, r.e.c);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.171 */\n/* [MS-XLS] 2.5.342 */\nfunction parse_Xnum(data, length) { return data.read_shift(8, 'f'); }\nfunction write_Xnum(data, o) { return (o || new_buf(8)).write_shift(8, 'f', data); }\n\n/* [MS-XLSB] 2.5.198.2 */\nvar BErr = {\n\t0x00: \"#NULL!\",\n\t0x07: \"#DIV/0!\",\n\t0x0F: \"#VALUE!\",\n\t0x17: \"#REF!\",\n\t0x1D: \"#NAME?\",\n\t0x24: \"#NUM!\",\n\t0x2A: \"#N/A\",\n\t0x2B: \"#GETTING_DATA\",\n\t0xFF: \"#WTF?\"\n};\nvar RBErr = evert_num(BErr);\n\n/* [MS-XLSB] 2.4.321 BrtColor */\nfunction parse_BrtColor(data, length) {\n\tvar out = {};\n\tvar d = data.read_shift(1);\n\tout.fValidRGB = d & 1;\n\tout.xColorType = d >>> 1;\n\tout.index = data.read_shift(1);\n\tout.nTintAndShade = data.read_shift(2, 'i');\n\tout.bRed   = data.read_shift(1);\n\tout.bGreen = data.read_shift(1);\n\tout.bBlue  = data.read_shift(1);\n\tout.bAlpha = data.read_shift(1);\n}\n\n/* [MS-XLSB] 2.5.52 */\nfunction parse_FontFlags(data, length) {\n\tvar d = data.read_shift(1);\n\tdata.l++;\n\tvar out = {\n\t\tfItalic: d & 0x2,\n\t\tfStrikeout: d & 0x8,\n\t\tfOutline: d & 0x10,\n\t\tfShadow: d & 0x20,\n\t\tfCondense: d & 0x40,\n\t\tfExtend: d & 0x80\n\t};\n\treturn out;\n}\n/* [MS-OLEPS] 2.2 PropertyType */\n{\n\tvar VT_EMPTY    = 0x0000;\n\tvar VT_NULL     = 0x0001;\n\tvar VT_I2       = 0x0002;\n\tvar VT_I4       = 0x0003;\n\tvar VT_R4       = 0x0004;\n\tvar VT_R8       = 0x0005;\n\tvar VT_CY       = 0x0006;\n\tvar VT_DATE     = 0x0007;\n\tvar VT_BSTR     = 0x0008;\n\tvar VT_ERROR    = 0x000A;\n\tvar VT_BOOL     = 0x000B;\n\tvar VT_VARIANT  = 0x000C;\n\tvar VT_DECIMAL  = 0x000E;\n\tvar VT_I1       = 0x0010;\n\tvar VT_UI1      = 0x0011;\n\tvar VT_UI2      = 0x0012;\n\tvar VT_UI4      = 0x0013;\n\tvar VT_I8       = 0x0014;\n\tvar VT_UI8      = 0x0015;\n\tvar VT_INT      = 0x0016;\n\tvar VT_UINT     = 0x0017;\n\tvar VT_LPSTR    = 0x001E;\n\tvar VT_LPWSTR   = 0x001F;\n\tvar VT_FILETIME = 0x0040;\n\tvar VT_BLOB     = 0x0041;\n\tvar VT_STREAM   = 0x0042;\n\tvar VT_STORAGE  = 0x0043;\n\tvar VT_STREAMED_Object  = 0x0044;\n\tvar VT_STORED_Object    = 0x0045;\n\tvar VT_BLOB_Object      = 0x0046;\n\tvar VT_CF       = 0x0047;\n\tvar VT_CLSID    = 0x0048;\n\tvar VT_VERSIONED_STREAM = 0x0049;\n\tvar VT_VECTOR   = 0x1000;\n\tvar VT_ARRAY    = 0x2000;\n\n\tvar VT_STRING   = 0x0050; // 2.3.3.1.11 VtString\n\tvar VT_USTR     = 0x0051; // 2.3.3.1.12 VtUnalignedString\n\tvar VT_CUSTOM   = [VT_STRING, VT_USTR];\n}\n\n/* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\nvar DocSummaryPIDDSI = {\n\t0x01: { n: 'CodePage', t: VT_I2 },\n\t0x02: { n: 'Category', t: VT_STRING },\n\t0x03: { n: 'PresentationFormat', t: VT_STRING },\n\t0x04: { n: 'ByteCount', t: VT_I4 },\n\t0x05: { n: 'LineCount', t: VT_I4 },\n\t0x06: { n: 'ParagraphCount', t: VT_I4 },\n\t0x07: { n: 'SlideCount', t: VT_I4 },\n\t0x08: { n: 'NoteCount', t: VT_I4 },\n\t0x09: { n: 'HiddenCount', t: VT_I4 },\n\t0x0a: { n: 'MultimediaClipCount', t: VT_I4 },\n\t0x0b: { n: 'Scale', t: VT_BOOL },\n\t0x0c: { n: 'HeadingPair', t: VT_VECTOR | VT_VARIANT },\n\t0x0d: { n: 'DocParts', t: VT_VECTOR | VT_LPSTR },\n\t0x0e: { n: 'Manager', t: VT_STRING },\n\t0x0f: { n: 'Company', t: VT_STRING },\n\t0x10: { n: 'LinksDirty', t: VT_BOOL },\n\t0x11: { n: 'CharacterCount', t: VT_I4 },\n\t0x13: { n: 'SharedDoc', t: VT_BOOL },\n\t0x16: { n: 'HLinksChanged', t: VT_BOOL },\n\t0x17: { n: 'AppVersion', t: VT_I4, p: 'version' },\n\t0x1A: { n: 'ContentType', t: VT_STRING },\n\t0x1B: { n: 'ContentStatus', t: VT_STRING },\n\t0x1C: { n: 'Language', t: VT_STRING },\n\t0x1D: { n: 'Version', t: VT_STRING },\n\t0xFF: {}\n};\n\n/* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\nvar SummaryPIDSI = {\n\t0x01: { n: 'CodePage', t: VT_I2 },\n\t0x02: { n: 'Title', t: VT_STRING },\n\t0x03: { n: 'Subject', t: VT_STRING },\n\t0x04: { n: 'Author', t: VT_STRING },\n\t0x05: { n: 'Keywords', t: VT_STRING },\n\t0x06: { n: 'Comments', t: VT_STRING },\n\t0x07: { n: 'Template', t: VT_STRING },\n\t0x08: { n: 'LastAuthor', t: VT_STRING },\n\t0x09: { n: 'RevNumber', t: VT_STRING },\n\t0x0A: { n: 'EditTime', t: VT_FILETIME },\n\t0x0B: { n: 'LastPrinted', t: VT_FILETIME },\n\t0x0C: { n: 'CreatedDate', t: VT_FILETIME },\n\t0x0D: { n: 'ModifiedDate', t: VT_FILETIME },\n\t0x0E: { n: 'PageCount', t: VT_I4 },\n\t0x0F: { n: 'WordCount', t: VT_I4 },\n\t0x10: { n: 'CharCount', t: VT_I4 },\n\t0x11: { n: 'Thumbnail', t: VT_CF },\n\t0x12: { n: 'ApplicationName', t: VT_LPSTR },\n\t0x13: { n: 'DocumentSecurity', t: VT_I4 },\n\t0xFF: {}\n};\n\n/* [MS-OLEPS] 2.18 */\nvar SpecialProperties = {\n\t0x80000000: { n: 'Locale', t: VT_UI4 },\n\t0x80000003: { n: 'Behavior', t: VT_UI4 },\n\t0x72627262: {}\n};\n\n(function() {\n\tfor(var y in SpecialProperties) if(SpecialProperties.hasOwnProperty(y))\n\tDocSummaryPIDDSI[y] = SummaryPIDSI[y] = SpecialProperties[y];\n})();\n\n/* [MS-XLS] 2.4.63 Country/Region codes */\nvar CountryEnum = {\n\t0x0001: \"US\", // United States\n\t0x0002: \"CA\", // Canada\n\t0x0003: \"\", // Latin America (except Brazil)\n\t0x0007: \"RU\", // Russia\n\t0x0014: \"EG\", // Egypt\n\t0x001E: \"GR\", // Greece\n\t0x001F: \"NL\", // Netherlands\n\t0x0020: \"BE\", // Belgium\n\t0x0021: \"FR\", // France\n\t0x0022: \"ES\", // Spain\n\t0x0024: \"HU\", // Hungary\n\t0x0027: \"IT\", // Italy\n\t0x0029: \"CH\", // Switzerland\n\t0x002B: \"AT\", // Austria\n\t0x002C: \"GB\", // United Kingdom\n\t0x002D: \"DK\", // Denmark\n\t0x002E: \"SE\", // Sweden\n\t0x002F: \"NO\", // Norway\n\t0x0030: \"PL\", // Poland\n\t0x0031: \"DE\", // Germany\n\t0x0034: \"MX\", // Mexico\n\t0x0037: \"BR\", // Brazil\n\t0x003d: \"AU\", // Australia\n\t0x0040: \"NZ\", // New Zealand\n\t0x0042: \"TH\", // Thailand\n\t0x0051: \"JP\", // Japan\n\t0x0052: \"KR\", // Korea\n\t0x0054: \"VN\", // Viet Nam\n\t0x0056: \"CN\", // China\n\t0x005A: \"TR\", // Turkey\n\t0x0069: \"JS\", // Ramastan\n\t0x00D5: \"DZ\", // Algeria\n\t0x00D8: \"MA\", // Morocco\n\t0x00DA: \"LY\", // Libya\n\t0x015F: \"PT\", // Portugal\n\t0x0162: \"IS\", // Iceland\n\t0x0166: \"FI\", // Finland\n\t0x01A4: \"CZ\", // Czech Republic\n\t0x0376: \"TW\", // Taiwan\n\t0x03C1: \"LB\", // Lebanon\n\t0x03C2: \"JO\", // Jordan\n\t0x03C3: \"SY\", // Syria\n\t0x03C4: \"IQ\", // Iraq\n\t0x03C5: \"KW\", // Kuwait\n\t0x03C6: \"SA\", // Saudi Arabia\n\t0x03CB: \"AE\", // United Arab Emirates\n\t0x03CC: \"IL\", // Israel\n\t0x03CE: \"QA\", // Qatar\n\t0x03D5: \"IR\", // Iran\n\t0xFFFF: \"US\"  // United States\n};\n\n/* [MS-XLS] 2.5.127 */\nvar XLSFillPattern = [\n\tnull,\n\t'solid',\n\t'mediumGray',\n\t'darkGray',\n\t'lightGray',\n\t'darkHorizontal',\n\t'darkVertical',\n\t'darkDown',\n\t'darkUp',\n\t'darkGrid',\n\t'darkTrellis',\n\t'lightHorizontal',\n\t'lightVertical',\n\t'lightDown',\n\t'lightUp',\n\t'lightGrid',\n\t'lightTrellis',\n\t'gray125',\n\t'gray0625'\n];\n\nfunction rgbify(arr) { return arr.map(function(x) { return [(x>>16)&255,(x>>8)&255,x&255]; }); }\n\n/* [MS-XLS] 2.5.161 */\nvar XLSIcv = rgbify([\n\t/* Color Constants */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t/* Defaults */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t0x800000,\n\t0x008000,\n\t0x000080,\n\t0x808000,\n\t0x800080,\n\t0x008080,\n\t0xC0C0C0,\n\t0x808080,\n\t0x9999FF,\n\t0x993366,\n\t0xFFFFCC,\n\t0xCCFFFF,\n\t0x660066,\n\t0xFF8080,\n\t0x0066CC,\n\t0xCCCCFF,\n\n\t0x000080,\n\t0xFF00FF,\n\t0xFFFF00,\n\t0x00FFFF,\n\t0x800080,\n\t0x800000,\n\t0x008080,\n\t0x0000FF,\n\t0x00CCFF,\n\t0xCCFFFF,\n\t0xCCFFCC,\n\t0xFFFF99,\n\t0x99CCFF,\n\t0xFF99CC,\n\t0xCC99FF,\n\t0xFFCC99,\n\n\t0x3366FF,\n\t0x33CCCC,\n\t0x99CC00,\n\t0xFFCC00,\n\t0xFF9900,\n\t0xFF6600,\n\t0x666699,\n\t0x969696,\n\t0x003366,\n\t0x339966,\n\t0x003300,\n\t0x333300,\n\t0x993300,\n\t0x993366,\n\t0x333399,\n\t0x333333,\n\n\t/* Sheet */\n\t0xFFFFFF,\n\t0x000000\n]);\n\n/* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\n/* 12.3 Part Summary <SpreadsheetML> */\n/* 14.2 Part Summary <DrawingML> */\n/* [MS-XLSX] 2.1 Part Enumerations */\n/* [MS-XLSB] 2.1.7 Part Enumeration */\nvar ct2type = {\n\t/* Workbook */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\n\n\t/* Worksheet */\n\t\"application/vnd.ms-excel.binIndexWs\": \"TODO\", /* Binary Index */\n\n\t/* Chartsheet */\n\t\"application/vnd.ms-excel.chartsheet\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"TODO\",\n\n\t/* Dialogsheet */\n\t\"application/vnd.ms-excel.dialogsheet\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"TODO\",\n\n\t/* Macrosheet */\n\t\"application/vnd.ms-excel.macrosheet\": \"TODO\",\n\t\"application/vnd.ms-excel.macrosheet+xml\": \"TODO\",\n\t\"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\n\t\"application/vnd.ms-excel.binIndexMs\": \"TODO\", /* Binary Index */\n\n\t/* File Properties */\n\t\"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\n\t\"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\n\t\"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\n\n\t/* Custom Data Properties */\n\t\"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\n\n\t/* Comments */\n\t\"application/vnd.ms-excel.comments\": \"comments\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\n\n\t/* PivotTable */\n\t\"application/vnd.ms-excel.pivotTable\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\n\n\t/* Calculation Chain */\n\t\"application/vnd.ms-excel.calcChain\": \"calcchains\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\n\n\t/* Printer Settings */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\n\n\t/* ActiveX */\n\t\"application/vnd.ms-office.activeX\": \"TODO\",\n\t\"application/vnd.ms-office.activeX+xml\": \"TODO\",\n\n\t/* Custom Toolbars */\n\t\"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\n\n\t/* External Data Connections */\n\t\"application/vnd.ms-excel.connections\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\n\n\t/* External Links */\n\t\"application/vnd.ms-excel.externalLink\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"TODO\",\n\n\t/* Metadata */\n\t\"application/vnd.ms-excel.sheetMetadata\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"TODO\",\n\n\t/* PivotCache */\n\t\"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\n\t\"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\n\n\t/* Query Table */\n\t\"application/vnd.ms-excel.queryTable\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\n\n\t/* Shared Workbook */\n\t\"application/vnd.ms-excel.userNames\": \"TODO\",\n\t\"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\n\t\"application/vnd.ms-excel.revisionLog\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\n\n\t/* Single Cell Table */\n\t\"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\n\n\t/* Slicer */\n\t\"application/vnd.ms-excel.slicer\": \"TODO\",\n\t\"application/vnd.ms-excel.slicerCache\": \"TODO\",\n\t\"application/vnd.ms-excel.slicer+xml\": \"TODO\",\n\t\"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\n\n\t/* Sort Map */\n\t\"application/vnd.ms-excel.wsSortMap\": \"TODO\",\n\n\t/* Table */\n\t\"application/vnd.ms-excel.table\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\n\n\t/* Themes */\n\t\"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\n\n\t/* Timeline */\n\t\"application/vnd.ms-excel.Timeline+xml\": \"TODO\", /* verify */\n\t\"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\", /* verify */\n\n\t/* VBA */\n\t\"application/vnd.ms-office.vbaProject\": \"vba\",\n\t\"application/vnd.ms-office.vbaProjectSignature\": \"vba\",\n\n\t/* Volatile Dependencies */\n\t\"application/vnd.ms-office.volatileDependencies\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\n\n\t/* Control Properties */\n\t\"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\n\n\t/* Data Model */\n\t\"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\n\n\t/* Survey */\n\t\"application/vnd.ms-excel.Survey+xml\": \"TODO\",\n\n\t/* Drawing */\n\t\"application/vnd.openxmlformats-officedocument.drawing+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\n\n\t/* VML */\n\t\"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\n\n\t\"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\n\t\"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\n\n\t\"sheet\": \"js\"\n};\n\nvar CT_LIST = (function(){\n\tvar o = {\n\t\tworkbooks: {\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\n\t\t\txlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\n\t\t\txltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\n\t\t},\n\t\tstrs: { /* Shared Strings */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.sharedStrings\"\n\t\t},\n\t\tsheets: {\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.worksheet\"\n\t\t},\n\t\tstyles: {/* Styles */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.styles\"\n\t\t}\n\t};\n\tkeys(o).forEach(function(k) { if(!o[k].xlsm) o[k].xlsm = o[k].xlsx; });\n\tkeys(o).forEach(function(k){ keys(o[k]).forEach(function(v) { ct2type[o[k][v]] = k; }); });\n\treturn o;\n})();\n\nvar type2ct = evert_arr(ct2type);\n\nXMLNS.CT = 'http://schemas.openxmlformats.org/package/2006/content-types';\n\nfunction parse_ct(data, opts) {\n\tvar ctext = {};\n\tif(!data || !data.match) return data;\n\tvar ct = { workbooks: [], sheets: [], calcchains: [], themes: [], styles: [],\n\t\tcoreprops: [], extprops: [], custprops: [], strs:[], comments: [], vba: [],\n\t\tTODO:[], rels:[], xmlns: \"\" };\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0].replace(nsregex,\"<\")) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<Types': ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/)||[\"\",\"\"])[1] ]; break;\n\t\t\tcase '<Default': ctext[y.Extension] = y.ContentType; break;\n\t\t\tcase '<Override':\n\t\t\t\tif(ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);\n\t\t\t\telse if(opts.WTF) console.error(y);\n\t\t\t\tbreak;\n\t\t}\n\t});\n\tif(ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\n\tct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\n\tct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\n\tct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\n\tct.defaults = ctext;\n\tdelete ct.calcchains;\n\treturn ct;\n}\n\nvar CTYPE_XML_ROOT = writextag('Types', null, {\n\t'xmlns': XMLNS.CT,\n\t'xmlns:xsd': XMLNS.xsd,\n\t'xmlns:xsi': XMLNS.xsi\n});\n\nvar CTYPE_DEFAULTS = [\n\t['xml', 'application/xml'],\n\t['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'],\n\t['rels', type2ct.rels[0]]\n].map(function(x) {\n\treturn writextag('Default', null, {'Extension':x[0], 'ContentType': x[1]});\n});\n\nfunction write_ct(ct, opts) {\n\tvar o = [], v;\n\to[o.length] = (XML_HEADER);\n\to[o.length] = (CTYPE_XML_ROOT);\n\to = o.concat(CTYPE_DEFAULTS);\n\tvar f1 = function(w) {\n\t\tif(ct[w] && ct[w].length > 0) {\n\t\t\tv = ct[w][0];\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\n\t\t\t}));\n\t\t}\n\t};\n\tvar f2 = function(w) {\n\t\tct[w].forEach(function(v) {\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\n\t\t\t}));\n\t\t});\n\t};\n\tvar f3 = function(t) {\n\t\t(ct[t]||[]).forEach(function(v) {\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': type2ct[t][0]\n\t\t\t}));\n\t\t});\n\t};\n\tf1('workbooks');\n\tf2('sheets');\n\tf3('themes');\n\t['strs', 'styles'].forEach(f1);\n\t['coreprops', 'extprops', 'custprops'].forEach(f3);\n\tif(o.length>2){ o[o.length] = ('</Types>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 9.3.2 OPC Relationships Markup */\nvar RELS = {\n\tWB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n\tSHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\"\n};\n\nfunction parse_rels(data, currentFilePath) {\n\tif (!data) return data;\n\tif (currentFilePath.charAt(0) !== '/') {\n\t\tcurrentFilePath = '/'+currentFilePath;\n\t}\n\tvar rels = {};\n\tvar hash = {};\n\tvar resolveRelativePathIntoAbsolute = function (to) {\n\t\tvar toksFrom = currentFilePath.split('/');\n\t\ttoksFrom.pop(); // folder path\n\t\tvar toksTo = to.split('/');\n\t\tvar reversed = [];\n\t\twhile (toksTo.length !== 0) {\n\t\t\tvar tokTo = toksTo.shift();\n\t\t\tif (tokTo === '..') {\n\t\t\t\ttoksFrom.pop();\n\t\t\t} else if (tokTo !== '.') {\n\t\t\t\ttoksFrom.push(tokTo);\n\t\t\t}\n\t\t}\n\t\treturn toksFrom.join('/');\n\t};\n\n\tdata.match(tagregex).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\t/* 9.3.2.2 OPC_Relationships */\n\t\tif (y[0] === '<Relationship') {\n\t\t\tvar rel = {}; rel.Type = y.Type; rel.Target = y.Target; rel.Id = y.Id; rel.TargetMode = y.TargetMode;\n\t\t\tvar canonictarget = y.TargetMode === 'External' ? y.Target : resolveRelativePathIntoAbsolute(y.Target);\n\t\t\trels[canonictarget] = rel;\n\t\t\thash[y.Id] = rel;\n\t\t}\n\t});\n\trels[\"!id\"] = hash;\n\treturn rels;\n}\n\nXMLNS.RELS = 'http://schemas.openxmlformats.org/package/2006/relationships';\n\nvar RELS_ROOT = writextag('Relationships', null, {\n\t//'xmlns:ns0': XMLNS.RELS,\n\t'xmlns': XMLNS.RELS\n});\n\n/* TODO */\nfunction write_rels(rels) {\n\tvar o = [];\n\to[o.length] = (XML_HEADER);\n\to[o.length] = (RELS_ROOT);\n\tkeys(rels['!id']).forEach(function(rid) { var rel = rels['!id'][rid];\n\t\to[o.length] = (writextag('Relationship', null, rel));\n\t});\n\tif(o.length>2){ o[o.length] = ('</Relationships>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* ECMA-376 Part II 11.1 Core Properties Part */\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\nvar CORE_PROPS = [\n\t[\"cp:category\", \"Category\"],\n\t[\"cp:contentStatus\", \"ContentStatus\"],\n\t[\"cp:keywords\", \"Keywords\"],\n\t[\"cp:lastModifiedBy\", \"LastAuthor\"],\n\t[\"cp:lastPrinted\", \"LastPrinted\"],\n\t[\"cp:revision\", \"RevNumber\"],\n\t[\"cp:version\", \"Version\"],\n\t[\"dc:creator\", \"Author\"],\n\t[\"dc:description\", \"Comments\"],\n\t[\"dc:identifier\", \"Identifier\"],\n\t[\"dc:language\", \"Language\"],\n\t[\"dc:subject\", \"Subject\"],\n\t[\"dc:title\", \"Title\"],\n\t[\"dcterms:created\", \"CreatedDate\", 'date'],\n\t[\"dcterms:modified\", \"ModifiedDate\", 'date']\n];\n\nXMLNS.CORE_PROPS = \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\";\nRELS.CORE_PROPS  = 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties';\n\nvar CORE_PROPS_REGEX = (function() {\n\tvar r = new Array(CORE_PROPS.length);\n\tfor(var i = 0; i < CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i];\n\t\tvar g = \"(?:\"+ f[0].substr(0,f[0].indexOf(\":\")) +\":)\"+ f[0].substr(f[0].indexOf(\":\")+1);\n\t\tr[i] = new RegExp(\"<\" + g + \"[^>]*>(.*)<\\/\" + g + \">\");\n\t}\n\treturn r;\n})();\n\nfunction parse_core_props(data) {\n\tvar p = {};\n\n\tfor(var i = 0; i < CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i], cur = data.match(CORE_PROPS_REGEX[i]);\n\t\tif(cur != null && cur.length > 0) p[f[1]] = cur[1];\n\t\tif(f[2] === 'date' && p[f[1]]) p[f[1]] = new Date(p[f[1]]);\n\t}\n\n\treturn p;\n}\n\nvar CORE_PROPS_XML_ROOT = writextag('cp:coreProperties', null, {\n\t//'xmlns': XMLNS.CORE_PROPS,\n\t'xmlns:cp': XMLNS.CORE_PROPS,\n\t'xmlns:dc': XMLNS.dc,\n\t'xmlns:dcterms': XMLNS.dcterms,\n\t'xmlns:dcmitype': XMLNS.dcmitype,\n\t'xmlns:xsi': XMLNS.xsi\n});\n\nfunction cp_doit(f, g, h, o, p) {\n\tif(p[f] != null || g == null || g === \"\") return;\n\tp[f] = g;\n\to[o.length] = (h ? writextag(f,g,h) : writetag(f,g));\n}\n\nfunction write_core_props(cp, opts) {\n\tvar o = [XML_HEADER, CORE_PROPS_XML_ROOT], p = {};\n  if (opts && opts.Props) {\n    if (opts.Props.title) o[o.length]       = '<dc:title>'       + opts.Props.title        + '</dc:title>';\n    if (opts.Props.subject) o[o.length]     = '<dc:subject>'     + opts.Props.subject      + '</dc:subject>';\n    if (opts.Props.creator) o[o.length]     = '<dc:creator>'     + opts.Props.creator      + '</dc:creator>';\n    if (opts.Props.keywords) o[o.length]    = '<cp:keywords>'    + opts.Props.keywords      + '</cp:keywords>';\n    if (opts.Props.description) o[o.length] = '<dc:description>' + opts.Props.description  + '</dc:description>';\n  }\n  if(cp) {\n\n    if(cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\n    if(cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\n\n  \tfor(var i = 0; i != CORE_PROPS.length; ++i) { var f = CORE_PROPS[i]; cp_doit(f[0], cp[f[1]], null, o, p); }\n  }\n  if(o.length>2){ o[o.length] = ('</cp:coreProperties>'); o[1]=o[1].replace(\"/>\",\">\"); }\n  return o.join(\"\");\n}\n/* 15.2.12.3 Extended File Properties Part */\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\nvar EXT_PROPS = [\n\t[\"Application\", \"Application\", \"string\"],\n\t[\"AppVersion\", \"AppVersion\", \"string\"],\n\t[\"Company\", \"Company\", \"string\"],\n\t[\"DocSecurity\", \"DocSecurity\", \"string\"],\n\t[\"Manager\", \"Manager\", \"string\"],\n\t[\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"],\n\t[\"SharedDoc\", \"SharedDoc\", \"bool\"],\n\t[\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"],\n\t[\"ScaleCrop\", \"ScaleCrop\", \"bool\"],\n\t[\"HeadingPairs\", \"HeadingPairs\", \"raw\"],\n\t[\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]\n];\n\nXMLNS.EXT_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\";\nRELS.EXT_PROPS  = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties';\n\nfunction parse_ext_props(data, p) {\n\tvar q = {}; if(!p) p = {};\n\n\tEXT_PROPS.forEach(function(f) {\n\t\tswitch(f[2]) {\n\t\t\tcase \"string\": p[f[1]] = (data.match(matchtag(f[0]))||[])[1]; break;\n\t\t\tcase \"bool\": p[f[1]] = (data.match(matchtag(f[0]))||[])[1] === \"true\"; break;\n\t\t\tcase \"raw\":\n\t\t\t\tvar cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>(.*)<\\/\" + f[0] + \">\"));\n\t\t\t\tif(cur && cur.length > 0) q[f[1]] = cur[1];\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(q.HeadingPairs && q.TitlesOfParts) {\n\t\tvar v = parseVector(q.HeadingPairs);\n\t\tvar j = 0, widx = 0;\n\t\tfor(var i = 0; i !== v.length; ++i) {\n\t\t\tswitch(v[i].v) {\n\t\t\t\tcase \"Worksheets\": widx = j; p.Worksheets = +(v[++i].v); break;\n\t\t\t\tcase \"Named Ranges\": ++i; break; // TODO: Handle Named Ranges\n\t\t\t}\n\t\t}\n\t\tvar parts = parseVector(q.TitlesOfParts).map(function(x) { return utf8read(x.v); });\n\t\tp.SheetNames = parts.slice(widx, widx + p.Worksheets);\n\t}\n\treturn p;\n}\n\nvar EXT_PROPS_XML_ROOT = writextag('Properties', null, {\n\t'xmlns': XMLNS.EXT_PROPS,\n\t'xmlns:vt': XMLNS.vt\n});\n\nfunction write_ext_props(cp, opts) {\n\tvar o = [], p = {}, W = writextag;\n\tif(!cp) cp = {};\n\tcp.Application = \"SheetJS\";\n\to[o.length] = (XML_HEADER);\n\to[o.length] = (EXT_PROPS_XML_ROOT);\n\n\tEXT_PROPS.forEach(function(f) {\n\t\tif(cp[f[1]] === undefined) return;\n\t\tvar v;\n\t\tswitch(f[2]) {\n\t\t\tcase 'string': v = cp[f[1]]; break;\n\t\t\tcase 'bool': v = cp[f[1]] ? 'true' : 'false'; break;\n\t\t}\n\t\tif(v !== undefined) o[o.length] = (W(f[0], v));\n\t});\n\n\t/* TODO: HeadingPairs, TitlesOfParts */\n\to[o.length] = (W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>')+W('vt:variant', W('vt:i4', String(cp.Worksheets))), {size:2, baseType:\"variant\"})));\n\to[o.length] = (W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function(s) { return \"<vt:lpstr>\" + s + \"</vt:lpstr>\"; }).join(\"\"), {size: cp.Worksheets, baseType:\"lpstr\"})));\n\tif(o.length>2){ o[o.length] = ('</Properties>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 15.2.12.2 Custom File Properties Part */\nXMLNS.CUST_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\";\nRELS.CUST_PROPS  = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties';\n\nvar custregex = /<[^>]+>[^<]*/g;\nfunction parse_cust_props(data, opts) {\n\tvar p = {}, name;\n\tvar m = data.match(custregex);\n\tif(m) for(var i = 0; i != m.length; ++i) {\n\t\tvar x = m[i], y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<Properties':\n\t\t\t\tif(y.xmlns !== XMLNS.CUST_PROPS) throw \"unrecognized xmlns \" + y.xmlns;\n\t\t\t\tif(y.xmlnsvt && y.xmlnsvt !== XMLNS.vt) throw \"unrecognized vt \" + y.xmlnsvt;\n\t\t\t\tbreak;\n\t\t\tcase '<property': name = y.name; break;\n\t\t\tcase '</property>': name = null; break;\n\t\t\tdefault: if (x.indexOf('<vt:') === 0) {\n\t\t\t\tvar toks = x.split('>');\n\t\t\t\tvar type = toks[0].substring(4), text = toks[1];\n\t\t\t\t/* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\n\t\t\t\tswitch(type) {\n\t\t\t\t\tcase 'lpstr': case 'lpwstr': case 'bstr': case 'lpwstr':\n\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'bool':\n\t\t\t\t\t\tp[name] = parsexmlbool(text, '<vt:bool>');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'i1': case 'i2': case 'i4': case 'i8': case 'int': case 'uint':\n\t\t\t\t\t\tp[name] = parseInt(text, 10);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'r4': case 'r8': case 'decimal':\n\t\t\t\t\t\tp[name] = parseFloat(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'filetime': case 'date':\n\t\t\t\t\t\tp[name] = new Date(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'cy': case 'error':\n\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\n\t\t\t\t}\n\t\t\t} else if(x.substr(0,2) === \"</\") {\n\t\t\t} else if(opts.WTF) throw new Error(x);\n\t\t}\n\t}\n\treturn p;\n}\n\nvar CUST_PROPS_XML_ROOT = writextag('Properties', null, {\n\t'xmlns': XMLNS.CUST_PROPS,\n\t'xmlns:vt': XMLNS.vt\n});\n\nfunction write_cust_props(cp, opts) {\n\tvar o = [XML_HEADER, CUST_PROPS_XML_ROOT];\n\tif(!cp) return o.join(\"\");\n\tvar pid = 1;\n\tkeys(cp).forEach(function custprop(k) { ++pid;\n\t\to[o.length] = (writextag('property', write_vt(cp[k]), {\n\t\t\t'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\n\t\t\t'pid': pid,\n\t\t\t'name': k\n\t\t}));\n\t});\n\tif(o.length>2){ o[o.length] = '</Properties>'; o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\nfunction xlml_set_prop(Props, tag, val) {\n\t/* TODO: Normalize the properties */\n\tswitch(tag) {\n\t\tcase 'Description': tag = 'Comments'; break;\n\t}\n\tProps[tag] = val;\n}\n\n/* [MS-DTYP] 2.3.3 FILETIME */\n/* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n/* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\nfunction parse_FILETIME(blob) {\n\tvar dwLowDateTime = blob.read_shift(4), dwHighDateTime = blob.read_shift(4);\n\treturn new Date(((dwHighDateTime/1e7*Math.pow(2,32) + dwLowDateTime/1e7) - 11644473600)*1000).toISOString().replace(/\\.000/,\"\");\n}\n\n/* [MS-OSHARED] 2.3.3.1.4 Lpstr */\nfunction parse_lpstr(blob, type, pad) {\n\tvar str = blob.read_shift(0, 'lpstr');\n\tif(pad) blob.l += (4 - ((str.length+1) & 3)) & 3;\n\treturn str;\n}\n\n/* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\nfunction parse_lpwstr(blob, type, pad) {\n\tvar str = blob.read_shift(0, 'lpwstr');\n\tif(pad) blob.l += (4 - ((str.length+1) & 3)) & 3;\n\treturn str;\n}\n\n\n/* [MS-OSHARED] 2.3.3.1.11 VtString */\n/* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\nfunction parse_VtStringBase(blob, stringType, pad) {\n\tif(stringType === 0x1F /*VT_LPWSTR*/) return parse_lpwstr(blob);\n\treturn parse_lpstr(blob, stringType, pad);\n}\n\nfunction parse_VtString(blob, t, pad) { return parse_VtStringBase(blob, t, pad === false ? 0: 4); }\nfunction parse_VtUnalignedString(blob, t) { if(!t) throw new Error(\"dafuq?\"); return parse_VtStringBase(blob, t, 0); }\n\n/* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\nfunction parse_VtVecUnalignedLpstrValue(blob) {\n\tvar length = blob.read_shift(4);\n\tvar ret = [];\n\tfor(var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr');\n\treturn ret;\n}\n\n/* [MS-OSHARED] 2.3.3.1.10 VtVecUnalignedLpstr */\nfunction parse_VtVecUnalignedLpstr(blob) {\n\treturn parse_VtVecUnalignedLpstrValue(blob);\n}\n\n/* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\nfunction parse_VtHeadingPair(blob) {\n\tvar headingString = parse_TypedPropertyValue(blob, VT_USTR);\n\tvar headerParts = parse_TypedPropertyValue(blob, VT_I4);\n\treturn [headingString, headerParts];\n}\n\n/* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\nfunction parse_VtVecHeadingPairValue(blob) {\n\tvar cElements = blob.read_shift(4);\n\tvar out = [];\n\tfor(var i = 0; i != cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\n\treturn out;\n}\n\n/* [MS-OSHARED] 2.3.3.1.15 VtVecHeadingPair */\nfunction parse_VtVecHeadingPair(blob) {\n\t// NOTE: When invoked, wType & padding were already consumed\n\treturn parse_VtVecHeadingPairValue(blob);\n}\n\n/* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\nfunction parse_dictionary(blob,CodePage) {\n\tvar cnt = blob.read_shift(4);\n\tvar dict = {};\n\tfor(var j = 0; j != cnt; ++j) {\n\t\tvar pid = blob.read_shift(4);\n\t\tvar len = blob.read_shift(4);\n\t\tdict[pid] = blob.read_shift(len, (CodePage === 0x4B0 ?'utf16le':'utf8')).replace(chr0,'').replace(chr1,'!');\n\t}\n\tif(blob.l & 3) blob.l = (blob.l>>2+1)<<2;\n\treturn dict;\n}\n\n/* [MS-OLEPS] 2.9 BLOB */\nfunction parse_BLOB(blob) {\n\tvar size = blob.read_shift(4);\n\tvar bytes = blob.slice(blob.l,blob.l+size);\n\tif(size & 3 > 0) blob.l += (4 - (size & 3)) & 3;\n\treturn bytes;\n}\n\n/* [MS-OLEPS] 2.11 ClipboardData */\nfunction parse_ClipboardData(blob) {\n\t// TODO\n\tvar o = {};\n\to.Size = blob.read_shift(4);\n\t//o.Format = blob.read_shift(4);\n\tblob.l += o.Size;\n\treturn o;\n}\n\n/* [MS-OLEPS] 2.14 Vector and Array Property Types */\nfunction parse_VtVector(blob, cb) {\n\t/* [MS-OLEPS] 2.14.2 VectorHeader */\n/*\tvar Length = blob.read_shift(4);\n\tvar o = [];\n\tfor(var i = 0; i != Length; ++i) {\n\t\to.push(cb(blob));\n\t}\n\treturn o;*/\n}\n\n/* [MS-OLEPS] 2.15 TypedPropertyValue */\nfunction parse_TypedPropertyValue(blob, type, _opts) {\n\tvar t = blob.read_shift(2), ret, opts = _opts||{};\n\tblob.l += 2;\n\tif(type !== VT_VARIANT)\n\tif(t !== type && VT_CUSTOM.indexOf(type)===-1) throw new Error('Expected type ' + type + ' saw ' + t);\n\tswitch(type === VT_VARIANT ? t : type) {\n\t\tcase 0x02 /*VT_I2*/: ret = blob.read_shift(2, 'i'); if(!opts.raw) blob.l += 2; return ret;\n\t\tcase 0x03 /*VT_I4*/: ret = blob.read_shift(4, 'i'); return ret;\n\t\tcase 0x0B /*VT_BOOL*/: return blob.read_shift(4) !== 0x0;\n\t\tcase 0x13 /*VT_UI4*/: ret = blob.read_shift(4); return ret;\n\t\tcase 0x1E /*VT_LPSTR*/: return parse_lpstr(blob, t, 4).replace(chr0,'');\n\t\tcase 0x1F /*VT_LPWSTR*/: return parse_lpwstr(blob);\n\t\tcase 0x40 /*VT_FILETIME*/: return parse_FILETIME(blob);\n\t\tcase 0x41 /*VT_BLOB*/: return parse_BLOB(blob);\n\t\tcase 0x47 /*VT_CF*/: return parse_ClipboardData(blob);\n\t\tcase 0x50 /*VT_STRING*/: return parse_VtString(blob, t, !opts.raw && 4).replace(chr0,'');\n\t\tcase 0x51 /*VT_USTR*/: return parse_VtUnalignedString(blob, t, 4).replace(chr0,'');\n\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: return parse_VtVecHeadingPair(blob);\n\t\tcase 0x101E /*VT_LPSTR*/: return parse_VtVecUnalignedLpstr(blob);\n\t\tdefault: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n\t}\n}\n/* [MS-OLEPS] 2.14.2 VectorHeader */\n/*function parse_VTVectorVariant(blob) {\n\tvar Length = blob.read_shift(4);\n\n\tif(Length & 1 !== 0) throw new Error(\"VectorHeader Length=\" + Length + \" must be even\");\n\tvar o = [];\n\tfor(var i = 0; i != Length; ++i) {\n\t\to.push(parse_TypedPropertyValue(blob, VT_VARIANT));\n\t}\n\treturn o;\n}*/\n\n/* [MS-OLEPS] 2.20 PropertySet */\nfunction parse_PropertySet(blob, PIDSI) {\n\tvar start_addr = blob.l;\n\tvar size = blob.read_shift(4);\n\tvar NumProps = blob.read_shift(4);\n\tvar Props = [], i = 0;\n\tvar CodePage = 0;\n\tvar Dictionary = -1, DictObj;\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tvar PropID = blob.read_shift(4);\n\t\tvar Offset = blob.read_shift(4);\n\t\tProps[i] = [PropID, Offset + start_addr];\n\t}\n\tvar PropH = {};\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tif(blob.l !== Props[i][1]) {\n\t\t\tvar fail = true;\n\t\t\tif(i>0 && PIDSI) switch(PIDSI[Props[i-1][0]].t) {\n\t\t\t\tcase 0x02 /*VT_I2*/: if(blob.l +2 === Props[i][1]) { blob.l+=2; fail = false; } break;\n\t\t\t\tcase 0x50 /*VT_STRING*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t}\n\t\t\tif(!PIDSI && blob.l <= Props[i][1]) { fail=false; blob.l = Props[i][1]; }\n\t\t\tif(fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n\t\t}\n\t\tif(PIDSI) {\n\t\t\tvar piddsi = PIDSI[Props[i][0]];\n\t\t\tPropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {raw:true});\n\t\t\tif(piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + String(PropH[piddsi.n] & 0xFFFF);\n\t\t\tif(piddsi.n == \"CodePage\") switch(PropH[piddsi.n]) {\n\t\t\t\tcase 0: PropH[piddsi.n] = 1252;\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 10000: // OSX Roman\n\t\t\t\tcase 1252: // Windows Latin\n\n\t\t\t\tcase 874: // SB Windows Thai\n\t\t\t\tcase 1250: // SB Windows Central Europe\n\t\t\t\tcase 1251: // SB Windows Cyrillic\n\t\t\t\tcase 1253: // SB Windows Greek\n\t\t\t\tcase 1254: // SB Windows Turkish\n\t\t\t\tcase 1255: // SB Windows Hebrew\n\t\t\t\tcase 1256: // SB Windows Arabic\n\t\t\t\tcase 1257: // SB Windows Baltic\n\t\t\t\tcase 1258: // SB Windows Vietnam\n\n\t\t\t\tcase 932: // DB Windows Japanese Shift-JIS\n\t\t\t\tcase 936: // DB Windows Simplified Chinese GBK\n\t\t\t\tcase 949: // DB Windows Korean\n\t\t\t\tcase 950: // DB Windows Traditional Chinese Big5\n\n\t\t\t\tcase 1200: // UTF16LE\n\t\t\t\tcase 1201: // UTF16BE\n\t\t\t\tcase 65000: case -536: // UTF-7\n\t\t\t\tcase 65001: case -535: // UTF-8\n\t\t\t\t\tset_cp(CodePage = PropH[piddsi.n]); break;\n\t\t\t\tdefault: throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n\t\t\t}\n\t\t} else {\n\t\t\tif(Props[i][0] === 0x1) {\n\t\t\t\tCodePage = PropH.CodePage = parse_TypedPropertyValue(blob, VT_I2);\n\t\t\t\tset_cp(CodePage);\n\t\t\t\tif(Dictionary !== -1) {\n\t\t\t\t\tvar oldpos = blob.l;\n\t\t\t\t\tblob.l = Props[Dictionary][1];\n\t\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t\t\tblob.l = oldpos;\n\t\t\t\t}\n\t\t\t} else if(Props[i][0] === 0) {\n\t\t\t\tif(CodePage === 0) { Dictionary = i; blob.l = Props[i+1][1]; continue; }\n\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t} else {\n\t\t\t\tvar name = DictObj[Props[i][0]];\n\t\t\t\tvar val;\n\t\t\t\t/* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n\t\t\t\tswitch(blob[blob.l]) {\n\t\t\t\t\tcase 0x41 /*VT_BLOB*/: blob.l += 4; val = parse_BLOB(blob); break;\n\t\t\t\t\tcase 0x1E /*VT_LPSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]); break;\n\t\t\t\t\tcase 0x1F /*VT_LPWSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]); break;\n\t\t\t\t\tcase 0x03 /*VT_I4*/: blob.l += 4; val = blob.read_shift(4, 'i'); break;\n\t\t\t\t\tcase 0x13 /*VT_UI4*/: blob.l += 4; val = blob.read_shift(4); break;\n\t\t\t\t\tcase 0x05 /*VT_R8*/: blob.l += 4; val = blob.read_shift(8, 'f'); break;\n\t\t\t\t\tcase 0x0B /*VT_BOOL*/: blob.l += 4; val = parsebool(blob, 4); break;\n\t\t\t\t\tcase 0x40 /*VT_FILETIME*/: blob.l += 4; val = new Date(parse_FILETIME(blob)); break;\n\t\t\t\t\tdefault: throw new Error(\"unparsed value: \" + blob[blob.l]);\n\t\t\t\t}\n\t\t\t\tPropH[name] = val;\n\t\t\t}\n\t\t}\n\t}\n\tblob.l = start_addr + size; /* step ahead to skip padding */\n\treturn PropH;\n}\n\n/* [MS-OLEPS] 2.21 PropertySetStream */\nfunction parse_PropertySetStream(file, PIDSI) {\n\tvar blob = file.content;\n\tprep_blob(blob, 0);\n\n\tvar NumSets, FMTID0, FMTID1, Offset0, Offset1;\n\tblob.chk('feff', 'Byte Order: ');\n\n\tvar vers = blob.read_shift(2); // TODO: check version\n\tvar SystemIdentifier = blob.read_shift(4);\n\tblob.chk(CFB.utils.consts.HEADER_CLSID, 'CLSID: ');\n\tNumSets = blob.read_shift(4);\n\tif(NumSets !== 1 && NumSets !== 2) throw \"Unrecognized #Sets: \" + NumSets;\n\tFMTID0 = blob.read_shift(16); Offset0 = blob.read_shift(4);\n\n\tif(NumSets === 1 && Offset0 !== blob.l) throw \"Length mismatch\";\n\telse if(NumSets === 2) { FMTID1 = blob.read_shift(16); Offset1 = blob.read_shift(4); }\n\tvar PSet0 = parse_PropertySet(blob, PIDSI);\n\n\tvar rval = { SystemIdentifier: SystemIdentifier };\n\tfor(var y in PSet0) rval[y] = PSet0[y];\n\t//rval.blob = blob;\n\trval.FMTID = FMTID0;\n\t//rval.PSet0 = PSet0;\n\tif(NumSets === 1) return rval;\n\tif(blob.l !== Offset1) throw \"Length mismatch 2: \" + blob.l + \" !== \" + Offset1;\n\tvar PSet1;\n\ttry { PSet1 = parse_PropertySet(blob, null); } catch(e) { }\n\tfor(y in PSet1) rval[y] = PSet1[y];\n\trval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n\treturn rval;\n}\n\n\nfunction parsenoop2(blob, length) { blob.read_shift(length); return null; }\n\nfunction parslurp(blob, length, cb) {\n\tvar arr = [], target = blob.l + length;\n\twhile(blob.l < target) arr.push(cb(blob, target - blob.l));\n\tif(target !== blob.l) throw new Error(\"Slurp error\");\n\treturn arr;\n}\n\nfunction parslurp2(blob, length, cb) {\n\tvar arr = [], target = blob.l + length, len = blob.read_shift(2);\n\twhile(len-- !== 0) arr.push(cb(blob, target - blob.l));\n\tif(target !== blob.l) throw new Error(\"Slurp error\");\n\treturn arr;\n}\n\nfunction parsebool(blob, length) { return blob.read_shift(length) === 0x1; }\n\nfunction parseuint16(blob) { return blob.read_shift(2, 'u'); }\nfunction parseuint16a(blob, length) { return parslurp(blob,length,parseuint16);}\n\n/* --- 2.5 Structures --- */\n\n/* [MS-XLS] 2.5.14 Boolean */\nvar parse_Boolean = parsebool;\n\n/* [MS-XLS] 2.5.10 Bes (boolean or error) */\nfunction parse_Bes(blob) {\n\tvar v = blob.read_shift(1), t = blob.read_shift(1);\n\treturn t === 0x01 ? v : v === 0x01;\n}\n\n/* [MS-XLS] 2.5.240 ShortXLUnicodeString */\nfunction parse_ShortXLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(1);\n\tvar width = 1, encoding = 'sbcs-cont';\n\tvar cp = current_codepage;\n\tif(opts && opts.biff >= 8) current_codepage = 1200;\n\tif(opts === undefined || opts.biff !== 5) {\n\t\tvar fHighByte = blob.read_shift(1);\n\t\tif(fHighByte) { width = 2; encoding = 'dbcs-cont'; }\n\t}\n\tvar o = cch ? blob.read_shift(cch, encoding) : \"\";\n\tcurrent_codepage = cp;\n\treturn o;\n}\n\n/* 2.5.293 XLUnicodeRichExtendedString */\nfunction parse_XLUnicodeRichExtendedString(blob) {\n\tvar cp = current_codepage;\n\tcurrent_codepage = 1200;\n\tvar cch = blob.read_shift(2), flags = blob.read_shift(1);\n\tvar fHighByte = flags & 0x1, fExtSt = flags & 0x4, fRichSt = flags & 0x8;\n\tvar width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n\tvar cRun, cbExtRst;\n\tvar z = {};\n\tif(fRichSt) cRun = blob.read_shift(2);\n\tif(fExtSt) cbExtRst = blob.read_shift(4);\n\tvar encoding = (flags & 0x1) ? 'dbcs-cont' : 'sbcs-cont';\n\tvar msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n\tif(fRichSt) blob.l += 4 * cRun; //TODO: parse this\n\tif(fExtSt) blob.l += cbExtRst; //TODO: parse this\n\tz.t = msg;\n\tif(!fRichSt) { z.raw = \"<t>\" + z.t + \"</t>\"; z.r = z.t; }\n\tcurrent_codepage = cp;\n\treturn z;\n}\n\n/* 2.5.296 XLUnicodeStringNoCch */\nfunction parse_XLUnicodeStringNoCch(blob, cch, opts) {\n\tvar retval;\n\tvar fHighByte = blob.read_shift(1);\n\tif(fHighByte===0) { retval = blob.read_shift(cch, 'sbcs-cont'); }\n\telse { retval = blob.read_shift(cch, 'dbcs-cont'); }\n\treturn retval;\n}\n\n/* 2.5.294 XLUnicodeString */\nfunction parse_XLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(opts !== undefined && opts.biff > 0 && opts.biff < 8 ? 1 : 2);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn parse_XLUnicodeStringNoCch(blob, cch, opts);\n}\n/* BIFF5 override */\nfunction parse_XLUnicodeString2(blob, length, opts) {\n\tif(opts.biff !== 5 && opts.biff !== 2) return parse_XLUnicodeString(blob, length, opts);\n\tvar cch = blob.read_shift(1);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn blob.read_shift(cch, 'sbcs-cont');\n}\n\n/* [MS-XLS] 2.5.61 ControlInfo */\nvar parse_ControlInfo = parsenoop;\n\n/* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\nvar parse_URLMoniker = function(blob, length) {\n\tvar len = blob.read_shift(4), start = blob.l;\n\tvar extra = false;\n\tif(len > 24) {\n\t\t/* look ahead */\n\t\tblob.l += len - 24;\n\t\tif(blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n\t\tblob.l = start;\n\t}\n\tvar url = blob.read_shift((extra?len-24:len)>>1, 'utf16le').replace(chr0,\"\");\n\tif(extra) blob.l += 24;\n\treturn url;\n};\n\n/* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\nvar parse_FileMoniker = function(blob, length) {\n\tvar cAnti = blob.read_shift(2);\n\tvar ansiLength = blob.read_shift(4);\n\tvar ansiPath = blob.read_shift(ansiLength, 'cstr');\n\tvar endServer = blob.read_shift(2);\n\tvar versionNumber = blob.read_shift(2);\n\tvar cbUnicodePathSize = blob.read_shift(4);\n\tif(cbUnicodePathSize === 0) return ansiPath.replace(/\\\\/g,\"/\");\n\tvar cbUnicodePathBytes = blob.read_shift(4);\n\tvar usKeyValue = blob.read_shift(2);\n\tvar unicodePath = blob.read_shift(cbUnicodePathBytes>>1, 'utf16le').replace(chr0,\"\");\n\treturn unicodePath;\n};\n\n/* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\nvar parse_HyperlinkMoniker = function(blob, length) {\n\tvar clsid = blob.read_shift(16); length -= 16;\n\tswitch(clsid) {\n\t\tcase \"e0c9ea79f9bace118c8200aa004ba90b\": return parse_URLMoniker(blob, length);\n\t\tcase \"0303000000000000c000000000000046\": return parse_FileMoniker(blob, length);\n\t\tdefault: throw \"unsupported moniker \" + clsid;\n\t}\n};\n\n/* [MS-OSHARED] 2.3.7.9 HyperlinkString */\nvar parse_HyperlinkString = function(blob, length) {\n\tvar len = blob.read_shift(4);\n\tvar o = blob.read_shift(len, 'utf16le').replace(chr0, \"\");\n\treturn o;\n};\n\n/* [MS-OSHARED] 2.3.7.1 Hyperlink Object TODO: unify params with XLSX */\nvar parse_Hyperlink = function(blob, length) {\n\tvar end = blob.l + length;\n\tvar sVer = blob.read_shift(4);\n\tif(sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n\tvar flags = blob.read_shift(2);\n\tblob.l += 2;\n\tvar displayName, targetFrameName, moniker, oleMoniker, location, guid, fileTime;\n\tif(flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n\tif(flags & 0x0008) location = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0020) guid = blob.read_shift(16);\n\tif(flags & 0x0040) fileTime = parse_FILETIME(blob, 8);\n\tblob.l = end;\n\tvar target = (targetFrameName||moniker||oleMoniker);\n\tif(location) target+=\"#\"+location;\n\treturn {Target: target};\n};\n\n/* 2.5.178 LongRGBA */\nfunction parse_LongRGBA(blob, length) { var r = blob.read_shift(1), g = blob.read_shift(1), b = blob.read_shift(1), a = blob.read_shift(1); return [r,g,b,a]; }\n\n/* 2.5.177 LongRGB */\nfunction parse_LongRGB(blob, length) { var x = parse_LongRGBA(blob, length); x[3] = 0; return x; }\n\n\n/* --- MS-XLS --- */\n\n/* 2.5.19 */\nfunction parse_XLSCell(blob, length) {\n\tvar rw = blob.read_shift(2); // 0-indexed\n\tvar col = blob.read_shift(2);\n\tvar ixfe = blob.read_shift(2);\n\treturn {r:rw, c:col, ixfe:ixfe};\n}\n\n/* 2.5.134 */\nfunction parse_frtHeader(blob) {\n\tvar rt = blob.read_shift(2);\n\tvar flags = blob.read_shift(2); // TODO: parse these flags\n\tblob.l += 8;\n\treturn {type: rt, flags: flags};\n}\n\n\n\nfunction parse_OptXLUnicodeString(blob, length, opts) { return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts); }\n\n/* 2.5.158 */\nvar HIDEOBJENUM = ['SHOWALL', 'SHOWPLACEHOLDER', 'HIDEALL'];\nvar parse_HideObjEnum = parseuint16;\n\n/* 2.5.344 */\nfunction parse_XTI(blob, length) {\n\tvar iSupBook = blob.read_shift(2), itabFirst = blob.read_shift(2,'i'), itabLast = blob.read_shift(2,'i');\n\treturn [iSupBook, itabFirst, itabLast];\n}\n\n/* 2.5.218 */\nfunction parse_RkRec(blob, length) {\n\tvar ixfe = blob.read_shift(2);\n\tvar RK = parse_RkNumber(blob);\n\t//console.log(\"::\", ixfe, RK,\";;\");\n\treturn [ixfe, RK];\n}\n\n/* 2.5.1 */\nfunction parse_AddinUdf(blob, length) {\n\tblob.l += 4; length -= 4;\n\tvar l = blob.l + length;\n\tvar udfName = parse_ShortXLUnicodeString(blob, length);\n\tvar cb = blob.read_shift(2);\n\tl -= blob.l;\n\tif(cb !== l) throw \"Malformed AddinUdf: padding = \" + l + \" != \" + cb;\n\tblob.l += cb;\n\treturn udfName;\n}\n\n/* 2.5.209 TODO: Check sizes */\nfunction parse_Ref8U(blob, length) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(2);\n\tvar colLast = blob.read_shift(2);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\n\n/* 2.5.211 */\nfunction parse_RefU(blob, length) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(1);\n\tvar colLast = blob.read_shift(1);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\n\n/* 2.5.207 */\nvar parse_Ref = parse_RefU;\n\n/* 2.5.143 */\nfunction parse_FtCmo(blob, length) {\n\tblob.l += 4;\n\tvar ot = blob.read_shift(2);\n\tvar id = blob.read_shift(2);\n\tvar flags = blob.read_shift(2);\n\tblob.l+=12;\n\treturn [id, ot, flags];\n}\n\n/* 2.5.149 */\nfunction parse_FtNts(blob, length) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.l += 16; // GUID TODO\n\tout.fSharedNote = blob.read_shift(2);\n\tblob.l += 4;\n\treturn out;\n}\n\n/* 2.5.142 */\nfunction parse_FtCf(blob, length) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.cf = blob.read_shift(2);\n\treturn out;\n}\n\n/* 2.5.140 - 2.5.154 and friends */\nvar FtTab = {\n\t0x15: parse_FtCmo,\n\t0x13: parsenoop,                                /* FtLbsData */\n\t0x12: function(blob, length) { blob.l += 12; }, /* FtCblsData */\n\t0x11: function(blob, length) { blob.l += 8; },  /* FtRboData */\n\t0x10: parsenoop,                                /* FtEdoData */\n\t0x0F: parsenoop,                                /* FtGboData */\n\t0x0D: parse_FtNts,                              /* FtNts */\n\t0x0C: function(blob, length) { blob.l += 24; }, /* FtSbs */\n\t0x0B: function(blob, length) { blob.l += 10; }, /* FtRbo */\n\t0x0A: function(blob, length) { blob.l += 16; }, /* FtCbls */\n\t0x09: parsenoop,                                /* FtPictFmla */\n\t0x08: function(blob, length) { blob.l += 6; },  /* FtPioGrbit */\n\t0x07: parse_FtCf,                               /* FtCf */\n\t0x06: function(blob, length) { blob.l += 6; },  /* FtGmo */\n\t0x04: parsenoop,                                /* FtMacro */\n\t0x00: function(blob, length) { blob.l += 4; }   /* FtEnding */\n};\nfunction parse_FtArray(blob, length, ot) {\n\tvar s = blob.l;\n\tvar fts = [];\n\twhile(blob.l < s + length) {\n\t\tvar ft = blob.read_shift(2);\n\t\tblob.l-=2;\n\t\ttry {\n\t\t\tfts.push(FtTab[ft](blob, s + length - blob.l));\n\t\t} catch(e) { blob.l = s + length; return fts; }\n\t}\n\tif(blob.l != s + length) blob.l = s + length; //throw \"bad Object Ft-sequence\";\n\treturn fts;\n}\n\n/* 2.5.129 */\nvar parse_FontIndex = parseuint16;\n\n/* --- 2.4 Records --- */\n\n/* 2.4.21 */\nfunction parse_BOF(blob, length) {\n\tvar o = {};\n\to.BIFFVer = blob.read_shift(2); length -= 2;\n\tswitch(o.BIFFVer) {\n\t\tcase 0x0600: /* BIFF8 */\n\t\tcase 0x0500: /* BIFF5 */\n\t\tcase 0x0002: case 0x0007: /* BIFF2 */\n\t\t\tbreak;\n\t\tdefault: throw \"Unexpected BIFF Ver \" + o.BIFFVer;\n\t}\n\tblob.read_shift(length);\n\treturn o;\n}\n\n\n/* 2.4.146 */\nfunction parse_InterfaceHdr(blob, length) {\n\tif(length === 0) return 0x04b0;\n\tvar q;\n\tif((q=blob.read_shift(2))!==0x04b0) throw 'InterfaceHdr codePage ' + q;\n\treturn 0x04b0;\n}\n\n\n/* 2.4.349 */\nfunction parse_WriteAccess(blob, length, opts) {\n\tif(opts.enc) { blob.l += length; return \"\"; }\n\tvar l = blob.l;\n\t// TODO: make sure XLUnicodeString doesnt overrun\n\tvar UserName = parse_XLUnicodeString(blob, 0, opts);\n\tblob.read_shift(length + l - blob.l);\n\treturn UserName;\n}\n\n/* 2.4.28 */\nfunction parse_BoundSheet8(blob, length, opts) {\n\tvar pos = blob.read_shift(4);\n\tvar hidden = blob.read_shift(1) >> 6;\n\tvar dt = blob.read_shift(1);\n\tswitch(dt) {\n\t\tcase 0: dt = 'Worksheet'; break;\n\t\tcase 1: dt = 'Macrosheet'; break;\n\t\tcase 2: dt = 'Chartsheet'; break;\n\t\tcase 6: dt = 'VBAModule'; break;\n\t}\n\tvar name = parse_ShortXLUnicodeString(blob, 0, opts);\n\tif(name.length === 0) name = \"Sheet1\";\n\treturn { pos:pos, hs:hidden, dt:dt, name:name };\n}\n\n/* 2.4.265 TODO */\nfunction parse_SST(blob, length) {\n\tvar cnt = blob.read_shift(4);\n\tvar ucnt = blob.read_shift(4);\n\tvar strs = [];\n\tfor(var i = 0; i != ucnt; ++i) {\n\t\tstrs.push(parse_XLUnicodeRichExtendedString(blob));\n\t}\n\tstrs.Count = cnt; strs.Unique = ucnt;\n\treturn strs;\n}\n\n/* 2.4.107 */\nfunction parse_ExtSST(blob, length) {\n\tvar extsst = {};\n\textsst.dsst = blob.read_shift(2);\n\tblob.l += length-2;\n\treturn extsst;\n}\n\n\n/* 2.4.221 TODO*/\nfunction parse_Row(blob, length) {\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2), Col = blob.read_shift(2), rht = blob.read_shift(2);\n\tblob.read_shift(4); // reserved(2), unused(2)\n\tvar flags = blob.read_shift(1); // various flags\n\tblob.read_shift(1); // reserved\n\tblob.read_shift(2); //ixfe, other flags\n\treturn {r:rw, c:col, cnt:Col-col};\n}\n\n\n/* 2.4.125 */\nfunction parse_ForceFullCalculation(blob, length) {\n\tvar header = parse_frtHeader(blob);\n\tif(header.type != 0x08A3) throw \"Invalid Future Record \" + header.type;\n\tvar fullcalc = blob.read_shift(4);\n\treturn fullcalc !== 0x0;\n}\n\n\nvar parse_CompressPictures = parsenoop2; /* 2.4.55 Not interesting */\n\n\n\n/* 2.4.215 rt */\nfunction parse_RecalcId(blob, length) {\n\tblob.read_shift(2);\n\treturn blob.read_shift(4);\n}\n\n/* 2.4.87 */\nfunction parse_DefaultRowHeight (blob, length) {\n\tvar f = blob.read_shift(2), miyRw;\n\tmiyRw = blob.read_shift(2); // flags & 0x02 -> hidden, else empty\n\tvar fl = {Unsynced:f&1,DyZero:(f&2)>>1,ExAsc:(f&4)>>2,ExDsc:(f&8)>>3};\n\treturn [fl, miyRw];\n}\n\n/* 2.4.345 TODO */\nfunction parse_Window1(blob, length) {\n\tvar xWn = blob.read_shift(2), yWn = blob.read_shift(2), dxWn = blob.read_shift(2), dyWn = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), iTabCur = blob.read_shift(2), iTabFirst = blob.read_shift(2);\n\tvar ctabSel = blob.read_shift(2), wTabRatio = blob.read_shift(2);\n\treturn { Pos: [xWn, yWn], Dim: [dxWn, dyWn], Flags: flags, CurTab: iTabCur,\n\t\tFirstTab: iTabFirst, Selected: ctabSel, TabRatio: wTabRatio };\n}\n\n/* 2.4.122 TODO */\nfunction parse_Font(blob, length, opts) {\n\tblob.l += 14;\n\tvar name = parse_ShortXLUnicodeString(blob, 0, opts);\n\treturn name;\n}\n\n/* 2.4.149 */\nfunction parse_LabelSst(blob, length) {\n\tvar cell = parse_XLSCell(blob);\n\tcell.isst = blob.read_shift(4);\n\treturn cell;\n}\n\n/* 2.4.148 */\nfunction parse_Label(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 6);\n\tvar str = parse_XLUnicodeString(blob, length-6, opts);\n\tcell.val = str;\n\treturn cell;\n}\n\n/* 2.4.126 Number Formats */\nfunction parse_Format(blob, length, opts) {\n\tvar ifmt = blob.read_shift(2);\n\tvar fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n\treturn [ifmt, fmtstr];\n}\n\n/* 2.4.90 */\nfunction parse_Dimensions(blob, length) {\n\tvar w = length === 10 ? 2 : 4;\n\tvar r = blob.read_shift(w), R = blob.read_shift(w),\n\t    c = blob.read_shift(2), C = blob.read_shift(2);\n\tblob.l += 2;\n\treturn {s: {r:r, c:c}, e: {r:R, c:C}};\n}\n\n/* 2.4.220 */\nfunction parse_RK(blob, length) {\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrec = parse_RkRec(blob);\n\treturn {r:rw, c:col, ixfe:rkrec[0], rknum:rkrec[1]};\n}\n\n/* 2.4.175 */\nfunction parse_MulRk(blob, length) {\n\tvar target = blob.l + length - 2;\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrecs = [];\n\twhile(blob.l < target) rkrecs.push(parse_RkRec(blob));\n\tif(blob.l !== target) throw \"MulRK read error\";\n\tvar lastcol = blob.read_shift(2);\n\tif(rkrecs.length != lastcol - col + 1) throw \"MulRK length mismatch\";\n\treturn {r:rw, c:col, C:lastcol, rkrec:rkrecs};\n}\n\n/* 2.5.20 2.5.249 TODO */\nfunction parse_CellStyleXF(blob, length, style) {\n\tvar o = {};\n\tvar a = blob.read_shift(4), b = blob.read_shift(4);\n\tvar c = blob.read_shift(4), d = blob.read_shift(2);\n\to.patternType = XLSFillPattern[c >> 26];\n\to.icvFore = d & 0x7F;\n\to.icvBack = (d >> 7) & 0x7F;\n\treturn o;\n}\nfunction parse_CellXF(blob, length) {return parse_CellStyleXF(blob,length,0);}\nfunction parse_StyleXF(blob, length) {return parse_CellStyleXF(blob,length,1);}\n\n/* 2.4.353 TODO: actually do this right */\nfunction parse_XF(blob, length) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(2); o.ifmt = blob.read_shift(2); o.flags = blob.read_shift(2);\n\to.fStyle = (o.flags >> 2) & 0x01;\n\tlength -= 6;\n\to.data = parse_CellStyleXF(blob, length, o.fStyle);\n\treturn o;\n}\n\n/* 2.4.134 */\nfunction parse_Guts(blob, length) {\n\tblob.l += 4;\n\tvar out = [blob.read_shift(2), blob.read_shift(2)];\n\tif(out[0] !== 0) out[0]--;\n\tif(out[1] !== 0) out[1]--;\n\tif(out[0] > 7 || out[1] > 7) throw \"Bad Gutters: \" + out;\n\treturn out;\n}\n\n/* 2.4.24 */\nfunction parse_BoolErr(blob, length) {\n\tvar cell = parse_XLSCell(blob, 6);\n\tvar val = parse_Bes(blob, 2);\n\tcell.val = val;\n\tcell.t = (val === true || val === false) ? 'b' : 'e';\n\treturn cell;\n}\n\n/* 2.4.180 Number */\nfunction parse_Number(blob, length) {\n\tvar cell = parse_XLSCell(blob, 6);\n\tvar xnum = parse_Xnum(blob, 8);\n\tcell.val = xnum;\n\treturn cell;\n}\n\nvar parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n/* 2.4.271 */\nfunction parse_SupBook(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar ctab = blob.read_shift(2);\n\tvar cch = blob.read_shift(2);\n\tvar virtPath;\n\tif(cch >=0x01 && cch <=0xff) virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n\tvar rgst = blob.read_shift(end - blob.l);\n\topts.sbcch = cch;\n\treturn [cch, ctab, virtPath, rgst];\n}\n\n/* 2.4.105 TODO */\nfunction parse_ExternName(blob, length, opts) {\n\tvar flags = blob.read_shift(2);\n\tvar body;\n\tvar o = {\n\t\tfBuiltIn: flags & 0x01,\n\t\tfWantAdvise: (flags >>> 1) & 0x01,\n\t\tfWantPict: (flags >>> 2) & 0x01,\n\t\tfOle: (flags >>> 3) & 0x01,\n\t\tfOleLink: (flags >>> 4) & 0x01,\n\t\tcf: (flags >>> 5) & 0x3FF,\n\t\tfIcon: flags >>> 15 & 0x01\n\t};\n\tif(opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length-2);\n\t//else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n\to.body = body || blob.read_shift(length-2);\n\treturn o;\n}\n\n/* 2.4.150 TODO */\nfunction parse_Lbl(blob, length, opts) {\n\tif(opts.biff < 8) return parse_Label(blob, length, opts);\n\tvar target = blob.l + length;\n\tvar flags = blob.read_shift(2);\n\tvar chKey = blob.read_shift(1);\n\tvar cch = blob.read_shift(1);\n\tvar cce = blob.read_shift(2);\n\tblob.l += 2;\n\tvar itab = blob.read_shift(2);\n\tblob.l += 4;\n\tvar name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n\tvar rgce = parse_NameParsedFormula(blob, target - blob.l, opts, cce);\n\treturn {\n\t\tchKey: chKey,\n\t\tName: name,\n\t\trgce: rgce\n\t};\n}\n\n/* 2.4.106 TODO: verify supbook manipulation */\nfunction parse_ExternSheet(blob, length, opts) {\n\tif(opts.biff < 8) return parse_ShortXLUnicodeString(blob, length, opts);\n\tvar o = parslurp2(blob,length,parse_XTI);\n\tvar oo = [];\n\tif(opts.sbcch === 0x0401) {\n\t\tfor(var i = 0; i != o.length; ++i) oo.push(opts.snames[o[i][1]]);\n\t\treturn oo;\n\t}\n\telse return o;\n}\n\n/* 2.4.260 */\nfunction parse_ShrFmla(blob, length, opts) {\n\tvar ref = parse_RefU(blob, 6);\n\tblob.l++;\n\tvar cUse = blob.read_shift(1);\n\tlength -= 8;\n\treturn [parse_SharedParsedFormula(blob, length, opts), cUse];\n}\n\n/* 2.4.4 TODO */\nfunction parse_Array(blob, length, opts) {\n\tvar ref = parse_Ref(blob, 6);\n\tblob.l += 6; length -= 12; /* TODO: fAlwaysCalc */\n\treturn [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\n}\n\n/* 2.4.173 */\nfunction parse_MTRSettings(blob, length) {\n\tvar fMTREnabled = blob.read_shift(4) !== 0x00;\n\tvar fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n\tvar cUserThreadCount = blob.read_shift(4);\n\treturn [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n}\n\n/* 2.5.186 TODO: BIFF5 */\nfunction parse_NoteSh(blob, length, opts) {\n\tif(opts.biff < 8) return;\n\tvar row = blob.read_shift(2), col = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), idObj = blob.read_shift(2);\n\tvar stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n\tif(opts.biff < 8) blob.read_shift(1);\n\treturn [{r:row,c:col}, stAuthor, idObj, flags];\n}\n\n/* 2.4.179 */\nfunction parse_Note(blob, length, opts) {\n\t/* TODO: Support revisions */\n\treturn parse_NoteSh(blob, length, opts);\n}\n\n/* 2.4.168 */\nfunction parse_MergeCells(blob, length) {\n\tvar merges = [];\n\tvar cmcs = blob.read_shift(2);\n\twhile (cmcs--) merges.push(parse_Ref8U(blob,length));\n\treturn merges;\n}\n\n/* 2.4.181 TODO: parse all the things! */\nfunction parse_Obj(blob, length) {\n\tvar cmo = parse_FtCmo(blob, 22); // id, ot, flags\n\tvar fts = parse_FtArray(blob, length-22, cmo[1]);\n\treturn { cmo: cmo, ft:fts };\n}\n\n/* 2.4.329 TODO: parse properly */\nfunction parse_TxO(blob, length, opts) {\n\tvar s = blob.l;\ntry {\n\tblob.l += 4;\n\tvar ot = (opts.lastobj||{cmo:[0,0]}).cmo[1];\n\tvar controlInfo;\n\tif([0,5,7,11,12,14].indexOf(ot) == -1) blob.l += 6;\n\telse controlInfo = parse_ControlInfo(blob, 6, opts);\n\tvar cchText = blob.read_shift(2);\n\tvar cbRuns = blob.read_shift(2);\n\tvar ifntEmpty = parse_FontIndex(blob, 2);\n\tvar len = blob.read_shift(2);\n\tblob.l += len;\n\t//var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n\tvar texts = \"\";\n\tfor(var i = 1; i < blob.lens.length-1; ++i) {\n\t\tif(blob.l-s != blob.lens[i]) throw \"TxO: bad continue record\";\n\t\tvar hdr = blob[blob.l];\n\t\tvar t = parse_XLUnicodeStringNoCch(blob, blob.lens[i+1]-blob.lens[i]-1);\n\t\ttexts += t;\n\t\tif(texts.length >= (hdr ? cchText : 2*cchText)) break;\n\t}\n\tif(texts.length !== cchText && texts.length !== cchText*2) {\n\t\tthrow \"cchText: \" + cchText + \" != \" + texts.length;\n\t}\n\n\tblob.l = s + length;\n\t/* 2.5.272 TxORuns */\n//\tvar rgTxoRuns = [];\n//\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n//\tvar cchText2 = blob.read_shift(2);\n//\tif(cchText2 !== cchText) throw \"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText;\n//\tblob.l += 6;\n//\tif(s + length != blob.l) throw \"TxO \" + (s + length) + \", at \" + blob.l;\n\treturn { t: texts };\n} catch(e) { blob.l = s + length; return { t: texts||\"\" }; }\n}\n\n/* 2.4.140 */\nvar parse_HLink = function(blob, length) {\n\tvar ref = parse_Ref8U(blob, 8);\n\tblob.l += 16; /* CLSID */\n\tvar hlink = parse_Hyperlink(blob, length-24);\n\treturn [ref, hlink];\n};\n\n/* 2.4.141 */\nvar parse_HLinkTooltip = function(blob, length) {\n\tvar end = blob.l + length;\n\tblob.read_shift(2);\n\tvar ref = parse_Ref8U(blob, 8);\n\tvar wzTooltip = blob.read_shift((length-10)/2, 'dbcs-cont');\n\twzTooltip = wzTooltip.replace(chr0,\"\");\n\treturn [ref, wzTooltip];\n};\n\n/* 2.4.63 */\nfunction parse_Country(blob, length) {\n\tvar o = [], d;\n\td = blob.read_shift(2); o[0] = CountryEnum[d] || d;\n\td = blob.read_shift(2); o[1] = CountryEnum[d] || d;\n\treturn o;\n}\n\n/* 2.4.50 ClrtClient */\nfunction parse_ClrtClient(blob, length) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* 2.4.188 */\nfunction parse_Palette(blob, length) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* 2.4.354 */\nfunction parse_XFCRC(blob, length) {\n\tblob.l += 2;\n\tvar o = {cxfs:0, crc:0};\n\to.cxfs = blob.read_shift(2);\n\to.crc = blob.read_shift(4);\n\treturn o;\n}\n\n\nvar parse_Style = parsenoop;\nvar parse_StyleExt = parsenoop;\n\nvar parse_ColInfo = parsenoop;\n\nvar parse_Window2 = parsenoop;\n\n\nvar parse_Backup = parsebool; /* 2.4.14 */\nvar parse_Blank = parse_XLSCell; /* 2.4.20 Just the cell */\nvar parse_BottomMargin = parse_Xnum; /* 2.4.27 */\nvar parse_BuiltInFnGroupCount = parseuint16; /* 2.4.30 0x0E or 0x10 but excel 2011 generates 0x11? */\nvar parse_CalcCount = parseuint16; /* 2.4.31 #Iterations */\nvar parse_CalcDelta = parse_Xnum; /* 2.4.32 */\nvar parse_CalcIter = parsebool;  /* 2.4.33 1=iterative calc */\nvar parse_CalcMode = parseuint16; /* 2.4.34 0=manual, 1=auto (def), 2=table */\nvar parse_CalcPrecision = parsebool; /* 2.4.35 */\nvar parse_CalcRefMode = parsenoop2; /* 2.4.36 */\nvar parse_CalcSaveRecalc = parsebool; /* 2.4.37 */\nvar parse_CodePage = parseuint16; /* 2.4.52 */\nvar parse_Compat12 = parsebool; /* 2.4.54 true = no compatibility check */\nvar parse_Date1904 = parsebool; /* 2.4.77 - 1=1904,0=1900 */\nvar parse_DefColWidth = parseuint16; /* 2.4.89 */\nvar parse_DSF = parsenoop2; /* 2.4.94 -- MUST be ignored */\nvar parse_EntExU2 = parsenoop2; /* 2.4.102 -- Explicitly says to ignore */\nvar parse_EOF = parsenoop2; /* 2.4.103 */\nvar parse_Excel9File = parsenoop2; /* 2.4.104 -- Optional and unused */\nvar parse_FeatHdr = parsenoop2; /* 2.4.112 */\nvar parse_FontX = parseuint16; /* 2.4.123 */\nvar parse_Footer = parse_XLHeaderFooter; /* 2.4.124 */\nvar parse_GridSet = parseuint16; /* 2.4.132, =1 */\nvar parse_HCenter = parsebool; /* 2.4.135 sheet centered horizontal on print */\nvar parse_Header = parse_XLHeaderFooter; /* 2.4.136 */\nvar parse_HideObj = parse_HideObjEnum; /* 2.4.139 */\nvar parse_InterfaceEnd = parsenoop2; /* 2.4.145 -- noop */\nvar parse_LeftMargin = parse_Xnum; /* 2.4.151 */\nvar parse_Mms = parsenoop2; /* 2.4.169 -- Explicitly says to ignore */\nvar parse_ObjProtect = parsebool; /* 2.4.183 -- must be 1 if present */\nvar parse_Password = parseuint16; /* 2.4.191 */\nvar parse_PrintGrid = parsebool; /* 2.4.202 */\nvar parse_PrintRowCol = parsebool; /* 2.4.203 */\nvar parse_PrintSize = parseuint16; /* 2.4.204 0:3 */\nvar parse_Prot4Rev = parsebool; /* 2.4.205 */\nvar parse_Prot4RevPass = parseuint16; /* 2.4.206 */\nvar parse_Protect = parsebool; /* 2.4.207 */\nvar parse_RefreshAll = parsebool; /* 2.4.217 -- must be 0 if not template */\nvar parse_RightMargin = parse_Xnum; /* 2.4.219 */\nvar parse_RRTabId = parseuint16a; /* 2.4.241 */\nvar parse_ScenarioProtect = parsebool; /* 2.4.245 */\nvar parse_Scl = parseuint16a; /* 2.4.247 num, den */\nvar parse_String = parse_XLUnicodeString; /* 2.4.268 */\nvar parse_SxBool = parsebool; /* 2.4.274 */\nvar parse_TopMargin = parse_Xnum; /* 2.4.328 */\nvar parse_UsesELFs = parsebool; /* 2.4.337 -- should be 0 */\nvar parse_VCenter = parsebool; /* 2.4.342 */\nvar parse_WinProtect = parsebool; /* 2.4.347 */\nvar parse_WriteProtect = parsenoop; /* 2.4.350 empty record */\n\n\n/* ---- */\nvar parse_VerticalPageBreaks = parsenoop;\nvar parse_HorizontalPageBreaks = parsenoop;\nvar parse_Selection = parsenoop;\nvar parse_Continue = parsenoop;\nvar parse_Pane = parsenoop;\nvar parse_Pls = parsenoop;\nvar parse_DCon = parsenoop;\nvar parse_DConRef = parsenoop;\nvar parse_DConName = parsenoop;\nvar parse_XCT = parsenoop;\nvar parse_CRN = parsenoop;\nvar parse_FileSharing = parsenoop;\nvar parse_Uncalced = parsenoop;\nvar parse_Template = parsenoop;\nvar parse_Intl = parsenoop;\nvar parse_WsBool = parsenoop;\nvar parse_Sort = parsenoop;\nvar parse_Sync = parsenoop;\nvar parse_LPr = parsenoop;\nvar parse_DxGCol = parsenoop;\nvar parse_FnGroupName = parsenoop;\nvar parse_FilterMode = parsenoop;\nvar parse_AutoFilterInfo = parsenoop;\nvar parse_AutoFilter = parsenoop;\nvar parse_Setup = parsenoop;\nvar parse_ScenMan = parsenoop;\nvar parse_SCENARIO = parsenoop;\nvar parse_SxView = parsenoop;\nvar parse_Sxvd = parsenoop;\nvar parse_SXVI = parsenoop;\nvar parse_SxIvd = parsenoop;\nvar parse_SXLI = parsenoop;\nvar parse_SXPI = parsenoop;\nvar parse_DocRoute = parsenoop;\nvar parse_RecipName = parsenoop;\nvar parse_MulBlank = parsenoop;\nvar parse_SXDI = parsenoop;\nvar parse_SXDB = parsenoop;\nvar parse_SXFDB = parsenoop;\nvar parse_SXDBB = parsenoop;\nvar parse_SXNum = parsenoop;\nvar parse_SxErr = parsenoop;\nvar parse_SXInt = parsenoop;\nvar parse_SXString = parsenoop;\nvar parse_SXDtr = parsenoop;\nvar parse_SxNil = parsenoop;\nvar parse_SXTbl = parsenoop;\nvar parse_SXTBRGIITM = parsenoop;\nvar parse_SxTbpg = parsenoop;\nvar parse_ObProj = parsenoop;\nvar parse_SXStreamID = parsenoop;\nvar parse_DBCell = parsenoop;\nvar parse_SXRng = parsenoop;\nvar parse_SxIsxoper = parsenoop;\nvar parse_BookBool = parsenoop;\nvar parse_DbOrParamQry = parsenoop;\nvar parse_OleObjectSize = parsenoop;\nvar parse_SXVS = parsenoop;\nvar parse_BkHim = parsenoop;\nvar parse_MsoDrawingGroup = parsenoop;\nvar parse_MsoDrawing = parsenoop;\nvar parse_MsoDrawingSelection = parsenoop;\nvar parse_PhoneticInfo = parsenoop;\nvar parse_SxRule = parsenoop;\nvar parse_SXEx = parsenoop;\nvar parse_SxFilt = parsenoop;\nvar parse_SxDXF = parsenoop;\nvar parse_SxItm = parsenoop;\nvar parse_SxName = parsenoop;\nvar parse_SxSelect = parsenoop;\nvar parse_SXPair = parsenoop;\nvar parse_SxFmla = parsenoop;\nvar parse_SxFormat = parsenoop;\nvar parse_SXVDEx = parsenoop;\nvar parse_SXFormula = parsenoop;\nvar parse_SXDBEx = parsenoop;\nvar parse_RRDInsDel = parsenoop;\nvar parse_RRDHead = parsenoop;\nvar parse_RRDChgCell = parsenoop;\nvar parse_RRDRenSheet = parsenoop;\nvar parse_RRSort = parsenoop;\nvar parse_RRDMove = parsenoop;\nvar parse_RRFormat = parsenoop;\nvar parse_RRAutoFmt = parsenoop;\nvar parse_RRInsertSh = parsenoop;\nvar parse_RRDMoveBegin = parsenoop;\nvar parse_RRDMoveEnd = parsenoop;\nvar parse_RRDInsDelBegin = parsenoop;\nvar parse_RRDInsDelEnd = parsenoop;\nvar parse_RRDConflict = parsenoop;\nvar parse_RRDDefName = parsenoop;\nvar parse_RRDRstEtxp = parsenoop;\nvar parse_LRng = parsenoop;\nvar parse_CUsr = parsenoop;\nvar parse_CbUsr = parsenoop;\nvar parse_UsrInfo = parsenoop;\nvar parse_UsrExcl = parsenoop;\nvar parse_FileLock = parsenoop;\nvar parse_RRDInfo = parsenoop;\nvar parse_BCUsrs = parsenoop;\nvar parse_UsrChk = parsenoop;\nvar parse_UserBView = parsenoop;\nvar parse_UserSViewBegin = parsenoop; // overloaded\nvar parse_UserSViewEnd = parsenoop;\nvar parse_RRDUserView = parsenoop;\nvar parse_Qsi = parsenoop;\nvar parse_CondFmt = parsenoop;\nvar parse_CF = parsenoop;\nvar parse_DVal = parsenoop;\nvar parse_DConBin = parsenoop;\nvar parse_Lel = parsenoop;\nvar parse_XLSCodeName = parse_XLUnicodeString;\nvar parse_SXFDBType = parsenoop;\nvar parse_ObNoMacros = parsenoop;\nvar parse_Dv = parsenoop;\nvar parse_Index = parsenoop;\nvar parse_Table = parsenoop;\nvar parse_BigName = parsenoop;\nvar parse_ContinueBigName = parsenoop;\nvar parse_WebPub = parsenoop;\nvar parse_QsiSXTag = parsenoop;\nvar parse_DBQueryExt = parsenoop;\nvar parse_ExtString = parsenoop;\nvar parse_TxtQry = parsenoop;\nvar parse_Qsir = parsenoop;\nvar parse_Qsif = parsenoop;\nvar parse_RRDTQSIF = parsenoop;\nvar parse_OleDbConn = parsenoop;\nvar parse_WOpt = parsenoop;\nvar parse_SXViewEx = parsenoop;\nvar parse_SXTH = parsenoop;\nvar parse_SXPIEx = parsenoop;\nvar parse_SXVDTEx = parsenoop;\nvar parse_SXViewEx9 = parsenoop;\nvar parse_ContinueFrt = parsenoop;\nvar parse_RealTimeData = parsenoop;\nvar parse_ChartFrtInfo = parsenoop;\nvar parse_FrtWrapper = parsenoop;\nvar parse_StartBlock = parsenoop;\nvar parse_EndBlock = parsenoop;\nvar parse_StartObject = parsenoop;\nvar parse_EndObject = parsenoop;\nvar parse_CatLab = parsenoop;\nvar parse_YMult = parsenoop;\nvar parse_SXViewLink = parsenoop;\nvar parse_PivotChartBits = parsenoop;\nvar parse_FrtFontList = parsenoop;\nvar parse_SheetExt = parsenoop;\nvar parse_BookExt = parsenoop;\nvar parse_SXAddl = parsenoop;\nvar parse_CrErr = parsenoop;\nvar parse_HFPicture = parsenoop;\nvar parse_Feat = parsenoop;\nvar parse_DataLabExt = parsenoop;\nvar parse_DataLabExtContents = parsenoop;\nvar parse_CellWatch = parsenoop;\nvar parse_FeatHdr11 = parsenoop;\nvar parse_Feature11 = parsenoop;\nvar parse_DropDownObjIds = parsenoop;\nvar parse_ContinueFrt11 = parsenoop;\nvar parse_DConn = parsenoop;\nvar parse_List12 = parsenoop;\nvar parse_Feature12 = parsenoop;\nvar parse_CondFmt12 = parsenoop;\nvar parse_CF12 = parsenoop;\nvar parse_CFEx = parsenoop;\nvar parse_AutoFilter12 = parsenoop;\nvar parse_ContinueFrt12 = parsenoop;\nvar parse_MDTInfo = parsenoop;\nvar parse_MDXStr = parsenoop;\nvar parse_MDXTuple = parsenoop;\nvar parse_MDXSet = parsenoop;\nvar parse_MDXProp = parsenoop;\nvar parse_MDXKPI = parsenoop;\nvar parse_MDB = parsenoop;\nvar parse_PLV = parsenoop;\nvar parse_DXF = parsenoop;\nvar parse_TableStyles = parsenoop;\nvar parse_TableStyle = parsenoop;\nvar parse_TableStyleElement = parsenoop;\nvar parse_NamePublish = parsenoop;\nvar parse_NameCmt = parsenoop;\nvar parse_SortData = parsenoop;\nvar parse_GUIDTypeLib = parsenoop;\nvar parse_FnGrp12 = parsenoop;\nvar parse_NameFnGrp12 = parsenoop;\nvar parse_HeaderFooter = parsenoop;\nvar parse_CrtLayout12 = parsenoop;\nvar parse_CrtMlFrt = parsenoop;\nvar parse_CrtMlFrtContinue = parsenoop;\nvar parse_ShapePropsStream = parsenoop;\nvar parse_TextPropsStream = parsenoop;\nvar parse_RichTextStream = parsenoop;\nvar parse_CrtLayout12A = parsenoop;\nvar parse_Units = parsenoop;\nvar parse_Chart = parsenoop;\nvar parse_Series = parsenoop;\nvar parse_DataFormat = parsenoop;\nvar parse_LineFormat = parsenoop;\nvar parse_MarkerFormat = parsenoop;\nvar parse_AreaFormat = parsenoop;\nvar parse_PieFormat = parsenoop;\nvar parse_AttachedLabel = parsenoop;\nvar parse_SeriesText = parsenoop;\nvar parse_ChartFormat = parsenoop;\nvar parse_Legend = parsenoop;\nvar parse_SeriesList = parsenoop;\nvar parse_Bar = parsenoop;\nvar parse_Line = parsenoop;\nvar parse_Pie = parsenoop;\nvar parse_Area = parsenoop;\nvar parse_Scatter = parsenoop;\nvar parse_CrtLine = parsenoop;\nvar parse_Axis = parsenoop;\nvar parse_Tick = parsenoop;\nvar parse_ValueRange = parsenoop;\nvar parse_CatSerRange = parsenoop;\nvar parse_AxisLine = parsenoop;\nvar parse_CrtLink = parsenoop;\nvar parse_DefaultText = parsenoop;\nvar parse_Text = parsenoop;\nvar parse_ObjectLink = parsenoop;\nvar parse_Frame = parsenoop;\nvar parse_Begin = parsenoop;\nvar parse_End = parsenoop;\nvar parse_PlotArea = parsenoop;\nvar parse_Chart3d = parsenoop;\nvar parse_PicF = parsenoop;\nvar parse_DropBar = parsenoop;\nvar parse_Radar = parsenoop;\nvar parse_Surf = parsenoop;\nvar parse_RadarArea = parsenoop;\nvar parse_AxisParent = parsenoop;\nvar parse_LegendException = parsenoop;\nvar parse_ShtProps = parsenoop;\nvar parse_SerToCrt = parsenoop;\nvar parse_AxesUsed = parsenoop;\nvar parse_SBaseRef = parsenoop;\nvar parse_SerParent = parsenoop;\nvar parse_SerAuxTrend = parsenoop;\nvar parse_IFmtRecord = parsenoop;\nvar parse_Pos = parsenoop;\nvar parse_AlRuns = parsenoop;\nvar parse_BRAI = parsenoop;\nvar parse_SerAuxErrBar = parsenoop;\nvar parse_SerFmt = parsenoop;\nvar parse_Chart3DBarShape = parsenoop;\nvar parse_Fbi = parsenoop;\nvar parse_BopPop = parsenoop;\nvar parse_AxcExt = parsenoop;\nvar parse_Dat = parsenoop;\nvar parse_PlotGrowth = parsenoop;\nvar parse_SIIndex = parsenoop;\nvar parse_GelFrame = parsenoop;\nvar parse_BopPopCustom = parsenoop;\nvar parse_Fbi2 = parsenoop;\n\n/* --- Specific to versions before BIFF8 --- */\nfunction parse_BIFF5String(blob) {\n\tvar len = blob.read_shift(1);\n\treturn blob.read_shift(len, 'sbcs-cont');\n}\n\n/* BIFF2_??? where ??? is the name from [XLS] */\nfunction parse_BIFF2STR(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 6);\n\t++blob.l;\n\tvar str = parse_XLUnicodeString2(blob, length-7, opts);\n\tcell.val = str;\n\treturn cell;\n}\n\nfunction parse_BIFF2NUM(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 6);\n\t++blob.l;\n\tvar num = parse_Xnum(blob, 8);\n\tcell.val = num;\n\treturn cell;\n}\n\n/* 18.4.1 charset to codepage mapping */\nvar CS2CP = {\n\t0:    1252, /* ANSI */\n\t1:   65001, /* DEFAULT */\n\t2:   65001, /* SYMBOL */\n\t77:  10000, /* MAC */\n\t128:   932, /* SHIFTJIS */\n\t129:   949, /* HANGUL */\n\t130:  1361, /* JOHAB */\n\t134:   936, /* GB2312 */\n\t136:   950, /* CHINESEBIG5 */\n\t161:  1253, /* GREEK */\n\t162:  1254, /* TURKISH */\n\t163:  1258, /* VIETNAMESE */\n\t177:  1255, /* HEBREW */\n\t178:  1256, /* ARABIC */\n\t186:  1257, /* BALTIC */\n\t204:  1251, /* RUSSIAN */\n\t222:   874, /* THAI */\n\t238:  1250, /* EASTEUROPE */\n\t255:  1252, /* OEM */\n\t69:   6969  /* MISC */\n};\n\n/* Parse a list of <r> tags */\nvar parse_rs = (function parse_rs_factory() {\n\tvar tregex = matchtag(\"t\"), rpregex = matchtag(\"rPr\"), rregex = /<r>/g, rend = /<\\/r>/, nlregex = /\\r\\n/g;\n\t/* 18.4.7 rPr CT_RPrElt */\n\tvar parse_rpr = function parse_rpr(rpr, intro, outro) {\n\t\tvar font = {}, cp = 65001;\n\t\tvar m = rpr.match(tagregex), i = 0;\n\t\tif(m) for(;i!=m.length; ++i) {\n\t\t\tvar y = parsexmltag(m[i]);\n\t\t\tswitch(y[0]) {\n\t\t\t\t/* 18.8.12 condense CT_BooleanProperty */\n\t\t\t\t/* ** not required . */\n\t\t\t\tcase '<condense': break;\n\t\t\t\t/* 18.8.17 extend CT_BooleanProperty */\n\t\t\t\t/* ** not required . */\n\t\t\t\tcase '<extend': break;\n\t\t\t\t/* 18.8.36 shadow CT_BooleanProperty */\n\t\t\t\t/* ** not required . */\n\t\t\t\tcase '<shadow':\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase '<shadow/>': break;\n\n\t\t\t\t/* 18.4.1 charset CT_IntProperty TODO */\n\t\t\t\tcase '<charset':\n\t\t\t\t\tif(y.val == '1') break;\n\t\t\t\t\tcp = CS2CP[parseInt(y.val, 10)];\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* 18.4.2 outline CT_BooleanProperty TODO */\n\t\t\t\tcase '<outline':\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase '<outline/>': break;\n\n\t\t\t\t/* 18.4.5 rFont CT_FontName */\n\t\t\t\tcase '<rFont': font.name = y.val; break;\n\n\t\t\t\t/* 18.4.11 sz CT_FontSize */\n\t\t\t\tcase '<sz': font.sz = y.val; break;\n\n\t\t\t\t/* 18.4.10 strike CT_BooleanProperty */\n\t\t\t\tcase '<strike':\n\t\t\t\t\tif(!y.val) break;\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase '<strike/>': font.strike = 1; break;\n\t\t\t\tcase '</strike>': break;\n\n\t\t\t\t/* 18.4.13 u CT_UnderlineProperty */\n\t\t\t\tcase '<u':\n\t\t\t\t\tif(!y.val) break;\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase '<u/>': font.u = 1; break;\n\t\t\t\tcase '</u>': break;\n\n\t\t\t\t/* 18.8.2 b */\n\t\t\t\tcase '<b':\n\t\t\t\t\tif(!y.val) break;\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase '<b/>': font.b = 1; break;\n\t\t\t\tcase '</b>': break;\n\n\t\t\t\t/* 18.8.26 i */\n\t\t\t\tcase '<i':\n\t\t\t\t\tif(!y.val) break;\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase '<i/>': font.i = 1; break;\n\t\t\t\tcase '</i>': break;\n\n\t\t\t\t/* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\n\t\t\t\tcase '<color':\n\t\t\t\t\tif(y.rgb) font.color = y.rgb.substr(2,6);\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* 18.8.18 family ST_FontFamily */\n\t\t\t\tcase '<family': font.family = y.val; break;\n\n\t\t\t\t/* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\n\t\t\t\tcase '<vertAlign': break;\n\n\t\t\t\t/* 18.8.35 scheme CT_FontScheme TODO */\n\t\t\t\tcase '<scheme': break;\n\n\t\t\t\tdefault:\n\t\t\t\t\tif(y[0].charCodeAt(1) !== 47) throw 'Unrecognized rich format ' + y[0];\n\t\t\t}\n\t\t}\n\t\t/* TODO: These should be generated styles, not inline */\n\t\tvar style = [];\n\t\tif(font.b) style.push(\"font-weight: bold;\");\n\t\tif(font.i) style.push(\"font-style: italic;\");\n\t\tintro.push('<span style=\"' + style.join(\"\") + '\">');\n\t\toutro.push(\"</span>\");\n\t\treturn cp;\n\t};\n\n\t/* 18.4.4 r CT_RElt */\n\tfunction parse_r(r) {\n\t\tvar terms = [[],\"\",[]];\n\t\t/* 18.4.12 t ST_Xstring */\n\t\tvar t = r.match(tregex), cp = 65001;\n\t\tif(!isval(t)) return \"\";\n\t\tterms[1] = t[1];\n\n\t\tvar rpr = r.match(rpregex);\n\t\tif(isval(rpr)) cp = parse_rpr(rpr[1], terms[0], terms[2]);\n\n\t\treturn terms[0].join(\"\") + terms[1].replace(nlregex,'<br/>') + terms[2].join(\"\");\n\t}\n\treturn function parse_rs(rs) {\n\t\treturn rs.replace(rregex,\"\").split(rend).map(parse_r).join(\"\");\n\t};\n})();\n\n/* 18.4.8 si CT_Rst */\nvar sitregex = /<t[^>]*>([^<]*)<\\/t>/g, sirregex = /<r>/;\nfunction parse_si(x, opts) {\n\tvar html = opts ? opts.cellHTML : true;\n\tvar z = {};\n\tif(!x) return null;\n\tvar y;\n\t/* 18.4.12 t ST_Xstring (Plaintext String) */\n\tif(x.charCodeAt(1) === 116) {\n\t\tz.t = utf8read(unescapexml(x.substr(x.indexOf(\">\")+1).split(/<\\/t>/)[0]));\n\t\tz.r = x;\n\t\tif(html) z.h = z.t;\n\t}\n\t/* 18.4.4 r CT_RElt (Rich Text Run) */\n\telse if((y = x.match(sirregex))) {\n\t\tz.r = x;\n\t\tz.t = utf8read(unescapexml(x.match(sitregex).join(\"\").replace(tagregex,\"\")));\n\t\tif(html) z.h = parse_rs(x);\n\t}\n\t/* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\n\t/* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\n\treturn z;\n}\n\n/* 18.4 Shared String Table */\nvar sstr0 = /<sst([^>]*)>([\\s\\S]*)<\\/sst>/;\nvar sstr1 = /<(?:si|sstItem)>/g;\nvar sstr2 = /<\\/(?:si|sstItem)>/;\nfunction parse_sst_xml(data, opts) {\n\tvar s = [], ss;\n\t/* 18.4.9 sst CT_Sst */\n\tvar sst = data.match(sstr0);\n\tif(isval(sst)) {\n\t\tss = sst[2].replace(sstr1,\"\").split(sstr2);\n\t\tfor(var i = 0; i != ss.length; ++i) {\n\t\t\tvar o = parse_si(ss[i], opts);\n\t\t\tif(o != null) s[s.length] = o;\n\t\t}\n\t\tsst = parsexmltag(sst[1]); s.Count = sst.count; s.Unique = sst.uniqueCount;\n\t}\n\treturn s;\n}\n\nRELS.SST = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\";\nvar straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\nfunction write_sst_xml(sst, opts) {\n\tif(!opts.bookSST) return \"\";\n\tvar o = [XML_HEADER];\n\to[o.length] = (writextag('sst', null, {\n\t\txmlns: XMLNS.main[0],\n\t\tcount: sst.Count,\n\t\tuniqueCount: sst.Unique\n\t}));\n\tfor(var i = 0; i != sst.length; ++i) { if(sst[i] == null) continue;\n\t\tvar s = sst[i];\n\t\tvar sitag = \"<si>\";\n\t\tif(s.r) sitag += s.r;\n\t\telse {\n\t\t\tsitag += \"<t\";\n\t\t\tif(s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\n\t\t\tsitag += \">\" + escapexml(s.t) + \"</t>\";\n\t\t}\n\t\tsitag += \"</si>\";\n\t\to[o.length] = (sitag);\n\t}\n\tif(o.length>2){ o[o.length] = ('</sst>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.219 BrtBeginSst */\nfunction parse_BrtBeginSst(data, length) {\n\treturn [data.read_shift(4), data.read_shift(4)];\n}\n\n/* [MS-XLSB] 2.1.7.45 Shared Strings */\nfunction parse_sst_bin(data, opts) {\n\tvar s = [];\n\tvar pass = false;\n\trecordhopper(data, function hopper_sst(val, R, RT) {\n\t\tswitch(R.n) {\n\t\t\tcase 'BrtBeginSst': s.Count = val[0]; s.Unique = val[1]; break;\n\t\t\tcase 'BrtSSTItem': s.push(val); break;\n\t\t\tcase 'BrtEndSst': return true;\n\t\t\t/* TODO: produce a test case with a future record */\n\t\t\tcase 'BrtFRTBegin': pass = true; break;\n\t\t\tcase 'BrtFRTEnd': pass = false; break;\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n\t\t}\n\t});\n\treturn s;\n}\n\nfunction write_BrtBeginSst(sst, o) {\n\tif(!o) o = new_buf(8);\n\to.write_shift(4, sst.Count);\n\to.write_shift(4, sst.Unique);\n\treturn o;\n}\n\nvar write_BrtSSTItem = write_RichStr;\n\nfunction write_sst_bin(sst, opts) {\n\tvar ba = buf_array();\n\twrite_record(ba, \"BrtBeginSst\", write_BrtBeginSst(sst));\n\tfor(var i = 0; i < sst.length; ++i) write_record(ba, \"BrtSSTItem\", write_BrtSSTItem(sst[i]));\n\twrite_record(ba, \"BrtEndSst\");\n\treturn ba.end();\n}\nfunction _JS2ANSI(str) { if(typeof cptable !== 'undefined') return cptable.utils.encode(1252, str); return str.split(\"\").map(function(x) { return x.charCodeAt(0); }); }\n\n/* [MS-OFFCRYPTO] 2.1.4 Version */\nfunction parse_Version(blob, length) {\n\tvar o = {};\n\to.Major = blob.read_shift(2);\n\to.Minor = blob.read_shift(2);\n\treturn o;\n}\n/* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\nfunction parse_EncryptionHeader(blob, length) {\n\tvar o = {};\n\to.Flags = blob.read_shift(4);\n\n\t// Check if SizeExtra is 0x00000000\n\tvar tmp = blob.read_shift(4);\n\tif(tmp !== 0) throw 'Unrecognized SizeExtra: ' + tmp;\n\n\to.AlgID = blob.read_shift(4);\n\tswitch(o.AlgID) {\n\t\tcase 0: case 0x6801: case 0x660E: case 0x660F: case 0x6610: break;\n\t\tdefault: throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n\t}\n\tparsenoop(blob, length-12);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\nfunction parse_EncryptionVerifier(blob, length) {\n\treturn parsenoop(blob, length);\n}\n/* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\nfunction parse_RC4CryptoHeader(blob, length) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_Version(blob, 4); length -= 4;\n\tif(vers.Minor != 2) throw 'unrecognized minor version code: ' + vers.Minor;\n\tif(vers.Major > 4 || vers.Major < 2) throw 'unrecognized major version code: ' + vers.Major;\n\to.Flags = blob.read_shift(4); length -= 4;\n\tvar sz = blob.read_shift(4); length -= 4;\n\to.EncryptionHeader = parse_EncryptionHeader(blob, sz); length -= sz;\n\to.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n\treturn o;\n}\n/* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\nfunction parse_RC4Header(blob, length) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_Version(blob, 4); length -= 4;\n\tif(vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n\to.Salt = blob.read_shift(16);\n\to.EncryptedVerifier = blob.read_shift(16);\n\to.EncryptedVerifierHash = blob.read_shift(16);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\nfunction crypto_CreatePasswordVerifier_Method1(Password) {\n\tvar Verifier = 0x0000, PasswordArray;\n\tvar PasswordDecoded = _JS2ANSI(Password);\n\tvar len = PasswordDecoded.length + 1, i, PasswordByte;\n\tvar Intermediate1, Intermediate2, Intermediate3;\n\tPasswordArray = new_raw_buf(len);\n\tPasswordArray[0] = PasswordDecoded.length;\n\tfor(i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i-1];\n\tfor(i = len-1; i >= 0; --i) {\n\t\tPasswordByte = PasswordArray[i];\n\t\tIntermediate1 = ((Verifier & 0x4000) === 0x0000) ? 0 : 1;\n\t\tIntermediate2 = (Verifier << 1) & 0x7FFF;\n\t\tIntermediate3 = Intermediate1 | Intermediate2;\n\t\tVerifier = Intermediate3 ^ PasswordByte;\n\t}\n\treturn Verifier ^ 0xCE4B;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\nvar crypto_CreateXorArray_Method1 = (function() {\n\tvar PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n\tvar InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n\tvar XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n\tvar Ror = function(Byte) { return ((Byte/2) | (Byte*128)) & 0xFF; };\n\tvar XorRor = function(byte1, byte2) { return Ror(byte1 ^ byte2); };\n\tvar CreateXorKey_Method1 = function(Password) {\n\t\tvar XorKey = InitialCode[Password.length - 1];\n\t\tvar CurrentElement = 0x68;\n\t\tfor(var i = Password.length-1; i >= 0; --i) {\n\t\t\tvar Char = Password[i];\n\t\t\tfor(var j = 0; j != 7; ++j) {\n\t\t\t\tif(Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n\t\t\t\tChar *= 2; --CurrentElement;\n\t\t\t}\n\t\t}\n\t\treturn XorKey;\n\t};\n\treturn function(password) {\n\t\tvar Password = _JS2ANSI(password);\n\t\tvar XorKey = CreateXorKey_Method1(Password);\n\t\tvar Index = Password.length;\n\t\tvar ObfuscationArray = new_raw_buf(16);\n\t\tfor(var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\n\t\tvar Temp, PasswordLastChar, PadIndex;\n\t\tif((Index & 1) === 1) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tPasswordLastChar = Password[Password.length - 1];\n\t\t\tObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n\t\t}\n\t\twhile(Index > 0) {\n\t\t\t--Index;\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t}\n\t\tIndex = 15;\n\t\tPadIndex = 15 - Password.length;\n\t\twhile(PadIndex > 0) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t}\n\t\treturn ObfuscationArray;\n\t};\n})();\n\n/* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\nvar crypto_DecryptData_Method1 = function(password, Data, XorArrayIndex, XorArray, O) {\n\t/* If XorArray is set, use it; if O is not set, make changes in-place */\n\tif(!O) O = Data;\n\tif(!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n\tvar Index, Value;\n\tfor(Index = 0; Index != Data.length; ++Index) {\n\t\tValue = Data[Index];\n\t\tValue ^= XorArray[XorArrayIndex];\n\t\tValue = ((Value>>5) | (Value<<3)) & 0xFF;\n\t\tO[Index] = Value;\n\t\t++XorArrayIndex;\n\t}\n\treturn [O, XorArrayIndex, XorArray];\n};\n\nvar crypto_MakeXorDecryptor = function(password) {\n\tvar XorArrayIndex = 0, XorArray = crypto_CreateXorArray_Method1(password);\n\treturn function(Data) {\n\t\tvar O = crypto_DecryptData_Method1(null, Data, XorArrayIndex, XorArray);\n\t\tXorArrayIndex = O[1];\n\t\treturn O[0];\n\t};\n};\n\n/* 2.5.343 */\nfunction parse_XORObfuscation(blob, length, opts, out) {\n\tvar o = { key: parseuint16(blob), verificationBytes: parseuint16(blob) };\n\tif(opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n\tout.valid = o.verificationBytes === o.verifier;\n\tif(out.valid) out.insitu_decrypt = crypto_MakeXorDecryptor(opts.password);\n\treturn o;\n}\n\n/* 2.4.117 */\nfunction parse_FilePassHeader(blob, length, oo) {\n\tvar o = oo || {}; o.Info = blob.read_shift(2); blob.l -= 2;\n\tif(o.Info === 1) o.Data = parse_RC4Header(blob, length);\n\telse o.Data = parse_RC4CryptoHeader(blob, length);\n\treturn o;\n}\nfunction parse_FilePass(blob, length, opts) {\n\tvar o = { Type: blob.read_shift(2) }; /* wEncryptionType */\n\tif(o.Type) parse_FilePassHeader(blob, length-2, o);\n\telse parse_XORObfuscation(blob, length-2, opts, o);\n\treturn o;\n}\n\n\nfunction hex2RGB(h) {\n\tvar o = h.substr(h[0]===\"#\"?1:0,6);\n\treturn [parseInt(o.substr(0,2),16),parseInt(o.substr(2,2),16),parseInt(o.substr(4,2),16)];\n}\nfunction rgb2Hex(rgb) {\n\tfor(var i=0,o=1; i!=3; ++i) o = o*256 + (rgb[i]>255?255:rgb[i]<0?0:rgb[i]);\n\treturn o.toString(16).toUpperCase().substr(1);\n}\n\nfunction rgb2HSL(rgb) {\n\tvar R = rgb[0]/255, G = rgb[1]/255, B=rgb[2]/255;\n\tvar M = Math.max(R, G, B), m = Math.min(R, G, B), C = M - m;\n\tif(C === 0) return [0, 0, R];\n\n\tvar H6 = 0, S = 0, L2 = (M + m);\n\tS = C / (L2 > 1 ? 2 - L2 : L2);\n\tswitch(M){\n\t\tcase R: H6 = ((G - B) / C + 6)%6; break;\n\t\tcase G: H6 = ((B - R) / C + 2); break;\n\t\tcase B: H6 = ((R - G) / C + 4); break;\n\t}\n\treturn [H6 / 6, S, L2 / 2];\n}\n\nfunction hsl2RGB(hsl){\n\tvar H = hsl[0], S = hsl[1], L = hsl[2];\n\tvar C = S * 2 * (L < 0.5 ? L : 1 - L), m = L - C/2;\n\tvar rgb = [m,m,m], h6 = 6*H;\n\n\tvar X;\n\tif(S !== 0) switch(h6|0) {\n\t\tcase 0: case 6: X = C * h6; rgb[0] += C; rgb[1] += X; break;\n\t\tcase 1: X = C * (2 - h6);   rgb[0] += X; rgb[1] += C; break;\n\t\tcase 2: X = C * (h6 - 2);   rgb[1] += C; rgb[2] += X; break;\n\t\tcase 3: X = C * (4 - h6);   rgb[1] += X; rgb[2] += C; break;\n\t\tcase 4: X = C * (h6 - 4);   rgb[2] += C; rgb[0] += X; break;\n\t\tcase 5: X = C * (6 - h6);   rgb[2] += X; rgb[0] += C; break;\n\t}\n\tfor(var i = 0; i != 3; ++i) rgb[i] = Math.round(rgb[i]*255);\n\treturn rgb;\n}\n\n/* 18.8.3 bgColor tint algorithm */\nfunction rgb_tint(hex, tint) {\n\tif(tint == 0) return hex;\n\tvar hsl = rgb2HSL(hex2RGB(hex));\n\tif (tint < 0) hsl[2] = hsl[2] * (1 + tint);\n\telse hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\n  var rev =rgb2Hex(hsl2RGB(hsl))\n\treturn rev;\n}\n\n/* 18.3.1.13 width calculations */\nvar DEF_MDW = 7, MAX_MDW = 15, MIN_MDW = 1, MDW = DEF_MDW;\nfunction width2px(width) { return (( width + ((128/MDW)|0)/256 )* MDW )|0; }\nfunction px2char(px) { return (((px - 5)/MDW * 100 + 0.5)|0)/100; }\nfunction char2width(chr) { return (((chr * MDW + 5)/MDW*256)|0)/256; }\nfunction cycle_width(collw) { return char2width(px2char(width2px(collw))); }\nfunction find_mdw(collw, coll) {\n\tif(cycle_width(collw) != collw) {\n\t\tfor(MDW=DEF_MDW; MDW>MIN_MDW; --MDW) if(cycle_width(collw) === collw) break;\n\t\tif(MDW === MIN_MDW) for(MDW=DEF_MDW+1; MDW<MAX_MDW; ++MDW) if(cycle_width(collw) === collw) break;\n\t\tif(MDW === MAX_MDW) MDW = DEF_MDW;\n\t}\n}\n\n/* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\nvar XLMLPatternTypeMap = {\n\t\"None\": \"none\",\n\t\"Solid\": \"solid\",\n\t\"Gray50\": \"mediumGray\",\n\t\"Gray75\": \"darkGray\",\n\t\"Gray25\": \"lightGray\",\n\t\"HorzStripe\": \"darkHorizontal\",\n\t\"VertStripe\": \"darkVertical\",\n\t\"ReverseDiagStripe\": \"darkDown\",\n\t\"DiagStripe\": \"darkUp\",\n\t\"DiagCross\": \"darkGrid\",\n\t\"ThickDiagCross\": \"darkTrellis\",\n\t\"ThinHorzStripe\": \"lightHorizontal\",\n\t\"ThinVertStripe\": \"lightVertical\",\n\t\"ThinReverseDiagStripe\": \"lightDown\",\n\t\"ThinHorzCross\": \"lightGrid\"\n};\n\nvar styles = {}; // shared styles\n\nvar themes = {}; // shared themes\n\n/* 18.8.21 fills CT_Fills */\nfunction parse_fills(t, opts) {\n  styles.Fills = [];\n  var fill = {};\n  t[0].match(tagregex).forEach(function (x) {\n    var y = parsexmltag(x);\n    switch (y[0]) {\n      case '<fills':\n      case '<fills>':\n      case '</fills>':\n        break;\n\n      /* 18.8.20 fill CT_Fill */\n      case '<fill>':\n        break;\n      case '</fill>':\n        styles.Fills.push(fill);\n        fill = {};\n        break;\n\n      /* 18.8.32 patternFill CT_PatternFill */\n      case '<patternFill':\n        if (y.patternType) fill.patternType = y.patternType;\n        break;\n      case '<patternFill/>':\n      case '</patternFill>':\n        break;\n\n      /* 18.8.3 bgColor CT_Color */\n      case '<bgColor':\n        if (!fill.bgColor) fill.bgColor = {};\n        if (y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\n        if (y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\n        if (y.tint) fill.bgColor.tint = parseFloat(y.tint);\n\n\n        if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n          fill.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[fill.bgColor.theme].rgb, fill.bgColor.tint || 0);\n          if (opts.WTF) fill.bgColor.raw_rgb = rgb_tint(themes.themeElements.clrScheme[fill.bgColor.theme].rgb,0);\n        }\n        /* Excel uses ARGB strings */\n        if (y.rgb) fill.bgColor.rgb = y.rgb;//.substring(y.rgb.length - 6);\n        break;\n      case '<bgColor/>':\n      case '</bgColor>':\n        break;\n\n      /* 18.8.19 fgColor CT_Color */\n      case '<fgColor':\n        if (!fill.fgColor) fill.fgColor = {};\n        if (y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\n        if (y.tint) fill.fgColor.tint = parseFloat(y.tint);\n\n        if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n          fill.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[fill.fgColor.theme].rgb, fill.fgColor.tint || 0);\n          if (opts.WTF) fill.fgColor.raw_rgb = rgb_tint(themes.themeElements.clrScheme[fill.fgColor.theme].rgb,0);\n        }\n\n        /* Excel uses ARGB strings */\n        if (y.rgb) fill.fgColor.rgb = y.rgb;//.substring(y.rgb.length - 6);\n        break;\n      case '<fgColor/>':\n      case '</fgColor>':\n        break;\n\n      default:\n        if (opts.WTF) throw 'unrecognized ' + y[0] + ' in fills';\n    }\n  });\n}\n\nfunction parse_fonts(t, opts) {\n  styles.Fonts = [];\n  var font = {};\n  t[0].match(tagregex).forEach(function (x) {\n    var y = parsexmltag(x);\n    switch (y[0]) {\n\n      case '<fonts':\n      case  '<fonts>':\n      case '</fonts>':\n        break;\n      case '<font':\n        break;\n      case '</font>':\n        styles.Fonts.push(font);\n        ;\n        font = {};\n        break;\n\n      case '<name':\n        if (y.val) font.name = y.val;\n        break;\n      case '<name/>':\n      case '</name>':\n        break;\n\n\n      case '<b/>':\n        font.bold = true;\n        break;\n      case '<u/>':\n        font.underline = true;\n        break;\n      case '<i/>':\n        font.italic = true;\n        break;\n      case '<strike/>':\n        font.strike = true;\n        break;\n      case '<outline/>':\n        font.outline = true;\n        break;\n      case '<shadow/>':\n        font.shadow = true;\n        break;\n\n\n      case '<sz':\n        if (y.val) font.sz = y.val;\n        break;\n      case '<sz/>':\n      case '</sz>':\n        break;\n\n      case '<vertAlign':\n        if (y.val) font.vertAlign = y.val;\n        break;\n      case '<vertAlign/>':\n      case '</vertAlign>':\n        break;\n\n\n      case '<color':\n        if (!font.color) font.color = {};\n        if (y.theme) font.color.theme = y.theme;\n        if (y.tint) font.color.tint = y.tint;\n        if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n          font.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\n        }\n        if (y.rgb) font.color.rgb = y.rgb;\n        break;\n      case '<color/>':\n      case '</color>':\n        break;\n    }\n  });\n}\n\nfunction parse_borders(t, opts) {\n  styles.Borders = [];\n  var border = {}, sub_border = {};\n  t[0].match(tagregex).forEach(function (x) {\n    var y = parsexmltag(x);\n    switch (y[0]) {\n      case '<borders':\n      case  '<borders>':\n      case '</borders>':\n        break;\n      case '<border':\n      case '<border>':\n        border = {};\n        if (y.diagonalUp) { border.diagonalUp = y.diagonalUp; }\n        if (y.diagonalDown) { border.diagonalDown = y.diagonalDown; }\n        styles.Borders.push(border);\n\n        break;\n        break;\n      case '</border>':\n        break;\n\n      case '<left':\n        sub_border = border.left = {};\n        if (y.style) {\n          sub_border.style = y.style;\n        }\n        break;\n      case '<right':\n        sub_border = border.right = {};\n        if (y.style) {\n          sub_border.style = y.style;\n        }\n        break;\n      case '<top':\n        sub_border = border.top = {};\n        if (y.style) {\n          sub_border.style = y.style;\n        }\n        break;\n      case '<bottom':\n        sub_border = border.bottom = {};\n        if (y.style) {\n          sub_border.style = y.style;\n        }\n        break;\n      case '<diagonal':\n        sub_border = border.diagonal = {};\n        if (y.style) {\n          sub_border.style = y.style;\n        }\n        break;\n\n      case '<color':\n        sub_border.color = {};\n        if (y.theme) sub_border.color.theme = y.theme;\n        if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n          sub_border.color.rgb = rgb_tint(themes.themeElements.clrScheme[sub_border.color.theme].rgb, sub_border.color.tint || 0);\n        }\n\n        if (y.tint) sub_border.color.tint = y.tint;\n        if (y.rgb) sub_border.color.rgb = y.rgb;\n        if (y.auto) sub_border.color.auto = y.auto;\n        break;\n      case '<name/>':\n      case '</name>':\n        break;\n      default:\n        break;\n    }\n  });\n\n}\n\n/* 18.8.31 numFmts CT_NumFmts */\nfunction parse_numFmts(t, opts) {\n  styles.NumberFmt = [];\n  var k = keys(SSF._table);\n  for (var i = 0; i < k.length; ++i) styles.NumberFmt[k[i]] = SSF._table[k[i]];\n  var m = t[0].match(tagregex);\n  for (i = 0; i < m.length; ++i) {\n    var y = parsexmltag(m[i]);\n    switch (y[0]) {\n      case '<numFmts':\n      case '</numFmts>':\n      case '<numFmts/>':\n      case '<numFmts>':\n        break;\n      case '<numFmt':\n      {\n        var f = unescapexml(utf8read(y.formatCode)), j = parseInt(y.numFmtId, 10);\n        styles.NumberFmt[j] = f;\n        if (j > 0) SSF.load(f, j);\n      }\n        break;\n      default:\n        if (opts.WTF) throw 'unrecognized ' + y[0] + ' in numFmts';\n    }\n  }\n}\n\nfunction write_numFmts(NF, opts) {\n  var o = [\"<numFmts>\"];\n  [\n    [5, 8],\n    [23, 26],\n    [41, 44],\n    [63, 66],\n    [164, 392]\n  ].forEach(function (r) {\n    for (var i = r[0]; i <= r[1]; ++i) if (NF[i] !== undefined) o[o.length] = (writextag('numFmt', null, {numFmtId: i, formatCode: escapexml(NF[i])}));\n  });\n  if (o.length === 1) return \"\";\n  o[o.length] = (\"</numFmts>\");\n  o[0] = writextag('numFmts', null, { count: o.length - 2 }).replace(\"/>\", \">\");\n  return o.join(\"\");\n}\n\n/* 18.8.10 cellXfs CT_CellXfs */\nfunction parse_cellXfs(t, opts) {\n  styles.CellXf = [];\n  var xf;\n  t[0].match(tagregex).forEach(function (x) {\n    var y = parsexmltag(x);\n    switch (y[0]) {\n      case '<cellXfs':\n      case '<cellXfs>':\n      case '<cellXfs/>':\n      case '</cellXfs>':\n        break;\n\n      /* 18.8.45 xf CT_Xf */\n      case '<xf':\n          xf = y;\n          delete xf[0];\n        delete y[0];\n        if (xf.numFmtId) xf.numFmtId = parseInt(xf.numFmtId, 10);\n        if (xf.fillId) xf.fillId = parseInt(xf.fillId, 10);\n        styles.CellXf.push(xf);\n        break;\n      case '</xf>':\n        break;\n\n      /* 18.8.1 alignment CT_CellAlignment */\n      case '<alignment':\n      case '<alignment/>':\n        var alignment = {}\n          if (y.vertical) { alignment.vertical = y.vertical;}\n          if (y.horizontal) { alignment.horizontal = y.horizontal;}\n          if (y.textRotation != undefined) { alignment.textRotation = y.textRotation; }\n          if (y.indent) { alignment.indent = y.indent; }\n          if (y.wrapText) { alignment.wrapText = y.wrapText; }\n          xf.alignment = alignment;\n\n        break;\n\n      /* 18.8.33 protection CT_CellProtection */\n      case '<protection':\n      case '</protection>':\n      case '<protection/>':\n        break;\n\n      case '<extLst':\n      case '</extLst>':\n        break;\n      case '<ext':\n        break;\n      default:\n        if (opts.WTF) throw 'unrecognized ' + y[0] + ' in cellXfs';\n    }\n  });\n}\n\nfunction write_cellXfs(cellXfs) {\n  var o = [];\n  o[o.length] = (writextag('cellXfs', null));\n  cellXfs.forEach(function (c) {\n    o[o.length] = (writextag('xf', null, c));\n  });\n  o[o.length] = (\"</cellXfs>\");\n  if (o.length === 2) return \"\";\n  o[0] = writextag('cellXfs', null, {count: o.length - 2}).replace(\"/>\", \">\");\n  return o.join(\"\");\n}\n\n/* 18.8 Styles CT_Stylesheet*/\nvar parse_sty_xml = (function make_pstyx() {\n  var numFmtRegex = /<numFmts([^>]*)>.*<\\/numFmts>/;\n  var cellXfRegex = /<cellXfs([^>]*)>.*<\\/cellXfs>/;\n  var fillsRegex = /<fills([^>]*)>.*<\\/fills>/;\n  var bordersRegex = /<borders([^>]*)>.*<\\/borders>/;\n\n  return function parse_sty_xml(data, opts) {\n    /* 18.8.39 styleSheet CT_Stylesheet */\n    var t;\n\n    /* numFmts CT_NumFmts ? */\n    if ((t = data.match(numFmtRegex))) parse_numFmts(t, opts);\n\n    /* fonts CT_Fonts ? */\n    if ((t = data.match(/<fonts([^>]*)>.*<\\/fonts>/))) parse_fonts(t, opts)\n\n    /* fills CT_Fills */\n    if ((t = data.match(fillsRegex))) parse_fills(t, opts);\n\n    /* borders CT_Borders ? */\n    if ((t = data.match(bordersRegex))) parse_borders(t, opts);\n    /* cellStyleXfs CT_CellStyleXfs ? */\n\n    /* cellXfs CT_CellXfs ? */\n    if ((t = data.match(cellXfRegex))) parse_cellXfs(t, opts);\n\n    /* dxfs CT_Dxfs ? */\n    /* tableStyles CT_TableStyles ? */\n    /* colors CT_Colors ? */\n    /* extLst CT_ExtensionList ? */\n\n    return styles;\n  };\n})();\n\nvar STYLES_XML_ROOT = writextag('styleSheet', null, {\n  'xmlns': XMLNS.main[0],\n  'xmlns:vt': XMLNS.vt\n});\n\nRELS.STY = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\";\n\nfunction write_sty_xml(wb, opts) {\n\n  if (typeof style_builder != 'undefined' && typeof 'require' != 'undefined') {\n    return style_builder.toXml();\n  }\n\n  var o = [XML_HEADER, STYLES_XML_ROOT], w;\n  if ((w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\n  o[o.length] = ('<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>');\n  o[o.length] = ('<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>');\n  o[o.length] = ('<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>');\n  o[o.length] = ('<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>');\n  if ((w = write_cellXfs(opts.cellXfs))) o[o.length] = (w);\n  o[o.length] = ('<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>');\n  o[o.length] = ('<dxfs count=\"0\"/>');\n  o[o.length] = ('<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>');\n\n  if (o.length > 2) {\n    o[o.length] = ('</styleSheet>');\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n  return o.join(\"\");\n}\n/* [MS-XLSB] 2.4.651 BrtFmt */\nfunction parse_BrtFmt(data, length) {\n\tvar ifmt = data.read_shift(2);\n\tvar stFmtCode = parse_XLWideString(data,length-2);\n\treturn [ifmt, stFmtCode];\n}\n\n/* [MS-XLSB] 2.4.653 BrtFont TODO */\nfunction parse_BrtFont(data, length) {\n\tvar out = {flags:{}};\n\tout.dyHeight = data.read_shift(2);\n\tout.grbit = parse_FontFlags(data, 2);\n\tout.bls = data.read_shift(2);\n\tout.sss = data.read_shift(2);\n\tout.uls = data.read_shift(1);\n\tout.bFamily = data.read_shift(1);\n\tout.bCharSet = data.read_shift(1);\n\tdata.l++;\n\tout.brtColor = parse_BrtColor(data, 8);\n\tout.bFontScheme = data.read_shift(1);\n\tout.name = parse_XLWideString(data, length - 21);\n\n\tout.flags.Bold = out.bls === 0x02BC;\n\tout.flags.Italic = out.grbit.fItalic;\n\tout.flags.Strikeout = out.grbit.fStrikeout;\n\tout.flags.Outline = out.grbit.fOutline;\n\tout.flags.Shadow = out.grbit.fShadow;\n\tout.flags.Condense = out.grbit.fCondense;\n\tout.flags.Extend = out.grbit.fExtend;\n\tout.flags.Sub = out.sss & 0x2;\n\tout.flags.Sup = out.sss & 0x1;\n\treturn out;\n}\n\n/* [MS-XLSB] 2.4.816 BrtXF */\nfunction parse_BrtXF(data, length) {\n\tvar ixfeParent = data.read_shift(2);\n\tvar ifmt = data.read_shift(2);\n\tparsenoop(data, length-4);\n\treturn {ixfe:ixfeParent, ifmt:ifmt };\n}\n\n/* [MS-XLSB] 2.1.7.50 Styles */\nfunction parse_sty_bin(data, opts) {\n\tstyles.NumberFmt = [];\n\tfor(var y in SSF._table) styles.NumberFmt[y] = SSF._table[y];\n\n\tstyles.CellXf = [];\n\tvar state = \"\"; /* TODO: this should be a stack */\n\tvar pass = false;\n\trecordhopper(data, function hopper_sty(val, R, RT) {\n\t\tswitch(R.n) {\n\t\t\tcase 'BrtFmt':\n\t\t\t\tstyles.NumberFmt[val[0]] = val[1]; SSF.load(val[1], val[0]);\n\t\t\t\tbreak;\n\t\t\tcase 'BrtFont': break; /* TODO */\n\t\t\tcase 'BrtKnownFonts': break; /* TODO */\n\t\t\tcase 'BrtFill': break; /* TODO */\n\t\t\tcase 'BrtBorder': break; /* TODO */\n\t\t\tcase 'BrtXF':\n\t\t\t\tif(state === \"CELLXFS\") {\n\t\t\t\t\tstyles.CellXf.push(val);\n\t\t\t\t}\n\t\t\t\tbreak; /* TODO */\n\t\t\tcase 'BrtStyle': break; /* TODO */\n\t\t\tcase 'BrtDXF': break; /* TODO */\n\t\t\tcase 'BrtMRUColor': break; /* TODO */\n\t\t\tcase 'BrtIndexedColor': break; /* TODO */\n\t\t\tcase 'BrtBeginStyleSheet': break;\n\t\t\tcase 'BrtEndStyleSheet': break;\n\t\t\tcase 'BrtBeginTableStyle': break;\n\t\t\tcase 'BrtTableStyleElement': break;\n\t\t\tcase 'BrtEndTableStyle': break;\n\t\t\tcase 'BrtBeginFmts': state = \"FMTS\"; break;\n\t\t\tcase 'BrtEndFmts': state = \"\"; break;\n\t\t\tcase 'BrtBeginFonts': state = \"FONTS\"; break;\n\t\t\tcase 'BrtEndFonts': state = \"\"; break;\n\t\t\tcase 'BrtACBegin': state = \"ACFONTS\"; break;\n\t\t\tcase 'BrtACEnd': state = \"\"; break;\n\t\t\tcase 'BrtBeginFills': state = \"FILLS\"; break;\n\t\t\tcase 'BrtEndFills': state = \"\"; break;\n\t\t\tcase 'BrtBeginBorders': state = \"BORDERS\"; break;\n\t\t\tcase 'BrtEndBorders': state = \"\"; break;\n\t\t\tcase 'BrtBeginCellStyleXFs': state = \"CELLSTYLEXFS\"; break;\n\t\t\tcase 'BrtEndCellStyleXFs': state = \"\"; break;\n\t\t\tcase 'BrtBeginCellXFs': state = \"CELLXFS\"; break;\n\t\t\tcase 'BrtEndCellXFs': state = \"\"; break;\n\t\t\tcase 'BrtBeginStyles': state = \"STYLES\"; break;\n\t\t\tcase 'BrtEndStyles': state = \"\"; break;\n\t\t\tcase 'BrtBeginDXFs': state = \"DXFS\"; break;\n\t\t\tcase 'BrtEndDXFs': state = \"\"; break;\n\t\t\tcase 'BrtBeginTableStyles': state = \"TABLESTYLES\"; break;\n\t\t\tcase 'BrtEndTableStyles': state = \"\"; break;\n\t\t\tcase 'BrtBeginColorPalette': state = \"COLORPALETTE\"; break;\n\t\t\tcase 'BrtEndColorPalette': state = \"\"; break;\n\t\t\tcase 'BrtBeginIndexedColors': state = \"INDEXEDCOLORS\"; break;\n\t\t\tcase 'BrtEndIndexedColors': state = \"\"; break;\n\t\t\tcase 'BrtBeginMRUColors': state = \"MRUCOLORS\"; break;\n\t\t\tcase 'BrtEndMRUColors': state = \"\"; break;\n\t\t\tcase 'BrtFRTBegin': pass = true; break;\n\t\t\tcase 'BrtFRTEnd': pass = false; break;\n\t\t\tcase 'BrtBeginStyleSheetExt14': break;\n\t\t\tcase 'BrtBeginSlicerStyles': break;\n\t\t\tcase 'BrtEndSlicerStyles': break;\n\t\t\tcase 'BrtBeginTimelineStylesheetExt15': break;\n\t\t\tcase 'BrtEndTimelineStylesheetExt15': break;\n\t\t\tcase 'BrtBeginTimelineStyles': break;\n\t\t\tcase 'BrtEndTimelineStyles': break;\n\t\t\tcase 'BrtEndStyleSheetExt14': break;\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n\t\t}\n\t});\n\treturn styles;\n}\n\n/* [MS-XLSB] 2.1.7.50 Styles */\nfunction write_sty_bin(data, opts) {\n\tvar ba = buf_array();\n\twrite_record(ba, \"BrtBeginStyleSheet\");\n\t/* [FMTS] */\n\t/* [FONTS] */\n\t/* [FILLS] */\n\t/* [BORDERS] */\n\t/* CELLSTYLEXFS */\n\t/* CELLXFS*/\n\t/* STYLES */\n\t/* DXFS */\n\t/* TABLESTYLES */\n\t/* [COLORPALETTE] */\n\t/* FRTSTYLESHEET*/\n\twrite_record(ba, \"BrtEndStyleSheet\");\n\treturn ba.end();\n}\nRELS.THEME = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\";\n\n/* 20.1.6.2 clrScheme CT_ColorScheme */\nfunction parse_clrScheme(t, opts) {\n\tthemes.themeElements.clrScheme = [];\n\tvar color = {};\n\tt[0].match(tagregex).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\tcase '<a:clrScheme': case '</a:clrScheme>': break;\n\n\t\t\t/* 20.1.2.3.32 srgbClr CT_SRgbColor */\n\t\t\tcase '<a:srgbClr': color.rgb = y.val; break;\n\n\t\t\t/* 20.1.2.3.33 sysClr CT_SystemColor */\n\t\t\tcase '<a:sysClr': color.rgb = y.lastClr; break;\n\n\t\t\t/* 20.1.4.1.9 dk1 (Dark 1) */\n\t\t\tcase '<a:dk1>':\n\t\t\tcase '</a:dk1>':\n\t\t\t/* 20.1.4.1.10 dk2 (Dark 2) */\n\t\t\tcase '<a:dk2>':\n\t\t\tcase '</a:dk2>':\n\t\t\t/* 20.1.4.1.22 lt1 (Light 1) */\n\t\t\tcase '<a:lt1>':\n\t\t\tcase '</a:lt1>':\n\t\t\t/* 20.1.4.1.23 lt2 (Light 2) */\n\t\t\tcase '<a:lt2>':\n\t\t\tcase '</a:lt2>':\n\t\t\t/* 20.1.4.1.1 accent1 (Accent 1) */\n\t\t\tcase '<a:accent1>':\n\t\t\tcase '</a:accent1>':\n\t\t\t/* 20.1.4.1.2 accent2 (Accent 2) */\n\t\t\tcase '<a:accent2>':\n\t\t\tcase '</a:accent2>':\n\t\t\t/* 20.1.4.1.3 accent3 (Accent 3) */\n\t\t\tcase '<a:accent3>':\n\t\t\tcase '</a:accent3>':\n\t\t\t/* 20.1.4.1.4 accent4 (Accent 4) */\n\t\t\tcase '<a:accent4>':\n\t\t\tcase '</a:accent4>':\n\t\t\t/* 20.1.4.1.5 accent5 (Accent 5) */\n\t\t\tcase '<a:accent5>':\n\t\t\tcase '</a:accent5>':\n\t\t\t/* 20.1.4.1.6 accent6 (Accent 6) */\n\t\t\tcase '<a:accent6>':\n\t\t\tcase '</a:accent6>':\n\t\t\t/* 20.1.4.1.19 hlink (Hyperlink) */\n\t\t\tcase '<a:hlink>':\n\t\t\tcase '</a:hlink>':\n\t\t\t/* 20.1.4.1.15 folHlink (Followed Hyperlink) */\n\t\t\tcase '<a:folHlink>':\n\t\t\tcase '</a:folHlink>':\n\t\t\t\tif (y[0][1] === '/') {\n\t\t\t\t\tthemes.themeElements.clrScheme.push(color);\n\t\t\t\t\tcolor = {};\n\t\t\t\t} else {\n\t\t\t\t\tcolor.name = y[0].substring(3, y[0].length - 1);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault: if(opts.WTF) throw 'unrecognized ' + y[0] + ' in clrScheme';\n\t\t}\n\t});\n}\n\n/* 20.1.4.1.18 fontScheme CT_FontScheme */\nfunction parse_fontScheme(t, opts) { }\n\n/* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\nfunction parse_fmtScheme(t, opts) { }\n\nvar clrsregex = /<a:clrScheme([^>]*)>[^\\u2603]*<\\/a:clrScheme>/;\nvar fntsregex = /<a:fontScheme([^>]*)>[^\\u2603]*<\\/a:fontScheme>/;\nvar fmtsregex = /<a:fmtScheme([^>]*)>[^\\u2603]*<\\/a:fmtScheme>/;\n\n/* 20.1.6.10 themeElements CT_BaseStyles */\nfunction parse_themeElements(data, opts) {\n\tthemes.themeElements = {};\n\n\tvar t;\n\n\t[\n\t\t/* clrScheme CT_ColorScheme */\n\t\t['clrScheme', clrsregex, parse_clrScheme],\n\t\t/* fontScheme CT_FontScheme */\n\t\t['fontScheme', fntsregex, parse_fontScheme],\n\t\t/* fmtScheme CT_StyleMatrix */\n\t\t['fmtScheme', fmtsregex, parse_fmtScheme]\n\t].forEach(function(m) {\n\t\tif(!(t=data.match(m[1]))) throw m[0] + ' not found in themeElements';\n\t\tm[2](t, opts);\n\t});\n}\n\nvar themeltregex = /<a:themeElements([^>]*)>[^\\u2603]*<\\/a:themeElements>/;\n\n/* 14.2.7 Theme Part */\nfunction parse_theme_xml(data, opts) {\n\t/* 20.1.6.9 theme CT_OfficeStyleSheet */\n\tif(!data || data.length === 0) return themes;\n\n\tvar t;\n\n\t/* themeElements CT_BaseStyles */\n\tif(!(t=data.match(themeltregex))) throw 'themeElements not found in theme';\n\tparse_themeElements(t[0], opts);\n\n\treturn themes;\n}\n\n//function write_theme() { return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>'; }\nfunction write_theme(opts) {\n  if (opts.themeXml) { return opts.themeXml; }\n  return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>';\n}/* [MS-XLS] 2.4.326 TODO: payload is a zip file */\nfunction parse_Theme(blob, length) {\n\tvar dwThemeVersion = blob.read_shift(4);\n\tif(dwThemeVersion === 124226) return;\n\tblob.l += length-4;\n}\n\n/* 2.5.49 */\nfunction parse_ColorTheme(blob, length) { return blob.read_shift(4); }\n\n/* 2.5.155 */\nfunction parse_FullColorExt(blob, length) {\n\tvar o = {};\n\to.xclrType = blob.read_shift(2);\n\to.nTintShade = blob.read_shift(2);\n\tswitch(o.xclrType) {\n\t\tcase 0: blob.l += 4; break;\n\t\tcase 1: o.xclrValue = parse_IcvXF(blob, 4); break;\n\t\tcase 2: o.xclrValue = parse_LongRGBA(blob, 4); break;\n\t\tcase 3: o.xclrValue = parse_ColorTheme(blob, 4); break;\n\t\tcase 4: blob.l += 4; break;\n\t}\n\tblob.l += 8;\n\treturn o;\n}\n\n/* 2.5.164 TODO: read 7 bits*/\nfunction parse_IcvXF(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* 2.5.280 */\nfunction parse_XFExtGradient(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* 2.5.108 */\nfunction parse_ExtProp(blob, length) {\n\tvar extType = blob.read_shift(2);\n\tvar cb = blob.read_shift(2);\n\tvar o = [extType];\n\tswitch(extType) {\n\t\tcase 0x04: case 0x05: case 0x07: case 0x08:\n\t\tcase 0x09: case 0x0A: case 0x0B: case 0x0D:\n\t\t\to[1] = parse_FullColorExt(blob, cb); break;\n\t\tcase 0x06: o[1] = parse_XFExtGradient(blob, cb); break;\n\t\tcase 0x0E: case 0x0F: o[1] = blob.read_shift(cb === 5 ? 1 : 2); break;\n\t\tdefault: throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n\t}\n\treturn o;\n}\n\n/* 2.4.355 */\nfunction parse_XFExt(blob, length) {\n\tvar end = blob.l + length;\n\tblob.l += 2;\n\tvar ixfe = blob.read_shift(2);\n\tblob.l += 2;\n\tvar cexts = blob.read_shift(2);\n\tvar ext = [];\n\twhile(cexts-- > 0) ext.push(parse_ExtProp(blob, end-blob.l));\n\treturn {ixfe:ixfe, ext:ext};\n}\n\n/* xf is an XF, see parse_XFExt for xfext */\nfunction update_xfext(xf, xfext) {\n\txfext.forEach(function(xfe) {\n\t\tswitch(xfe[0]) { /* 2.5.108 extPropData */\n\t\t\tcase 0x04: break; /* foreground color */\n\t\t\tcase 0x05: break; /* background color */\n\t\t\tcase 0x07: case 0x08: case 0x09: case 0x0a: break;\n\t\t\tcase 0x0d: break; /* text color */\n\t\t\tcase 0x0e: break; /* font scheme */\n\t\t\tdefault: throw \"bafuq\" + xfe[0].toString(16);\n\t\t}\n\t});\n}\n\n/* 18.6 Calculation Chain */\nfunction parse_cc_xml(data, opts) {\n\tvar d = [];\n\tvar l = 0, i = 1;\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\tcase '<?xml': break;\n\t\t\t/* 18.6.2  calcChain CT_CalcChain 1 */\n\t\t\tcase '<calcChain': case '<calcChain>': case '</calcChain>': break;\n\t\t\t/* 18.6.1  c CT_CalcCell 1 */\n\t\t\tcase '<c': delete y[0]; if(y.i) i = y.i; else y.i = i; d.push(y); break;\n\t\t}\n\t});\n\treturn d;\n}\n\nfunction write_cc_xml(data, opts) { }\n/* [MS-XLSB] 2.6.4.1 */\nfunction parse_BrtCalcChainItem$(data, length) {\n\tvar out = {};\n\tout.i = data.read_shift(4);\n\tvar cell = {};\n\tcell.r = data.read_shift(4);\n\tcell.c = data.read_shift(4);\n\tout.r = encode_cell(cell);\n\tvar flags = data.read_shift(1);\n\tif(flags & 0x2) out.l = '1';\n\tif(flags & 0x8) out.a = '1';\n\treturn out;\n}\n\n/* 18.6 Calculation Chain */\nfunction parse_cc_bin(data, opts) {\n\tvar out = [];\n\tvar pass = false;\n\trecordhopper(data, function hopper_cc(val, R, RT) {\n\t\tswitch(R.n) {\n\t\t\tcase 'BrtCalcChainItem$': out.push(val); break;\n\t\t\tcase 'BrtBeginCalcChain$': break;\n\t\t\tcase 'BrtEndCalcChain$': break;\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n\t\t}\n\t});\n\treturn out;\n}\n\nfunction write_cc_bin(data, opts) { }\n\nfunction parse_comments(zip, dirComments, sheets, sheetRels, opts) {\n\tfor(var i = 0; i != dirComments.length; ++i) {\n\t\tvar canonicalpath=dirComments[i];\n\t\tvar comments=parse_cmnt(getzipdata(zip, canonicalpath.replace(/^\\//,''), true), canonicalpath, opts);\n\t\tif(!comments || !comments.length) continue;\n\t\t// find the sheets targeted by these comments\n\t\tvar sheetNames = keys(sheets);\n\t\tfor(var j = 0; j != sheetNames.length; ++j) {\n\t\t\tvar sheetName = sheetNames[j];\n\t\t\tvar rels = sheetRels[sheetName];\n\t\t\tif(rels) {\n\t\t\t\tvar rel = rels[canonicalpath];\n\t\t\t\tif(rel) insertCommentsIntoSheet(sheetName, sheets[sheetName], comments);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction insertCommentsIntoSheet(sheetName, sheet, comments) {\n\tcomments.forEach(function(comment) {\n\t\tvar cell = sheet[comment.ref];\n\t\tif (!cell) {\n\t\t\tcell = {};\n\t\t\tsheet[comment.ref] = cell;\n\t\t\tvar range = safe_decode_range(sheet[\"!ref\"]||\"BDWGO1000001:A1\");\n\t\t\tvar thisCell = decode_cell(comment.ref);\n\t\t\tif(range.s.r > thisCell.r) range.s.r = thisCell.r;\n\t\t\tif(range.e.r < thisCell.r) range.e.r = thisCell.r;\n\t\t\tif(range.s.c > thisCell.c) range.s.c = thisCell.c;\n\t\t\tif(range.e.c < thisCell.c) range.e.c = thisCell.c;\n\t\t\tvar encoded = encode_range(range);\n\t\t\tif (encoded !== sheet[\"!ref\"]) sheet[\"!ref\"] = encoded;\n\t\t}\n\n\t\tif (!cell.c) cell.c = [];\n\t\tvar o = {a: comment.author, t: comment.t, r: comment.r};\n\t\tif(comment.h) o.h = comment.h;\n\t\tcell.c.push(o);\n\t});\n}\n\n/* 18.7.3 CT_Comment */\nfunction parse_comments_xml(data, opts) {\n\tif(data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\n\tvar authors = [];\n\tvar commentList = [];\n\tdata.match(/<(?:\\w+:)?authors>([^\\u2603]*)<\\/(?:\\w+:)?authors>/)[1].split(/<\\/\\w*:?author>/).forEach(function(x) {\n\t\tif(x === \"\" || x.trim() === \"\") return;\n\t\tauthors.push(x.match(/<(?:\\w+:)?author[^>]*>(.*)/)[1]);\n\t});\n\t(data.match(/<(?:\\w+:)?commentList>([^\\u2603]*)<\\/(?:\\w+:)?commentList>/)||[\"\",\"\"])[1].split(/<\\/\\w*:?comment>/).forEach(function(x, index) {\n\t\tif(x === \"\" || x.trim() === \"\") return;\n\t\tvar y = parsexmltag(x.match(/<(?:\\w+:)?comment[^>]*>/)[0]);\n\t\tvar comment = { author: y.authorId && authors[y.authorId] ? authors[y.authorId] : undefined, ref: y.ref, guid: y.guid };\n\t\tvar cell = decode_cell(y.ref);\n\t\tif(opts.sheetRows && opts.sheetRows <= cell.r) return;\n\t\tvar textMatch = x.match(/<text>([^\\u2603]*)<\\/text>/);\n\t\tif (!textMatch || !textMatch[1]) return; // a comment may contain an empty text tag.\n\t\tvar rt = parse_si(textMatch[1]);\n\t\tcomment.r = rt.r;\n\t\tcomment.t = rt.t;\n\t\tif(opts.cellHTML) comment.h = rt.h;\n\t\tcommentList.push(comment);\n\t});\n\treturn commentList;\n}\n\nfunction write_comments_xml(data, opts) { }\n/* [MS-XLSB] 2.4.28 BrtBeginComment */\nfunction parse_BrtBeginComment(data, length) {\n\tvar out = {};\n\tout.iauthor = data.read_shift(4);\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tout.rfx = rfx.s;\n\tout.ref = encode_cell(rfx.s);\n\tdata.l += 16; /*var guid = parse_GUID(data); */\n\treturn out;\n}\n\n/* [MS-XLSB] 2.4.324 BrtCommentAuthor */\nvar parse_BrtCommentAuthor = parse_XLWideString;\n\n/* [MS-XLSB] 2.4.325 BrtCommentText */\nvar parse_BrtCommentText = parse_RichStr;\n\n/* [MS-XLSB] 2.1.7.8 Comments */\nfunction parse_comments_bin(data, opts) {\n\tvar out = [];\n\tvar authors = [];\n\tvar c = {};\n\tvar pass = false;\n\trecordhopper(data, function hopper_cmnt(val, R, RT) {\n\t\tswitch(R.n) {\n\t\t\tcase 'BrtCommentAuthor': authors.push(val); break;\n\t\t\tcase 'BrtBeginComment': c = val; break;\n\t\t\tcase 'BrtCommentText': c.t = val.t; c.h = val.h; c.r = val.r; break;\n\t\t\tcase 'BrtEndComment':\n\t\t\t\tc.author = authors[c.iauthor];\n\t\t\t\tdelete c.iauthor;\n\t\t\t\tif(opts.sheetRows && opts.sheetRows <= c.rfx.r) break;\n\t\t\t\tdelete c.rfx; out.push(c); break;\n\t\t\tcase 'BrtBeginComments': break;\n\t\t\tcase 'BrtEndComments': break;\n\t\t\tcase 'BrtBeginCommentAuthors': break;\n\t\t\tcase 'BrtEndCommentAuthors': break;\n\t\t\tcase 'BrtBeginCommentList': break;\n\t\t\tcase 'BrtEndCommentList': break;\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n\t\t}\n\t});\n\treturn out;\n}\n\nfunction write_comments_bin(data, opts) { }\n/* TODO: it will be useful to parse the function str */\nvar rc_to_a1 = (function(){\n\tvar rcregex = /(^|[^A-Za-z])R(\\[?)(-?\\d+|)\\]?C(\\[?)(-?\\d+|)\\]?/g;\n\tvar rcbase;\n\tfunction rcfunc($$,$1,$2,$3,$4,$5) {\n\t\tvar R = $3.length>0?parseInt($3,10)|0:0, C = $5.length>0?parseInt($5,10)|0:0;\n\t\tif(C<0 && $4.length === 0) C=0;\n\t\tif($4.length > 0) C += rcbase.c;\n\t\tif($2.length > 0) R += rcbase.r;\n\t\treturn $1 + encode_col(C) + encode_row(R);\n\t}\n\treturn function rc_to_a1(fstr, base) {\n\t\trcbase = base;\n\t\treturn fstr.replace(rcregex, rcfunc);\n\t};\n})();\n\n/* --- formula references point to MS-XLS --- */\n/* Small helpers */\nfunction parseread(l) { return function(blob, length) { blob.l+=l; return; }; }\nfunction parseread1(blob, length) { blob.l+=1; return; }\n\n/* Rgce Helpers */\n\n/* 2.5.51 */\nfunction parse_ColRelU(blob, length) {\n\tvar c = blob.read_shift(2);\n\treturn [c & 0x3FFF, (c >> 14) & 1, (c >> 15) & 1];\n}\n\n/* 2.5.198.105 */\nfunction parse_RgceArea(blob, length) {\n\tvar r=blob.read_shift(2), R=blob.read_shift(2);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n\n/* 2.5.198.105 TODO */\nfunction parse_RgceAreaRel(blob, length) {\n\tvar r=blob.read_shift(2), R=blob.read_shift(2);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n\n/* 2.5.198.109 */\nfunction parse_RgceLoc(blob, length) {\n\tvar r = blob.read_shift(2);\n\tvar c = parse_ColRelU(blob, 2);\n\treturn {r:r, c:c[0], cRel:c[1], rRel:c[2]};\n}\n\n/* 2.5.198.111 */\nfunction parse_RgceLocRel(blob, length) {\n\tvar r = blob.read_shift(2);\n\tvar cl = blob.read_shift(2);\n\tvar cRel = (cl & 0x8000) >> 15, rRel = (cl & 0x4000) >> 14;\n\tcl &= 0x3FFF;\n\tif(cRel !== 0) while(cl >= 0x100) cl -= 0x100;\n\treturn {r:r,c:cl,cRel:cRel,rRel:rRel};\n}\n\n/* Ptg Tokens */\n\n/* 2.5.198.27 */\nfunction parse_PtgArea(blob, length) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceArea(blob, 8);\n\treturn [type, area];\n}\n\n/* 2.5.198.28 */\nfunction parse_PtgArea3d(blob, length) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2);\n\tvar area = parse_RgceArea(blob, 8);\n\treturn [type, ixti, area];\n}\n\n/* 2.5.198.29 */\nfunction parse_PtgAreaErr(blob, length) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += 8;\n\treturn [type];\n}\n/* 2.5.198.30 */\nfunction parse_PtgAreaErr3d(blob, length) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2);\n\tblob.l += 8;\n\treturn [type, ixti];\n}\n\n/* 2.5.198.31 */\nfunction parse_PtgAreaN(blob, length) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceAreaRel(blob, 8);\n\treturn [type, area];\n}\n\n/* 2.5.198.32 -- ignore this and look in PtgExtraArray for shape + values */\nfunction parse_PtgArray(blob, length) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += 7;\n\treturn [type];\n}\n\n/* 2.5.198.33 */\nfunction parse_PtgAttrBaxcel(blob, length) {\n\tvar bitSemi = blob[blob.l+1] & 0x01; /* 1 = volatile */\n\tvar bitBaxcel = 1;\n\tblob.l += 4;\n\treturn [bitSemi, bitBaxcel];\n}\n\n/* 2.5.198.34 */\nfunction parse_PtgAttrChoose(blob, length) {\n\tblob.l +=2;\n\tvar offset = blob.read_shift(2);\n\tvar o = [];\n\t/* offset is 1 less than the number of elements */\n\tfor(var i = 0; i <= offset; ++i) o.push(blob.read_shift(2));\n\treturn o;\n}\n\n/* 2.5.198.35 */\nfunction parse_PtgAttrGoto(blob, length) {\n\tvar bitGoto = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitGoto, blob.read_shift(2)];\n}\n\n/* 2.5.198.36 */\nfunction parse_PtgAttrIf(blob, length) {\n\tvar bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitIf, blob.read_shift(2)];\n}\n\n/* 2.5.198.37 */\nfunction parse_PtgAttrSemi(blob, length) {\n\tvar bitSemi = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 4;\n\treturn [bitSemi];\n}\n\n/* 2.5.198.40 (used by PtgAttrSpace and PtgAttrSpaceSemi) */\nfunction parse_PtgAttrSpaceType(blob, length) {\n\tvar type = blob.read_shift(1), cch = blob.read_shift(1);\n\treturn [type, cch];\n}\n\n/* 2.5.198.38 */\nfunction parse_PtgAttrSpace(blob, length) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* 2.5.198.39 */\nfunction parse_PtgAttrSpaceSemi(blob, length) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* 2.5.198.84 TODO */\nfunction parse_PtgRef(blob, length) {\n\tvar ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLoc(blob,4);\n\treturn [type, loc];\n}\n\n/* 2.5.198.88 TODO */\nfunction parse_PtgRefN(blob, length) {\n\tvar ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLocRel(blob,4);\n\treturn [type, loc];\n}\n\n/* 2.5.198.85 TODO */\nfunction parse_PtgRef3d(blob, length) {\n\tvar ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tvar loc = parse_RgceLoc(blob,4);\n\treturn [type, ixti, loc];\n}\n\n\n/* 2.5.198.62 TODO */\nfunction parse_PtgFunc(blob, length) {\n\tvar ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar iftab = blob.read_shift(2);\n\treturn [FtabArgc[iftab], Ftab[iftab]];\n}\n/* 2.5.198.63 TODO */\nfunction parse_PtgFuncVar(blob, length) {\n\tblob.l++;\n\tvar cparams = blob.read_shift(1), tab = parsetab(blob);\n\treturn [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n}\n\nfunction parsetab(blob, length) {\n\treturn [blob[blob.l+1]>>7, blob.read_shift(2) & 0x7FFF];\n}\n\n/* 2.5.198.41 */\nvar parse_PtgAttrSum = parseread(4);\n/* 2.5.198.43 */\nvar parse_PtgConcat = parseread1;\n\n/* 2.5.198.58 */\nfunction parse_PtgExp(blob, length) {\n\tblob.l++;\n\tvar row = blob.read_shift(2);\n\tvar col = blob.read_shift(2);\n\treturn [row, col];\n}\n\n/* 2.5.198.57 */\nfunction parse_PtgErr(blob, length) { blob.l++; return BErr[blob.read_shift(1)]; }\n\n/* 2.5.198.66 TODO */\nfunction parse_PtgInt(blob, length) { blob.l++; return blob.read_shift(2); }\n\n/* 2.5.198.42 */\nfunction parse_PtgBool(blob, length) { blob.l++; return blob.read_shift(1)!==0;}\n\n/* 2.5.198.79 */\nfunction parse_PtgNum(blob, length) { blob.l++; return parse_Xnum(blob, 8); }\n\n/* 2.5.198.89 */\nfunction parse_PtgStr(blob, length) { blob.l++; return parse_ShortXLUnicodeString(blob); }\n\n/* 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\nfunction parse_SerAr(blob) {\n\tvar val = [];\n\tswitch((val[0] = blob.read_shift(1))) {\n\t\t/* 2.5.192.113 */\n\t\tcase 0x04: /* SerBool -- boolean */\n\t\t\tval[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n\t\t\tblob.l += 7; break;\n\t\t/* 2.5.192.114 */\n\t\tcase 0x10: /* SerErr -- error */\n\t\t\tval[1] = BErr[blob[blob.l]];\n\t\t\tblob.l += 8; break;\n\t\t/* 2.5.192.115 */\n\t\tcase 0x00: /* SerNil -- honestly, I'm not sure how to reproduce this */\n\t\t\tblob.l += 8; break;\n\t\t/* 2.5.192.116 */\n\t\tcase 0x01: /* SerNum -- Xnum */\n\t\t\tval[1] = parse_Xnum(blob, 8); break;\n\t\t/* 2.5.192.117 */\n\t\tcase 0x02: /* SerStr -- XLUnicodeString (<256 chars) */\n\t\t\tval[1] = parse_XLUnicodeString(blob); break;\n\t\t// default: throw \"Bad SerAr: \" + val[0]; /* Unreachable */\n\t}\n\treturn val;\n}\n\n/* 2.5.198.61 */\nfunction parse_PtgExtraMem(blob, cce) {\n\tvar count = blob.read_shift(2);\n\tvar out = [];\n\tfor(var i = 0; i != count; ++i) out.push(parse_Ref8U(blob, 8));\n\treturn out;\n}\n\n/* 2.5.198.59 */\nfunction parse_PtgExtraArray(blob) {\n\tvar cols = 1 + blob.read_shift(1); //DColByteU\n\tvar rows = 1 + blob.read_shift(2); //DRw\n\tfor(var i = 0, o=[]; i != rows && (o[i] = []); ++i)\n\t\tfor(var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob);\n\treturn o;\n}\n\n/* 2.5.198.76 */\nfunction parse_PtgName(blob, length) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar nameindex = blob.read_shift(4);\n\treturn [type, 0, nameindex];\n}\n\n/* 2.5.198.77 */\nfunction parse_PtgNameX(blob, length) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tvar nameindex = blob.read_shift(4);\n\treturn [type, ixti, nameindex];\n}\n\n/* 2.5.198.70 */\nfunction parse_PtgMemArea(blob, length) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += 4;\n\tvar cce = blob.read_shift(2);\n\treturn [type, cce];\n}\n\n/* 2.5.198.72 */\nfunction parse_PtgMemFunc(blob, length) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(2);\n\treturn [type, cce];\n}\n\n\n/* 2.5.198.86 */\nfunction parse_PtgRefErr(blob, length) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += 4;\n\treturn [type];\n}\n\n/* 2.5.198.26 */\nvar parse_PtgAdd = parseread1;\n/* 2.5.198.45 */\nvar parse_PtgDiv = parseread1;\n/* 2.5.198.56 */\nvar parse_PtgEq = parseread1;\n/* 2.5.198.64 */\nvar parse_PtgGe = parseread1;\n/* 2.5.198.65 */\nvar parse_PtgGt = parseread1;\n/* 2.5.198.67 */\nvar parse_PtgIsect = parseread1;\n/* 2.5.198.68 */\nvar parse_PtgLe = parseread1;\n/* 2.5.198.69 */\nvar parse_PtgLt = parseread1;\n/* 2.5.198.74 */\nvar parse_PtgMissArg = parseread1;\n/* 2.5.198.75 */\nvar parse_PtgMul = parseread1;\n/* 2.5.198.78 */\nvar parse_PtgNe = parseread1;\n/* 2.5.198.80 */\nvar parse_PtgParen = parseread1;\n/* 2.5.198.81 */\nvar parse_PtgPercent = parseread1;\n/* 2.5.198.82 */\nvar parse_PtgPower = parseread1;\n/* 2.5.198.83 */\nvar parse_PtgRange = parseread1;\n/* 2.5.198.90 */\nvar parse_PtgSub = parseread1;\n/* 2.5.198.93 */\nvar parse_PtgUminus = parseread1;\n/* 2.5.198.94 */\nvar parse_PtgUnion = parseread1;\n/* 2.5.198.95 */\nvar parse_PtgUplus = parseread1;\n\n/* 2.5.198.71 */\nvar parse_PtgMemErr = parsenoop;\n/* 2.5.198.73 */\nvar parse_PtgMemNoMem = parsenoop;\n/* 2.5.198.87 */\nvar parse_PtgRefErr3d = parsenoop;\n/* 2.5.198.92 */\nvar parse_PtgTbl = parsenoop;\n\n/* 2.5.198.25 */\nvar PtgTypes = {\n\t0x01: { n:'PtgExp', f:parse_PtgExp },\n\t0x02: { n:'PtgTbl', f:parse_PtgTbl },\n\t0x03: { n:'PtgAdd', f:parse_PtgAdd },\n\t0x04: { n:'PtgSub', f:parse_PtgSub },\n\t0x05: { n:'PtgMul', f:parse_PtgMul },\n\t0x06: { n:'PtgDiv', f:parse_PtgDiv },\n\t0x07: { n:'PtgPower', f:parse_PtgPower },\n\t0x08: { n:'PtgConcat', f:parse_PtgConcat },\n\t0x09: { n:'PtgLt', f:parse_PtgLt },\n\t0x0A: { n:'PtgLe', f:parse_PtgLe },\n\t0x0B: { n:'PtgEq', f:parse_PtgEq },\n\t0x0C: { n:'PtgGe', f:parse_PtgGe },\n\t0x0D: { n:'PtgGt', f:parse_PtgGt },\n\t0x0E: { n:'PtgNe', f:parse_PtgNe },\n\t0x0F: { n:'PtgIsect', f:parse_PtgIsect },\n\t0x10: { n:'PtgUnion', f:parse_PtgUnion },\n\t0x11: { n:'PtgRange', f:parse_PtgRange },\n\t0x12: { n:'PtgUplus', f:parse_PtgUplus },\n\t0x13: { n:'PtgUminus', f:parse_PtgUminus },\n\t0x14: { n:'PtgPercent', f:parse_PtgPercent },\n\t0x15: { n:'PtgParen', f:parse_PtgParen },\n\t0x16: { n:'PtgMissArg', f:parse_PtgMissArg },\n\t0x17: { n:'PtgStr', f:parse_PtgStr },\n\t0x1C: { n:'PtgErr', f:parse_PtgErr },\n\t0x1D: { n:'PtgBool', f:parse_PtgBool },\n\t0x1E: { n:'PtgInt', f:parse_PtgInt },\n\t0x1F: { n:'PtgNum', f:parse_PtgNum },\n\t0x20: { n:'PtgArray', f:parse_PtgArray },\n\t0x21: { n:'PtgFunc', f:parse_PtgFunc },\n\t0x22: { n:'PtgFuncVar', f:parse_PtgFuncVar },\n\t0x23: { n:'PtgName', f:parse_PtgName },\n\t0x24: { n:'PtgRef', f:parse_PtgRef },\n\t0x25: { n:'PtgArea', f:parse_PtgArea },\n\t0x26: { n:'PtgMemArea', f:parse_PtgMemArea },\n\t0x27: { n:'PtgMemErr', f:parse_PtgMemErr },\n\t0x28: { n:'PtgMemNoMem', f:parse_PtgMemNoMem },\n\t0x29: { n:'PtgMemFunc', f:parse_PtgMemFunc },\n\t0x2A: { n:'PtgRefErr', f:parse_PtgRefErr },\n\t0x2B: { n:'PtgAreaErr', f:parse_PtgAreaErr },\n\t0x2C: { n:'PtgRefN', f:parse_PtgRefN },\n\t0x2D: { n:'PtgAreaN', f:parse_PtgAreaN },\n\t0x39: { n:'PtgNameX', f:parse_PtgNameX },\n\t0x3A: { n:'PtgRef3d', f:parse_PtgRef3d },\n\t0x3B: { n:'PtgArea3d', f:parse_PtgArea3d },\n\t0x3C: { n:'PtgRefErr3d', f:parse_PtgRefErr3d },\n\t0x3D: { n:'PtgAreaErr3d', f:parse_PtgAreaErr3d },\n\t0xFF: {}\n};\n/* These are duplicated in the PtgTypes table */\nvar PtgDupes = {\n\t0x40: 0x20, 0x60: 0x20,\n\t0x41: 0x21, 0x61: 0x21,\n\t0x42: 0x22, 0x62: 0x22,\n\t0x43: 0x23, 0x63: 0x23,\n\t0x44: 0x24, 0x64: 0x24,\n\t0x45: 0x25, 0x65: 0x25,\n\t0x46: 0x26, 0x66: 0x26,\n\t0x47: 0x27, 0x67: 0x27,\n\t0x48: 0x28, 0x68: 0x28,\n\t0x49: 0x29, 0x69: 0x29,\n\t0x4A: 0x2A, 0x6A: 0x2A,\n\t0x4B: 0x2B, 0x6B: 0x2B,\n\t0x4C: 0x2C, 0x6C: 0x2C,\n\t0x4D: 0x2D, 0x6D: 0x2D,\n\t0x59: 0x39, 0x79: 0x39,\n\t0x5A: 0x3A, 0x7A: 0x3A,\n\t0x5B: 0x3B, 0x7B: 0x3B,\n\t0x5C: 0x3C, 0x7C: 0x3C,\n\t0x5D: 0x3D, 0x7D: 0x3D\n};\n(function(){for(var y in PtgDupes) PtgTypes[y] = PtgTypes[PtgDupes[y]];})();\n\nvar Ptg18 = {};\nvar Ptg19 = {\n\t0x01: { n:'PtgAttrSemi', f:parse_PtgAttrSemi },\n\t0x02: { n:'PtgAttrIf', f:parse_PtgAttrIf },\n\t0x04: { n:'PtgAttrChoose', f:parse_PtgAttrChoose },\n\t0x08: { n:'PtgAttrGoto', f:parse_PtgAttrGoto },\n\t0x10: { n:'PtgAttrSum', f:parse_PtgAttrSum },\n\t0x20: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\n\t0x40: { n:'PtgAttrSpace', f:parse_PtgAttrSpace },\n\t0x41: { n:'PtgAttrSpaceSemi', f:parse_PtgAttrSpaceSemi },\n\t0xFF: {}\n};\n\n/* 2.4.127 TODO */\nfunction parse_Formula(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 6);\n\tvar val = parse_FormulaValue(blob,8);\n\tvar flags = blob.read_shift(1);\n\tblob.read_shift(1);\n\tvar chn = blob.read_shift(4);\n\tvar cbf = \"\";\n\tif(opts.biff === 5) blob.l += length-20;\n\telse cbf = parse_XLSCellParsedFormula(blob, length-20, opts);\n\treturn {cell:cell, val:val[0], formula:cbf, shared: (flags >> 3) & 1, tt:val[1]};\n}\n\n/* 2.5.133 TODO: how to emit empty strings? */\nfunction parse_FormulaValue(blob) {\n\tvar b;\n\tif(__readUInt16LE(blob,blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob),'n'];\n\tswitch(blob[blob.l]) {\n\t\tcase 0x00: blob.l += 8; return [\"String\", 's'];\n\t\tcase 0x01: b = blob[blob.l+2] === 0x1; blob.l += 8; return [b,'b'];\n\t\tcase 0x02: b = blob[blob.l+2]; blob.l += 8; return [b,'e'];\n\t\tcase 0x03: blob.l += 8; return [\"\",'s'];\n\t}\n}\n\n/* 2.5.198.103 */\nfunction parse_RgbExtra(blob, length, rgce, opts) {\n\tif(opts.biff < 8) return parsenoop(blob, length);\n\tvar target = blob.l + length;\n\tvar o = [];\n\tfor(var i = 0; i !== rgce.length; ++i) {\n\t\tswitch(rgce[i][0]) {\n\t\t\tcase 'PtgArray': /* PtgArray -> PtgExtraArray */\n\t\t\t\trgce[i][1] = parse_PtgExtraArray(blob);\n\t\t\t\to.push(rgce[i][1]);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgMemArea': /* PtgMemArea -> PtgExtraMem */\n\t\t\t\trgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1]);\n\t\t\t\to.push(rgce[i][2]);\n\t\t\t\tbreak;\n\t\t\tdefault: break;\n\t\t}\n\t}\n\tlength = target - blob.l;\n\tif(length !== 0) o.push(parsenoop(blob, length));\n\treturn o;\n}\n\n/* 2.5.198.21 */\nfunction parse_NameParsedFormula(blob, length, opts, cce) {\n\tvar target = blob.l + length;\n\tvar rgce = parse_Rgce(blob, cce);\n\tvar rgcb;\n\tif(target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* 2.5.198.3 TODO */\nfunction parse_XLSCellParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar rgcb, cce = blob.read_shift(2); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce);\n\tif(length !== cce + 2) rgcb = parse_RgbExtra(blob, length - cce - 2, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* 2.5.198.118 TODO */\nfunction parse_SharedParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar rgcb, cce = blob.read_shift(2); // length of rgce\n\tvar rgce = parse_Rgce(blob, cce);\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tif(length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* 2.5.198.1 TODO */\nfunction parse_ArrayParsedFormula(blob, length, opts, ref) {\n\tvar target = blob.l + length;\n\tvar rgcb, cce = blob.read_shift(2); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce);\n\tif(length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* 2.5.198.104 */\nfunction parse_Rgce(blob, length) {\n\tvar target = blob.l + length;\n\tvar R, id, ptgs = [];\n\twhile(target != blob.l) {\n\t\tlength = target - blob.l;\n\t\tid = blob[blob.l];\n\t\tR = PtgTypes[id];\n\t\t//console.log(\"ptg\", id, R)\n\t\tif(id === 0x18 || id === 0x19) {\n\t\t\tid = blob[blob.l + 1];\n\t\t\tR = (id === 0x18 ? Ptg18 : Ptg19)[id];\n\t\t}\n\t\tif(!R || !R.f) { ptgs.push(parsenoop(blob, length)); }\n\t\telse { ptgs.push([R.n, R.f(blob, length)]); }\n\t}\n\treturn ptgs;\n}\n\nfunction mapper(x) { return x.map(function f2(y) { return y[1];}).join(\",\");}\n\n/* 2.2.2 + Magic TODO */\nfunction stringify_formula(formula, range, cell, supbooks, opts) {\n\tif(opts !== undefined && opts.biff === 5) return \"BIFF5??\";\n\tvar _range = range !== undefined ? range : {s:{c:0, r:0}};\n\tvar stack = [], e1, e2, type, c, ixti, nameidx, r;\n\tif(!formula[0] || !formula[0][0]) return \"\";\n\t//console.log(\"--\",cell,formula[0])\n\tfor(var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n\t\tvar f = formula[0][ff];\n\t\t//console.log(\"++\",f, stack)\n\t\tswitch(f[0]) {\n\t\t/* 2.2.2.1 Unary Operator Tokens */\n\t\t\t/* 2.5.198.93 */\n\t\t\tcase 'PtgUminus': stack.push(\"-\" + stack.pop()); break;\n\t\t\t/* 2.5.198.95 */\n\t\t\tcase 'PtgUplus': stack.push(\"+\" + stack.pop()); break;\n\t\t\t/* 2.5.198.81 */\n\t\t\tcase 'PtgPercent': stack.push(stack.pop() + \"%\"); break;\n\n\t\t/* 2.2.2.1 Binary Value Operator Token */\n\t\t\t/* 2.5.198.26 */\n\t\t\tcase 'PtgAdd':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\"+\"+e1);\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.90 */\n\t\t\tcase 'PtgSub':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\"-\"+e1);\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.75 */\n\t\t\tcase 'PtgMul':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\"*\"+e1);\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.45 */\n\t\t\tcase 'PtgDiv':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\"/\"+e1);\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.82 */\n\t\t\tcase 'PtgPower':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\"^\"+e1);\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.43 */\n\t\t\tcase 'PtgConcat':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\"&\"+e1);\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.69 */\n\t\t\tcase 'PtgLt':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\"<\"+e1);\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.68 */\n\t\t\tcase 'PtgLe':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\"<=\"+e1);\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.56 */\n\t\t\tcase 'PtgEq':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\"=\"+e1);\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.64 */\n\t\t\tcase 'PtgGe':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\">=\"+e1);\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.65 */\n\t\t\tcase 'PtgGt':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\">\"+e1);\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.78 */\n\t\t\tcase 'PtgNe':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\"<>\"+e1);\n\t\t\t\tbreak;\n\n\t\t/* 2.2.2.1 Binary Reference Operator Token */\n\t\t\t/* 2.5.198.67 */\n\t\t\tcase 'PtgIsect':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\" \"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgUnion':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\",\"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRange': break;\n\n\t\t/* 2.2.2.3 Control Tokens \"can be ignored\" */\n\t\t\t/* 2.5.198.34 */\n\t\t\tcase 'PtgAttrChoose': break;\n\t\t\t/* 2.5.198.35 */\n\t\t\tcase 'PtgAttrGoto': break;\n\t\t\t/* 2.5.198.36 */\n\t\t\tcase 'PtgAttrIf': break;\n\n\n\t\t\t/* 2.5.198.84 */\n\t\t\tcase 'PtgRef':\n\t\t\t\ttype = f[1][0]; c = shift_cell_xls(decode_cell(encode_cell(f[1][1])), _range);\n\t\t\t\tstack.push(encode_cell(c));\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.88 */\n\t\t\tcase 'PtgRefN':\n\t\t\t\ttype = f[1][0]; c = shift_cell_xls(decode_cell(encode_cell(f[1][1])), cell);\n\t\t\t\tstack.push(encode_cell(c));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRef3d': // TODO: lots of stuff\n\t\t\t\ttype = f[1][0]; ixti = f[1][1]; c = shift_cell_xls(f[1][2], _range);\n\t\t\t\tstack.push(supbooks[1][ixti+1]+\"!\"+encode_cell(c));\n\t\t\t\tbreak;\n\n\t\t/* Function Call */\n\t\t\t/* 2.5.198.62 */\n\t\t\tcase 'PtgFunc':\n\t\t\t/* 2.5.198.63 */\n\t\t\tcase 'PtgFuncVar':\n\t\t\t\t/* f[1] = [argc, func] */\n\t\t\t\tvar argc = f[1][0], func = f[1][1];\n\t\t\t\tif(!argc) argc = 0;\n\t\t\t\tvar args = stack.slice(-argc);\n\t\t\t\tstack.length -= argc;\n\t\t\t\tif(func === 'User') func = args.shift();\n\t\t\t\tstack.push(func + \"(\" + args.join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\t/* 2.5.198.42 */\n\t\t\tcase 'PtgBool': stack.push(f[1] ? \"TRUE\" : \"FALSE\"); break;\n\t\t\t/* 2.5.198.66 */\n\t\t\tcase 'PtgInt': stack.push(f[1]); break;\n\t\t\t/* 2.5.198.79 TODO: precision? */\n\t\t\tcase 'PtgNum': stack.push(String(f[1])); break;\n\t\t\t/* 2.5.198.89 */\n\t\t\tcase 'PtgStr': stack.push('\"' + f[1] + '\"'); break;\n\t\t\t/* 2.5.198.57 */\n\t\t\tcase 'PtgErr': stack.push(f[1]); break;\n\t\t\t/* 2.5.198.27 TODO: fixed points */\n\t\t\tcase 'PtgArea':\n\t\t\t\ttype = f[1][0]; r = shift_range_xls(f[1][1], _range);\n\t\t\t\tstack.push(encode_range(r));\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.28 */\n\t\t\tcase 'PtgArea3d': // TODO: lots of stuff\n\t\t\t\ttype = f[1][0]; ixti = f[1][1]; r = f[1][2];\n\t\t\t\tstack.push(supbooks[1][ixti+1]+\"!\"+encode_range(r));\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.41 */\n\t\t\tcase 'PtgAttrSum':\n\t\t\t\tstack.push(\"SUM(\" + stack.pop() + \")\");\n\t\t\t\tbreak;\n\n\t\t/* Expression Prefixes */\n\t\t\t/* 2.5.198.37 */\n\t\t\tcase 'PtgAttrSemi': break;\n\n\t\t\t/* 2.5.97.60 TODO: do something different for revisions */\n\t\t\tcase 'PtgName':\n\t\t\t\t/* f[1] = type, 0, nameindex */\n\t\t\t\tnameidx = f[1][2];\n\t\t\t\tvar lbl = supbooks[0][nameidx];\n\t\t\t\tvar name = lbl.Name;\n\t\t\t\tif(name in XLSXFutureFunctions) name = XLSXFutureFunctions[name];\n\t\t\t\tstack.push(name);\n\t\t\t\tbreak;\n\n\t\t\t/* 2.5.97.61 TODO: do something different for revisions */\n\t\t\tcase 'PtgNameX':\n\t\t\t\t/* f[1] = type, ixti, nameindex */\n\t\t\t\tvar bookidx = f[1][1]; nameidx = f[1][2]; var externbook;\n\t\t\t\t/* TODO: Properly handle missing values */\n\t\t\t\tif(supbooks[bookidx+1]) externbook = supbooks[bookidx+1][nameidx];\n\t\t\t\telse if(supbooks[bookidx-1]) externbook = supbooks[bookidx-1][nameidx];\n\t\t\t\tif(!externbook) externbook = {body: \"??NAMEX??\"};\n\t\t\t\tstack.push(externbook.body);\n\t\t\t\tbreak;\n\n\t\t/* 2.2.2.4 Display Tokens */\n\t\t\t/* 2.5.198.80 */\n\t\t\tcase 'PtgParen': stack.push('(' + stack.pop() + ')'); break;\n\n\t\t\t/* 2.5.198.86 */\n\t\t\tcase 'PtgRefErr': stack.push('#REF!'); break;\n\n\t\t/* */\n\t\t\t/* 2.5.198.58 TODO */\n\t\t\tcase 'PtgExp':\n\t\t\t\tc = {c:f[1][1],r:f[1][0]};\n\t\t\t\tvar q = {c: cell.c, r:cell.r};\n\t\t\t\tif(supbooks.sharedf[encode_cell(c)]) {\n\t\t\t\t\tvar parsedf = (supbooks.sharedf[encode_cell(c)]);\n\t\t\t\t\tstack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar fnd = false;\n\t\t\t\t\tfor(e1=0;e1!=supbooks.arrayf.length; ++e1) {\n\t\t\t\t\t\t/* TODO: should be something like range_has */\n\t\t\t\t\t\te2 = supbooks.arrayf[e1];\n\t\t\t\t\t\tif(c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n\t\t\t\t\t\tif(c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n\t\t\t\t\t\tstack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n\t\t\t\t\t}\n\t\t\t\t\tif(!fnd) stack.push(f[1]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t/* 2.5.198.32 TODO */\n\t\t\tcase 'PtgArray':\n\t\t\t\tstack.push(\"{\" + f[1].map(mapper).join(\";\") + \"}\");\n\t\t\t\tbreak;\n\n\t\t/* 2.2.2.5 Mem Tokens */\n\t\t\t/* 2.5.198.70 TODO: confirm this is a non-display */\n\t\t\tcase 'PtgMemArea':\n\t\t\t\t//stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\t/* 2.5.198.38 TODO */\n\t\t\tcase 'PtgAttrSpace': break;\n\n\t\t\t/* 2.5.198.92 TODO */\n\t\t\tcase 'PtgTbl': break;\n\n\t\t\t/* 2.5.198.71 */\n\t\t\tcase 'PtgMemErr': break;\n\n\t\t\t/* 2.5.198.74 */\n\t\t\tcase 'PtgMissArg':\n\t\t\t\tstack.push(\"\");\n\t\t\t\tbreak;\n\n\t\t\t/* 2.5.198.29 TODO */\n\t\t\tcase 'PtgAreaErr': break;\n\n\t\t\t/* 2.5.198.31 TODO */\n\t\t\tcase 'PtgAreaN': stack.push(\"\"); break;\n\n\t\t\t/* 2.5.198.87 TODO */\n\t\t\tcase 'PtgRefErr3d': break;\n\n\t\t\t/* 2.5.198.72 TODO */\n\t\t\tcase 'PtgMemFunc': break;\n\n\t\t\tdefault: throw 'Unrecognized Formula Token: ' + f;\n\t\t}\n\t\t//console.log(\"::\",f, stack)\n\t}\n\t//console.log(\"--\",stack);\n\treturn stack[0];\n}\n\n/* [MS-XLSB] 2.5.97.4 CellParsedFormula TODO: use similar logic to js-xls */\nfunction parse_XLSBCellParsedFormula(data, length) {\n\tvar cce = data.read_shift(4);\n\treturn parsenoop(data, length-4);\n}\n/* [MS-XLS] 2.5.198.44 */\nvar PtgDataType = {\n\t0x1: \"REFERENCE\", // reference to range\n\t0x2: \"VALUE\", // single value\n\t0x3: \"ARRAY\" // array of values\n};\n\n/* [MS-XLS] 2.5.198.4 */\nvar Cetab = {\n\t0x0000: 'BEEP',\n\t0x0001: 'OPEN',\n\t0x0002: 'OPEN.LINKS',\n\t0x0003: 'CLOSE.ALL',\n\t0x0004: 'SAVE',\n\t0x0005: 'SAVE.AS',\n\t0x0006: 'FILE.DELETE',\n\t0x0007: 'PAGE.SETUP',\n\t0x0008: 'PRINT',\n\t0x0009: 'PRINTER.SETUP',\n\t0x000A: 'QUIT',\n\t0x000B: 'NEW.WINDOW',\n\t0x000C: 'ARRANGE.ALL',\n\t0x000D: 'WINDOW.SIZE',\n\t0x000E: 'WINDOW.MOVE',\n\t0x000F: 'FULL',\n\t0x0010: 'CLOSE',\n\t0x0011: 'RUN',\n\t0x0016: 'SET.PRINT.AREA',\n\t0x0017: 'SET.PRINT.TITLES',\n\t0x0018: 'SET.PAGE.BREAK',\n\t0x0019: 'REMOVE.PAGE.BREAK',\n\t0x001A: 'FONT',\n\t0x001B: 'DISPLAY',\n\t0x001C: 'PROTECT.DOCUMENT',\n\t0x001D: 'PRECISION',\n\t0x001E: 'A1.R1C1',\n\t0x001F: 'CALCULATE.NOW',\n\t0x0020: 'CALCULATION',\n\t0x0022: 'DATA.FIND',\n\t0x0023: 'EXTRACT',\n\t0x0024: 'DATA.DELETE',\n\t0x0025: 'SET.DATABASE',\n\t0x0026: 'SET.CRITERIA',\n\t0x0027: 'SORT',\n\t0x0028: 'DATA.SERIES',\n\t0x0029: 'TABLE',\n\t0x002A: 'FORMAT.NUMBER',\n\t0x002B: 'ALIGNMENT',\n\t0x002C: 'STYLE',\n\t0x002D: 'BORDER',\n\t0x002E: 'CELL.PROTECTION',\n\t0x002F: 'COLUMN.WIDTH',\n\t0x0030: 'UNDO',\n\t0x0031: 'CUT',\n\t0x0032: 'COPY',\n\t0x0033: 'PASTE',\n\t0x0034: 'CLEAR',\n\t0x0035: 'PASTE.SPECIAL',\n\t0x0036: 'EDIT.DELETE',\n\t0x0037: 'INSERT',\n\t0x0038: 'FILL.RIGHT',\n\t0x0039: 'FILL.DOWN',\n\t0x003D: 'DEFINE.NAME',\n\t0x003E: 'CREATE.NAMES',\n\t0x003F: 'FORMULA.GOTO',\n\t0x0040: 'FORMULA.FIND',\n\t0x0041: 'SELECT.LAST.CELL',\n\t0x0042: 'SHOW.ACTIVE.CELL',\n\t0x0043: 'GALLERY.AREA',\n\t0x0044: 'GALLERY.BAR',\n\t0x0045: 'GALLERY.COLUMN',\n\t0x0046: 'GALLERY.LINE',\n\t0x0047: 'GALLERY.PIE',\n\t0x0048: 'GALLERY.SCATTER',\n\t0x0049: 'COMBINATION',\n\t0x004A: 'PREFERRED',\n\t0x004B: 'ADD.OVERLAY',\n\t0x004C: 'GRIDLINES',\n\t0x004D: 'SET.PREFERRED',\n\t0x004E: 'AXES',\n\t0x004F: 'LEGEND',\n\t0x0050: 'ATTACH.TEXT',\n\t0x0051: 'ADD.ARROW',\n\t0x0052: 'SELECT.CHART',\n\t0x0053: 'SELECT.PLOT.AREA',\n\t0x0054: 'PATTERNS',\n\t0x0055: 'MAIN.CHART',\n\t0x0056: 'OVERLAY',\n\t0x0057: 'SCALE',\n\t0x0058: 'FORMAT.LEGEND',\n\t0x0059: 'FORMAT.TEXT',\n\t0x005A: 'EDIT.REPEAT',\n\t0x005B: 'PARSE',\n\t0x005C: 'JUSTIFY',\n\t0x005D: 'HIDE',\n\t0x005E: 'UNHIDE',\n\t0x005F: 'WORKSPACE',\n\t0x0060: 'FORMULA',\n\t0x0061: 'FORMULA.FILL',\n\t0x0062: 'FORMULA.ARRAY',\n\t0x0063: 'DATA.FIND.NEXT',\n\t0x0064: 'DATA.FIND.PREV',\n\t0x0065: 'FORMULA.FIND.NEXT',\n\t0x0066: 'FORMULA.FIND.PREV',\n\t0x0067: 'ACTIVATE',\n\t0x0068: 'ACTIVATE.NEXT',\n\t0x0069: 'ACTIVATE.PREV',\n\t0x006A: 'UNLOCKED.NEXT',\n\t0x006B: 'UNLOCKED.PREV',\n\t0x006C: 'COPY.PICTURE',\n\t0x006D: 'SELECT',\n\t0x006E: 'DELETE.NAME',\n\t0x006F: 'DELETE.FORMAT',\n\t0x0070: 'VLINE',\n\t0x0071: 'HLINE',\n\t0x0072: 'VPAGE',\n\t0x0073: 'HPAGE',\n\t0x0074: 'VSCROLL',\n\t0x0075: 'HSCROLL',\n\t0x0076: 'ALERT',\n\t0x0077: 'NEW',\n\t0x0078: 'CANCEL.COPY',\n\t0x0079: 'SHOW.CLIPBOARD',\n\t0x007A: 'MESSAGE',\n\t0x007C: 'PASTE.LINK',\n\t0x007D: 'APP.ACTIVATE',\n\t0x007E: 'DELETE.ARROW',\n\t0x007F: 'ROW.HEIGHT',\n\t0x0080: 'FORMAT.MOVE',\n\t0x0081: 'FORMAT.SIZE',\n\t0x0082: 'FORMULA.REPLACE',\n\t0x0083: 'SEND.KEYS',\n\t0x0084: 'SELECT.SPECIAL',\n\t0x0085: 'APPLY.NAMES',\n\t0x0086: 'REPLACE.FONT',\n\t0x0087: 'FREEZE.PANES',\n\t0x0088: 'SHOW.INFO',\n\t0x0089: 'SPLIT',\n\t0x008A: 'ON.WINDOW',\n\t0x008B: 'ON.DATA',\n\t0x008C: 'DISABLE.INPUT',\n\t0x008E: 'OUTLINE',\n\t0x008F: 'LIST.NAMES',\n\t0x0090: 'FILE.CLOSE',\n\t0x0091: 'SAVE.WORKBOOK',\n\t0x0092: 'DATA.FORM',\n\t0x0093: 'COPY.CHART',\n\t0x0094: 'ON.TIME',\n\t0x0095: 'WAIT',\n\t0x0096: 'FORMAT.FONT',\n\t0x0097: 'FILL.UP',\n\t0x0098: 'FILL.LEFT',\n\t0x0099: 'DELETE.OVERLAY',\n\t0x009B: 'SHORT.MENUS',\n\t0x009F: 'SET.UPDATE.STATUS',\n\t0x00A1: 'COLOR.PALETTE',\n\t0x00A2: 'DELETE.STYLE',\n\t0x00A3: 'WINDOW.RESTORE',\n\t0x00A4: 'WINDOW.MAXIMIZE',\n\t0x00A6: 'CHANGE.LINK',\n\t0x00A7: 'CALCULATE.DOCUMENT',\n\t0x00A8: 'ON.KEY',\n\t0x00A9: 'APP.RESTORE',\n\t0x00AA: 'APP.MOVE',\n\t0x00AB: 'APP.SIZE',\n\t0x00AC: 'APP.MINIMIZE',\n\t0x00AD: 'APP.MAXIMIZE',\n\t0x00AE: 'BRING.TO.FRONT',\n\t0x00AF: 'SEND.TO.BACK',\n\t0x00B9: 'MAIN.CHART.TYPE',\n\t0x00BA: 'OVERLAY.CHART.TYPE',\n\t0x00BB: 'SELECT.END',\n\t0x00BC: 'OPEN.MAIL',\n\t0x00BD: 'SEND.MAIL',\n\t0x00BE: 'STANDARD.FONT',\n\t0x00BF: 'CONSOLIDATE',\n\t0x00C0: 'SORT.SPECIAL',\n\t0x00C1: 'GALLERY.3D.AREA',\n\t0x00C2: 'GALLERY.3D.COLUMN',\n\t0x00C3: 'GALLERY.3D.LINE',\n\t0x00C4: 'GALLERY.3D.PIE',\n\t0x00C5: 'VIEW.3D',\n\t0x00C6: 'GOAL.SEEK',\n\t0x00C7: 'WORKGROUP',\n\t0x00C8: 'FILL.GROUP',\n\t0x00C9: 'UPDATE.LINK',\n\t0x00CA: 'PROMOTE',\n\t0x00CB: 'DEMOTE',\n\t0x00CC: 'SHOW.DETAIL',\n\t0x00CE: 'UNGROUP',\n\t0x00CF: 'OBJECT.PROPERTIES',\n\t0x00D0: 'SAVE.NEW.OBJECT',\n\t0x00D1: 'SHARE',\n\t0x00D2: 'SHARE.NAME',\n\t0x00D3: 'DUPLICATE',\n\t0x00D4: 'APPLY.STYLE',\n\t0x00D5: 'ASSIGN.TO.OBJECT',\n\t0x00D6: 'OBJECT.PROTECTION',\n\t0x00D7: 'HIDE.OBJECT',\n\t0x00D8: 'SET.EXTRACT',\n\t0x00D9: 'CREATE.PUBLISHER',\n\t0x00DA: 'SUBSCRIBE.TO',\n\t0x00DB: 'ATTRIBUTES',\n\t0x00DC: 'SHOW.TOOLBAR',\n\t0x00DE: 'PRINT.PREVIEW',\n\t0x00DF: 'EDIT.COLOR',\n\t0x00E0: 'SHOW.LEVELS',\n\t0x00E1: 'FORMAT.MAIN',\n\t0x00E2: 'FORMAT.OVERLAY',\n\t0x00E3: 'ON.RECALC',\n\t0x00E4: 'EDIT.SERIES',\n\t0x00E5: 'DEFINE.STYLE',\n\t0x00F0: 'LINE.PRINT',\n\t0x00F3: 'ENTER.DATA',\n\t0x00F9: 'GALLERY.RADAR',\n\t0x00FA: 'MERGE.STYLES',\n\t0x00FB: 'EDITION.OPTIONS',\n\t0x00FC: 'PASTE.PICTURE',\n\t0x00FD: 'PASTE.PICTURE.LINK',\n\t0x00FE: 'SPELLING',\n\t0x0100: 'ZOOM',\n\t0x0103: 'INSERT.OBJECT',\n\t0x0104: 'WINDOW.MINIMIZE',\n\t0x0109: 'SOUND.NOTE',\n\t0x010A: 'SOUND.PLAY',\n\t0x010B: 'FORMAT.SHAPE',\n\t0x010C: 'EXTEND.POLYGON',\n\t0x010D: 'FORMAT.AUTO',\n\t0x0110: 'GALLERY.3D.BAR',\n\t0x0111: 'GALLERY.3D.SURFACE',\n\t0x0112: 'FILL.AUTO',\n\t0x0114: 'CUSTOMIZE.TOOLBAR',\n\t0x0115: 'ADD.TOOL',\n\t0x0116: 'EDIT.OBJECT',\n\t0x0117: 'ON.DOUBLECLICK',\n\t0x0118: 'ON.ENTRY',\n\t0x0119: 'WORKBOOK.ADD',\n\t0x011A: 'WORKBOOK.MOVE',\n\t0x011B: 'WORKBOOK.COPY',\n\t0x011C: 'WORKBOOK.OPTIONS',\n\t0x011D: 'SAVE.WORKSPACE',\n\t0x0120: 'CHART.WIZARD',\n\t0x0121: 'DELETE.TOOL',\n\t0x0122: 'MOVE.TOOL',\n\t0x0123: 'WORKBOOK.SELECT',\n\t0x0124: 'WORKBOOK.ACTIVATE',\n\t0x0125: 'ASSIGN.TO.TOOL',\n\t0x0127: 'COPY.TOOL',\n\t0x0128: 'RESET.TOOL',\n\t0x0129: 'CONSTRAIN.NUMERIC',\n\t0x012A: 'PASTE.TOOL',\n\t0x012E: 'WORKBOOK.NEW',\n\t0x0131: 'SCENARIO.CELLS',\n\t0x0132: 'SCENARIO.DELETE',\n\t0x0133: 'SCENARIO.ADD',\n\t0x0134: 'SCENARIO.EDIT',\n\t0x0135: 'SCENARIO.SHOW',\n\t0x0136: 'SCENARIO.SHOW.NEXT',\n\t0x0137: 'SCENARIO.SUMMARY',\n\t0x0138: 'PIVOT.TABLE.WIZARD',\n\t0x0139: 'PIVOT.FIELD.PROPERTIES',\n\t0x013A: 'PIVOT.FIELD',\n\t0x013B: 'PIVOT.ITEM',\n\t0x013C: 'PIVOT.ADD.FIELDS',\n\t0x013E: 'OPTIONS.CALCULATION',\n\t0x013F: 'OPTIONS.EDIT',\n\t0x0140: 'OPTIONS.VIEW',\n\t0x0141: 'ADDIN.MANAGER',\n\t0x0142: 'MENU.EDITOR',\n\t0x0143: 'ATTACH.TOOLBARS',\n\t0x0144: 'VBAActivate',\n\t0x0145: 'OPTIONS.CHART',\n\t0x0148: 'VBA.INSERT.FILE',\n\t0x014A: 'VBA.PROCEDURE.DEFINITION',\n\t0x0150: 'ROUTING.SLIP',\n\t0x0152: 'ROUTE.DOCUMENT',\n\t0x0153: 'MAIL.LOGON',\n\t0x0156: 'INSERT.PICTURE',\n\t0x0157: 'EDIT.TOOL',\n\t0x0158: 'GALLERY.DOUGHNUT',\n\t0x015E: 'CHART.TREND',\n\t0x0160: 'PIVOT.ITEM.PROPERTIES',\n\t0x0162: 'WORKBOOK.INSERT',\n\t0x0163: 'OPTIONS.TRANSITION',\n\t0x0164: 'OPTIONS.GENERAL',\n\t0x0172: 'FILTER.ADVANCED',\n\t0x0175: 'MAIL.ADD.MAILER',\n\t0x0176: 'MAIL.DELETE.MAILER',\n\t0x0177: 'MAIL.REPLY',\n\t0x0178: 'MAIL.REPLY.ALL',\n\t0x0179: 'MAIL.FORWARD',\n\t0x017A: 'MAIL.NEXT.LETTER',\n\t0x017B: 'DATA.LABEL',\n\t0x017C: 'INSERT.TITLE',\n\t0x017D: 'FONT.PROPERTIES',\n\t0x017E: 'MACRO.OPTIONS',\n\t0x017F: 'WORKBOOK.HIDE',\n\t0x0180: 'WORKBOOK.UNHIDE',\n\t0x0181: 'WORKBOOK.DELETE',\n\t0x0182: 'WORKBOOK.NAME',\n\t0x0184: 'GALLERY.CUSTOM',\n\t0x0186: 'ADD.CHART.AUTOFORMAT',\n\t0x0187: 'DELETE.CHART.AUTOFORMAT',\n\t0x0188: 'CHART.ADD.DATA',\n\t0x0189: 'AUTO.OUTLINE',\n\t0x018A: 'TAB.ORDER',\n\t0x018B: 'SHOW.DIALOG',\n\t0x018C: 'SELECT.ALL',\n\t0x018D: 'UNGROUP.SHEETS',\n\t0x018E: 'SUBTOTAL.CREATE',\n\t0x018F: 'SUBTOTAL.REMOVE',\n\t0x0190: 'RENAME.OBJECT',\n\t0x019C: 'WORKBOOK.SCROLL',\n\t0x019D: 'WORKBOOK.NEXT',\n\t0x019E: 'WORKBOOK.PREV',\n\t0x019F: 'WORKBOOK.TAB.SPLIT',\n\t0x01A0: 'FULL.SCREEN',\n\t0x01A1: 'WORKBOOK.PROTECT',\n\t0x01A4: 'SCROLLBAR.PROPERTIES',\n\t0x01A5: 'PIVOT.SHOW.PAGES',\n\t0x01A6: 'TEXT.TO.COLUMNS',\n\t0x01A7: 'FORMAT.CHARTTYPE',\n\t0x01A8: 'LINK.FORMAT',\n\t0x01A9: 'TRACER.DISPLAY',\n\t0x01AE: 'TRACER.NAVIGATE',\n\t0x01AF: 'TRACER.CLEAR',\n\t0x01B0: 'TRACER.ERROR',\n\t0x01B1: 'PIVOT.FIELD.GROUP',\n\t0x01B2: 'PIVOT.FIELD.UNGROUP',\n\t0x01B3: 'CHECKBOX.PROPERTIES',\n\t0x01B4: 'LABEL.PROPERTIES',\n\t0x01B5: 'LISTBOX.PROPERTIES',\n\t0x01B6: 'EDITBOX.PROPERTIES',\n\t0x01B7: 'PIVOT.REFRESH',\n\t0x01B8: 'LINK.COMBO',\n\t0x01B9: 'OPEN.TEXT',\n\t0x01BA: 'HIDE.DIALOG',\n\t0x01BB: 'SET.DIALOG.FOCUS',\n\t0x01BC: 'ENABLE.OBJECT',\n\t0x01BD: 'PUSHBUTTON.PROPERTIES',\n\t0x01BE: 'SET.DIALOG.DEFAULT',\n\t0x01BF: 'FILTER',\n\t0x01C0: 'FILTER.SHOW.ALL',\n\t0x01C1: 'CLEAR.OUTLINE',\n\t0x01C2: 'FUNCTION.WIZARD',\n\t0x01C3: 'ADD.LIST.ITEM',\n\t0x01C4: 'SET.LIST.ITEM',\n\t0x01C5: 'REMOVE.LIST.ITEM',\n\t0x01C6: 'SELECT.LIST.ITEM',\n\t0x01C7: 'SET.CONTROL.VALUE',\n\t0x01C8: 'SAVE.COPY.AS',\n\t0x01CA: 'OPTIONS.LISTS.ADD',\n\t0x01CB: 'OPTIONS.LISTS.DELETE',\n\t0x01CC: 'SERIES.AXES',\n\t0x01CD: 'SERIES.X',\n\t0x01CE: 'SERIES.Y',\n\t0x01CF: 'ERRORBAR.X',\n\t0x01D0: 'ERRORBAR.Y',\n\t0x01D1: 'FORMAT.CHART',\n\t0x01D2: 'SERIES.ORDER',\n\t0x01D3: 'MAIL.LOGOFF',\n\t0x01D4: 'CLEAR.ROUTING.SLIP',\n\t0x01D5: 'APP.ACTIVATE.MICROSOFT',\n\t0x01D6: 'MAIL.EDIT.MAILER',\n\t0x01D7: 'ON.SHEET',\n\t0x01D8: 'STANDARD.WIDTH',\n\t0x01D9: 'SCENARIO.MERGE',\n\t0x01DA: 'SUMMARY.INFO',\n\t0x01DB: 'FIND.FILE',\n\t0x01DC: 'ACTIVE.CELL.FONT',\n\t0x01DD: 'ENABLE.TIPWIZARD',\n\t0x01DE: 'VBA.MAKE.ADDIN',\n\t0x01E0: 'INSERTDATATABLE',\n\t0x01E1: 'WORKGROUP.OPTIONS',\n\t0x01E2: 'MAIL.SEND.MAILER',\n\t0x01E5: 'AUTOCORRECT',\n\t0x01E9: 'POST.DOCUMENT',\n\t0x01EB: 'PICKLIST',\n\t0x01ED: 'VIEW.SHOW',\n\t0x01EE: 'VIEW.DEFINE',\n\t0x01EF: 'VIEW.DELETE',\n\t0x01FD: 'SHEET.BACKGROUND',\n\t0x01FE: 'INSERT.MAP.OBJECT',\n\t0x01FF: 'OPTIONS.MENONO',\n\t0x0205: 'MSOCHECKS',\n\t0x0206: 'NORMAL',\n\t0x0207: 'LAYOUT',\n\t0x0208: 'RM.PRINT.AREA',\n\t0x0209: 'CLEAR.PRINT.AREA',\n\t0x020A: 'ADD.PRINT.AREA',\n\t0x020B: 'MOVE.BRK',\n\t0x0221: 'HIDECURR.NOTE',\n\t0x0222: 'HIDEALL.NOTES',\n\t0x0223: 'DELETE.NOTE',\n\t0x0224: 'TRAVERSE.NOTES',\n\t0x0225: 'ACTIVATE.NOTES',\n\t0x026C: 'PROTECT.REVISIONS',\n\t0x026D: 'UNPROTECT.REVISIONS',\n\t0x0287: 'OPTIONS.ME',\n\t0x028D: 'WEB.PUBLISH',\n\t0x029B: 'NEWWEBQUERY',\n\t0x02A1: 'PIVOT.TABLE.CHART',\n\t0x02F1: 'OPTIONS.SAVE',\n\t0x02F3: 'OPTIONS.SPELL',\n\t0x0328: 'HIDEALL.INKANNOTS'\n};\n\n/* [MS-XLS] 2.5.198.17 */\nvar Ftab = {\n\t0x0000: 'COUNT',\n\t0x0001: 'IF',\n\t0x0002: 'ISNA',\n\t0x0003: 'ISERROR',\n\t0x0004: 'SUM',\n\t0x0005: 'AVERAGE',\n\t0x0006: 'MIN',\n\t0x0007: 'MAX',\n\t0x0008: 'ROW',\n\t0x0009: 'COLUMN',\n\t0x000A: 'NA',\n\t0x000B: 'NPV',\n\t0x000C: 'STDEV',\n\t0x000D: 'DOLLAR',\n\t0x000E: 'FIXED',\n\t0x000F: 'SIN',\n\t0x0010: 'COS',\n\t0x0011: 'TAN',\n\t0x0012: 'ATAN',\n\t0x0013: 'PI',\n\t0x0014: 'SQRT',\n\t0x0015: 'EXP',\n\t0x0016: 'LN',\n\t0x0017: 'LOG10',\n\t0x0018: 'ABS',\n\t0x0019: 'INT',\n\t0x001A: 'SIGN',\n\t0x001B: 'ROUND',\n\t0x001C: 'LOOKUP',\n\t0x001D: 'INDEX',\n\t0x001E: 'REPT',\n\t0x001F: 'MID',\n\t0x0020: 'LEN',\n\t0x0021: 'VALUE',\n\t0x0022: 'TRUE',\n\t0x0023: 'FALSE',\n\t0x0024: 'AND',\n\t0x0025: 'OR',\n\t0x0026: 'NOT',\n\t0x0027: 'MOD',\n\t0x0028: 'DCOUNT',\n\t0x0029: 'DSUM',\n\t0x002A: 'DAVERAGE',\n\t0x002B: 'DMIN',\n\t0x002C: 'DMAX',\n\t0x002D: 'DSTDEV',\n\t0x002E: 'VAR',\n\t0x002F: 'DVAR',\n\t0x0030: 'TEXT',\n\t0x0031: 'LINEST',\n\t0x0032: 'TREND',\n\t0x0033: 'LOGEST',\n\t0x0034: 'GROWTH',\n\t0x0035: 'GOTO',\n\t0x0036: 'HALT',\n\t0x0037: 'RETURN',\n\t0x0038: 'PV',\n\t0x0039: 'FV',\n\t0x003A: 'NPER',\n\t0x003B: 'PMT',\n\t0x003C: 'RATE',\n\t0x003D: 'MIRR',\n\t0x003E: 'IRR',\n\t0x003F: 'RAND',\n\t0x0040: 'MATCH',\n\t0x0041: 'DATE',\n\t0x0042: 'TIME',\n\t0x0043: 'DAY',\n\t0x0044: 'MONTH',\n\t0x0045: 'YEAR',\n\t0x0046: 'WEEKDAY',\n\t0x0047: 'HOUR',\n\t0x0048: 'MINUTE',\n\t0x0049: 'SECOND',\n\t0x004A: 'NOW',\n\t0x004B: 'AREAS',\n\t0x004C: 'ROWS',\n\t0x004D: 'COLUMNS',\n\t0x004E: 'OFFSET',\n\t0x004F: 'ABSREF',\n\t0x0050: 'RELREF',\n\t0x0051: 'ARGUMENT',\n\t0x0052: 'SEARCH',\n\t0x0053: 'TRANSPOSE',\n\t0x0054: 'ERROR',\n\t0x0055: 'STEP',\n\t0x0056: 'TYPE',\n\t0x0057: 'ECHO',\n\t0x0058: 'SET.NAME',\n\t0x0059: 'CALLER',\n\t0x005A: 'DEREF',\n\t0x005B: 'WINDOWS',\n\t0x005C: 'SERIES',\n\t0x005D: 'DOCUMENTS',\n\t0x005E: 'ACTIVE.CELL',\n\t0x005F: 'SELECTION',\n\t0x0060: 'RESULT',\n\t0x0061: 'ATAN2',\n\t0x0062: 'ASIN',\n\t0x0063: 'ACOS',\n\t0x0064: 'CHOOSE',\n\t0x0065: 'HLOOKUP',\n\t0x0066: 'VLOOKUP',\n\t0x0067: 'LINKS',\n\t0x0068: 'INPUT',\n\t0x0069: 'ISREF',\n\t0x006A: 'GET.FORMULA',\n\t0x006B: 'GET.NAME',\n\t0x006C: 'SET.VALUE',\n\t0x006D: 'LOG',\n\t0x006E: 'EXEC',\n\t0x006F: 'CHAR',\n\t0x0070: 'LOWER',\n\t0x0071: 'UPPER',\n\t0x0072: 'PROPER',\n\t0x0073: 'LEFT',\n\t0x0074: 'RIGHT',\n\t0x0075: 'EXACT',\n\t0x0076: 'TRIM',\n\t0x0077: 'REPLACE',\n\t0x0078: 'SUBSTITUTE',\n\t0x0079: 'CODE',\n\t0x007A: 'NAMES',\n\t0x007B: 'DIRECTORY',\n\t0x007C: 'FIND',\n\t0x007D: 'CELL',\n\t0x007E: 'ISERR',\n\t0x007F: 'ISTEXT',\n\t0x0080: 'ISNUMBER',\n\t0x0081: 'ISBLANK',\n\t0x0082: 'T',\n\t0x0083: 'N',\n\t0x0084: 'FOPEN',\n\t0x0085: 'FCLOSE',\n\t0x0086: 'FSIZE',\n\t0x0087: 'FREADLN',\n\t0x0088: 'FREAD',\n\t0x0089: 'FWRITELN',\n\t0x008A: 'FWRITE',\n\t0x008B: 'FPOS',\n\t0x008C: 'DATEVALUE',\n\t0x008D: 'TIMEVALUE',\n\t0x008E: 'SLN',\n\t0x008F: 'SYD',\n\t0x0090: 'DDB',\n\t0x0091: 'GET.DEF',\n\t0x0092: 'REFTEXT',\n\t0x0093: 'TEXTREF',\n\t0x0094: 'INDIRECT',\n\t0x0095: 'REGISTER',\n\t0x0096: 'CALL',\n\t0x0097: 'ADD.BAR',\n\t0x0098: 'ADD.MENU',\n\t0x0099: 'ADD.COMMAND',\n\t0x009A: 'ENABLE.COMMAND',\n\t0x009B: 'CHECK.COMMAND',\n\t0x009C: 'RENAME.COMMAND',\n\t0x009D: 'SHOW.BAR',\n\t0x009E: 'DELETE.MENU',\n\t0x009F: 'DELETE.COMMAND',\n\t0x00A0: 'GET.CHART.ITEM',\n\t0x00A1: 'DIALOG.BOX',\n\t0x00A2: 'CLEAN',\n\t0x00A3: 'MDETERM',\n\t0x00A4: 'MINVERSE',\n\t0x00A5: 'MMULT',\n\t0x00A6: 'FILES',\n\t0x00A7: 'IPMT',\n\t0x00A8: 'PPMT',\n\t0x00A9: 'COUNTA',\n\t0x00AA: 'CANCEL.KEY',\n\t0x00AB: 'FOR',\n\t0x00AC: 'WHILE',\n\t0x00AD: 'BREAK',\n\t0x00AE: 'NEXT',\n\t0x00AF: 'INITIATE',\n\t0x00B0: 'REQUEST',\n\t0x00B1: 'POKE',\n\t0x00B2: 'EXECUTE',\n\t0x00B3: 'TERMINATE',\n\t0x00B4: 'RESTART',\n\t0x00B5: 'HELP',\n\t0x00B6: 'GET.BAR',\n\t0x00B7: 'PRODUCT',\n\t0x00B8: 'FACT',\n\t0x00B9: 'GET.CELL',\n\t0x00BA: 'GET.WORKSPACE',\n\t0x00BB: 'GET.WINDOW',\n\t0x00BC: 'GET.DOCUMENT',\n\t0x00BD: 'DPRODUCT',\n\t0x00BE: 'ISNONTEXT',\n\t0x00BF: 'GET.NOTE',\n\t0x00C0: 'NOTE',\n\t0x00C1: 'STDEVP',\n\t0x00C2: 'VARP',\n\t0x00C3: 'DSTDEVP',\n\t0x00C4: 'DVARP',\n\t0x00C5: 'TRUNC',\n\t0x00C6: 'ISLOGICAL',\n\t0x00C7: 'DCOUNTA',\n\t0x00C8: 'DELETE.BAR',\n\t0x00C9: 'UNREGISTER',\n\t0x00CC: 'USDOLLAR',\n\t0x00CD: 'FINDB',\n\t0x00CE: 'SEARCHB',\n\t0x00CF: 'REPLACEB',\n\t0x00D0: 'LEFTB',\n\t0x00D1: 'RIGHTB',\n\t0x00D2: 'MIDB',\n\t0x00D3: 'LENB',\n\t0x00D4: 'ROUNDUP',\n\t0x00D5: 'ROUNDDOWN',\n\t0x00D6: 'ASC',\n\t0x00D7: 'DBCS',\n\t0x00D8: 'RANK',\n\t0x00DB: 'ADDRESS',\n\t0x00DC: 'DAYS360',\n\t0x00DD: 'TODAY',\n\t0x00DE: 'VDB',\n\t0x00DF: 'ELSE',\n\t0x00E0: 'ELSE.IF',\n\t0x00E1: 'END.IF',\n\t0x00E2: 'FOR.CELL',\n\t0x00E3: 'MEDIAN',\n\t0x00E4: 'SUMPRODUCT',\n\t0x00E5: 'SINH',\n\t0x00E6: 'COSH',\n\t0x00E7: 'TANH',\n\t0x00E8: 'ASINH',\n\t0x00E9: 'ACOSH',\n\t0x00EA: 'ATANH',\n\t0x00EB: 'DGET',\n\t0x00EC: 'CREATE.OBJECT',\n\t0x00ED: 'VOLATILE',\n\t0x00EE: 'LAST.ERROR',\n\t0x00EF: 'CUSTOM.UNDO',\n\t0x00F0: 'CUSTOM.REPEAT',\n\t0x00F1: 'FORMULA.CONVERT',\n\t0x00F2: 'GET.LINK.INFO',\n\t0x00F3: 'TEXT.BOX',\n\t0x00F4: 'INFO',\n\t0x00F5: 'GROUP',\n\t0x00F6: 'GET.OBJECT',\n\t0x00F7: 'DB',\n\t0x00F8: 'PAUSE',\n\t0x00FB: 'RESUME',\n\t0x00FC: 'FREQUENCY',\n\t0x00FD: 'ADD.TOOLBAR',\n\t0x00FE: 'DELETE.TOOLBAR',\n\t0x00FF: 'User',\n\t0x0100: 'RESET.TOOLBAR',\n\t0x0101: 'EVALUATE',\n\t0x0102: 'GET.TOOLBAR',\n\t0x0103: 'GET.TOOL',\n\t0x0104: 'SPELLING.CHECK',\n\t0x0105: 'ERROR.TYPE',\n\t0x0106: 'APP.TITLE',\n\t0x0107: 'WINDOW.TITLE',\n\t0x0108: 'SAVE.TOOLBAR',\n\t0x0109: 'ENABLE.TOOL',\n\t0x010A: 'PRESS.TOOL',\n\t0x010B: 'REGISTER.ID',\n\t0x010C: 'GET.WORKBOOK',\n\t0x010D: 'AVEDEV',\n\t0x010E: 'BETADIST',\n\t0x010F: 'GAMMALN',\n\t0x0110: 'BETAINV',\n\t0x0111: 'BINOMDIST',\n\t0x0112: 'CHIDIST',\n\t0x0113: 'CHIINV',\n\t0x0114: 'COMBIN',\n\t0x0115: 'CONFIDENCE',\n\t0x0116: 'CRITBINOM',\n\t0x0117: 'EVEN',\n\t0x0118: 'EXPONDIST',\n\t0x0119: 'FDIST',\n\t0x011A: 'FINV',\n\t0x011B: 'FISHER',\n\t0x011C: 'FISHERINV',\n\t0x011D: 'FLOOR',\n\t0x011E: 'GAMMADIST',\n\t0x011F: 'GAMMAINV',\n\t0x0120: 'CEILING',\n\t0x0121: 'HYPGEOMDIST',\n\t0x0122: 'LOGNORMDIST',\n\t0x0123: 'LOGINV',\n\t0x0124: 'NEGBINOMDIST',\n\t0x0125: 'NORMDIST',\n\t0x0126: 'NORMSDIST',\n\t0x0127: 'NORMINV',\n\t0x0128: 'NORMSINV',\n\t0x0129: 'STANDARDIZE',\n\t0x012A: 'ODD',\n\t0x012B: 'PERMUT',\n\t0x012C: 'POISSON',\n\t0x012D: 'TDIST',\n\t0x012E: 'WEIBULL',\n\t0x012F: 'SUMXMY2',\n\t0x0130: 'SUMX2MY2',\n\t0x0131: 'SUMX2PY2',\n\t0x0132: 'CHITEST',\n\t0x0133: 'CORREL',\n\t0x0134: 'COVAR',\n\t0x0135: 'FORECAST',\n\t0x0136: 'FTEST',\n\t0x0137: 'INTERCEPT',\n\t0x0138: 'PEARSON',\n\t0x0139: 'RSQ',\n\t0x013A: 'STEYX',\n\t0x013B: 'SLOPE',\n\t0x013C: 'TTEST',\n\t0x013D: 'PROB',\n\t0x013E: 'DEVSQ',\n\t0x013F: 'GEOMEAN',\n\t0x0140: 'HARMEAN',\n\t0x0141: 'SUMSQ',\n\t0x0142: 'KURT',\n\t0x0143: 'SKEW',\n\t0x0144: 'ZTEST',\n\t0x0145: 'LARGE',\n\t0x0146: 'SMALL',\n\t0x0147: 'QUARTILE',\n\t0x0148: 'PERCENTILE',\n\t0x0149: 'PERCENTRANK',\n\t0x014A: 'MODE',\n\t0x014B: 'TRIMMEAN',\n\t0x014C: 'TINV',\n\t0x014E: 'MOVIE.COMMAND',\n\t0x014F: 'GET.MOVIE',\n\t0x0150: 'CONCATENATE',\n\t0x0151: 'POWER',\n\t0x0152: 'PIVOT.ADD.DATA',\n\t0x0153: 'GET.PIVOT.TABLE',\n\t0x0154: 'GET.PIVOT.FIELD',\n\t0x0155: 'GET.PIVOT.ITEM',\n\t0x0156: 'RADIANS',\n\t0x0157: 'DEGREES',\n\t0x0158: 'SUBTOTAL',\n\t0x0159: 'SUMIF',\n\t0x015A: 'COUNTIF',\n\t0x015B: 'COUNTBLANK',\n\t0x015C: 'SCENARIO.GET',\n\t0x015D: 'OPTIONS.LISTS.GET',\n\t0x015E: 'ISPMT',\n\t0x015F: 'DATEDIF',\n\t0x0160: 'DATESTRING',\n\t0x0161: 'NUMBERSTRING',\n\t0x0162: 'ROMAN',\n\t0x0163: 'OPEN.DIALOG',\n\t0x0164: 'SAVE.DIALOG',\n\t0x0165: 'VIEW.GET',\n\t0x0166: 'GETPIVOTDATA',\n\t0x0167: 'HYPERLINK',\n\t0x0168: 'PHONETIC',\n\t0x0169: 'AVERAGEA',\n\t0x016A: 'MAXA',\n\t0x016B: 'MINA',\n\t0x016C: 'STDEVPA',\n\t0x016D: 'VARPA',\n\t0x016E: 'STDEVA',\n\t0x016F: 'VARA',\n\t0x0170: 'BAHTTEXT',\n\t0x0171: 'THAIDAYOFWEEK',\n\t0x0172: 'THAIDIGIT',\n\t0x0173: 'THAIMONTHOFYEAR',\n\t0x0174: 'THAINUMSOUND',\n\t0x0175: 'THAINUMSTRING',\n\t0x0176: 'THAISTRINGLENGTH',\n\t0x0177: 'ISTHAIDIGIT',\n\t0x0178: 'ROUNDBAHTDOWN',\n\t0x0179: 'ROUNDBAHTUP',\n\t0x017A: 'THAIYEAR',\n\t0x017B: 'RTD'\n};\nvar FtabArgc = {\n\t0x0002: 1, /* ISNA */\n\t0x0003: 1, /* ISERROR */\n\t0x000F: 1, /* SIN */\n\t0x0010: 1, /* COS */\n\t0x0011: 1, /* TAN */\n\t0x0012: 1, /* ATAN */\n\t0x0014: 1, /* SQRT */\n\t0x0015: 1, /* EXP */\n\t0x0016: 1, /* LN */\n\t0x0017: 1, /* LOG10 */\n\t0x0018: 1, /* ABS */\n\t0x0019: 1, /* INT */\n\t0x001A: 1, /* SIGN */\n\t0x001B: 2, /* ROUND */\n\t0x001E: 2, /* REPT */\n\t0x001F: 3, /* MID */\n\t0x0020: 1, /* LEN */\n\t0x0021: 1, /* VALUE */\n\t0x0026: 1, /* NOT */\n\t0x0027: 2, /* MOD */\n\t0x0028: 3, /* DCOUNT */\n\t0x0029: 3, /* DSUM */\n\t0x002A: 3, /* DAVERAGE */\n\t0x002B: 3, /* DMIN */\n\t0x002C: 3, /* DMAX */\n\t0x002D: 3, /* DSTDEV */\n\t0x002F: 3, /* DVAR */\n\t0x0030: 2, /* TEXT */\n\t0x0035: 1, /* GOTO */\n\t0x003D: 3, /* MIRR */\n\t0x0041: 3, /* DATE */\n\t0x0042: 3, /* TIME */\n\t0x0043: 1, /* DAY */\n\t0x0044: 1, /* MONTH */\n\t0x0045: 1, /* YEAR */\n\t0x0047: 1, /* HOUR */\n\t0x0048: 1, /* MINUTE */\n\t0x0049: 1, /* SECOND */\n\t0x004B: 1, /* AREAS */\n\t0x004C: 1, /* ROWS */\n\t0x004D: 1, /* COLUMNS */\n\t0x004F: 2, /* ABSREF */\n\t0x0050: 2, /* RELREF */\n\t0x0053: 1, /* TRANSPOSE */\n\t0x0056: 1, /* TYPE */\n\t0x005A: 1, /* DEREF */\n\t0x0061: 2, /* ATAN2 */\n\t0x0062: 1, /* ASIN */\n\t0x0063: 1, /* ACOS */\n\t0x0069: 1, /* ISREF */\n\t0x006F: 1, /* CHAR */\n\t0x0070: 1, /* LOWER */\n\t0x0071: 1, /* UPPER */\n\t0x0072: 1, /* PROPER */\n\t0x0075: 2, /* EXACT */\n\t0x0076: 1, /* TRIM */\n\t0x0077: 4, /* REPLACE */\n\t0x0079: 1, /* CODE */\n\t0x007E: 1, /* ISERR */\n\t0x007F: 1, /* ISTEXT */\n\t0x0080: 1, /* ISNUMBER */\n\t0x0081: 1, /* ISBLANK */\n\t0x0082: 1, /* T */\n\t0x0083: 1, /* N */\n\t0x0085: 1, /* FCLOSE */\n\t0x0086: 1, /* FSIZE */\n\t0x0087: 1, /* FREADLN */\n\t0x0088: 2, /* FREAD */\n\t0x0089: 2, /* FWRITELN */\n\t0x008A: 2, /* FWRITE */\n\t0x008C: 1, /* DATEVALUE */\n\t0x008D: 1, /* TIMEVALUE */\n\t0x008E: 3, /* SLN */\n\t0x008F: 4, /* SYD */\n\t0x00A2: 1, /* CLEAN */\n\t0x00A3: 1, /* MDETERM */\n\t0x00A4: 1, /* MINVERSE */\n\t0x00A5: 2, /* MMULT */\n\t0x00AC: 1, /* WHILE */\n\t0x00AF: 2, /* INITIATE */\n\t0x00B0: 2, /* REQUEST */\n\t0x00B1: 3, /* POKE */\n\t0x00B2: 2, /* EXECUTE */\n\t0x00B3: 1, /* TERMINATE */\n\t0x00B8: 1, /* FACT */\n\t0x00BD: 3, /* DPRODUCT */\n\t0x00BE: 1, /* ISNONTEXT */\n\t0x00C3: 3, /* DSTDEVP */\n\t0x00C4: 3, /* DVARP */\n\t0x00C6: 1, /* ISLOGICAL */\n\t0x00C7: 3, /* DCOUNTA */\n\t0x00C9: 1, /* UNREGISTER */\n\t0x00CF: 4, /* REPLACEB */\n\t0x00D2: 3, /* MIDB */\n\t0x00D3: 1, /* LENB */\n\t0x00D4: 2, /* ROUNDUP */\n\t0x00D5: 2, /* ROUNDDOWN */\n\t0x00D6: 1, /* ASC */\n\t0x00D7: 1, /* DBCS */\n\t0x00E5: 1, /* SINH */\n\t0x00E6: 1, /* COSH */\n\t0x00E7: 1, /* TANH */\n\t0x00E8: 1, /* ASINH */\n\t0x00E9: 1, /* ACOSH */\n\t0x00EA: 1, /* ATANH */\n\t0x00EB: 3, /* DGET */\n\t0x00F4: 1, /* INFO */\n\t0x00FC: 2, /* FREQUENCY */\n\t0x0101: 1, /* EVALUATE */\n\t0x0105: 1, /* ERROR.TYPE */\n\t0x010F: 1, /* GAMMALN */\n\t0x0111: 4, /* BINOMDIST */\n\t0x0112: 2, /* CHIDIST */\n\t0x0113: 2, /* CHIINV */\n\t0x0114: 2, /* COMBIN */\n\t0x0115: 3, /* CONFIDENCE */\n\t0x0116: 3, /* CRITBINOM */\n\t0x0117: 1, /* EVEN */\n\t0x0118: 3, /* EXPONDIST */\n\t0x0119: 3, /* FDIST */\n\t0x011A: 3, /* FINV */\n\t0x011B: 1, /* FISHER */\n\t0x011C: 1, /* FISHERINV */\n\t0x011D: 2, /* FLOOR */\n\t0x011E: 4, /* GAMMADIST */\n\t0x011F: 3, /* GAMMAINV */\n\t0x0120: 2, /* CEILING */\n\t0x0121: 4, /* HYPGEOMDIST */\n\t0x0122: 3, /* LOGNORMDIST */\n\t0x0123: 3, /* LOGINV */\n\t0x0124: 3, /* NEGBINOMDIST */\n\t0x0125: 4, /* NORMDIST */\n\t0x0126: 1, /* NORMSDIST */\n\t0x0127: 3, /* NORMINV */\n\t0x0128: 1, /* NORMSINV */\n\t0x0129: 3, /* STANDARDIZE */\n\t0x012A: 1, /* ODD */\n\t0x012B: 2, /* PERMUT */\n\t0x012C: 3, /* POISSON */\n\t0x012D: 3, /* TDIST */\n\t0x012E: 4, /* WEIBULL */\n\t0x012F: 2, /* SUMXMY2 */\n\t0x0130: 2, /* SUMX2MY2 */\n\t0x0131: 2, /* SUMX2PY2 */\n\t0x0132: 2, /* CHITEST */\n\t0x0133: 2, /* CORREL */\n\t0x0134: 2, /* COVAR */\n\t0x0135: 3, /* FORECAST */\n\t0x0136: 2, /* FTEST */\n\t0x0137: 2, /* INTERCEPT */\n\t0x0138: 2, /* PEARSON */\n\t0x0139: 2, /* RSQ */\n\t0x013A: 2, /* STEYX */\n\t0x013B: 2, /* SLOPE */\n\t0x013C: 4, /* TTEST */\n\t0x0145: 2, /* LARGE */\n\t0x0146: 2, /* SMALL */\n\t0x0147: 2, /* QUARTILE */\n\t0x0148: 2, /* PERCENTILE */\n\t0x014B: 2, /* TRIMMEAN */\n\t0x014C: 2, /* TINV */\n\t0x0151: 2, /* POWER */\n\t0x0156: 1, /* RADIANS */\n\t0x0157: 1, /* DEGREES */\n\t0x015A: 2, /* COUNTIF */\n\t0x015B: 1, /* COUNTBLANK */\n\t0x015E: 4, /* ISPMT */\n\t0x015F: 3, /* DATEDIF */\n\t0x0160: 1, /* DATESTRING */\n\t0x0161: 2, /* NUMBERSTRING */\n\t0x0168: 1, /* PHONETIC */\n\t0x0170: 1, /* BAHTTEXT */\n\t0x0171: 1, /* THAIDAYOFWEEK */\n\t0x0172: 1, /* THAIDIGIT */\n\t0x0173: 1, /* THAIMONTHOFYEAR */\n\t0x0174: 1, /* THAINUMSOUND */\n\t0x0175: 1, /* THAINUMSTRING */\n\t0x0176: 1, /* THAISTRINGLENGTH */\n\t0x0177: 1, /* ISTHAIDIGIT */\n\t0x0178: 1, /* ROUNDBAHTDOWN */\n\t0x0179: 1, /* ROUNDBAHTUP */\n\t0x017A: 1, /* THAIYEAR */\n\t0xFFFF: 0\n};\n/* [MS-XLSX] 2.2.3 Functions */\nvar XLSXFutureFunctions = {\n\t\"_xlfn.ACOT\": \"ACOT\",\n\t\"_xlfn.ACOTH\": \"ACOTH\",\n\t\"_xlfn.AGGREGATE\": \"AGGREGATE\",\n\t\"_xlfn.ARABIC\": \"ARABIC\",\n\t\"_xlfn.AVERAGEIF\": \"AVERAGEIF\",\n\t\"_xlfn.AVERAGEIFS\": \"AVERAGEIFS\",\n\t\"_xlfn.BASE\": \"BASE\",\n\t\"_xlfn.BETA.DIST\": \"BETA.DIST\",\n\t\"_xlfn.BETA.INV\": \"BETA.INV\",\n\t\"_xlfn.BINOM.DIST\": \"BINOM.DIST\",\n\t\"_xlfn.BINOM.DIST.RANGE\": \"BINOM.DIST.RANGE\",\n\t\"_xlfn.BINOM.INV\": \"BINOM.INV\",\n\t\"_xlfn.BITAND\": \"BITAND\",\n\t\"_xlfn.BITLSHIFT\": \"BITLSHIFT\",\n\t\"_xlfn.BITOR\": \"BITOR\",\n\t\"_xlfn.BITRSHIFT\": \"BITRSHIFT\",\n\t\"_xlfn.BITXOR\": \"BITXOR\",\n\t\"_xlfn.CEILING.MATH\": \"CEILING.MATH\",\n\t\"_xlfn.CEILING.PRECISE\": \"CEILING.PRECISE\",\n\t\"_xlfn.CHISQ.DIST\": \"CHISQ.DIST\",\n\t\"_xlfn.CHISQ.DIST.RT\": \"CHISQ.DIST.RT\",\n\t\"_xlfn.CHISQ.INV\": \"CHISQ.INV\",\n\t\"_xlfn.CHISQ.INV.RT\": \"CHISQ.INV.RT\",\n\t\"_xlfn.CHISQ.TEST\": \"CHISQ.TEST\",\n\t\"_xlfn.COMBINA\": \"COMBINA\",\n\t\"_xlfn.CONFIDENCE.NORM\": \"CONFIDENCE.NORM\",\n\t\"_xlfn.CONFIDENCE.T\": \"CONFIDENCE.T\",\n\t\"_xlfn.COT\": \"COT\",\n\t\"_xlfn.COTH\": \"COTH\",\n\t\"_xlfn.COUNTIFS\": \"COUNTIFS\",\n\t\"_xlfn.COVARIANCE.P\": \"COVARIANCE.P\",\n\t\"_xlfn.COVARIANCE.S\": \"COVARIANCE.S\",\n\t\"_xlfn.CSC\": \"CSC\",\n\t\"_xlfn.CSCH\": \"CSCH\",\n\t\"_xlfn.DAYS\": \"DAYS\",\n\t\"_xlfn.DECIMAL\": \"DECIMAL\",\n\t\"_xlfn.ECMA.CEILING\": \"ECMA.CEILING\",\n\t\"_xlfn.ERF.PRECISE\": \"ERF.PRECISE\",\n\t\"_xlfn.ERFC.PRECISE\": \"ERFC.PRECISE\",\n\t\"_xlfn.EXPON.DIST\": \"EXPON.DIST\",\n\t\"_xlfn.F.DIST\": \"F.DIST\",\n\t\"_xlfn.F.DIST.RT\": \"F.DIST.RT\",\n\t\"_xlfn.F.INV\": \"F.INV\",\n\t\"_xlfn.F.INV.RT\": \"F.INV.RT\",\n\t\"_xlfn.F.TEST\": \"F.TEST\",\n\t\"_xlfn.FILTERXML\": \"FILTERXML\",\n\t\"_xlfn.FLOOR.MATH\": \"FLOOR.MATH\",\n\t\"_xlfn.FLOOR.PRECISE\": \"FLOOR.PRECISE\",\n\t\"_xlfn.FORMULATEXT\": \"FORMULATEXT\",\n\t\"_xlfn.GAMMA\": \"GAMMA\",\n\t\"_xlfn.GAMMA.DIST\": \"GAMMA.DIST\",\n\t\"_xlfn.GAMMA.INV\": \"GAMMA.INV\",\n\t\"_xlfn.GAMMALN.PRECISE\": \"GAMMALN.PRECISE\",\n\t\"_xlfn.GAUSS\": \"GAUSS\",\n\t\"_xlfn.HYPGEOM.DIST\": \"HYPGEOM.DIST\",\n\t\"_xlfn.IFNA\": \"IFNA\",\n\t\"_xlfn.IFERROR\": \"IFERROR\",\n\t\"_xlfn.IMCOSH\": \"IMCOSH\",\n\t\"_xlfn.IMCOT\": \"IMCOT\",\n\t\"_xlfn.IMCSC\": \"IMCSC\",\n\t\"_xlfn.IMCSCH\": \"IMCSCH\",\n\t\"_xlfn.IMSEC\": \"IMSEC\",\n\t\"_xlfn.IMSECH\": \"IMSECH\",\n\t\"_xlfn.IMSINH\": \"IMSINH\",\n\t\"_xlfn.IMTAN\": \"IMTAN\",\n\t\"_xlfn.ISFORMULA\": \"ISFORMULA\",\n\t\"_xlfn.ISO.CEILING\": \"ISO.CEILING\",\n\t\"_xlfn.ISOWEEKNUM\": \"ISOWEEKNUM\",\n\t\"_xlfn.LOGNORM.DIST\": \"LOGNORM.DIST\",\n\t\"_xlfn.LOGNORM.INV\": \"LOGNORM.INV\",\n\t\"_xlfn.MODE.MULT\": \"MODE.MULT\",\n\t\"_xlfn.MODE.SNGL\": \"MODE.SNGL\",\n\t\"_xlfn.MUNIT\": \"MUNIT\",\n\t\"_xlfn.NEGBINOM.DIST\": \"NEGBINOM.DIST\",\n\t\"_xlfn.NETWORKDAYS.INTL\": \"NETWORKDAYS.INTL\",\n\t\"_xlfn.NIGBINOM\": \"NIGBINOM\",\n\t\"_xlfn.NORM.DIST\": \"NORM.DIST\",\n\t\"_xlfn.NORM.INV\": \"NORM.INV\",\n\t\"_xlfn.NORM.S.DIST\": \"NORM.S.DIST\",\n\t\"_xlfn.NORM.S.INV\": \"NORM.S.INV\",\n\t\"_xlfn.NUMBERVALUE\": \"NUMBERVALUE\",\n\t\"_xlfn.PDURATION\": \"PDURATION\",\n\t\"_xlfn.PERCENTILE.EXC\": \"PERCENTILE.EXC\",\n\t\"_xlfn.PERCENTILE.INC\": \"PERCENTILE.INC\",\n\t\"_xlfn.PERCENTRANK.EXC\": \"PERCENTRANK.EXC\",\n\t\"_xlfn.PERCENTRANK.INC\": \"PERCENTRANK.INC\",\n\t\"_xlfn.PERMUTATIONA\": \"PERMUTATIONA\",\n\t\"_xlfn.PHI\": \"PHI\",\n\t\"_xlfn.POISSON.DIST\": \"POISSON.DIST\",\n\t\"_xlfn.QUARTILE.EXC\": \"QUARTILE.EXC\",\n\t\"_xlfn.QUARTILE.INC\": \"QUARTILE.INC\",\n\t\"_xlfn.QUERYSTRING\": \"QUERYSTRING\",\n\t\"_xlfn.RANK.AVG\": \"RANK.AVG\",\n\t\"_xlfn.RANK.EQ\": \"RANK.EQ\",\n\t\"_xlfn.RRI\": \"RRI\",\n\t\"_xlfn.SEC\": \"SEC\",\n\t\"_xlfn.SECH\": \"SECH\",\n\t\"_xlfn.SHEET\": \"SHEET\",\n\t\"_xlfn.SHEETS\": \"SHEETS\",\n\t\"_xlfn.SKEW.P\": \"SKEW.P\",\n\t\"_xlfn.STDEV.P\": \"STDEV.P\",\n\t\"_xlfn.STDEV.S\": \"STDEV.S\",\n\t\"_xlfn.SUMIFS\": \"SUMIFS\",\n\t\"_xlfn.T.DIST\": \"T.DIST\",\n\t\"_xlfn.T.DIST.2T\": \"T.DIST.2T\",\n\t\"_xlfn.T.DIST.RT\": \"T.DIST.RT\",\n\t\"_xlfn.T.INV\": \"T.INV\",\n\t\"_xlfn.T.INV.2T\": \"T.INV.2T\",\n\t\"_xlfn.T.TEST\": \"T.TEST\",\n\t\"_xlfn.UNICHAR\": \"UNICHAR\",\n\t\"_xlfn.UNICODE\": \"UNICODE\",\n\t\"_xlfn.VAR.P\": \"VAR.P\",\n\t\"_xlfn.VAR.S\": \"VAR.S\",\n\t\"_xlfn.WEBSERVICE\": \"WEBSERVICE\",\n\t\"_xlfn.WEIBULL.DIST\": \"WEIBULL.DIST\",\n\t\"_xlfn.WORKDAY.INTL\": \"WORKDAY.INTL\",\n\t\"_xlfn.XOR\": \"XOR\",\n\t\"_xlfn.Z.TEST\": \"Z.TEST\"\n};\n\nvar strs = {}; // shared strings\nvar _ssfopts = {}; // spreadsheet formatting options\n\nRELS.WS = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\";\n\nfunction get_sst_id(sst, str) {\n\tfor(var i = 0, len = sst.length; i < len; ++i) if(sst[i].t === str) { sst.Count ++; return i; }\n\tsst[len] = {t:str}; sst.Count ++; sst.Unique ++; return len;\n}\n\nfunction get_cell_style(styles, cell, opts) {\n  if (typeof style_builder != 'undefined') {\n    if (/^\\d+$/.exec(cell.s)) { return cell.s}  // if its already an integer index, let it be\n    if (cell.s && (cell.s == +cell.s)) { return cell.s}  // if its already an integer index, let it be\n    var s = cell.s || {};\n    if (cell.z) s.numFmt = cell.z;\n    return style_builder.addStyle(s);\n  }\n  else {\n    var z = opts.revssf[cell.z != null ? cell.z : \"General\"];\n    for(var i = 0, len = styles.length; i != len; ++i) if(styles[i].numFmtId === z) return i;\n    styles[len] = {\n      numFmtId:z,\n      fontId:0,\n      fillId:0,\n      borderId:0,\n      xfId:0,\n      applyNumberFormat:1\n    };\n    return len;\n  }\n}\n\nfunction get_cell_style_csf(cellXf) {\n\n  if (cellXf) {\n\n    var s = {}\n\n    if (typeof cellXf.numFmtId != undefined)  {\n      s.numFmt = SSF._table[cellXf.numFmtId];\n    }\n\n    if(cellXf.fillId)  {\n      s.fill =  styles.Fills[cellXf.fillId];\n    }\n\n    if (cellXf.fontId) {\n      s.font = styles.Fonts[cellXf.fontId];\n    }\n    if (cellXf.borderId) {\n      s.border = styles.Borders[cellXf.borderId];\n    }\n    if (cellXf.applyAlignment==1) {\n      s.alignment = cellXf.alignment;\n    }\n\n\n    return JSON.parse(JSON.stringify(s));\n  }\n  return null;\n}\n\nfunction safe_format(p, fmtid, fillid, opts) {\n\ttry {\n\t\tif(p.t === 'e') p.w = p.w || BErr[p.v];\n\t\telse if(fmtid === 0) {\n\t\t\tif(p.t === 'n') {\n\t\t\t\tif((p.v|0) === p.v) p.w = SSF._general_int(p.v,_ssfopts);\n\t\t\t\telse p.w = SSF._general_num(p.v,_ssfopts);\n\t\t\t}\n\t\t\telse if(p.t === 'd') {\n\t\t\t\tvar dd = datenum(p.v);\n\t\t\t\tif((dd|0) === dd) p.w = SSF._general_int(dd,_ssfopts);\n\t\t\t\telse p.w = SSF._general_num(dd,_ssfopts);\n\t\t\t}\n\t\t\telse if(p.v === undefined) return \"\";\n\t\t\telse p.w = SSF._general(p.v,_ssfopts);\n\t\t}\n\t\telse if(p.t === 'd') p.w = SSF.format(fmtid,datenum(p.v),_ssfopts);\n\t\telse p.w = SSF.format(fmtid,p.v,_ssfopts);\n\t\tif(opts.cellNF) p.z = SSF._table[fmtid];\n\t} catch(e) { if(opts.WTF) throw e; }\n}\nfunction parse_ws_xml_dim(ws, s) {\n  var d = safe_decode_range(s);\n  if (d.s.r <= d.e.r && d.s.c <= d.e.c && d.s.r >= 0 && d.s.c >= 0) ws[\"!ref\"] = encode_range(d);\n}\nvar mergecregex = /<mergeCell ref=\"[A-Z0-9:]+\"\\s*\\/>/g;\nvar sheetdataregex = /<(?:\\w+:)?sheetData>([^\\u2603]*)<\\/(?:\\w+:)?sheetData>/;\nvar hlinkregex = /<hyperlink[^>]*\\/>/g;\nvar dimregex = /\"(\\w*:\\w*)\"/;\nvar colregex = /<col[^>]*\\/>/g;\n/* 18.3 Worksheets */\nfunction parse_ws_xml(data, opts, rels) {\n  if (!data) return data;\n  /* 18.3.1.99 worksheet CT_Worksheet */\n  var s = {};\n\n  /* 18.3.1.35 dimension CT_SheetDimension ? */\n  var ridx = data.indexOf(\"<dimension\");\n  if (ridx > 0) {\n    var ref = data.substr(ridx, 50).match(dimregex);\n    if (ref != null) parse_ws_xml_dim(s, ref[1]);\n  }\n\n  /* 18.3.1.55 mergeCells CT_MergeCells */\n  var mergecells = [];\n  if (data.indexOf(\"</mergeCells>\") !== -1) {\n    var merges = data.match(mergecregex);\n    for (ridx = 0; ridx != merges.length; ++ridx)\n      mergecells[ridx] = safe_decode_range(merges[ridx].substr(merges[ridx].indexOf(\"\\\"\") + 1));\n  }\n\n  /* 18.3.1.17 cols CT_Cols */\n  var columns = [];\n  if (opts.cellStyles && data.indexOf(\"</cols>\") !== -1) {\n    /* 18.3.1.13 col CT_Col */\n    var cols = data.match(colregex);\n    parse_ws_xml_cols(columns, cols);\n  }\n\n  var refguess = {s: {r: 1000000, c: 1000000}, e: {r: 0, c: 0}};\n\n  /* 18.3.1.80 sheetData CT_SheetData ? */\n  var mtch = data.match(sheetdataregex);\n  if (mtch) parse_ws_xml_data(mtch[1], s, opts, refguess);\n\n  /* 18.3.1.48 hyperlinks CT_Hyperlinks */\n  if (data.indexOf(\"</hyperlinks>\") !== -1) parse_ws_xml_hlinks(s, data.match(hlinkregex), rels);\n\n  if (!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\n  if (opts.sheetRows > 0 && s[\"!ref\"]) {\n    var tmpref = safe_decode_range(s[\"!ref\"]);\n    if (opts.sheetRows < +tmpref.e.r) {\n      tmpref.e.r = opts.sheetRows - 1;\n      if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n      if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n      if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n      if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n      s[\"!fullref\"] = s[\"!ref\"];\n      s[\"!ref\"] = encode_range(tmpref);\n    }\n  }\n  if (mergecells.length > 0) s[\"!merges\"] = mergecells;\n  if (columns.length > 0) s[\"!cols\"] = columns;\n  return s;\n}\n\nfunction write_ws_xml_merges(merges) {\n  if (merges.length == 0) return \"\";\n  var o = '<mergeCells count=\"' + merges.length + '\">';\n  for (var i = 0; i != merges.length; ++i) o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\n  return o + '</mergeCells>';\n}\n\nfunction write_ws_xml_pagesetup(setup) {\n  var pageSetup = writextag('pageSetup', null, {\n    scale: setup.scale || '100',\n    orientation: setup.orientation || 'portrait',\n    horizontalDpi: setup.horizontalDpi || '4294967292',\n    verticalDpi: setup.verticalDpi || '4294967292'\n  })\n  return pageSetup;\n}\n\n\nfunction parse_ws_xml_hlinks(s, data, rels) {\n  for (var i = 0; i != data.length; ++i) {\n    var val = parsexmltag(data[i], true);\n    if (!val.ref) return;\n    var rel = rels ? rels['!id'][val.id] : null;\n    if (rel) {\n      val.Target = rel.Target;\n      if (val.location) val.Target += \"#\" + val.location;\n      val.Rel = rel;\n    } else {\n      val.Target = val.location;\n      rel = {Target: val.location, TargetMode: 'Internal'};\n      val.Rel = rel;\n    }\n    var rng = safe_decode_range(val.ref);\n    for (var R = rng.s.r; R <= rng.e.r; ++R) for (var C = rng.s.c; C <= rng.e.c; ++C) {\n      var addr = encode_cell({c: C, r: R});\n      if (!s[addr]) s[addr] = {t: \"stub\", v: undefined};\n      s[addr].l = val;\n    }\n  }\n}\n\nfunction parse_ws_xml_cols(columns, cols) {\n  var seencol = false;\n  for (var coli = 0; coli != cols.length; ++coli) {\n    var coll = parsexmltag(cols[coli], true);\n    var colm = parseInt(coll.min, 10) - 1, colM = parseInt(coll.max, 10) - 1;\n    delete coll.min;\n    delete coll.max;\n    if (!seencol && coll.width) {\n      seencol = true;\n      find_mdw(+coll.width, coll);\n    }\n    if (coll.width) {\n      coll.wpx = width2px(+coll.width);\n      coll.wch = px2char(coll.wpx);\n      coll.MDW = MDW;\n    }\n    while (colm <= colM) columns[colm++] = coll;\n  }\n}\n\nfunction write_ws_xml_cols(ws, cols) {\n  var o = [\"<cols>\"], col, width;\n  for (var i = 0; i != cols.length; ++i) {\n    if (!(col = cols[i])) continue;\n    var p = {min: i + 1, max: i + 1};\n    /* wch (chars), wpx (pixels) */\n    width = -1;\n    if (col.wpx) width = px2char(col.wpx);\n    else if (col.wch) width = col.wch;\n    if (width > -1) {\n      p.width = char2width(width);\n      p.customWidth = 1;\n    }\n    o[o.length] = (writextag('col', null, p));\n  }\n  o[o.length] = \"</cols>\";\n  return o.join(\"\");\n}\n\nfunction write_ws_xml_cell(cell, ref, ws, opts, idx, wb) {\n  if (cell.v === undefined && cell.s === undefined) return \"\";\n  var vv = \"\";\n  var oldt = cell.t, oldv = cell.v;\n  switch (cell.t) {\n    case 'b':\n      vv = cell.v ? \"1\" : \"0\";\n      break;\n    case 'n':\n      vv = '' + cell.v;\n      break;\n    case 'e':\n      vv = BErr[cell.v];\n      break;\n    case 'd':\n      if (opts.cellDates) vv = new Date(cell.v).toISOString();\n      else {\n        cell.t = 'n';\n        vv = '' + (cell.v = datenum(cell.v));\n        if (typeof cell.z === 'undefined') cell.z = SSF._table[14];\n      }\n      break;\n    default:\n      vv = cell.v;\n      break;\n  }\n  var v = writetag('v', escapexml(vv)), o = {r: ref};\n  /* TODO: cell style */\n  var os = get_cell_style(opts.cellXfs, cell, opts);\n  if (os !== 0) o.s = os;\n  switch (cell.t) {\n    case 'n':\n      break;\n    case 'd':\n      o.t = \"d\";\n      break;\n    case 'b':\n      o.t = \"b\";\n      break;\n    case 'e':\n      o.t = \"e\";\n      break;\n    default:\n      if (opts.bookSST) {\n        v = writetag('v', '' + get_sst_id(opts.Strings, cell.v));\n        o.t = \"s\";\n        break;\n      }\n      o.t = \"str\";\n      break;\n  }\n  if (cell.t != oldt) {\n    cell.t = oldt;\n    cell.v = oldv;\n  }\n  return writextag('c', v, o);\n}\n\nvar parse_ws_xml_data = (function parse_ws_xml_data_factory() {\n  var cellregex = /<(?:\\w+:)?c[ >]/, rowregex = /<\\/(?:\\w+:)?row>/;\n  var rregex = /r=[\"']([^\"']*)[\"']/, isregex = /<is>([\\S\\s]*?)<\\/is>/;\n  var match_v = matchtag(\"v\"), match_f = matchtag(\"f\");\n\n  return function parse_ws_xml_data(sdata, s, opts, guess) {\n    var ri = 0, x = \"\", cells = [], cref = [], idx = 0, i = 0, cc = 0, d = \"\", p;\n    var tag, tagr = 0, tagc = 0;\n    var sstr;\n    var fmtid = 0, fillid = 0, do_format = Array.isArray(styles.CellXf), cf;\n    for (var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\n      x = marr[mt].trim();\n      var xlen = x.length;\n      if (xlen === 0) continue;\n\n      /* 18.3.1.73 row CT_Row */\n      for (ri = 0; ri < xlen; ++ri) if (x.charCodeAt(ri) === 62) break;\n      ++ri;\n      tag = parsexmltag(x.substr(0, ri), true);\n      /* SpreadSheetGear uses implicit r/c */\n      tagr = typeof tag.r !== 'undefined' ? parseInt(tag.r, 10) : tagr + 1;\n      tagc = -1;\n      if (opts.sheetRows && opts.sheetRows < tagr) continue;\n      if (guess.s.r > tagr - 1) guess.s.r = tagr - 1;\n      if (guess.e.r < tagr - 1) guess.e.r = tagr - 1;\n\n      /* 18.3.1.4 c CT_Cell */\n      cells = x.substr(ri).split(cellregex);\n      for (ri = typeof tag.r === 'undefined' ? 0 : 1; ri != cells.length; ++ri) {\n        x = cells[ri].trim();\n        if (x.length === 0) continue;\n        cref = x.match(rregex);\n        idx = ri;\n        i = 0;\n        cc = 0;\n        x = \"<c \" + (x.substr(0, 1) == \"<\" ? \">\" : \"\") + x;\n        if (cref !== null && cref.length === 2) {\n          idx = 0;\n          d = cref[1];\n          for (i = 0; i != d.length; ++i) {\n            if ((cc = d.charCodeAt(i) - 64) < 1 || cc > 26) break;\n            idx = 26 * idx + cc;\n          }\n          --idx;\n          tagc = idx;\n        } else ++tagc;\n        for (i = 0; i != x.length; ++i) if (x.charCodeAt(i) === 62) break;\n        ++i;\n        tag = parsexmltag(x.substr(0, i), true);\n        if (!tag.r) tag.r = utils.encode_cell({r: tagr - 1, c: tagc});\n        d = x.substr(i);\n        p = {t: \"\"};\n\n        if ((cref = d.match(match_v)) !== null && cref[1] !== '') p.v = unescapexml(cref[1]);\n        if (opts.cellFormula && (cref = d.match(match_f)) !== null) p.f = unescapexml(cref[1]);\n\n        /* SCHEMA IS ACTUALLY INCORRECT HERE.  IF A CELL HAS NO T, EMIT \"\" */\n        if (tag.t === undefined && tag.s === undefined && p.v === undefined) {\n          if (!opts.sheetStubs) continue;\n          p.t = \"stub\";\n        }\n        else p.t = tag.t || \"n\";\n        if (guess.s.c > idx) guess.s.c = idx;\n        if (guess.e.c < idx) guess.e.c = idx;\n        /* 18.18.11 t ST_CellType */\n        switch (p.t) {\n          case 'n':\n            p.v = parseFloat(p.v);\n            if (isNaN(p.v)) p.v = \"\" // we don't want NaN if p.v is null\n            break;\n          case 's':\n            // if (!p.hasOwnProperty('v')) continue;\n            sstr = strs[parseInt(p.v, 10)];\n            p.v = sstr.t;\n            p.r = sstr.r;\n            if (opts.cellHTML) p.h = sstr.h;\n            break;\n          case 'str':\n            p.t = \"s\";\n            p.v = (p.v != null) ? utf8read(p.v) : '';\n            if (opts.cellHTML) p.h = p.v;\n            break;\n          case 'inlineStr':\n            cref = d.match(isregex);\n            p.t = 's';\n            if (cref !== null) {\n              sstr = parse_si(cref[1]);\n              p.v = sstr.t;\n            } else p.v = \"\";\n            break; // inline string\n          case 'b':\n            p.v = parsexmlbool(p.v);\n            break;\n          case 'd':\n            if (!opts.cellDates) {\n              p.v = datenum(p.v);\n              p.t = 'n';\n            }\n            break;\n            /* error string in .v, number in .v */\n          case 'e':\n            p.w = p.v;\n            p.v = RBErr[p.v];\n            break;\n        }\n        /* formatting */\n        fmtid = fillid = 0;\n        if (do_format && tag.s !== undefined) {\n          cf = styles.CellXf[tag.s];\n          if (opts.cellStyles) {\n            p.s = get_cell_style_csf(cf)\n          }\n          if (cf != null) {\n            if (cf.numFmtId != null) fmtid = cf.numFmtId;\n            if (opts.cellStyles && cf.fillId != null) fillid = cf.fillId;\n          }\n        }\n        safe_format(p, fmtid, fillid, opts);\n        s[tag.r] = p;\n      }\n    }\n  };\n})();\n\nfunction write_ws_xml_data(ws, opts, idx, wb) {\n  var o = [], r = [], range = safe_decode_range(ws['!ref']), cell, ref, rr = \"\", cols = [], R, C;\n  for (C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n  for (R = range.s.r; R <= range.e.r; ++R) {\n    r = [];\n    rr = encode_row(R);\n    for (C = range.s.c; C <= range.e.c; ++C) {\n      ref = cols[C] + rr;\n      if (ws[ref] === undefined) continue;\n      if ((cell = write_ws_xml_cell(ws[ref], ref, ws, opts, idx, wb)) != null) r.push(cell);\n    }\n    if (r.length > 0) o[o.length] = (writextag('row', r.join(\"\"), {r: rr}));\n  }\n  return o.join(\"\");\n}\n\nvar WS_XML_ROOT = writextag('worksheet', null, {\n  'xmlns': XMLNS.main[0],\n  'xmlns:r': XMLNS.r\n});\n\nfunction write_ws_xml(idx, opts, wb) {\n  var o = [XML_HEADER, WS_XML_ROOT];\n  var s = wb.SheetNames[idx], sidx = 0, rdata = \"\";\n  var ws = wb.Sheets[s];\n  if (ws === undefined) ws = {};\n  var ref = ws['!ref'];\n  if (ref === undefined) ref = 'A1';\n  o[o.length] = (writextag('dimension', null, {'ref': ref}));\n\n  var kids = [];\n  if (ws['!freeze']) {\n    var pane = '';\n    pane = writextag('pane', null, ws['!freeze'])\n    kids.push(pane)\n\n    var selection = writextag('selection', null, {\n      pane: \"topLeft\"\n    })\n    kids.push(selection)\n\n    var selection = writextag('selection', null, {\n      pane: \"bottomLeft\"\n    })\n    kids.push(selection)\n\n    var selection = writextag('selection', null, {\n      pane: \"bottomRight\",\n      activeCell: ws['!freeze'],\n      sqref: ws['!freeze']\n    })\n    kids.push(selection)\n  }\n\n\n//<selection pane=\"bottomRight\" activeCell=\"A4\" sqref=\"A4\"/>\n\n  var sheetView = writextag('sheetView', kids.join('') || undefined, {\n    showGridLines: opts.showGridLines == false ? '0' : '1',\n    tabSelected: opts.tabSelected === undefined ? '0' : opts.tabSelected,  // see issue #26, need to set WorkbookViews if this is set\n    workbookViewId: opts.workbookViewId === undefined ? '0' : opts.workbookViewId\n  });\n  o[o.length] = writextag('sheetViews', sheetView);\n\n  if (ws['!cols'] !== undefined && ws['!cols'].length > 0) o[o.length] = (write_ws_xml_cols(ws, ws['!cols']));\n  o[sidx = o.length] = '<sheetData/>';\n  if (ws['!ref'] !== undefined) {\n    rdata = write_ws_xml_data(ws, opts, idx, wb);\n    if (rdata.length > 0) o[o.length] = (rdata);\n  }\n  if (o.length > sidx + 1) {\n    o[o.length] = ('</sheetData>');\n    o[sidx] = o[sidx].replace(\"/>\", \">\");\n  }\n\n  if (ws['!merges'] !== undefined && ws['!merges'].length > 0) o[o.length] = (write_ws_xml_merges(ws['!merges']));\n\n  if (ws['!pageSetup'] !== undefined) o[o.length] = write_ws_xml_pagesetup(ws['!pageSetup']);\n  if (ws['!rowBreaks'] !== undefined) o[o.length] = write_ws_xml_row_breaks(ws['!rowBreaks']);\n  if (ws['!colBreaks'] !== undefined) o[o.length] = write_ws_xml_col_breaks(ws['!colBreaks']);\n\n  if (o.length > 2) {\n    o[o.length] = ('</worksheet>');\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n  return o.join(\"\");\n}\n\nfunction write_ws_xml_row_breaks(breaks) {\n  var brk = [];\n  for (var i = 0; i < breaks.length; i++) {\n    var thisBreak = '' + (breaks[i]);\n    var nextBreak = '' + (breaks[i + 1] || '16383');\n    brk.push(writextag('brk', null, {id: thisBreak, max: nextBreak, man: '1'}))\n  }\n  return writextag('rowBreaks', brk.join(' '), {count: brk.length, manualBreakCount: brk.length})\n}\nfunction write_ws_xml_col_breaks(breaks) {\n  var brk = [];\n  for (var i = 0; i < breaks.length; i++) {\n    var thisBreak = '' + (breaks[i]);\n    var nextBreak = '' + (breaks[i + 1] || '1048575');\n    brk.push(writextag('brk', null, {id: thisBreak, max: nextBreak, man: '1'}))\n  }\n  return writextag('colBreaks', brk.join(' '), {count: brk.length, manualBreakCount: brk.length})\n}\n\n/* [MS-XLSB] 2.4.718 BrtRowHdr */\nfunction parse_BrtRowHdr(data, length) {\n\tvar z = [];\n\tz.r = data.read_shift(4);\n\tdata.l += length-4;\n\treturn z;\n}\n\n/* [MS-XLSB] 2.4.812 BrtWsDim */\nvar parse_BrtWsDim = parse_UncheckedRfX;\nvar write_BrtWsDim = write_UncheckedRfX;\n\n/* [MS-XLSB] 2.4.815 BrtWsProp */\nfunction parse_BrtWsProp(data, length) {\n\tvar z = {};\n\t/* TODO: pull flags */\n\tdata.l += 19;\n\tz.name = parse_XLSBCodeName(data, length - 19);\n\treturn z;\n}\n\n/* [MS-XLSB] 2.4.303 BrtCellBlank */\nfunction parse_BrtCellBlank(data, length) {\n\tvar cell = parse_XLSBCell(data);\n\treturn [cell];\n}\nfunction write_BrtCellBlank(cell, val, o) {\n\tif(o == null) o = new_buf(8);\n\treturn write_XLSBCell(val, o);\n}\n\n\n/* [MS-XLSB] 2.4.304 BrtCellBool */\nfunction parse_BrtCellBool(data, length) {\n\tvar cell = parse_XLSBCell(data);\n\tvar fBool = data.read_shift(1);\n\treturn [cell, fBool, 'b'];\n}\n\n/* [MS-XLSB] 2.4.305 BrtCellError */\nfunction parse_BrtCellError(data, length) {\n\tvar cell = parse_XLSBCell(data);\n\tvar fBool = data.read_shift(1);\n\treturn [cell, fBool, 'e'];\n}\n\n/* [MS-XLSB] 2.4.308 BrtCellIsst */\nfunction parse_BrtCellIsst(data, length) {\n\tvar cell = parse_XLSBCell(data);\n\tvar isst = data.read_shift(4);\n\treturn [cell, isst, 's'];\n}\n\n/* [MS-XLSB] 2.4.310 BrtCellReal */\nfunction parse_BrtCellReal(data, length) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_Xnum(data);\n\treturn [cell, value, 'n'];\n}\n\n/* [MS-XLSB] 2.4.311 BrtCellRk */\nfunction parse_BrtCellRk(data, length) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_RkNumber(data);\n\treturn [cell, value, 'n'];\n}\n\n/* [MS-XLSB] 2.4.314 BrtCellSt */\nfunction parse_BrtCellSt(data, length) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_XLWideString(data);\n\treturn [cell, value, 'str'];\n}\n\n/* [MS-XLSB] 2.4.647 BrtFmlaBool */\nfunction parse_BrtFmlaBool(data, length, opts) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = data.read_shift(1);\n\tvar o = [cell, value, 'b'];\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBCellParsedFormula(data, length-9);\n\t\to[3] = \"\"; /* TODO */\n\t}\n\telse data.l += length-9;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.648 BrtFmlaError */\nfunction parse_BrtFmlaError(data, length, opts) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = data.read_shift(1);\n\tvar o = [cell, value, 'e'];\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBCellParsedFormula(data, length-9);\n\t\to[3] = \"\"; /* TODO */\n\t}\n\telse data.l += length-9;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.649 BrtFmlaNum */\nfunction parse_BrtFmlaNum(data, length, opts) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_Xnum(data);\n\tvar o = [cell, value, 'n'];\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBCellParsedFormula(data, length - 16);\n\t\to[3] = \"\"; /* TODO */\n\t}\n\telse data.l += length-16;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.650 BrtFmlaString */\nfunction parse_BrtFmlaString(data, length, opts) {\n\tvar start = data.l;\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_XLWideString(data);\n\tvar o = [cell, value, 'str'];\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBCellParsedFormula(data, start + length - data.l);\n\t}\n\telse data.l = start + length;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.676 BrtMergeCell */\nvar parse_BrtMergeCell = parse_UncheckedRfX;\n\n/* [MS-XLSB] 2.4.656 BrtHLink */\nfunction parse_BrtHLink(data, length, opts) {\n\tvar end = data.l + length;\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tvar relId = parse_XLNullableWideString(data);\n\tvar loc = parse_XLWideString(data);\n\tvar tooltip = parse_XLWideString(data);\n\tvar display = parse_XLWideString(data);\n\tdata.l = end;\n\treturn {rfx:rfx, relId:relId, loc:loc, tooltip:tooltip, display:display};\n}\n\n/* [MS-XLSB] 2.1.7.61 Worksheet */\nfunction parse_ws_bin(data, opts, rels) {\n\tif(!data) return data;\n\tif(!rels) rels = {'!id':{}};\n\tvar s = {};\n\n\tvar ref;\n\tvar refguess = {s: {r:1000000, c:1000000}, e: {r:0, c:0} };\n\n\tvar pass = false, end = false;\n\tvar row, p, cf, R, C, addr, sstr, rr;\n\tvar mergecells = [];\n\trecordhopper(data, function ws_parse(val, R) {\n\t\tif(end) return;\n\t\tswitch(R.n) {\n\t\t\tcase 'BrtWsDim': ref = val; break;\n\t\t\tcase 'BrtRowHdr':\n\t\t\t\trow = val;\n\t\t\t\tif(opts.sheetRows && opts.sheetRows <= row.r) end=true;\n\t\t\t\trr = encode_row(row.r);\n\t\t\t\tbreak;\n\n\t\t\tcase 'BrtFmlaBool':\n\t\t\tcase 'BrtFmlaError':\n\t\t\tcase 'BrtFmlaNum':\n\t\t\tcase 'BrtFmlaString':\n\t\t\tcase 'BrtCellBool':\n\t\t\tcase 'BrtCellError':\n\t\t\tcase 'BrtCellIsst':\n\t\t\tcase 'BrtCellReal':\n\t\t\tcase 'BrtCellRk':\n\t\t\tcase 'BrtCellSt':\n\t\t\t\tp = {t:val[2]};\n\t\t\t\tswitch(val[2]) {\n\t\t\t\t\tcase 'n': p.v = val[1]; break;\n\t\t\t\t\tcase 's': sstr = strs[val[1]]; p.v = sstr.t; p.r = sstr.r; break;\n\t\t\t\t\tcase 'b': p.v = val[1] ? true : false; break;\n\t\t\t\t\tcase 'e': p.v = val[1]; p.w = BErr[p.v]; break;\n\t\t\t\t\tcase 'str': p.t = 's'; p.v = utf8read(val[1]); break;\n\t\t\t\t}\n\t\t\t\tif(opts.cellFormula && val.length > 3) p.f = val[3];\n\t\t\t\tif((cf = styles.CellXf[val[0].iStyleRef])) safe_format(p,cf.ifmt,null,opts);\n\t\t\t\ts[encode_col(C=val[0].c) + rr] = p;\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\n\t\t\t\tbreak;\n\n\t\t\tcase 'BrtCellBlank': if(!opts.sheetStubs) break;\n\t\t\t\tp = {t:'s',v:undefined};\n\t\t\t\ts[encode_col(C=val[0].c) + rr] = p;\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\n\t\t\t\tbreak;\n\n\t\t\t/* Merge Cells */\n\t\t\tcase 'BrtBeginMergeCells': break;\n\t\t\tcase 'BrtEndMergeCells': break;\n\t\t\tcase 'BrtMergeCell': mergecells.push(val); break;\n\n\t\t\tcase 'BrtHLink':\n\t\t\t\tvar rel = rels['!id'][val.relId];\n\t\t\t\tif(rel) {\n\t\t\t\t\tval.Target = rel.Target;\n\t\t\t\t\tif(val.loc) val.Target += \"#\"+val.loc;\n\t\t\t\t\tval.Rel = rel;\n\t\t\t\t}\n\t\t\t\tfor(R=val.rfx.s.r;R<=val.rfx.e.r;++R) for(C=val.rfx.s.c;C<=val.rfx.e.c;++C) {\n\t\t\t\t\taddr = encode_cell({c:C,r:R});\n\t\t\t\t\tif(!s[addr]) s[addr] = {t:'s',v:undefined};\n\t\t\t\t\ts[addr].l = val;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'BrtArrFmla': break; // TODO\n\t\t\tcase 'BrtShrFmla': break; // TODO\n\t\t\tcase 'BrtBeginSheet': break;\n\t\t\tcase 'BrtWsProp': break; // TODO\n\t\t\tcase 'BrtSheetCalcProp': break; // TODO\n\t\t\tcase 'BrtBeginWsViews': break; // TODO\n\t\t\tcase 'BrtBeginWsView': break; // TODO\n\t\t\tcase 'BrtPane': break; // TODO\n\t\t\tcase 'BrtSel': break; // TODO\n\t\t\tcase 'BrtEndWsView': break; // TODO\n\t\t\tcase 'BrtEndWsViews': break; // TODO\n\t\t\tcase 'BrtACBegin': break; // TODO\n\t\t\tcase 'BrtRwDescent': break; // TODO\n\t\t\tcase 'BrtACEnd': break; // TODO\n\t\t\tcase 'BrtWsFmtInfoEx14': break; // TODO\n\t\t\tcase 'BrtWsFmtInfo': break; // TODO\n\t\t\tcase 'BrtBeginColInfos': break; // TODO\n\t\t\tcase 'BrtColInfo': break; // TODO\n\t\t\tcase 'BrtEndColInfos': break; // TODO\n\t\t\tcase 'BrtBeginSheetData': break; // TODO\n\t\t\tcase 'BrtEndSheetData': break; // TODO\n\t\t\tcase 'BrtSheetProtection': break; // TODO\n\t\t\tcase 'BrtPrintOptions': break; // TODO\n\t\t\tcase 'BrtMargins': break; // TODO\n\t\t\tcase 'BrtPageSetup': break; // TODO\n\t\t\tcase 'BrtFRTBegin': pass = true; break;\n\t\t\tcase 'BrtFRTEnd': pass = false; break;\n\t\t\tcase 'BrtEndSheet': break; // TODO\n\t\t\tcase 'BrtDrawing': break; // TODO\n\t\t\tcase 'BrtLegacyDrawing': break; // TODO\n\t\t\tcase 'BrtLegacyDrawingHF': break; // TODO\n\t\t\tcase 'BrtPhoneticInfo': break; // TODO\n\t\t\tcase 'BrtBeginHeaderFooter': break; // TODO\n\t\t\tcase 'BrtEndHeaderFooter': break; // TODO\n\t\t\tcase 'BrtBrk': break; // TODO\n\t\t\tcase 'BrtBeginRwBrk': break; // TODO\n\t\t\tcase 'BrtEndRwBrk': break; // TODO\n\t\t\tcase 'BrtBeginColBrk': break; // TODO\n\t\t\tcase 'BrtEndColBrk': break; // TODO\n\t\t\tcase 'BrtBeginUserShViews': break; // TODO\n\t\t\tcase 'BrtBeginUserShView': break; // TODO\n\t\t\tcase 'BrtEndUserShView': break; // TODO\n\t\t\tcase 'BrtEndUserShViews': break; // TODO\n\t\t\tcase 'BrtBkHim': break; // TODO\n\t\t\tcase 'BrtBeginOleObjects': break; // TODO\n\t\t\tcase 'BrtOleObject': break; // TODO\n\t\t\tcase 'BrtEndOleObjects': break; // TODO\n\t\t\tcase 'BrtBeginListParts': break; // TODO\n\t\t\tcase 'BrtListPart': break; // TODO\n\t\t\tcase 'BrtEndListParts': break; // TODO\n\t\t\tcase 'BrtBeginSortState': break; // TODO\n\t\t\tcase 'BrtBeginSortCond': break; // TODO\n\t\t\tcase 'BrtEndSortCond': break; // TODO\n\t\t\tcase 'BrtEndSortState': break; // TODO\n\t\t\tcase 'BrtBeginConditionalFormatting': break; // TODO\n\t\t\tcase 'BrtEndConditionalFormatting': break; // TODO\n\t\t\tcase 'BrtBeginCFRule': break; // TODO\n\t\t\tcase 'BrtEndCFRule': break; // TODO\n\t\t\tcase 'BrtBeginDVals': break; // TODO\n\t\t\tcase 'BrtDVal': break; // TODO\n\t\t\tcase 'BrtEndDVals': break; // TODO\n\t\t\tcase 'BrtRangeProtection': break; // TODO\n\t\t\tcase 'BrtBeginDCon': break; // TODO\n\t\t\tcase 'BrtEndDCon': break; // TODO\n\t\t\tcase 'BrtBeginDRefs': break;\n\t\t\tcase 'BrtDRef': break;\n\t\t\tcase 'BrtEndDRefs': break;\n\n\t\t\t/* ActiveX */\n\t\t\tcase 'BrtBeginActiveXControls': break;\n\t\t\tcase 'BrtActiveX': break;\n\t\t\tcase 'BrtEndActiveXControls': break;\n\n\t\t\t/* AutoFilter */\n\t\t\tcase 'BrtBeginAFilter': break;\n\t\t\tcase 'BrtEndAFilter': break;\n\t\t\tcase 'BrtBeginFilterColumn': break;\n\t\t\tcase 'BrtBeginFilters': break;\n\t\t\tcase 'BrtFilter': break;\n\t\t\tcase 'BrtEndFilters': break;\n\t\t\tcase 'BrtEndFilterColumn': break;\n\t\t\tcase 'BrtDynamicFilter': break;\n\t\t\tcase 'BrtTop10Filter': break;\n\t\t\tcase 'BrtBeginCustomFilters': break;\n\t\t\tcase 'BrtCustomFilter': break;\n\t\t\tcase 'BrtEndCustomFilters': break;\n\n\t\t\t/* Smart Tags */\n\t\t\tcase 'BrtBeginSmartTags': break;\n\t\t\tcase 'BrtBeginCellSmartTags': break;\n\t\t\tcase 'BrtBeginCellSmartTag': break;\n\t\t\tcase 'BrtCellSmartTagProperty': break;\n\t\t\tcase 'BrtEndCellSmartTag': break;\n\t\t\tcase 'BrtEndCellSmartTags': break;\n\t\t\tcase 'BrtEndSmartTags': break;\n\n\t\t\t/* Cell Watch */\n\t\t\tcase 'BrtBeginCellWatches': break;\n\t\t\tcase 'BrtCellWatch': break;\n\t\t\tcase 'BrtEndCellWatches': break;\n\n\t\t\t/* Table */\n\t\t\tcase 'BrtTable': break;\n\n\t\t\t/* Ignore Cell Errors */\n\t\t\tcase 'BrtBeginCellIgnoreECs': break;\n\t\t\tcase 'BrtCellIgnoreEC': break;\n\t\t\tcase 'BrtEndCellIgnoreECs': break;\n\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + R.n);\n\t\t}\n\t}, opts);\n\tif(!s[\"!ref\"] && (refguess.s.r < 1000000 || ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0)) s[\"!ref\"] = encode_range(ref);\n\tif(opts.sheetRows && s[\"!ref\"]) {\n\t\tvar tmpref = safe_decode_range(s[\"!ref\"]);\n\t\tif(opts.sheetRows < +tmpref.e.r) {\n\t\t\ttmpref.e.r = opts.sheetRows - 1;\n\t\t\tif(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n\t\t\tif(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n\t\t\tif(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n\t\t\tif(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n\t\t\ts[\"!fullref\"] = s[\"!ref\"];\n\t\t\ts[\"!ref\"] = encode_range(tmpref);\n\t\t}\n\t}\n\tif(mergecells.length > 0) s[\"!merges\"] = mergecells;\n\treturn s;\n}\n\n/* TODO: something useful -- this is a stub */\nfunction write_ws_bin_cell(ba, cell, R, C, opts) {\n\tif(cell.v === undefined) return \"\";\n\tvar vv = \"\";\n\tswitch(cell.t) {\n\t\tcase 'b': vv = cell.v ? \"1\" : \"0\"; break;\n\t\tcase 'n': case 'e': vv = ''+cell.v; break;\n\t\tdefault: vv = cell.v; break;\n\t}\n\tvar o = {r:R, c:C};\n\t/* TODO: cell style */\n\to.s = get_cell_style(opts.cellXfs, cell, opts);\n\tswitch(cell.t) {\n\t\tcase 's': case 'str':\n\t\t\tif(opts.bookSST) {\n\t\t\t\tvv = get_sst_id(opts.Strings, cell.v);\n\t\t\t\to.t = \"s\"; break;\n\t\t\t}\n\t\t\to.t = \"str\"; break;\n\t\tcase 'n': break;\n\t\tcase 'b': o.t = \"b\"; break;\n\t\tcase 'e': o.t = \"e\"; break;\n\t}\n\twrite_record(ba, \"BrtCellBlank\", write_BrtCellBlank(cell, o));\n}\n\nfunction write_CELLTABLE(ba, ws, idx, opts, wb) {\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\"), ref, rr = \"\", cols = [];\n\twrite_record(ba, 'BrtBeginSheetData');\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\t/* [ACCELLTABLE] */\n\t\t/* BrtRowHdr */\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t/* *16384CELL */\n\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\tref = cols[C] + rr;\n\t\t\tif(!ws[ref]) continue;\n\t\t\t/* write cell */\n\t\t\twrite_ws_bin_cell(ba, ws[ref], R, C, opts);\n\t\t}\n\t}\n\twrite_record(ba, 'BrtEndSheetData');\n}\n\nfunction write_ws_bin(idx, opts, wb) {\n\tvar ba = buf_array();\n\tvar s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\n\tvar r = safe_decode_range(ws['!ref'] || \"A1\");\n\twrite_record(ba, \"BrtBeginSheet\");\n\t/* [BrtWsProp] */\n\twrite_record(ba, \"BrtWsDim\", write_BrtWsDim(r));\n\t/* [WSVIEWS2] */\n\t/* [WSFMTINFO] */\n\t/* *COLINFOS */\n\twrite_CELLTABLE(ba, ws, idx, opts, wb);\n\t/* [BrtSheetCalcProp] */\n\t/* [[BrtSheetProtectionIso] BrtSheetProtection] */\n\t/* *([BrtRangeProtectionIso] BrtRangeProtection) */\n\t/* [SCENMAN] */\n\t/* [AUTOFILTER] */\n\t/* [SORTSTATE] */\n\t/* [DCON] */\n\t/* [USERSHVIEWS] */\n\t/* [MERGECELLS] */\n\t/* [BrtPhoneticInfo] */\n\t/* *CONDITIONALFORMATTING */\n\t/* [DVALS] */\n\t/* *BrtHLink */\n\t/* [BrtPrintOptions] */\n\t/* [BrtMargins] */\n\t/* [BrtPageSetup] */\n\t/* [HEADERFOOTER] */\n\t/* [RWBRK] */\n\t/* [COLBRK] */\n\t/* *BrtBigName */\n\t/* [CELLWATCHES] */\n\t/* [IGNOREECS] */\n\t/* [SMARTTAGS] */\n\t/* [BrtDrawing] */\n\t/* [BrtLegacyDrawing] */\n\t/* [BrtLegacyDrawingHF] */\n\t/* [BrtBkHim] */\n\t/* [OLEOBJECTS] */\n\t/* [ACTIVEXCONTROLS] */\n\t/* [WEBPUBITEMS] */\n\t/* [LISTPARTS] */\n\t/* FRTWORKSHEET */\n\twrite_record(ba, \"BrtEndSheet\");\n\treturn ba.end();\n}\n/* 18.2.28 (CT_WorkbookProtection) Defaults */\nvar WBPropsDef = [\n\t['allowRefreshQuery', '0'],\n\t['autoCompressPictures', '1'],\n\t['backupFile', '0'],\n\t['checkCompatibility', '0'],\n\t['codeName', ''],\n\t['date1904', '0'],\n\t['dateCompatibility', '1'],\n\t//['defaultThemeVersion', '0'],\n\t['filterPrivacy', '0'],\n\t['hidePivotFieldList', '0'],\n\t['promptedSolutions', '0'],\n\t['publishItems', '0'],\n\t['refreshAllConnections', false],\n\t['saveExternalLinkValues', '1'],\n\t['showBorderUnselectedTables', '1'],\n\t['showInkAnnotation', '1'],\n\t['showObjects', 'all'],\n\t['showPivotChartFilter', '0']\n\t//['updateLinks', 'userSet']\n];\n\n/* 18.2.30 (CT_BookView) Defaults */\nvar WBViewDef = [\n\t['activeTab', '0'],\n\t['autoFilterDateGrouping', '1'],\n\t['firstSheet', '0'],\n\t['minimized', '0'],\n\t['showHorizontalScroll', '1'],\n\t['showSheetTabs', '1'],\n\t['showVerticalScroll', '1'],\n\t['tabRatio', '600'],\n\t['visibility', 'visible']\n\t//window{Height,Width}, {x,y}Window\n];\n\n/* 18.2.19 (CT_Sheet) Defaults */\nvar SheetDef = [\n\t['state', 'visible']\n];\n\n/* 18.2.2  (CT_CalcPr) Defaults */\nvar CalcPrDef = [\n\t['calcCompleted', 'true'],\n\t['calcMode', 'auto'],\n\t['calcOnSave', 'true'],\n\t['concurrentCalc', 'true'],\n\t['fullCalcOnLoad', 'false'],\n\t['fullPrecision', 'true'],\n\t['iterate', 'false'],\n\t['iterateCount', '100'],\n\t['iterateDelta', '0.001'],\n\t['refMode', 'A1']\n];\n\n/* 18.2.3 (CT_CustomWorkbookView) Defaults */\nvar CustomWBViewDef = [\n\t['autoUpdate', 'false'],\n\t['changesSavedWin', 'false'],\n\t['includeHiddenRowCol', 'true'],\n\t['includePrintSettings', 'true'],\n\t['maximized', 'false'],\n\t['minimized', 'false'],\n\t['onlySync', 'false'],\n\t['personalView', 'false'],\n\t['showComments', 'commIndicator'],\n\t['showFormulaBar', 'true'],\n\t['showHorizontalScroll', 'true'],\n\t['showObjects', 'all'],\n\t['showSheetTabs', 'true'],\n\t['showStatusbar', 'true'],\n\t['showVerticalScroll', 'true'],\n\t['tabRatio', '600'],\n\t['xWindow', '0'],\n\t['yWindow', '0']\n];\n\nfunction push_defaults_array(target, defaults) {\n\tfor(var j = 0; j != target.length; ++j) { var w = target[j];\n\t\tfor(var i=0; i != defaults.length; ++i) { var z = defaults[i];\n\t\t\tif(w[z[0]] == null) w[z[0]] = z[1];\n\t\t}\n\t}\n}\nfunction push_defaults(target, defaults) {\n\tfor(var i = 0; i != defaults.length; ++i) { var z = defaults[i];\n\t\tif(target[z[0]] == null) target[z[0]] = z[1];\n\t}\n}\n\nfunction parse_wb_defaults(wb) {\n\tpush_defaults(wb.WBProps, WBPropsDef);\n\tpush_defaults(wb.CalcPr, CalcPrDef);\n\n\tpush_defaults_array(wb.WBView, WBViewDef);\n\tpush_defaults_array(wb.Sheets, SheetDef);\n\n\t_ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904, 'date1904');\n}\n/* 18.2 Workbook */\nvar wbnsregex = /<\\w+:workbook/;\nfunction parse_wb_xml(data, opts) {\n\tvar wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, xmlns: \"\" };\n\tvar pass = false, xmlns = \"xmlns\";\n\tdata.match(tagregex).forEach(function xml_wb(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 18.2.27 workbook CT_Workbook 1 */\n\t\t\tcase '<workbook':\n\t\t\t\tif(x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\n\t\t\t\twb.xmlns = y[xmlns];\n\t\t\t\tbreak;\n\t\t\tcase '</workbook>': break;\n\n\t\t\t/* 18.2.13 fileVersion CT_FileVersion ? */\n\t\t\tcase '<fileVersion': delete y[0]; wb.AppVersion = y; break;\n\t\t\tcase '<fileVersion/>': break;\n\n\t\t\t/* 18.2.12 fileSharing CT_FileSharing ? */\n\t\t\tcase '<fileSharing': case '<fileSharing/>': break;\n\n\t\t\t/* 18.2.28 workbookPr CT_WorkbookPr ? */\n\t\t\tcase '<workbookPr': delete y[0]; wb.WBProps = y; break;\n\t\t\tcase '<workbookPr/>': delete y[0]; wb.WBProps = y; break;\n\n\t\t\t/* 18.2.29 workbookProtection CT_WorkbookProtection ? */\n\t\t\tcase '<workbookProtection': break;\n\t\t\tcase '<workbookProtection/>': break;\n\n\t\t\t/* 18.2.1  bookViews CT_BookViews ? */\n\t\t\tcase '<bookViews>': case '</bookViews>': break;\n\t\t\t/* 18.2.30   workbookView CT_BookView + */\n\t\t\tcase '<workbookView': delete y[0]; wb.WBView.push(y); break;\n\n\t\t\t/* 18.2.20 sheets CT_Sheets 1 */\n\t\t\tcase '<sheets>': case '</sheets>': break; // aggregate sheet\n\t\t\t/* 18.2.19   sheet CT_Sheet + */\n\t\t\tcase '<sheet': delete y[0]; y.name = utf8read(y.name); wb.Sheets.push(y); break;\n\n\t\t\t/* 18.2.15 functionGroups CT_FunctionGroups ? */\n\t\t\tcase '<functionGroups': case '<functionGroups/>': break;\n\t\t\t/* 18.2.14   functionGroup CT_FunctionGroup + */\n\t\t\tcase '<functionGroup': break;\n\n\t\t\t/* 18.2.9  externalReferences CT_ExternalReferences ? */\n\t\t\tcase '<externalReferences': case '</externalReferences>': case '<externalReferences>': break;\n\t\t\t/* 18.2.8    externalReference CT_ExternalReference + */\n\t\t\tcase '<externalReference': break;\n\n\t\t\t/* 18.2.6  definedNames CT_DefinedNames ? */\n\t\t\tcase '<definedNames/>': break;\n\t\t\tcase '<definedNames>': case '<definedNames': pass=true; break;\n\t\t\tcase '</definedNames>': pass=false; break;\n\t\t\t/* 18.2.5    definedName CT_DefinedName + */\n\t\t\tcase '<definedName': case '<definedName/>': case '</definedName>': break;\n\n\t\t\t/* 18.2.2  calcPr CT_CalcPr ? */\n\t\t\tcase '<calcPr': delete y[0]; wb.CalcPr = y; break;\n\t\t\tcase '<calcPr/>': delete y[0]; wb.CalcPr = y; break;\n\n\t\t\t/* 18.2.16 oleSize CT_OleSize ? (ref required) */\n\t\t\tcase '<oleSize': break;\n\n\t\t\t/* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\n\t\t\tcase '<customWorkbookViews>': case '</customWorkbookViews>': case '<customWorkbookViews': break;\n\t\t\t/* 18.2.3    customWorkbookView CT_CustomWorkbookView + */\n\t\t\tcase '<customWorkbookView': case '</customWorkbookView>': break;\n\n\t\t\t/* 18.2.18 pivotCaches CT_PivotCaches ? */\n\t\t\tcase '<pivotCaches>': case '</pivotCaches>': case '<pivotCaches': break;\n\t\t\t/* 18.2.17 pivotCache CT_PivotCache ? */\n\t\t\tcase '<pivotCache': break;\n\n\t\t\t/* 18.2.21 smartTagPr CT_SmartTagPr ? */\n\t\t\tcase '<smartTagPr': case '<smartTagPr/>': break;\n\n\t\t\t/* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\n\t\t\tcase '<smartTagTypes': case '<smartTagTypes>': case '</smartTagTypes>': break;\n\t\t\t/* 18.2.22   smartTagType CT_SmartTagType ? */\n\t\t\tcase '<smartTagType': break;\n\n\t\t\t/* 18.2.24 webPublishing CT_WebPublishing ? */\n\t\t\tcase '<webPublishing': case '<webPublishing/>': break;\n\n\t\t\t/* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\n\t\t\tcase '<fileRecoveryPr': case '<fileRecoveryPr/>': break;\n\n\t\t\t/* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\n\t\t\tcase '<webPublishObjects>': case '<webPublishObjects': case '</webPublishObjects>': break;\n\t\t\t/* 18.2.25 webPublishObject CT_WebPublishObject ? */\n\t\t\tcase '<webPublishObject': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7    ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break; //TODO: check with versions of excel\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\t/* Others */\n\t\t\tcase '<ArchID': break;\n\t\t\tcase '<AlternateContent': pass=true; break;\n\t\t\tcase '</AlternateContent>': pass=false; break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw 'unrecognized ' + y[0] + ' in workbook';\n\t\t}\n\t});\n\tif(XMLNS.main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\n\n\tparse_wb_defaults(wb);\n\n\treturn wb;\n}\n\nvar WB_XML_ROOT = writextag('workbook', null, {\n\t'xmlns': XMLNS.main[0],\n\t//'xmlns:mx': XMLNS.mx,\n\t//'xmlns:s': XMLNS.main[0],\n\t'xmlns:r': XMLNS.r\n});\n\nfunction safe1904(wb) {\n\t/* TODO: store date1904 somewhere else */\n\ttry { return parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\"; } catch(e) { return \"false\"; }\n}\n\nfunction write_wb_xml(wb, opts) {\n\tvar o = [XML_HEADER];\n\to[o.length] = WB_XML_ROOT;\n\to[o.length] = (writextag('workbookPr', null, {date1904:safe1904(wb)}));\n\to[o.length] = \"<sheets>\";\n\tfor(var i = 0; i != wb.SheetNames.length; ++i)\n\t\to[o.length] = (writextag('sheet',null,{name:wb.SheetNames[i].substr(0,31), sheetId:\"\"+(i+1), \"r:id\":\"rId\"+(i+1)}));\n\to[o.length] = \"</sheets>\";\n\n  var hasPrintHeaders = false;\n  for(var i = 0; i != wb.SheetNames.length; ++i) {\n    var sheetName = wb.SheetNames[i];\n    var sheet = wb.Sheets[sheetName]\n    if (sheet['!printHeader']) {\n      if (sheet['!printHeader'].length !== 2) {\n        throw \"!printHeaders must be an array of length 2: \"+sheet['!printHeader'];\n\n      }\n      hasPrintHeaders = true;\n    }\n\n  }\n\n  if (hasPrintHeaders) {\n    o[o.length] = '<definedNames>';\n    for(var i = 0; i != wb.SheetNames.length; ++i) {\n      var sheetName = wb.SheetNames[i];\n      var sheet = wb.Sheets[sheetName]\n      if (sheet['!printHeader'] || sheet['!printColumns']) {\n          var printHeader = sheet['!printHeader'];\n          var printColumns = sheet['!printColumns'];\n\n        //Sheet1!$A:$C,Sheet1!$1:$1\n        var range = \"\";\n\n        if (printColumns)  range += (\"'\" + sheetName + \"'!\")  + (\"$\" + printColumns[0] + \":$\" + printColumns[1]);\n        if (printColumns && printHeader)  range += \",\"\n        if (printHeader) range += (\"'\" + sheetName + \"'!\" ) +  (\"$\" + printHeader[0] + \":$\" + printHeader[1]);\n\n        console.log(\"-----------------------------\")\n        console.log(range)\n        o[o.length] = (writextag('definedName', range, {\n          \"name\":\"_xlnm.Print_Titles\",\n          localSheetId : ''+i\n        }))\n      }\n    }\n    o[o.length] = '</definedNames>';\n  }\n\n\tif(o.length>2){ o[o.length] = '</workbook>'; o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.301 BrtBundleSh */\nfunction parse_BrtBundleSh(data, length) {\n\tvar z = {};\n\tz.hsState = data.read_shift(4); //ST_SheetState\n\tz.iTabID = data.read_shift(4);\n\tz.strRelID = parse_RelID(data,length-8);\n\tz.name = parse_XLWideString(data);\n\treturn z;\n}\nfunction write_BrtBundleSh(data, o) {\n\tif(!o) o = new_buf(127);\n\to.write_shift(4, data.hsState);\n\to.write_shift(4, data.iTabID);\n\twrite_RelID(data.strRelID, o);\n\twrite_XLWideString(data.name.substr(0,31), o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.807 BrtWbProp */\nfunction parse_BrtWbProp(data, length) {\n\tdata.read_shift(4);\n\tvar dwThemeVersion = data.read_shift(4);\n\tvar strName = (length > 8) ? parse_XLWideString(data) : \"\";\n\treturn [dwThemeVersion, strName];\n}\nfunction write_BrtWbProp(data, o) {\n\tif(!o) o = new_buf(8);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\treturn o;\n}\n\nfunction parse_BrtFRTArchID$(data, length) {\n\tvar o = {};\n\tdata.read_shift(4);\n\to.ArchID = data.read_shift(4);\n\tdata.l += length - 8;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.1.7.60 Workbook */\nfunction parse_wb_bin(data, opts) {\n\tvar wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, xmlns: \"\" };\n\tvar pass = false, z;\n\n\trecordhopper(data, function hopper_wb(val, R) {\n\t\tswitch(R.n) {\n\t\t\tcase 'BrtBundleSh': wb.Sheets.push(val); break;\n\n\t\t\tcase 'BrtBeginBook': break;\n\t\t\tcase 'BrtFileVersion': break;\n\t\t\tcase 'BrtWbProp': break;\n\t\t\tcase 'BrtACBegin': break;\n\t\t\tcase 'BrtAbsPath15': break;\n\t\t\tcase 'BrtACEnd': break;\n\t\t\tcase 'BrtWbFactoid': break;\n\t\t\t/*case 'BrtBookProtectionIso': break;*/\n\t\t\tcase 'BrtBookProtection': break;\n\t\t\tcase 'BrtBeginBookViews': break;\n\t\t\tcase 'BrtBookView': break;\n\t\t\tcase 'BrtEndBookViews': break;\n\t\t\tcase 'BrtBeginBundleShs': break;\n\t\t\tcase 'BrtEndBundleShs': break;\n\t\t\tcase 'BrtBeginFnGroup': break;\n\t\t\tcase 'BrtEndFnGroup': break;\n\t\t\tcase 'BrtBeginExternals': break;\n\t\t\tcase 'BrtSupSelf': break;\n\t\t\tcase 'BrtSupBookSrc': break;\n\t\t\tcase 'BrtExternSheet': break;\n\t\t\tcase 'BrtEndExternals': break;\n\t\t\tcase 'BrtName': break;\n\t\t\tcase 'BrtCalcProp': break;\n\t\t\tcase 'BrtUserBookView': break;\n\t\t\tcase 'BrtBeginPivotCacheIDs': break;\n\t\t\tcase 'BrtBeginPivotCacheID': break;\n\t\t\tcase 'BrtEndPivotCacheID': break;\n\t\t\tcase 'BrtEndPivotCacheIDs': break;\n\t\t\tcase 'BrtWebOpt': break;\n\t\t\tcase 'BrtFileRecover': break;\n\t\t\tcase 'BrtFileSharing': break;\n\t\t\t/*case 'BrtBeginWebPubItems': break;\n\t\t\tcase 'BrtBeginWebPubItem': break;\n\t\t\tcase 'BrtEndWebPubItem': break;\n\t\t\tcase 'BrtEndWebPubItems': break;*/\n\n\t\t\t/* Smart Tags */\n\t\t\tcase 'BrtBeginSmartTagTypes': break;\n\t\t\tcase 'BrtSmartTagType': break;\n\t\t\tcase 'BrtEndSmartTagTypes': break;\n\n\t\t\tcase 'BrtFRTBegin': pass = true; break;\n\t\t\tcase 'BrtFRTArchID$': break;\n\t\t\tcase 'BrtWorkBookPr15': break;\n\t\t\tcase 'BrtFRTEnd': pass = false; break;\n\t\t\tcase 'BrtEndBook': break;\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + R.n);\n\t\t}\n\t});\n\n\tparse_wb_defaults(wb);\n\n\treturn wb;\n}\n\n/* [MS-XLSB] 2.1.7.60 Workbook */\nfunction write_BUNDLESHS(ba, wb, opts) {\n\twrite_record(ba, \"BrtBeginBundleShs\");\n\tfor(var idx = 0; idx != wb.SheetNames.length; ++idx) {\n\t\tvar d = { hsState: 0, iTabID: idx+1, strRelID: 'rId' + (idx+1), name: wb.SheetNames[idx] };\n\t\twrite_record(ba, \"BrtBundleSh\", write_BrtBundleSh(d));\n\t}\n\twrite_record(ba, \"BrtEndBundleShs\");\n}\n\n/* [MS-XLSB] 2.4.643 BrtFileVersion */\nfunction write_BrtFileVersion(data, o) {\n\tif(!o) o = new_buf(127);\n\tfor(var i = 0; i != 4; ++i) o.write_shift(4, 0);\n\twrite_XLWideString(\"SheetJS\", o);\n\twrite_XLWideString(XLSX.version, o);\n\twrite_XLWideString(XLSX.version, o);\n\twrite_XLWideString(\"7262\", o);\n\to.length = o.l;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.1.7.60 Workbook */\nfunction write_BOOKVIEWS(ba, wb, opts) {\n\twrite_record(ba, \"BrtBeginBookViews\");\n\t/* 1*(BrtBookView *FRT) */\n\twrite_record(ba, \"BrtEndBookViews\");\n}\n\n/* [MS-XLSB] 2.4.302 BrtCalcProp */\nfunction write_BrtCalcProp(data, o) {\n\tif(!o) o = new_buf(26);\n\to.write_shift(4,0); /* force recalc */\n\to.write_shift(4,1);\n\to.write_shift(4,0);\n\twrite_Xnum(0, o);\n\to.write_shift(-4, 1023);\n\to.write_shift(1, 0x33);\n\to.write_shift(1, 0x00);\n\treturn o;\n}\n\nfunction write_BrtFileRecover(data, o) {\n\tif(!o) o = new_buf(1);\n\to.write_shift(1,0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.1.7.60 Workbook */\nfunction write_wb_bin(wb, opts) {\n\tvar ba = buf_array();\n\twrite_record(ba, \"BrtBeginBook\");\n\twrite_record(ba, \"BrtFileVersion\", write_BrtFileVersion());\n\t/* [[BrtFileSharingIso] BrtFileSharing] */\n\twrite_record(ba, \"BrtWbProp\", write_BrtWbProp());\n\t/* [ACABSPATH] */\n\t/* [[BrtBookProtectionIso] BrtBookProtection] */\n\twrite_BOOKVIEWS(ba, wb, opts);\n\twrite_BUNDLESHS(ba, wb, opts);\n\t/* [FNGROUP] */\n\t/* [EXTERNALS] */\n\t/* *BrtName */\n\twrite_record(ba, \"BrtCalcProp\", write_BrtCalcProp());\n\t/* [BrtOleSize] */\n\t/* *(BrtUserBookView *FRT) */\n\t/* [PIVOTCACHEIDS] */\n\t/* [BrtWbFactoid] */\n\t/* [SMARTTAGTYPES] */\n\t/* [BrtWebOpt] */\n\twrite_record(ba, \"BrtFileRecover\", write_BrtFileRecover());\n\t/* [WEBPUBITEMS] */\n\t/* [CRERRS] */\n\t/* FRTWORKBOOK */\n\twrite_record(ba, \"BrtEndBook\");\n\n\treturn ba.end();\n}\nfunction parse_wb(data, name, opts) {\n\treturn (name.substr(-4)===\".bin\" ? parse_wb_bin : parse_wb_xml)(data, opts);\n}\n\nfunction parse_ws(data, name, opts, rels) {\n\treturn (name.substr(-4)===\".bin\" ? parse_ws_bin : parse_ws_xml)(data, opts, rels);\n}\n\nfunction parse_sty(data, name, opts) {\n\treturn (name.substr(-4)===\".bin\" ? parse_sty_bin : parse_sty_xml)(data, opts);\n}\n\nfunction parse_theme(data, name, opts) {\n\treturn parse_theme_xml(data, opts);\n}\n\nfunction parse_sst(data, name, opts) {\n\treturn (name.substr(-4)===\".bin\" ? parse_sst_bin : parse_sst_xml)(data, opts);\n}\n\nfunction parse_cmnt(data, name, opts) {\n\treturn (name.substr(-4)===\".bin\" ? parse_comments_bin : parse_comments_xml)(data, opts);\n}\n\nfunction parse_cc(data, name, opts) {\n\treturn (name.substr(-4)===\".bin\" ? parse_cc_bin : parse_cc_xml)(data, opts);\n}\n\nfunction write_wb(wb, name, opts) {\n\treturn (name.substr(-4)===\".bin\" ? write_wb_bin : write_wb_xml)(wb, opts);\n}\n\nfunction write_ws(data, name, opts, wb) {\n\treturn (name.substr(-4)===\".bin\" ? write_ws_bin : write_ws_xml)(data, opts, wb);\n}\n\nfunction write_sty(data, name, opts) {\n\treturn (name.substr(-4)===\".bin\" ? write_sty_bin : write_sty_xml)(data, opts);\n}\n\nfunction write_sst(data, name, opts) {\n\treturn (name.substr(-4)===\".bin\" ? write_sst_bin : write_sst_xml)(data, opts);\n}\n/*\nfunction write_cmnt(data, name, opts) {\n\treturn (name.substr(-4)===\".bin\" ? write_comments_bin : write_comments_xml)(data, opts);\n}\n\nfunction write_cc(data, name, opts) {\n\treturn (name.substr(-4)===\".bin\" ? write_cc_bin : write_cc_xml)(data, opts);\n}\n*/\nvar attregexg2=/([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\nvar attregex2=/([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\nvar _chr = function(c) { return String.fromCharCode(c); };\nfunction xlml_parsexmltag(tag, skip_root) {\n\tvar words = tag.split(/\\s+/);\n\tvar z = []; if(!skip_root) z[0] = words[0];\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg2), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex2);\n\t\tif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1,y[2].length-2);\n\t\telse {\n\t\t\tif(y[1].substr(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].substr(6);\n\t\t\telse w = y[1].substr(j+1);\n\t\t\tz[w] = y[2].substr(1,y[2].length-2);\n\t\t}\n\t}\n\treturn z;\n}\nfunction xlml_parsexmltagobj(tag) {\n\tvar words = tag.split(/\\s+/);\n\tvar z = {};\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg2), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex2);\n\t\tif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1,y[2].length-2);\n\t\telse {\n\t\t\tif(y[1].substr(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].substr(6);\n\t\t\telse w = y[1].substr(j+1);\n\t\t\tz[w] = y[2].substr(1,y[2].length-2);\n\t\t}\n\t}\n\treturn z;\n}\n\n// ----\n\nfunction xlml_format(format, value) {\n\tvar fmt = XLMLFormatMap[format] || unescapexml(format);\n\tif(fmt === \"General\") return SSF._general(value);\n\treturn SSF.format(fmt, value);\n}\n\nfunction xlml_set_custprop(Custprops, Rn, cp, val) {\n\tswitch((cp[0].match(/dt:dt=\"([\\w.]+)\"/)||[\"\",\"\"])[1]) {\n\t\tcase \"boolean\": val = parsexmlbool(val); break;\n\t\tcase \"i2\": case \"int\": val = parseInt(val, 10); break;\n\t\tcase \"r4\": case \"float\": val = parseFloat(val); break;\n\t\tcase \"date\": case \"dateTime.tz\": val = new Date(val); break;\n\t\tcase \"i8\": case \"string\": case \"fixed\": case \"uuid\": case \"bin.base64\": break;\n\t\tdefault: throw \"bad custprop:\" + cp[0];\n\t}\n\tCustprops[unescapexml(Rn[3])] = val;\n}\n\nfunction safe_format_xlml(cell, nf, o) {\n\ttry {\n\t\tif(cell.t === 'e') { cell.w = cell.w || BErr[cell.v]; }\n\t\telse if(nf === \"General\") {\n\t\t\tif(cell.t === 'n') {\n\t\t\t\tif((cell.v|0) === cell.v) cell.w = SSF._general_int(cell.v);\n\t\t\t\telse cell.w = SSF._general_num(cell.v);\n\t\t\t}\n\t\t\telse cell.w = SSF._general(cell.v);\n\t\t}\n\t\telse cell.w = xlml_format(nf||\"General\", cell.v);\n\t\tif(o.cellNF) cell.z = XLMLFormatMap[nf]||nf||\"General\";\n\t} catch(e) { if(o.WTF) throw e; }\n}\n\nfunction process_style_xlml(styles, stag, opts) {\n\tif(opts.cellStyles) {\n\t\tif(stag.Interior) {\n\t\t\tvar I = stag.Interior;\n\t\t\tif(I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\n\t\t}\n\t}\n\tstyles[stag.ID] = stag;\n}\n\n/* TODO: there must exist some form of OSP-blessed spec */\nfunction parse_xlml_data(xml, ss, data, cell, base, styles, csty, row, o) {\n\tvar nf = \"General\", sid = cell.StyleID, S = {}; o = o || {};\n\tvar interiors = [];\n\tif(sid === undefined && row) sid = row.StyleID;\n\tif(sid === undefined && csty) sid = csty.StyleID;\n\twhile(styles[sid] !== undefined) {\n\t\tif(styles[sid].nf) nf = styles[sid].nf;\n\t\tif(styles[sid].Interior) interiors.push(styles[sid].Interior);\n\t\tif(!styles[sid].Parent) break;\n\t\tsid = styles[sid].Parent;\n\t}\n\tswitch(data.Type) {\n\t\tcase 'Boolean':\n\t\t\tcell.t = 'b';\n\t\t\tcell.v = parsexmlbool(xml);\n\t\t\tbreak;\n\t\tcase 'String':\n\t\t\tcell.t = 's'; cell.r = xlml_fixstr(unescapexml(xml));\n\t\t\tcell.v = xml.indexOf(\"<\") > -1 ? ss : cell.r;\n\t\t\tbreak;\n\t\tcase 'DateTime':\n\t\t\tcell.v = (Date.parse(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n\t\t\tif(cell.v !== cell.v) cell.v = unescapexml(xml);\n\t\t\telse if(cell.v >= 1 && cell.v<60) cell.v = cell.v -1;\n\t\t\tif(!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n\t\t\t/* falls through */\n\t\tcase 'Number':\n\t\t\tif(cell.v === undefined) cell.v=+xml;\n\t\t\tif(!cell.t) cell.t = 'n';\n\t\t\tbreak;\n\t\tcase 'Error': cell.t = 'e'; cell.v = RBErr[xml]; cell.w = xml; break;\n\t\tdefault: cell.t = 's'; cell.v = xlml_fixstr(ss); break;\n\t}\n\tsafe_format_xlml(cell, nf, o);\n\tif(o.cellFormula != null && cell.Formula) {\n\t\tcell.f = rc_to_a1(unescapexml(cell.Formula), base);\n\t\tcell.Formula = undefined;\n\t}\n\tif(o.cellStyles) {\n\t\tinteriors.forEach(function(x) {\n\t\t\tif(!S.patternType && x.patternType) S.patternType = x.patternType;\n\t\t});\n\t\tcell.s = S;\n\t}\n\tcell.ixfe = cell.StyleID !== undefined ? cell.StyleID : 'Default';\n}\n\nfunction xlml_clean_comment(comment) {\n\tcomment.t = comment.v;\n\tcomment.v = comment.w = comment.ixfe = undefined;\n}\n\nfunction xlml_normalize(d) {\n\tif(has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\n\tif(typeof d === 'string') return d;\n\tthrow \"badf\";\n}\n\n/* TODO: Everything */\nvar xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\nfunction parse_xlml_xml(d, opts) {\n\tvar str = xlml_normalize(d);\n\tvar Rn;\n\tvar state = [], tmp;\n\tvar sheets = {}, sheetnames = [], cursheet = {}, sheetname = \"\";\n\tvar table = {}, cell = {}, row = {}, dtag, didx;\n\tvar c = 0, r = 0;\n\tvar refguess = {s: {r:1000000, c:1000000}, e: {r:0, c:0} };\n\tvar styles = {}, stag = {};\n\tvar ss = \"\", fidx = 0;\n\tvar mergecells = [];\n\tvar Props = {}, Custprops = {}, pidx = 0, cp = {};\n\tvar comments = [], comment = {};\n\tvar cstys = [], csty;\n\txlmlregex.lastIndex = 0;\n\twhile((Rn = xlmlregex.exec(str))) switch(Rn[3]) {\n\t\tcase 'Data':\n\t\t\tif(state[state.length-1][1]) break;\n\t\t\tif(Rn[1]==='/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length-1][0]==\"Comment\"?comment:cell, {c:c,r:r}, styles, cstys[c], row, opts);\n\t\t\telse { ss = \"\"; dtag = xlml_parsexmltag(Rn[0]); didx = Rn.index + Rn[0].length; }\n\t\t\tbreak;\n\t\tcase 'Cell':\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif(comments.length > 0) cell.c = comments;\n\t\t\t\tif((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) cursheet[encode_col(c) + encode_row(r)] = cell;\n\t\t\t\tif(cell.HRef) {\n\t\t\t\t\tcell.l = {Target:cell.HRef, tooltip:cell.HRefScreenTip};\n\t\t\t\t\tcell.HRef = cell.HRefScreenTip = undefined;\n\t\t\t\t}\n\t\t\t\tif(cell.MergeAcross || cell.MergeDown) {\n\t\t\t\t\tvar cc = c + (parseInt(cell.MergeAcross,10)|0);\n\t\t\t\t\tvar rr = r + (parseInt(cell.MergeDown,10)|0);\n\t\t\t\t\tmergecells.push({s:{c:c,r:r},e:{c:cc,r:rr}});\n\t\t\t\t}\n\t\t\t\t++c;\n\t\t\t\tif(cell.MergeAcross) c += +cell.MergeAcross;\n\t\t\t} else {\n\t\t\t\tcell = xlml_parsexmltagobj(Rn[0]);\n\t\t\t\tif(cell.Index) c = +cell.Index - 1;\n\t\t\t\tif(c < refguess.s.c) refguess.s.c = c;\n\t\t\t\tif(c > refguess.e.c) refguess.e.c = c;\n\t\t\t\tif(Rn[0].substr(-2) === \"/>\") ++c;\n\t\t\t\tcomments = [];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'Row':\n\t\t\tif(Rn[1]==='/' || Rn[0].substr(-2) === \"/>\") {\n\t\t\t\tif(r < refguess.s.r) refguess.s.r = r;\n\t\t\t\tif(r > refguess.e.r) refguess.e.r = r;\n\t\t\t\tif(Rn[0].substr(-2) === \"/>\") {\n\t\t\t\t\trow = xlml_parsexmltag(Rn[0]);\n\t\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t\t}\n\t\t\t\tc = 0; ++r;\n\t\t\t} else {\n\t\t\t\trow = xlml_parsexmltag(Rn[0]);\n\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'Worksheet': /* TODO: read range from FullRows/FullColumns */\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\n\t\t\t\tsheetnames.push(sheetname);\n\t\t\t\tif(refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) cursheet[\"!ref\"] = encode_range(refguess);\n\t\t\t\tif(mergecells.length) cursheet[\"!merges\"] = mergecells;\n\t\t\t\tsheets[sheetname] = cursheet;\n\t\t\t} else {\n\t\t\t\trefguess = {s: {r:1000000, c:1000000}, e: {r:0, c:0} };\n\t\t\t\tr = c = 0;\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\n\t\t\t\tsheetname = tmp.Name;\n\t\t\t\tcursheet = {};\n\t\t\t\tmergecells = [];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'Table':\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\telse if(Rn[0].slice(-2) == \"/>\") break;\n\t\t\telse {\n\t\t\t\ttable = xlml_parsexmltag(Rn[0]);\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\tcstys = [];\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'Style':\n\t\t\tif(Rn[1]==='/') process_style_xlml(styles, stag, opts);\n\t\t\telse stag = xlml_parsexmltag(Rn[0]);\n\t\t\tbreak;\n\n\t\tcase 'NumberFormat':\n\t\t\tstag.nf = xlml_parsexmltag(Rn[0]).Format || \"General\";\n\t\t\tbreak;\n\n\t\tcase 'Column':\n\t\t\tif(state[state.length-1][0] !== 'Table') break;\n\t\t\tcsty = xlml_parsexmltag(Rn[0]);\n\t\t\tcstys[(csty.Index-1||cstys.length)] = csty;\n\t\t\tfor(var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = csty;\n\t\t\tbreak;\n\n\t\tcase 'NamedRange': break;\n\t\tcase 'NamedCell': break;\n\t\tcase 'B': break;\n\t\tcase 'I': break;\n\t\tcase 'U': break;\n\t\tcase 'S': break;\n\t\tcase 'Sub': break;\n\t\tcase 'Sup': break;\n\t\tcase 'Span': break;\n\t\tcase 'Border': break;\n\t\tcase 'Alignment': break;\n\t\tcase 'Borders': break;\n\t\tcase 'Font':\n\t\t\tif(Rn[0].substr(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") ss += str.slice(fidx, Rn.index);\n\t\t\telse fidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'Interior':\n\t\t\tif(!opts.cellStyles) break;\n\t\t\tstag.Interior = xlml_parsexmltag(Rn[0]);\n\t\t\tbreak;\n\t\tcase 'Protection': break;\n\n\t\tcase 'Author':\n\t\tcase 'Title':\n\t\tcase 'Description':\n\t\tcase 'Created':\n\t\tcase 'Keywords':\n\t\tcase 'Subject':\n\t\tcase 'Category':\n\t\tcase 'Company':\n\t\tcase 'LastAuthor':\n\t\tcase 'LastSaved':\n\t\tcase 'LastPrinted':\n\t\tcase 'Version':\n\t\tcase 'Revision':\n\t\tcase 'TotalTime':\n\t\tcase 'HyperlinkBase':\n\t\tcase 'Manager':\n\t\t\tif(Rn[0].substr(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") xlml_set_prop(Props, Rn[3], str.slice(pidx, Rn.index));\n\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'Paragraphs': break;\n\n\t\tcase 'Styles':\n\t\tcase 'Workbook':\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\telse state.push([Rn[3], false]);\n\t\t\tbreak;\n\n\t\tcase 'Comment':\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\n\t\t\t\txlml_clean_comment(comment);\n\t\t\t\tcomments.push(comment);\n\t\t\t} else {\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\n\t\t\t\tcomment = {a:tmp.Author};\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'Name': break;\n\n\t\tcase 'ComponentOptions':\n\t\tcase 'DocumentProperties':\n\t\tcase 'CustomDocumentProperties':\n\t\tcase 'OfficeDocumentSettings':\n\t\tcase 'PivotTable':\n\t\tcase 'PivotCache':\n\t\tcase 'Names':\n\t\tcase 'MapInfo':\n\t\tcase 'PageBreaks':\n\t\tcase 'QueryTable':\n\t\tcase 'DataValidation':\n\t\tcase 'AutoFilter':\n\t\tcase 'Sorting':\n\t\tcase 'Schema':\n\t\tcase 'data':\n\t\tcase 'ConditionalFormatting':\n\t\tcase 'SmartTagType':\n\t\tcase 'SmartTags':\n\t\tcase 'ExcelWorkbook':\n\t\tcase 'WorkbookOptions':\n\t\tcase 'WorksheetOptions':\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tvar seen = true;\n\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t/* OfficeDocumentSettings */\n\t\t\t\tcase 'OfficeDocumentSettings': switch(Rn[3]) {\n\t\t\t\t\tcase 'AllowPNG': break;\n\t\t\t\t\tcase 'RemovePersonalInformation': break;\n\t\t\t\t\tcase 'DownloadComponents': break;\n\t\t\t\t\tcase 'LocationOfComponents': break;\n\t\t\t\t\tcase 'Colors': break;\n\t\t\t\t\tcase 'Color': break;\n\t\t\t\t\tcase 'Index': break;\n\t\t\t\t\tcase 'RGB': break;\n\t\t\t\t\tcase 'PixelsPerInch': break;\n\t\t\t\t\tcase 'TargetScreenSize': break;\n\t\t\t\t\tcase 'ReadOnlyRecommended': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ComponentOptions */\n\t\t\t\tcase 'ComponentOptions': switch(Rn[3]) {\n\t\t\t\t\tcase 'Toolbar': break;\n\t\t\t\t\tcase 'HideOfficeLogo': break;\n\t\t\t\t\tcase 'SpreadsheetAutoFit': break;\n\t\t\t\t\tcase 'Label': break;\n\t\t\t\t\tcase 'Caption': break;\n\t\t\t\t\tcase 'MaxHeight': break;\n\t\t\t\t\tcase 'MaxWidth': break;\n\t\t\t\t\tcase 'NextSheetNumber': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ExcelWorkbook */\n\t\t\t\tcase 'ExcelWorkbook': switch(Rn[3]) {\n\t\t\t\t\tcase 'WindowHeight': break;\n\t\t\t\t\tcase 'WindowWidth': break;\n\t\t\t\t\tcase 'WindowTopX': break;\n\t\t\t\t\tcase 'WindowTopY': break;\n\t\t\t\t\tcase 'TabRatio': break;\n\t\t\t\t\tcase 'ProtectStructure': break;\n\t\t\t\t\tcase 'ProtectWindows': break;\n\t\t\t\t\tcase 'ActiveSheet': break;\n\t\t\t\t\tcase 'DisplayInkNotes': break;\n\t\t\t\t\tcase 'FirstVisibleSheet': break;\n\t\t\t\t\tcase 'SupBook': break;\n\t\t\t\t\tcase 'SheetName': break;\n\t\t\t\t\tcase 'SheetIndex': break;\n\t\t\t\t\tcase 'SheetIndexFirst': break;\n\t\t\t\t\tcase 'SheetIndexLast': break;\n\t\t\t\t\tcase 'Dll': break;\n\t\t\t\t\tcase 'AcceptLabelsInFormulas': break;\n\t\t\t\t\tcase 'DoNotSaveLinkValues': break;\n\t\t\t\t\tcase 'Date1904': break;\n\t\t\t\t\tcase 'Iteration': break;\n\t\t\t\t\tcase 'MaxIterations': break;\n\t\t\t\t\tcase 'MaxChange': break;\n\t\t\t\t\tcase 'Path': break;\n\t\t\t\t\tcase 'Xct': break;\n\t\t\t\t\tcase 'Count': break;\n\t\t\t\t\tcase 'SelectedSheets': break;\n\t\t\t\t\tcase 'Calculation': break;\n\t\t\t\t\tcase 'Uncalced': break;\n\t\t\t\t\tcase 'StartupPrompt': break;\n\t\t\t\t\tcase 'Crn': break;\n\t\t\t\t\tcase 'ExternName': break;\n\t\t\t\t\tcase 'Formula': break;\n\t\t\t\t\tcase 'ColFirst': break;\n\t\t\t\t\tcase 'ColLast': break;\n\t\t\t\t\tcase 'WantAdvise': break;\n\t\t\t\t\tcase 'Boolean': break;\n\t\t\t\t\tcase 'Error': break;\n\t\t\t\t\tcase 'Text': break;\n\t\t\t\t\tcase 'OLE': break;\n\t\t\t\t\tcase 'NoAutoRecover': break;\n\t\t\t\t\tcase 'PublishObjects': break;\n\t\t\t\t\tcase 'DoNotCalculateBeforeSave': break;\n\t\t\t\t\tcase 'Number': break;\n\t\t\t\t\tcase 'RefModeR1C1': break;\n\t\t\t\t\tcase 'EmbedSaveSmartTags': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorkbookOptions */\n\t\t\t\tcase 'WorkbookOptions': switch(Rn[3]) {\n\t\t\t\t\tcase 'OWCVersion': break;\n\t\t\t\t\tcase 'Height': break;\n\t\t\t\t\tcase 'Width': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorksheetOptions */\n\t\t\t\tcase 'WorksheetOptions': switch(Rn[3]) {\n\t\t\t\t\tcase 'Unsynced': break;\n\t\t\t\t\tcase 'Visible': break;\n\t\t\t\t\tcase 'Print': break;\n\t\t\t\t\tcase 'Panes': break;\n\t\t\t\t\tcase 'Scale': break;\n\t\t\t\t\tcase 'Pane': break;\n\t\t\t\t\tcase 'Number': break;\n\t\t\t\t\tcase 'Layout': break;\n\t\t\t\t\tcase 'Header': break;\n\t\t\t\t\tcase 'Footer': break;\n\t\t\t\t\tcase 'PageSetup': break;\n\t\t\t\t\tcase 'PageMargins': break;\n\t\t\t\t\tcase 'Selected': break;\n\t\t\t\t\tcase 'ProtectObjects': break;\n\t\t\t\t\tcase 'EnableSelection': break;\n\t\t\t\t\tcase 'ProtectScenarios': break;\n\t\t\t\t\tcase 'ValidPrinterInfo': break;\n\t\t\t\t\tcase 'HorizontalResolution': break;\n\t\t\t\t\tcase 'VerticalResolution': break;\n\t\t\t\t\tcase 'NumberofCopies': break;\n\t\t\t\t\tcase 'ActiveRow': break;\n\t\t\t\t\tcase 'ActiveCol': break;\n\t\t\t\t\tcase 'ActivePane': break;\n\t\t\t\t\tcase 'TopRowVisible': break;\n\t\t\t\t\tcase 'TopRowBottomPane': break;\n\t\t\t\t\tcase 'LeftColumnVisible': break;\n\t\t\t\t\tcase 'LeftColumnRightPane': break;\n\t\t\t\t\tcase 'FitToPage': break;\n\t\t\t\t\tcase 'RangeSelection': break;\n\t\t\t\t\tcase 'PaperSizeIndex': break;\n\t\t\t\t\tcase 'PageLayoutZoom': break;\n\t\t\t\t\tcase 'PageBreakZoom': break;\n\t\t\t\t\tcase 'FilterOn': break;\n\t\t\t\t\tcase 'DoNotDisplayGridlines': break;\n\t\t\t\t\tcase 'SplitHorizontal': break;\n\t\t\t\t\tcase 'SplitVertical': break;\n\t\t\t\t\tcase 'FreezePanes': break;\n\t\t\t\t\tcase 'FrozenNoSplit': break;\n\t\t\t\t\tcase 'FitWidth': break;\n\t\t\t\t\tcase 'FitHeight': break;\n\t\t\t\t\tcase 'CommentsLayout': break;\n\t\t\t\t\tcase 'Zoom': break;\n\t\t\t\t\tcase 'LeftToRight': break;\n\t\t\t\t\tcase 'Gridlines': break;\n\t\t\t\t\tcase 'AllowSort': break;\n\t\t\t\t\tcase 'AllowFilter': break;\n\t\t\t\t\tcase 'AllowInsertRows': break;\n\t\t\t\t\tcase 'AllowDeleteRows': break;\n\t\t\t\t\tcase 'AllowInsertCols': break;\n\t\t\t\t\tcase 'AllowDeleteCols': break;\n\t\t\t\t\tcase 'AllowInsertHyperlinks': break;\n\t\t\t\t\tcase 'AllowFormatCells': break;\n\t\t\t\t\tcase 'AllowSizeCols': break;\n\t\t\t\t\tcase 'AllowSizeRows': break;\n\t\t\t\t\tcase 'NoSummaryRowsBelowDetail': break;\n\t\t\t\t\tcase 'TabColorIndex': break;\n\t\t\t\t\tcase 'DoNotDisplayHeadings': break;\n\t\t\t\t\tcase 'ShowPageLayoutZoom': break;\n\t\t\t\t\tcase 'NoSummaryColumnsRightDetail': break;\n\t\t\t\t\tcase 'BlackAndWhite': break;\n\t\t\t\t\tcase 'DoNotDisplayZeros': break;\n\t\t\t\t\tcase 'DisplayPageBreak': break;\n\t\t\t\t\tcase 'RowColHeadings': break;\n\t\t\t\t\tcase 'DoNotDisplayOutline': break;\n\t\t\t\t\tcase 'NoOrientation': break;\n\t\t\t\t\tcase 'AllowUsePivotTables': break;\n\t\t\t\t\tcase 'ZeroHeight': break;\n\t\t\t\t\tcase 'ViewableRange': break;\n\t\t\t\t\tcase 'Selection': break;\n\t\t\t\t\tcase 'ProtectContents': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PivotTable */\n\t\t\t\tcase 'PivotTable': case 'PivotCache': switch(Rn[3]) {\n\t\t\t\t\tcase 'ImmediateItemsOnDrop': break;\n\t\t\t\t\tcase 'ShowPageMultipleItemLabel': break;\n\t\t\t\t\tcase 'CompactRowIndent': break;\n\t\t\t\t\tcase 'Location': break;\n\t\t\t\t\tcase 'PivotField': break;\n\t\t\t\t\tcase 'Orientation': break;\n\t\t\t\t\tcase 'LayoutForm': break;\n\t\t\t\t\tcase 'LayoutSubtotalLocation': break;\n\t\t\t\t\tcase 'LayoutCompactRow': break;\n\t\t\t\t\tcase 'Position': break;\n\t\t\t\t\tcase 'PivotItem': break;\n\t\t\t\t\tcase 'DataType': break;\n\t\t\t\t\tcase 'DataField': break;\n\t\t\t\t\tcase 'SourceName': break;\n\t\t\t\t\tcase 'ParentField': break;\n\t\t\t\t\tcase 'PTLineItems': break;\n\t\t\t\t\tcase 'PTLineItem': break;\n\t\t\t\t\tcase 'CountOfSameItems': break;\n\t\t\t\t\tcase 'Item': break;\n\t\t\t\t\tcase 'ItemType': break;\n\t\t\t\t\tcase 'PTSource': break;\n\t\t\t\t\tcase 'CacheIndex': break;\n\t\t\t\t\tcase 'ConsolidationReference': break;\n\t\t\t\t\tcase 'FileName': break;\n\t\t\t\t\tcase 'Reference': break;\n\t\t\t\t\tcase 'NoColumnGrand': break;\n\t\t\t\t\tcase 'NoRowGrand': break;\n\t\t\t\t\tcase 'BlankLineAfterItems': break;\n\t\t\t\t\tcase 'Hidden': break;\n\t\t\t\t\tcase 'Subtotal': break;\n\t\t\t\t\tcase 'BaseField': break;\n\t\t\t\t\tcase 'MapChildItems': break;\n\t\t\t\t\tcase 'Function': break;\n\t\t\t\t\tcase 'RefreshOnFileOpen': break;\n\t\t\t\t\tcase 'PrintSetTitles': break;\n\t\t\t\t\tcase 'MergeLabels': break;\n\t\t\t\t\tcase 'DefaultVersion': break;\n\t\t\t\t\tcase 'RefreshName': break;\n\t\t\t\t\tcase 'RefreshDate': break;\n\t\t\t\t\tcase 'RefreshDateCopy': break;\n\t\t\t\t\tcase 'VersionLastRefresh': break;\n\t\t\t\t\tcase 'VersionLastUpdate': break;\n\t\t\t\t\tcase 'VersionUpdateableMin': break;\n\t\t\t\t\tcase 'VersionRefreshableMin': break;\n\t\t\t\t\tcase 'Calculation': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PageBreaks */\n\t\t\t\tcase 'PageBreaks': switch(Rn[3]) {\n\t\t\t\t\tcase 'ColBreaks': break;\n\t\t\t\t\tcase 'ColBreak': break;\n\t\t\t\t\tcase 'RowBreaks': break;\n\t\t\t\t\tcase 'RowBreak': break;\n\t\t\t\t\tcase 'ColStart': break;\n\t\t\t\t\tcase 'ColEnd': break;\n\t\t\t\t\tcase 'RowEnd': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* AutoFilter */\n\t\t\t\tcase 'AutoFilter': switch(Rn[3]) {\n\t\t\t\t\tcase 'AutoFilterColumn': break;\n\t\t\t\t\tcase 'AutoFilterCondition': break;\n\t\t\t\t\tcase 'AutoFilterAnd': break;\n\t\t\t\t\tcase 'AutoFilterOr': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* QueryTable */\n\t\t\t\tcase 'QueryTable': switch(Rn[3]) {\n\t\t\t\t\tcase 'Id': break;\n\t\t\t\t\tcase 'AutoFormatFont': break;\n\t\t\t\t\tcase 'AutoFormatPattern': break;\n\t\t\t\t\tcase 'QuerySource': break;\n\t\t\t\t\tcase 'QueryType': break;\n\t\t\t\t\tcase 'EnableRedirections': break;\n\t\t\t\t\tcase 'RefreshedInXl9': break;\n\t\t\t\t\tcase 'URLString': break;\n\t\t\t\t\tcase 'HTMLTables': break;\n\t\t\t\t\tcase 'Connection': break;\n\t\t\t\t\tcase 'CommandText': break;\n\t\t\t\t\tcase 'RefreshInfo': break;\n\t\t\t\t\tcase 'NoTitles': break;\n\t\t\t\t\tcase 'NextId': break;\n\t\t\t\t\tcase 'ColumnInfo': break;\n\t\t\t\t\tcase 'OverwriteCells': break;\n\t\t\t\t\tcase 'DoNotPromptForFile': break;\n\t\t\t\t\tcase 'TextWizardSettings': break;\n\t\t\t\t\tcase 'Source': break;\n\t\t\t\t\tcase 'Number': break;\n\t\t\t\t\tcase 'Decimal': break;\n\t\t\t\t\tcase 'ThousandSeparator': break;\n\t\t\t\t\tcase 'TrailingMinusNumbers': break;\n\t\t\t\t\tcase 'FormatSettings': break;\n\t\t\t\t\tcase 'FieldType': break;\n\t\t\t\t\tcase 'Delimiters': break;\n\t\t\t\t\tcase 'Tab': break;\n\t\t\t\t\tcase 'Comma': break;\n\t\t\t\t\tcase 'AutoFormatName': break;\n\t\t\t\t\tcase 'VersionLastEdit': break;\n\t\t\t\t\tcase 'VersionLastRefresh': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* Sorting */\n\t\t\t\tcase 'Sorting':\n\t\t\t\t/* ConditionalFormatting */\n\t\t\t\tcase 'ConditionalFormatting':\n\t\t\t\t/* DataValidation */\n\t\t\t\tcase 'DataValidation': switch(Rn[3]) {\n\t\t\t\t\tcase 'Range': break;\n\t\t\t\t\tcase 'Type': break;\n\t\t\t\t\tcase 'Min': break;\n\t\t\t\t\tcase 'Max': break;\n\t\t\t\t\tcase 'Sort': break;\n\t\t\t\t\tcase 'Descending': break;\n\t\t\t\t\tcase 'Order': break;\n\t\t\t\t\tcase 'CaseSensitive': break;\n\t\t\t\t\tcase 'Value': break;\n\t\t\t\t\tcase 'ErrorStyle': break;\n\t\t\t\t\tcase 'ErrorMessage': break;\n\t\t\t\t\tcase 'ErrorTitle': break;\n\t\t\t\t\tcase 'CellRangeList': break;\n\t\t\t\t\tcase 'InputMessage': break;\n\t\t\t\t\tcase 'InputTitle': break;\n\t\t\t\t\tcase 'ComboHide': break;\n\t\t\t\t\tcase 'InputHide': break;\n\t\t\t\t\tcase 'Condition': break;\n\t\t\t\t\tcase 'Qualifier': break;\n\t\t\t\t\tcase 'UseBlank': break;\n\t\t\t\t\tcase 'Value1': break;\n\t\t\t\t\tcase 'Value2': break;\n\t\t\t\t\tcase 'Format': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* MapInfo (schema) */\n\t\t\t\tcase 'MapInfo': case 'Schema': case 'data': switch(Rn[3]) {\n\t\t\t\t\tcase 'Map': break;\n\t\t\t\t\tcase 'Entry': break;\n\t\t\t\t\tcase 'Range': break;\n\t\t\t\t\tcase 'XPath': break;\n\t\t\t\t\tcase 'Field': break;\n\t\t\t\t\tcase 'XSDType': break;\n\t\t\t\t\tcase 'FilterOn': break;\n\t\t\t\t\tcase 'Aggregate': break;\n\t\t\t\t\tcase 'ElementType': break;\n\t\t\t\t\tcase 'AttributeType': break;\n\t\t\t\t/* These are from xsd (XML Schema Definition) */\n\t\t\t\t\tcase 'schema':\n\t\t\t\t\tcase 'element':\n\t\t\t\t\tcase 'complexType':\n\t\t\t\t\tcase 'datatype':\n\t\t\t\t\tcase 'all':\n\t\t\t\t\tcase 'attribute':\n\t\t\t\t\tcase 'extends': break;\n\n\t\t\t\t\tcase 'row': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* SmartTags (can be anything) */\n\t\t\t\tcase 'SmartTags': break;\n\n\t\t\t\tdefault: seen = false; break;\n\t\t\t}\n\t\t\tif(seen) break;\n\t\t\t/* CustomDocumentProperties */\n\t\t\tif(!state[state.length-1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t\t\tif(state[state.length-1][0]==='CustomDocumentProperties') {\n\t\t\t\tif(Rn[0].substr(-2) === \"/>\") break;\n\t\t\t\telse if(Rn[1]===\"/\") xlml_set_custprop(Custprops, Rn, cp, str.slice(pidx, Rn.index));\n\t\t\t\telse { cp = Rn; pidx = Rn.index + Rn[0].length; }\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t}\n\tvar out = {};\n\tif(!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n\tout.SheetNames = sheetnames;\n\tout.SSF = SSF.get_table();\n\tout.Props = Props;\n\tout.Custprops = Custprops;\n\treturn out;\n}\n\nfunction parse_xlml(data, opts) {\n\tfix_read_opts(opts=opts||{});\n\tswitch(opts.type||\"base64\") {\n\t\tcase \"base64\": return parse_xlml_xml(Base64.decode(data), opts);\n\t\tcase \"binary\": case \"buffer\": case \"file\": return parse_xlml_xml(data, opts);\n\t\tcase \"array\": return parse_xlml_xml(data.map(_chr).join(\"\"), opts);\n\t}\n}\n\nfunction write_xlml(wb, opts) { }\n\n/* [MS-OLEDS] 2.3.8 CompObjStream */\nfunction parse_compobj(obj) {\n\tvar v = {};\n\tvar o = obj.content;\n\n\t/* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n\tvar l = 28, m;\n\tm = __lpstr(o, l);\n\tl += 4 + __readUInt32LE(o,l);\n\tv.UserType = m;\n\n\t/* [MS-OLEDS] 2.3.1 ClipboardFormatOrAnsiString */\n\tm = __readUInt32LE(o,l); l+= 4;\n\tswitch(m) {\n\t\tcase 0x00000000: break;\n\t\tcase 0xffffffff: case 0xfffffffe: l+=4; break;\n\t\tdefault:\n\t\t\tif(m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n\t\t\tl += m;\n\t}\n\n\tm = __lpstr(o, l); l += m.length === 0 ? 0 : 5 + m.length; v.Reserved1 = m;\n\n\tif((m = __readUInt32LE(o,l)) !== 0x71b2e9f4) return v;\n\tthrow \"Unsupported Unicode Extension\";\n}\n\n/* 2.4.58 Continue logic */\nfunction slurp(R, blob, length, opts) {\n\tvar l = length;\n\tvar bufs = [];\n\tvar d = blob.slice(blob.l,blob.l+l);\n\tif(opts && opts.enc && opts.enc.insitu_decrypt) switch(R.n) {\n\tcase 'BOF': case 'FilePass': case 'FileLock': case 'InterfaceHdr': case 'RRDInfo': case 'RRDHead': case 'UsrExcl': break;\n\tdefault:\n\t\tif(d.length === 0) break;\n\t\topts.enc.insitu_decrypt(d);\n\t}\n\tbufs.push(d);\n\tblob.l += l;\n\tvar next = (XLSRecordEnum[__readUInt16LE(blob,blob.l)]);\n\twhile(next != null && next.n === 'Continue') {\n\t\tl = __readUInt16LE(blob,blob.l+2);\n\t\tbufs.push(blob.slice(blob.l+4,blob.l+4+l));\n\t\tblob.l += 4+l;\n\t\tnext = (XLSRecordEnum[__readUInt16LE(blob, blob.l)]);\n\t}\n\tvar b = bconcat(bufs);\n\tprep_blob(b, 0);\n\tvar ll = 0; b.lens = [];\n\tfor(var j = 0; j < bufs.length; ++j) { b.lens.push(ll); ll += bufs[j].length; }\n\treturn R.f(b, b.length, opts);\n}\n\nfunction safe_format_xf(p, opts, date1904) {\n\tif(!p.XF) return;\n\ttry {\n\t\tvar fmtid = p.XF.ifmt||0;\n\t\tif(p.t === 'e') { p.w = p.w || BErr[p.v]; }\n\t\telse if(fmtid === 0) {\n\t\t\tif(p.t === 'n') {\n\t\t\t\tif((p.v|0) === p.v) p.w = SSF._general_int(p.v);\n\t\t\t\telse p.w = SSF._general_num(p.v);\n\t\t\t}\n\t\t\telse p.w = SSF._general(p.v);\n\t\t}\n\t\telse p.w = SSF.format(fmtid,p.v, {date1904:date1904||false});\n\t\tif(opts.cellNF) p.z = SSF._table[fmtid];\n\t} catch(e) { if(opts.WTF) throw e; }\n}\n\nfunction make_cell(val, ixfe, t) {\n\treturn {v:val, ixfe:ixfe, t:t};\n}\n\n// 2.3.2\nfunction parse_workbook(blob, options) {\n\tvar wb = {opts:{}};\n\tvar Sheets = {};\n\tvar out = {};\n\tvar Directory = {};\n\tvar found_sheet = false;\n\tvar range = {};\n\tvar last_formula = null;\n\tvar sst = [];\n\tvar cur_sheet = \"\";\n\tvar Preamble = {};\n\tvar lastcell, last_cell, cc, cmnt, rng, rngC, rngR;\n\tvar shared_formulae = {};\n\tvar array_formulae = []; /* TODO: something more clever */\n\tvar temp_val;\n\tvar country;\n\tvar cell_valid = true;\n\tvar XFs = []; /* XF records */\n\tvar palette = [];\n\tvar get_rgb = function getrgb(icv) {\n\t\tif(icv < 8) return XLSIcv[icv];\n\t\tif(icv < 64) return palette[icv-8] || XLSIcv[icv];\n\t\treturn XLSIcv[icv];\n\t};\n\tvar process_cell_style = function pcs(cell, line) {\n\t\tvar xfd = line.XF.data;\n\t\tif(!xfd || !xfd.patternType) return;\n\t\tline.s = {};\n\t\tline.s.patternType = xfd.patternType;\n\t\tvar t;\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvFore)))) { line.s.fgColor = {rgb:t}; }\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvBack)))) { line.s.bgColor = {rgb:t}; }\n\t};\n\tvar addcell = function addcell(cell, line, options) {\n\t\tif(!cell_valid) return;\n\t\tif(options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line);\n\t\tlastcell = cell;\n\t\tlast_cell = encode_cell(cell);\n\t\tif(range.s) {\n\t\t\tif(cell.r < range.s.r) range.s.r = cell.r;\n\t\t\tif(cell.c < range.s.c) range.s.c = cell.c;\n\t\t}\n\t\tif(range.e) {\n\t\t\tif(cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n\t\t\tif(cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n\t\t}\n\t\tif(options.sheetRows && lastcell.r >= options.sheetRows) cell_valid = false;\n\t\telse out[last_cell] = line;\n\t};\n\tvar opts = {\n\t\tenc: false, // encrypted\n\t\tsbcch: 0, // cch in the preceding SupBook\n\t\tsnames: [], // sheetnames\n\t\tsharedf: shared_formulae, // shared formulae by address\n\t\tarrayf: array_formulae, // array formulae array\n\t\trrtabid: [], // RRTabId\n\t\tlastuser: \"\", // Last User from WriteAccess\n\t\tbiff: 8, // BIFF version\n\t\tcodepage: 0, // CP from CodePage record\n\t\twinlocked: 0, // fLockWn from WinProtect\n\t\twtf: false\n\t};\n\tif(options.password) opts.password = options.password;\n\tvar mergecells = [];\n\tvar objects = [];\n\tvar supbooks = [[]]; // 1-indexed, will hold extern names\n\tvar sbc = 0, sbci = 0, sbcli = 0;\n\tsupbooks.SheetNames = opts.snames;\n\tsupbooks.sharedf = opts.sharedf;\n\tsupbooks.arrayf = opts.arrayf;\n\tvar last_Rn = '';\n\tvar file_depth = 0; /* TODO: make a real stack */\n\n\t/* explicit override for some broken writers */\n\topts.codepage = 1200;\n\tset_cp(1200);\n\n\twhile(blob.l < blob.length - 1) {\n\t\tvar s = blob.l;\n\t\tvar RecordType = blob.read_shift(2);\n\t\tif(RecordType === 0 && last_Rn === 'EOF') break;\n\t\tvar length = (blob.l === blob.length ? 0 : blob.read_shift(2)), y;\n\t\tvar R = XLSRecordEnum[RecordType];\n\t\tif(R && R.f) {\n\t\t\tif(options.bookSheets) {\n\t\t\t\tif(last_Rn === 'BoundSheet8' && R.n !== 'BoundSheet8') break;\n\t\t\t}\n\t\t\tlast_Rn = R.n;\n\t\t\tif(R.r === 2 || R.r == 12) {\n\t\t\t\tvar rt = blob.read_shift(2); length -= 2;\n\t\t\t\tif(!opts.enc && rt !== RecordType) throw \"rt mismatch\";\n\t\t\t\tif(R.r == 12){ blob.l += 10; length -= 10; } // skip FRT\n\t\t\t}\n\t\t\t//console.error(R,blob.l,length,blob.length);\n\t\t\tvar val;\n\t\t\tif(R.n === 'EOF') val = R.f(blob, length, opts);\n\t\t\telse val = slurp(R, blob, length, opts);\n\t\t\tvar Rn = R.n;\n\t\t\t/* BIFF5 overrides */\n\t\t\tif(opts.biff === 5 || opts.biff === 2) switch(Rn) {\n\t\t\t\tcase 'Lbl': Rn = 'Label'; break;\n\t\t\t}\n\t\t\t/* nested switch statements to workaround V8 128 limit */\n\t\t\tswitch(Rn) {\n\t\t\t\t/* Workbook Options */\n\t\t\t\tcase 'Date1904': wb.opts.Date1904 = val; break;\n\t\t\t\tcase 'WriteProtect': wb.opts.WriteProtect = true; break;\n\t\t\t\tcase 'FilePass':\n\t\t\t\t\tif(!opts.enc) blob.l = 0;\n\t\t\t\t\topts.enc = val;\n\t\t\t\t\tif(opts.WTF) console.error(val);\n\t\t\t\t\tif(!options.password) throw new Error(\"File is password-protected\");\n\t\t\t\t\tif(val.Type !== 0) throw new Error(\"Encryption scheme unsupported\");\n\t\t\t\t\tif(!val.valid) throw new Error(\"Password is incorrect\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'WriteAccess': opts.lastuser = val; break;\n\t\t\t\tcase 'FileSharing': break; //TODO\n\t\t\t\tcase 'CodePage':\n\t\t\t\t\t/* overrides based on test cases */\n\t\t\t\t\tif(val === 0x5212) val = 1200;\n\t\t\t\t\telse if(val === 0x8001) val = 1252;\n\t\t\t\t\topts.codepage = val;\n\t\t\t\t\tset_cp(val);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'RRTabId': opts.rrtabid = val; break;\n\t\t\t\tcase 'WinProtect': opts.winlocked = val; break;\n\t\t\t\tcase 'Template': break; // TODO\n\t\t\t\tcase 'RefreshAll': wb.opts.RefreshAll = val; break;\n\t\t\t\tcase 'BookBool': break; // TODO\n\t\t\t\tcase 'UsesELFs': /* if(val) console.error(\"Unsupported ELFs\"); */ break;\n\t\t\t\tcase 'MTRSettings': {\n\t\t\t\t\tif(val[0] && val[1]) throw \"Unsupported threads: \" + val;\n\t\t\t\t} break; // TODO: actually support threads\n\t\t\t\tcase 'CalcCount': wb.opts.CalcCount = val; break;\n\t\t\t\tcase 'CalcDelta': wb.opts.CalcDelta = val; break;\n\t\t\t\tcase 'CalcIter': wb.opts.CalcIter = val; break;\n\t\t\t\tcase 'CalcMode': wb.opts.CalcMode = val; break;\n\t\t\t\tcase 'CalcPrecision': wb.opts.CalcPrecision = val; break;\n\t\t\t\tcase 'CalcSaveRecalc': wb.opts.CalcSaveRecalc = val; break;\n\t\t\t\tcase 'CalcRefMode': opts.CalcRefMode = val; break; // TODO: implement R1C1\n\t\t\t\tcase 'Uncalced': break;\n\t\t\t\tcase 'ForceFullCalculation': wb.opts.FullCalc = val; break;\n\t\t\t\tcase 'WsBool': break; // TODO\n\t\t\t\tcase 'XF': XFs.push(val); break;\n\t\t\t\tcase 'ExtSST': break; // TODO\n\t\t\t\tcase 'BookExt': break; // TODO\n\t\t\t\tcase 'RichTextStream': break;\n\t\t\t\tcase 'BkHim': break;\n\n\t\t\t\tcase 'SupBook': supbooks[++sbc] = [val]; sbci = 0; break;\n\t\t\t\tcase 'ExternName': supbooks[sbc][++sbci] = val; break;\n\t\t\t\tcase 'Index': break; // TODO\n\t\t\t\tcase 'Lbl': supbooks[0][++sbcli] = val; break;\n\t\t\t\tcase 'ExternSheet': supbooks[sbc] = supbooks[sbc].concat(val); sbci += val.length; break;\n\n\t\t\t\tcase 'Protect': out[\"!protect\"] = val; break; /* for sheet or book */\n\t\t\t\tcase 'Password': if(val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val); break;\n\t\t\t\tcase 'Prot4Rev': case 'Prot4RevPass': break; /*TODO: Revision Control*/\n\n\t\t\t\tcase 'BoundSheet8': {\n\t\t\t\t\tDirectory[val.pos] = val;\n\t\t\t\t\topts.snames.push(val.name);\n\t\t\t\t} break;\n\t\t\t\tcase 'EOF': {\n\t\t\t\t\tif(--file_depth) break;\n\t\t\t\t\tif(range.e) {\n\t\t\t\t\t\tout[\"!range\"] = range;\n\t\t\t\t\t\tif(range.e.r > 0 && range.e.c > 0) {\n\t\t\t\t\t\t\trange.e.r--; range.e.c--;\n\t\t\t\t\t\t\tout[\"!ref\"] = encode_range(range);\n\t\t\t\t\t\t\trange.e.r++; range.e.c++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(mergecells.length > 0) out[\"!merges\"] = mergecells;\n\t\t\t\t\t\tif(objects.length > 0) out[\"!objects\"] = objects;\n\t\t\t\t\t}\n\t\t\t\t\tif(cur_sheet === \"\") Preamble = out; else Sheets[cur_sheet] = out;\n\t\t\t\t\tout = {};\n\t\t\t\t} break;\n\t\t\t\tcase 'BOF': {\n\t\t\t\t\tif(opts.biff !== 8);\n\t\t\t\t\telse if(val.BIFFVer === 0x0500) opts.biff = 5;\n\t\t\t\t\telse if(val.BIFFVer === 0x0002) opts.biff = 2;\n\t\t\t\t\telse if(val.BIFFVer === 0x0007) opts.biff = 2;\n\t\t\t\t\tif(file_depth++) break;\n\t\t\t\t\tcell_valid = true;\n\t\t\t\t\tout = {};\n\t\t\t\t\tif(opts.biff === 2) {\n\t\t\t\t\t\tif(cur_sheet === \"\") cur_sheet = \"Sheet1\";\n\t\t\t\t\t\trange = {s:{r:0,c:0},e:{r:0,c:0}};\n\t\t\t\t\t}\n\t\t\t\t\telse cur_sheet = (Directory[s] || {name:\"\"}).name;\n\t\t\t\t\tmergecells = [];\n\t\t\t\t\tobjects = [];\n\t\t\t\t} break;\n\t\t\t\tcase 'Number': case 'BIFF2NUM': {\n\t\t\t\t\ttemp_val = {ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.val, t:'n'};\n\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 'BoolErr': {\n\t\t\t\t\ttemp_val = {ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.val, t:val.t};\n\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 'RK': {\n\t\t\t\t\ttemp_val = {ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.rknum, t:'n'};\n\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 'MulRk': {\n\t\t\t\t\tfor(var j = val.c; j <= val.C; ++j) {\n\t\t\t\t\t\tvar ixfe = val.rkrec[j-val.c][0];\n\t\t\t\t\t\ttemp_val= {ixfe:ixfe, XF:XFs[ixfe], v:val.rkrec[j-val.c][1], t:'n'};\n\t\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell({c:j, r:val.r}, temp_val, options);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 'Formula': {\n\t\t\t\t\tswitch(val.val) {\n\t\t\t\t\t\tcase 'String': last_formula = val; break;\n\t\t\t\t\t\tcase 'Array Formula': throw \"Array Formula unsupported\";\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\ttemp_val = {v:val.val, ixfe:val.cell.ixfe, t:val.tt};\n\t\t\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\t\t\tif(options.cellFormula) temp_val.f = \"=\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\n\t\t\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\t\taddcell(val.cell, temp_val, options);\n\t\t\t\t\t\t\tlast_formula = val;\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 'String': {\n\t\t\t\t\tif(last_formula) {\n\t\t\t\t\t\tlast_formula.val = val;\n\t\t\t\t\t\ttemp_val = {v:last_formula.val, ixfe:last_formula.cell.ixfe, t:'s'};\n\t\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\t\tif(options.cellFormula) temp_val.f = \"=\"+stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n\t\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell(last_formula.cell, temp_val, options);\n\t\t\t\t\t\tlast_formula = null;\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 'Array': {\n\t\t\t\t\tarray_formulae.push(val);\n\t\t\t\t} break;\n\t\t\t\tcase 'ShrFmla': {\n\t\t\t\t\tif(!cell_valid) break;\n\t\t\t\t\t//if(options.cellFormula) out[last_cell].f = stringify_formula(val[0], range, lastcell, supbooks, opts);\n\t\t\t\t\t/* TODO: capture range */\n\t\t\t\t\tshared_formulae[encode_cell(last_formula.cell)]= val[0];\n\t\t\t\t} break;\n\t\t\t\tcase 'LabelSst':\n\t\t\t\t\t//temp_val={v:sst[val.isst].t, ixfe:val.ixfe, t:'s'};\n\t\t\t\t\ttemp_val=make_cell(sst[val.isst].t, val.ixfe, 's');\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Label': case 'BIFF2STR':\n\t\t\t\t\t/* Some writers erroneously write Label */\n\t\t\t\t\ttemp_val=make_cell(val.val, val.ixfe, 's');\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Dimensions': {\n\t\t\t\t\tif(file_depth === 1) range = val; /* TODO: stack */\n\t\t\t\t} break;\n\t\t\t\tcase 'SST': {\n\t\t\t\t\tsst = val;\n\t\t\t\t} break;\n\t\t\t\tcase 'Format': { /* val = [id, fmt] */\n\t\t\t\t\tSSF.load(val[1], val[0]);\n\t\t\t\t} break;\n\n\t\t\t\tcase 'MergeCells': mergecells = mergecells.concat(val); break;\n\n\t\t\t\tcase 'Obj': objects[val.cmo[0]] = opts.lastobj = val; break;\n\t\t\t\tcase 'TxO': opts.lastobj.TxO = val; break;\n\n\t\t\t\tcase 'HLink': {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC)\n\t\t\t\t\t\t\tif(out[encode_cell({c:rngC,r:rngR})])\n\t\t\t\t\t\t\t\tout[encode_cell({c:rngC,r:rngR})].l = val[1];\n\t\t\t\t} break;\n\t\t\t\tcase 'HLinkTooltip': {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC)\n\t\t\t\t\t\t\tif(out[encode_cell({c:rngC,r:rngR})])\n\t\t\t\t\t\t\t\tout[encode_cell({c:rngC,r:rngR})].l.tooltip = val[1];\n\t\t\t\t} break;\n\n\t\t\t\t/* Comments */\n\t\t\t\tcase 'Note': {\n\t\t\t\t\tif(opts.biff <= 5 && opts.biff >= 2) break; /* TODO: BIFF5 */\n\t\t\t\t\tcc = out[encode_cell(val[0])];\n\t\t\t\t\tvar noteobj = objects[val[2]];\n\t\t\t\t\tif(!cc) break;\n\t\t\t\t\tif(!cc.c) cc.c = [];\n\t\t\t\t\tcmnt = {a:val[1],t:noteobj.TxO.t};\n\t\t\t\t\tcc.c.push(cmnt);\n\t\t\t\t} break;\n\n\t\t\t\tdefault: switch(R.n) { /* nested */\n\t\t\t\tcase 'ClrtClient': break;\n\t\t\t\tcase 'XFExt': update_xfext(XFs[val.ixfe], val.ext); break;\n\n\t\t\t\tcase 'NameCmt': break;\n\t\t\t\tcase 'Header': break; // TODO\n\t\t\t\tcase 'Footer': break; // TODO\n\t\t\t\tcase 'HCenter': break; // TODO\n\t\t\t\tcase 'VCenter': break; // TODO\n\t\t\t\tcase 'Pls': break; // TODO\n\t\t\t\tcase 'Setup': break; // TODO\n\t\t\t\tcase 'DefColWidth': break; // TODO\n\t\t\t\tcase 'GCW': break;\n\t\t\t\tcase 'LHRecord': break;\n\t\t\t\tcase 'ColInfo': break; // TODO\n\t\t\t\tcase 'Row': break; // TODO\n\t\t\t\tcase 'DBCell': break; // TODO\n\t\t\t\tcase 'MulBlank': break; // TODO\n\t\t\t\tcase 'EntExU2': break; // TODO\n\t\t\t\tcase 'SxView': break; // TODO\n\t\t\t\tcase 'Sxvd': break; // TODO\n\t\t\t\tcase 'SXVI': break; // TODO\n\t\t\t\tcase 'SXVDEx': break; // TODO\n\t\t\t\tcase 'SxIvd': break; // TODO\n\t\t\t\tcase 'SXDI': break; // TODO\n\t\t\t\tcase 'SXLI': break; // TODO\n\t\t\t\tcase 'SXEx': break; // TODO\n\t\t\t\tcase 'QsiSXTag': break; // TODO\n\t\t\t\tcase 'Selection': break;\n\t\t\t\tcase 'Feat': break;\n\t\t\t\tcase 'FeatHdr': case 'FeatHdr11': break;\n\t\t\t\tcase 'Feature11': case 'Feature12': case 'List12': break;\n\t\t\t\tcase 'Blank': break;\n\t\t\t\tcase 'Country': country = val; break;\n\t\t\t\tcase 'RecalcId': break;\n\t\t\t\tcase 'DefaultRowHeight': case 'DxGCol': break; // TODO: htmlify\n\t\t\t\tcase 'Fbi': case 'Fbi2': case 'GelFrame': break;\n\t\t\t\tcase 'Font': break; // TODO\n\t\t\t\tcase 'XFCRC': break; // TODO\n\t\t\t\tcase 'Style': break; // TODO\n\t\t\t\tcase 'StyleExt': break; // TODO\n\t\t\t\tcase 'Palette': palette = val; break; // TODO\n\t\t\t\tcase 'Theme': break; // TODO\n\t\t\t\t/* Protection */\n\t\t\t\tcase 'ScenarioProtect': break;\n\t\t\t\tcase 'ObjProtect': break;\n\n\t\t\t\t/* Conditional Formatting */\n\t\t\t\tcase 'CondFmt12': break;\n\n\t\t\t\t/* Table */\n\t\t\t\tcase 'Table': break; // TODO\n\t\t\t\tcase 'TableStyles': break; // TODO\n\t\t\t\tcase 'TableStyle': break; // TODO\n\t\t\t\tcase 'TableStyleElement': break; // TODO\n\n\t\t\t\t/* PivotTable */\n\t\t\t\tcase 'SXStreamID': break; // TODO\n\t\t\t\tcase 'SXVS': break; // TODO\n\t\t\t\tcase 'DConRef': break; // TODO\n\t\t\t\tcase 'SXAddl': break; // TODO\n\t\t\t\tcase 'DConBin': break; // TODO\n\t\t\t\tcase 'DConName': break; // TODO\n\t\t\t\tcase 'SXPI': break; // TODO\n\t\t\t\tcase 'SxFormat': break; // TODO\n\t\t\t\tcase 'SxSelect': break; // TODO\n\t\t\t\tcase 'SxRule': break; // TODO\n\t\t\t\tcase 'SxFilt': break; // TODO\n\t\t\t\tcase 'SxItm': break; // TODO\n\t\t\t\tcase 'SxDXF': break; // TODO\n\n\t\t\t\t/* Scenario Manager */\n\t\t\t\tcase 'ScenMan': break;\n\n\t\t\t\t/* Data Consolidation */\n\t\t\t\tcase 'DCon': break;\n\n\t\t\t\t/* Watched Cell */\n\t\t\t\tcase 'CellWatch': break;\n\n\t\t\t\t/* Print Settings */\n\t\t\t\tcase 'PrintRowCol': break;\n\t\t\t\tcase 'PrintGrid': break;\n\t\t\t\tcase 'PrintSize': break;\n\n\t\t\t\tcase 'XCT': break;\n\t\t\t\tcase 'CRN': break;\n\n\t\t\t\tcase 'Scl': {\n\t\t\t\t\t//console.log(\"Zoom Level:\", val[0]/val[1],val);\n\t\t\t\t} break;\n\t\t\t\tcase 'SheetExt': {\n\n\t\t\t\t} break;\n\t\t\t\tcase 'SheetExtOptional': {\n\n\t\t\t\t} break;\n\n\t\t\t\t/* VBA */\n\t\t\t\tcase 'ObNoMacros': {\n\n\t\t\t\t} break;\n\t\t\t\tcase 'ObProj': {\n\n\t\t\t\t} break;\n\t\t\t\tcase 'CodeName': {\n\n\t\t\t\t} break;\n\t\t\t\tcase 'GUIDTypeLib': {\n\n\t\t\t\t} break;\n\n\t\t\t\tcase 'WOpt': break; // TODO: WTF?\n\t\t\t\tcase 'PhoneticInfo': break;\n\n\t\t\t\tcase 'OleObjectSize': break;\n\n\t\t\t\t/* Differential Formatting */\n\t\t\t\tcase 'DXF': case 'DXFN': case 'DXFN12': case 'DXFN12List': case 'DXFN12NoCB': break;\n\n\t\t\t\t/* Data Validation */\n\t\t\t\tcase 'Dv': case 'DVal': break;\n\n\t\t\t\t/* Data Series */\n\t\t\t\tcase 'BRAI': case 'Series': case 'SeriesText': break;\n\n\t\t\t\t/* Data Connection */\n\t\t\t\tcase 'DConn': break;\n\t\t\t\tcase 'DbOrParamQry': break;\n\t\t\t\tcase 'DBQueryExt': break;\n\n\t\t\t\t/* Formatting */\n\t\t\t\tcase 'IFmtRecord': break;\n\t\t\t\tcase 'CondFmt': case 'CF': case 'CF12': case 'CFEx': break;\n\n\t\t\t\t/* Explicitly Ignored */\n\t\t\t\tcase 'Excel9File': break;\n\t\t\t\tcase 'Units': break;\n\t\t\t\tcase 'InterfaceHdr': case 'Mms': case 'InterfaceEnd': case 'DSF': case 'BuiltInFnGroupCount':\n\t\t\t\t/* View Stuff */\n\t\t\t\tcase 'Window1': case 'Window2': case 'HideObj': case 'GridSet': case 'Guts':\n\t\t\t\tcase 'UserBView': case 'UserSViewBegin': case 'UserSViewEnd':\n\t\t\t\tcase 'Pane': break;\n\t\t\t\tdefault: switch(R.n) { /* nested */\n\t\t\t\t/* Chart */\n\t\t\t\tcase 'Dat':\n\t\t\t\tcase 'Begin': case 'End':\n\t\t\t\tcase 'StartBlock': case 'EndBlock':\n\t\t\t\tcase 'Frame': case 'Area':\n\t\t\t\tcase 'Axis': case 'AxisLine': case 'Tick': break;\n\t\t\t\tcase 'AxesUsed':\n\t\t\t\tcase 'CrtLayout12': case 'CrtLayout12A': case 'CrtLink': case 'CrtLine': case 'CrtMlFrt': case 'CrtMlFrtContinue': break;\n\t\t\t\tcase 'LineFormat': case 'AreaFormat':\n\t\t\t\tcase 'Chart': case 'Chart3d': case 'Chart3DBarShape': case 'ChartFormat': case 'ChartFrtInfo': break;\n\t\t\t\tcase 'PlotArea': case 'PlotGrowth': break;\n\t\t\t\tcase 'SeriesList': case 'SerParent': case 'SerAuxTrend': break;\n\t\t\t\tcase 'DataFormat': case 'SerToCrt': case 'FontX': break;\n\t\t\t\tcase 'CatSerRange': case 'AxcExt': case 'SerFmt': break;\n\t\t\t\tcase 'ShtProps': break;\n\t\t\t\tcase 'DefaultText': case 'Text': case 'CatLab': break;\n\t\t\t\tcase 'DataLabExtContents': break;\n\t\t\t\tcase 'Legend': case 'LegendException': break;\n\t\t\t\tcase 'Pie': case 'Scatter': break;\n\t\t\t\tcase 'PieFormat': case 'MarkerFormat': break;\n\t\t\t\tcase 'StartObject': case 'EndObject': break;\n\t\t\t\tcase 'AlRuns': case 'ObjectLink': break;\n\t\t\t\tcase 'SIIndex': break;\n\t\t\t\tcase 'AttachedLabel': case 'YMult': break;\n\n\t\t\t\t/* Chart Group */\n\t\t\t\tcase 'Line': case 'Bar': break;\n\t\t\t\tcase 'Surf': break;\n\n\t\t\t\t/* Axis Group */\n\t\t\t\tcase 'AxisParent': break;\n\t\t\t\tcase 'Pos': break;\n\t\t\t\tcase 'ValueRange': break;\n\n\t\t\t\t/* Pivot Chart */\n\t\t\t\tcase 'SXViewEx9': break; // TODO\n\t\t\t\tcase 'SXViewLink': break;\n\t\t\t\tcase 'PivotChartBits': break;\n\t\t\t\tcase 'SBaseRef': break;\n\t\t\t\tcase 'TextPropsStream': break;\n\n\t\t\t\t/* Chart Misc */\n\t\t\t\tcase 'LnExt': break;\n\t\t\t\tcase 'MkrExt': break;\n\t\t\t\tcase 'CrtCoopt': break;\n\n\t\t\t\t/* Query Table */\n\t\t\t\tcase 'Qsi': case 'Qsif': case 'Qsir': case 'QsiSXTag': break;\n\t\t\t\tcase 'TxtQry': break;\n\n\t\t\t\t/* Filter */\n\t\t\t\tcase 'FilterMode': break;\n\t\t\t\tcase 'AutoFilter': case 'AutoFilterInfo': break;\n\t\t\t\tcase 'AutoFilter12': break;\n\t\t\t\tcase 'DropDownObjIds': break;\n\t\t\t\tcase 'Sort': break;\n\t\t\t\tcase 'SortData': break;\n\n\t\t\t\t/* Drawing */\n\t\t\t\tcase 'ShapePropsStream': break;\n\t\t\t\tcase 'MsoDrawing': case 'MsoDrawingGroup': case 'MsoDrawingSelection': break;\n\t\t\t\tcase 'ImData': break;\n\t\t\t\t/* Pub Stuff */\n\t\t\t\tcase 'WebPub': case 'AutoWebPub':\n\n\t\t\t\t/* Print Stuff */\n\t\t\t\tcase 'RightMargin': case 'LeftMargin': case 'TopMargin': case 'BottomMargin':\n\t\t\t\tcase 'HeaderFooter': case 'HFPicture': case 'PLV':\n\t\t\t\tcase 'HorizontalPageBreaks': case 'VerticalPageBreaks':\n\t\t\t\t/* Behavioral */\n\t\t\t\tcase 'Backup': case 'CompressPictures': case 'Compat12': break;\n\n\t\t\t\t/* Should not Happen */\n\t\t\t\tcase 'Continue': case 'ContinueFrt12': break;\n\n\t\t\t\t/* Future Records */\n\t\t\t\tcase 'FrtFontList': case 'FrtWrapper': break;\n\n\t\t\t\t/* BIFF5 records */\n\t\t\t\tcase 'ExternCount': break;\n\t\t\t\tcase 'RString': break;\n\t\t\t\tcase 'TabIdConf': case 'Radar': case 'RadarArea': case 'DropBar': case 'Intl': case 'CoordList': case 'SerAuxErrBar': break;\n\n\t\t\t\tdefault: switch(R.n) { /* nested */\n\t\t\t\t/* Miscellaneous */\n\t\t\t\tcase 'SCENARIO': case 'DConBin': case 'PicF': case 'DataLabExt':\n\t\t\t\tcase 'Lel': case 'BopPop': case 'BopPopCustom': case 'RealTimeData':\n\t\t\t\tcase 'Name': break;\n\t\t\t\tdefault: if(options.WTF) throw 'Unrecognized Record ' + R.n;\n\t\t\t}}}}\n\t\t} else blob.l += length;\n\t}\n\tvar sheetnamesraw = opts.biff === 2 ? ['Sheet1'] : Object.keys(Directory).sort(function(a,b) { return Number(a) - Number(b); }).map(function(x){return Directory[x].name;});\n\tvar sheetnames = sheetnamesraw.slice();\n\twb.Directory=sheetnamesraw;\n\twb.SheetNames=sheetnamesraw;\n\tif(!options.bookSheets) wb.Sheets=Sheets;\n\twb.Preamble=Preamble;\n\twb.Strings = sst;\n\twb.SSF = SSF.get_table();\n\tif(opts.enc) wb.Encryption = opts.enc;\n\twb.Metadata = {};\n\tif(country !== undefined) wb.Metadata.Country = country;\n\treturn wb;\n}\n\nfunction parse_xlscfb(cfb, options) {\nif(!options) options = {};\nfix_read_opts(options);\nreset_cp();\nvar CompObj, Summary, Workbook;\nif(cfb.find) {\n\tCompObj = cfb.find('!CompObj');\n\tSummary = cfb.find('!SummaryInformation');\n\tWorkbook = cfb.find('/Workbook');\n} else {\n\tprep_blob(cfb, 0);\n\tWorkbook = {content: cfb};\n}\n\nif(!Workbook) Workbook = cfb.find('/Book');\nvar CompObjP, SummaryP, WorkbookP;\n\nif(CompObj) CompObjP = parse_compobj(CompObj);\nif(options.bookProps && !options.bookSheets) WorkbookP = {};\nelse {\n\tif(Workbook) WorkbookP = parse_workbook(Workbook.content, options, !!Workbook.find);\n\telse throw new Error(\"Cannot find Workbook stream\");\n}\n\nif(cfb.find) parse_props(cfb);\n\nvar props = {};\nfor(var y in cfb.Summary) props[y] = cfb.Summary[y];\nfor(y in cfb.DocSummary) props[y] = cfb.DocSummary[y];\nWorkbookP.Props = WorkbookP.Custprops = props; /* TODO: split up properties */\nif(options.bookFiles) WorkbookP.cfb = cfb;\nWorkbookP.CompObjP = CompObjP;\nreturn WorkbookP;\n}\n\n/* TODO: WTF */\nfunction parse_props(cfb) {\n\t/* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n\tvar DSI = cfb.find('!DocumentSummaryInformation');\n\tif(DSI) try { cfb.DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI); } catch(e) {}\n\n\t/* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n\tvar SI = cfb.find('!SummaryInformation');\n\tif(SI) try { cfb.Summary = parse_PropertySetStream(SI, SummaryPIDSI); } catch(e) {}\n}\n\n/* [MS-XLSB] 2.3 Record Enumeration */\nvar XLSBRecordEnum = {\n\t0x0000: { n:\"BrtRowHdr\", f:parse_BrtRowHdr },\n\t0x0001: { n:\"BrtCellBlank\", f:parse_BrtCellBlank },\n\t0x0002: { n:\"BrtCellRk\", f:parse_BrtCellRk },\n\t0x0003: { n:\"BrtCellError\", f:parse_BrtCellError },\n\t0x0004: { n:\"BrtCellBool\", f:parse_BrtCellBool },\n\t0x0005: { n:\"BrtCellReal\", f:parse_BrtCellReal },\n\t0x0006: { n:\"BrtCellSt\", f:parse_BrtCellSt },\n\t0x0007: { n:\"BrtCellIsst\", f:parse_BrtCellIsst },\n\t0x0008: { n:\"BrtFmlaString\", f:parse_BrtFmlaString },\n\t0x0009: { n:\"BrtFmlaNum\", f:parse_BrtFmlaNum },\n\t0x000A: { n:\"BrtFmlaBool\", f:parse_BrtFmlaBool },\n\t0x000B: { n:\"BrtFmlaError\", f:parse_BrtFmlaError },\n\t0x0010: { n:\"BrtFRTArchID$\", f:parse_BrtFRTArchID$ },\n\t0x0013: { n:\"BrtSSTItem\", f:parse_RichStr },\n\t0x0014: { n:\"BrtPCDIMissing\", f:parsenoop },\n\t0x0015: { n:\"BrtPCDINumber\", f:parsenoop },\n\t0x0016: { n:\"BrtPCDIBoolean\", f:parsenoop },\n\t0x0017: { n:\"BrtPCDIError\", f:parsenoop },\n\t0x0018: { n:\"BrtPCDIString\", f:parsenoop },\n\t0x0019: { n:\"BrtPCDIDatetime\", f:parsenoop },\n\t0x001A: { n:\"BrtPCDIIndex\", f:parsenoop },\n\t0x001B: { n:\"BrtPCDIAMissing\", f:parsenoop },\n\t0x001C: { n:\"BrtPCDIANumber\", f:parsenoop },\n\t0x001D: { n:\"BrtPCDIABoolean\", f:parsenoop },\n\t0x001E: { n:\"BrtPCDIAError\", f:parsenoop },\n\t0x001F: { n:\"BrtPCDIAString\", f:parsenoop },\n\t0x0020: { n:\"BrtPCDIADatetime\", f:parsenoop },\n\t0x0021: { n:\"BrtPCRRecord\", f:parsenoop },\n\t0x0022: { n:\"BrtPCRRecordDt\", f:parsenoop },\n\t0x0023: { n:\"BrtFRTBegin\", f:parsenoop },\n\t0x0024: { n:\"BrtFRTEnd\", f:parsenoop },\n\t0x0025: { n:\"BrtACBegin\", f:parsenoop },\n\t0x0026: { n:\"BrtACEnd\", f:parsenoop },\n\t0x0027: { n:\"BrtName\", f:parsenoop },\n\t0x0028: { n:\"BrtIndexRowBlock\", f:parsenoop },\n\t0x002A: { n:\"BrtIndexBlock\", f:parsenoop },\n\t0x002B: { n:\"BrtFont\", f:parse_BrtFont },\n\t0x002C: { n:\"BrtFmt\", f:parse_BrtFmt },\n\t0x002D: { n:\"BrtFill\", f:parsenoop },\n\t0x002E: { n:\"BrtBorder\", f:parsenoop },\n\t0x002F: { n:\"BrtXF\", f:parse_BrtXF },\n\t0x0030: { n:\"BrtStyle\", f:parsenoop },\n\t0x0031: { n:\"BrtCellMeta\", f:parsenoop },\n\t0x0032: { n:\"BrtValueMeta\", f:parsenoop },\n\t0x0033: { n:\"BrtMdb\", f:parsenoop },\n\t0x0034: { n:\"BrtBeginFmd\", f:parsenoop },\n\t0x0035: { n:\"BrtEndFmd\", f:parsenoop },\n\t0x0036: { n:\"BrtBeginMdx\", f:parsenoop },\n\t0x0037: { n:\"BrtEndMdx\", f:parsenoop },\n\t0x0038: { n:\"BrtBeginMdxTuple\", f:parsenoop },\n\t0x0039: { n:\"BrtEndMdxTuple\", f:parsenoop },\n\t0x003A: { n:\"BrtMdxMbrIstr\", f:parsenoop },\n\t0x003B: { n:\"BrtStr\", f:parsenoop },\n\t0x003C: { n:\"BrtColInfo\", f:parsenoop },\n\t0x003E: { n:\"BrtCellRString\", f:parsenoop },\n\t0x003F: { n:\"BrtCalcChainItem$\", f:parse_BrtCalcChainItem$ },\n\t0x0040: { n:\"BrtDVal\", f:parsenoop },\n\t0x0041: { n:\"BrtSxvcellNum\", f:parsenoop },\n\t0x0042: { n:\"BrtSxvcellStr\", f:parsenoop },\n\t0x0043: { n:\"BrtSxvcellBool\", f:parsenoop },\n\t0x0044: { n:\"BrtSxvcellErr\", f:parsenoop },\n\t0x0045: { n:\"BrtSxvcellDate\", f:parsenoop },\n\t0x0046: { n:\"BrtSxvcellNil\", f:parsenoop },\n\t0x0080: { n:\"BrtFileVersion\", f:parsenoop },\n\t0x0081: { n:\"BrtBeginSheet\", f:parsenoop },\n\t0x0082: { n:\"BrtEndSheet\", f:parsenoop },\n\t0x0083: { n:\"BrtBeginBook\", f:parsenoop, p:0 },\n\t0x0084: { n:\"BrtEndBook\", f:parsenoop },\n\t0x0085: { n:\"BrtBeginWsViews\", f:parsenoop },\n\t0x0086: { n:\"BrtEndWsViews\", f:parsenoop },\n\t0x0087: { n:\"BrtBeginBookViews\", f:parsenoop },\n\t0x0088: { n:\"BrtEndBookViews\", f:parsenoop },\n\t0x0089: { n:\"BrtBeginWsView\", f:parsenoop },\n\t0x008A: { n:\"BrtEndWsView\", f:parsenoop },\n\t0x008B: { n:\"BrtBeginCsViews\", f:parsenoop },\n\t0x008C: { n:\"BrtEndCsViews\", f:parsenoop },\n\t0x008D: { n:\"BrtBeginCsView\", f:parsenoop },\n\t0x008E: { n:\"BrtEndCsView\", f:parsenoop },\n\t0x008F: { n:\"BrtBeginBundleShs\", f:parsenoop },\n\t0x0090: { n:\"BrtEndBundleShs\", f:parsenoop },\n\t0x0091: { n:\"BrtBeginSheetData\", f:parsenoop },\n\t0x0092: { n:\"BrtEndSheetData\", f:parsenoop },\n\t0x0093: { n:\"BrtWsProp\", f:parse_BrtWsProp },\n\t0x0094: { n:\"BrtWsDim\", f:parse_BrtWsDim, p:16 },\n\t0x0097: { n:\"BrtPane\", f:parsenoop },\n\t0x0098: { n:\"BrtSel\", f:parsenoop },\n\t0x0099: { n:\"BrtWbProp\", f:parse_BrtWbProp },\n\t0x009A: { n:\"BrtWbFactoid\", f:parsenoop },\n\t0x009B: { n:\"BrtFileRecover\", f:parsenoop },\n\t0x009C: { n:\"BrtBundleSh\", f:parse_BrtBundleSh },\n\t0x009D: { n:\"BrtCalcProp\", f:parsenoop },\n\t0x009E: { n:\"BrtBookView\", f:parsenoop },\n\t0x009F: { n:\"BrtBeginSst\", f:parse_BrtBeginSst },\n\t0x00A0: { n:\"BrtEndSst\", f:parsenoop },\n\t0x00A1: { n:\"BrtBeginAFilter\", f:parsenoop },\n\t0x00A2: { n:\"BrtEndAFilter\", f:parsenoop },\n\t0x00A3: { n:\"BrtBeginFilterColumn\", f:parsenoop },\n\t0x00A4: { n:\"BrtEndFilterColumn\", f:parsenoop },\n\t0x00A5: { n:\"BrtBeginFilters\", f:parsenoop },\n\t0x00A6: { n:\"BrtEndFilters\", f:parsenoop },\n\t0x00A7: { n:\"BrtFilter\", f:parsenoop },\n\t0x00A8: { n:\"BrtColorFilter\", f:parsenoop },\n\t0x00A9: { n:\"BrtIconFilter\", f:parsenoop },\n\t0x00AA: { n:\"BrtTop10Filter\", f:parsenoop },\n\t0x00AB: { n:\"BrtDynamicFilter\", f:parsenoop },\n\t0x00AC: { n:\"BrtBeginCustomFilters\", f:parsenoop },\n\t0x00AD: { n:\"BrtEndCustomFilters\", f:parsenoop },\n\t0x00AE: { n:\"BrtCustomFilter\", f:parsenoop },\n\t0x00AF: { n:\"BrtAFilterDateGroupItem\", f:parsenoop },\n\t0x00B0: { n:\"BrtMergeCell\", f:parse_BrtMergeCell },\n\t0x00B1: { n:\"BrtBeginMergeCells\", f:parsenoop },\n\t0x00B2: { n:\"BrtEndMergeCells\", f:parsenoop },\n\t0x00B3: { n:\"BrtBeginPivotCacheDef\", f:parsenoop },\n\t0x00B4: { n:\"BrtEndPivotCacheDef\", f:parsenoop },\n\t0x00B5: { n:\"BrtBeginPCDFields\", f:parsenoop },\n\t0x00B6: { n:\"BrtEndPCDFields\", f:parsenoop },\n\t0x00B7: { n:\"BrtBeginPCDField\", f:parsenoop },\n\t0x00B8: { n:\"BrtEndPCDField\", f:parsenoop },\n\t0x00B9: { n:\"BrtBeginPCDSource\", f:parsenoop },\n\t0x00BA: { n:\"BrtEndPCDSource\", f:parsenoop },\n\t0x00BB: { n:\"BrtBeginPCDSRange\", f:parsenoop },\n\t0x00BC: { n:\"BrtEndPCDSRange\", f:parsenoop },\n\t0x00BD: { n:\"BrtBeginPCDFAtbl\", f:parsenoop },\n\t0x00BE: { n:\"BrtEndPCDFAtbl\", f:parsenoop },\n\t0x00BF: { n:\"BrtBeginPCDIRun\", f:parsenoop },\n\t0x00C0: { n:\"BrtEndPCDIRun\", f:parsenoop },\n\t0x00C1: { n:\"BrtBeginPivotCacheRecords\", f:parsenoop },\n\t0x00C2: { n:\"BrtEndPivotCacheRecords\", f:parsenoop },\n\t0x00C3: { n:\"BrtBeginPCDHierarchies\", f:parsenoop },\n\t0x00C4: { n:\"BrtEndPCDHierarchies\", f:parsenoop },\n\t0x00C5: { n:\"BrtBeginPCDHierarchy\", f:parsenoop },\n\t0x00C6: { n:\"BrtEndPCDHierarchy\", f:parsenoop },\n\t0x00C7: { n:\"BrtBeginPCDHFieldsUsage\", f:parsenoop },\n\t0x00C8: { n:\"BrtEndPCDHFieldsUsage\", f:parsenoop },\n\t0x00C9: { n:\"BrtBeginExtConnection\", f:parsenoop },\n\t0x00CA: { n:\"BrtEndExtConnection\", f:parsenoop },\n\t0x00CB: { n:\"BrtBeginECDbProps\", f:parsenoop },\n\t0x00CC: { n:\"BrtEndECDbProps\", f:parsenoop },\n\t0x00CD: { n:\"BrtBeginECOlapProps\", f:parsenoop },\n\t0x00CE: { n:\"BrtEndECOlapProps\", f:parsenoop },\n\t0x00CF: { n:\"BrtBeginPCDSConsol\", f:parsenoop },\n\t0x00D0: { n:\"BrtEndPCDSConsol\", f:parsenoop },\n\t0x00D1: { n:\"BrtBeginPCDSCPages\", f:parsenoop },\n\t0x00D2: { n:\"BrtEndPCDSCPages\", f:parsenoop },\n\t0x00D3: { n:\"BrtBeginPCDSCPage\", f:parsenoop },\n\t0x00D4: { n:\"BrtEndPCDSCPage\", f:parsenoop },\n\t0x00D5: { n:\"BrtBeginPCDSCPItem\", f:parsenoop },\n\t0x00D6: { n:\"BrtEndPCDSCPItem\", f:parsenoop },\n\t0x00D7: { n:\"BrtBeginPCDSCSets\", f:parsenoop },\n\t0x00D8: { n:\"BrtEndPCDSCSets\", f:parsenoop },\n\t0x00D9: { n:\"BrtBeginPCDSCSet\", f:parsenoop },\n\t0x00DA: { n:\"BrtEndPCDSCSet\", f:parsenoop },\n\t0x00DB: { n:\"BrtBeginPCDFGroup\", f:parsenoop },\n\t0x00DC: { n:\"BrtEndPCDFGroup\", f:parsenoop },\n\t0x00DD: { n:\"BrtBeginPCDFGItems\", f:parsenoop },\n\t0x00DE: { n:\"BrtEndPCDFGItems\", f:parsenoop },\n\t0x00DF: { n:\"BrtBeginPCDFGRange\", f:parsenoop },\n\t0x00E0: { n:\"BrtEndPCDFGRange\", f:parsenoop },\n\t0x00E1: { n:\"BrtBeginPCDFGDiscrete\", f:parsenoop },\n\t0x00E2: { n:\"BrtEndPCDFGDiscrete\", f:parsenoop },\n\t0x00E3: { n:\"BrtBeginPCDSDTupleCache\", f:parsenoop },\n\t0x00E4: { n:\"BrtEndPCDSDTupleCache\", f:parsenoop },\n\t0x00E5: { n:\"BrtBeginPCDSDTCEntries\", f:parsenoop },\n\t0x00E6: { n:\"BrtEndPCDSDTCEntries\", f:parsenoop },\n\t0x00E7: { n:\"BrtBeginPCDSDTCEMembers\", f:parsenoop },\n\t0x00E8: { n:\"BrtEndPCDSDTCEMembers\", f:parsenoop },\n\t0x00E9: { n:\"BrtBeginPCDSDTCEMember\", f:parsenoop },\n\t0x00EA: { n:\"BrtEndPCDSDTCEMember\", f:parsenoop },\n\t0x00EB: { n:\"BrtBeginPCDSDTCQueries\", f:parsenoop },\n\t0x00EC: { n:\"BrtEndPCDSDTCQueries\", f:parsenoop },\n\t0x00ED: { n:\"BrtBeginPCDSDTCQuery\", f:parsenoop },\n\t0x00EE: { n:\"BrtEndPCDSDTCQuery\", f:parsenoop },\n\t0x00EF: { n:\"BrtBeginPCDSDTCSets\", f:parsenoop },\n\t0x00F0: { n:\"BrtEndPCDSDTCSets\", f:parsenoop },\n\t0x00F1: { n:\"BrtBeginPCDSDTCSet\", f:parsenoop },\n\t0x00F2: { n:\"BrtEndPCDSDTCSet\", f:parsenoop },\n\t0x00F3: { n:\"BrtBeginPCDCalcItems\", f:parsenoop },\n\t0x00F4: { n:\"BrtEndPCDCalcItems\", f:parsenoop },\n\t0x00F5: { n:\"BrtBeginPCDCalcItem\", f:parsenoop },\n\t0x00F6: { n:\"BrtEndPCDCalcItem\", f:parsenoop },\n\t0x00F7: { n:\"BrtBeginPRule\", f:parsenoop },\n\t0x00F8: { n:\"BrtEndPRule\", f:parsenoop },\n\t0x00F9: { n:\"BrtBeginPRFilters\", f:parsenoop },\n\t0x00FA: { n:\"BrtEndPRFilters\", f:parsenoop },\n\t0x00FB: { n:\"BrtBeginPRFilter\", f:parsenoop },\n\t0x00FC: { n:\"BrtEndPRFilter\", f:parsenoop },\n\t0x00FD: { n:\"BrtBeginPNames\", f:parsenoop },\n\t0x00FE: { n:\"BrtEndPNames\", f:parsenoop },\n\t0x00FF: { n:\"BrtBeginPName\", f:parsenoop },\n\t0x0100: { n:\"BrtEndPName\", f:parsenoop },\n\t0x0101: { n:\"BrtBeginPNPairs\", f:parsenoop },\n\t0x0102: { n:\"BrtEndPNPairs\", f:parsenoop },\n\t0x0103: { n:\"BrtBeginPNPair\", f:parsenoop },\n\t0x0104: { n:\"BrtEndPNPair\", f:parsenoop },\n\t0x0105: { n:\"BrtBeginECWebProps\", f:parsenoop },\n\t0x0106: { n:\"BrtEndECWebProps\", f:parsenoop },\n\t0x0107: { n:\"BrtBeginEcWpTables\", f:parsenoop },\n\t0x0108: { n:\"BrtEndECWPTables\", f:parsenoop },\n\t0x0109: { n:\"BrtBeginECParams\", f:parsenoop },\n\t0x010A: { n:\"BrtEndECParams\", f:parsenoop },\n\t0x010B: { n:\"BrtBeginECParam\", f:parsenoop },\n\t0x010C: { n:\"BrtEndECParam\", f:parsenoop },\n\t0x010D: { n:\"BrtBeginPCDKPIs\", f:parsenoop },\n\t0x010E: { n:\"BrtEndPCDKPIs\", f:parsenoop },\n\t0x010F: { n:\"BrtBeginPCDKPI\", f:parsenoop },\n\t0x0110: { n:\"BrtEndPCDKPI\", f:parsenoop },\n\t0x0111: { n:\"BrtBeginDims\", f:parsenoop },\n\t0x0112: { n:\"BrtEndDims\", f:parsenoop },\n\t0x0113: { n:\"BrtBeginDim\", f:parsenoop },\n\t0x0114: { n:\"BrtEndDim\", f:parsenoop },\n\t0x0115: { n:\"BrtIndexPartEnd\", f:parsenoop },\n\t0x0116: { n:\"BrtBeginStyleSheet\", f:parsenoop },\n\t0x0117: { n:\"BrtEndStyleSheet\", f:parsenoop },\n\t0x0118: { n:\"BrtBeginSXView\", f:parsenoop },\n\t0x0119: { n:\"BrtEndSXVI\", f:parsenoop },\n\t0x011A: { n:\"BrtBeginSXVI\", f:parsenoop },\n\t0x011B: { n:\"BrtBeginSXVIs\", f:parsenoop },\n\t0x011C: { n:\"BrtEndSXVIs\", f:parsenoop },\n\t0x011D: { n:\"BrtBeginSXVD\", f:parsenoop },\n\t0x011E: { n:\"BrtEndSXVD\", f:parsenoop },\n\t0x011F: { n:\"BrtBeginSXVDs\", f:parsenoop },\n\t0x0120: { n:\"BrtEndSXVDs\", f:parsenoop },\n\t0x0121: { n:\"BrtBeginSXPI\", f:parsenoop },\n\t0x0122: { n:\"BrtEndSXPI\", f:parsenoop },\n\t0x0123: { n:\"BrtBeginSXPIs\", f:parsenoop },\n\t0x0124: { n:\"BrtEndSXPIs\", f:parsenoop },\n\t0x0125: { n:\"BrtBeginSXDI\", f:parsenoop },\n\t0x0126: { n:\"BrtEndSXDI\", f:parsenoop },\n\t0x0127: { n:\"BrtBeginSXDIs\", f:parsenoop },\n\t0x0128: { n:\"BrtEndSXDIs\", f:parsenoop },\n\t0x0129: { n:\"BrtBeginSXLI\", f:parsenoop },\n\t0x012A: { n:\"BrtEndSXLI\", f:parsenoop },\n\t0x012B: { n:\"BrtBeginSXLIRws\", f:parsenoop },\n\t0x012C: { n:\"BrtEndSXLIRws\", f:parsenoop },\n\t0x012D: { n:\"BrtBeginSXLICols\", f:parsenoop },\n\t0x012E: { n:\"BrtEndSXLICols\", f:parsenoop },\n\t0x012F: { n:\"BrtBeginSXFormat\", f:parsenoop },\n\t0x0130: { n:\"BrtEndSXFormat\", f:parsenoop },\n\t0x0131: { n:\"BrtBeginSXFormats\", f:parsenoop },\n\t0x0132: { n:\"BrtEndSxFormats\", f:parsenoop },\n\t0x0133: { n:\"BrtBeginSxSelect\", f:parsenoop },\n\t0x0134: { n:\"BrtEndSxSelect\", f:parsenoop },\n\t0x0135: { n:\"BrtBeginISXVDRws\", f:parsenoop },\n\t0x0136: { n:\"BrtEndISXVDRws\", f:parsenoop },\n\t0x0137: { n:\"BrtBeginISXVDCols\", f:parsenoop },\n\t0x0138: { n:\"BrtEndISXVDCols\", f:parsenoop },\n\t0x0139: { n:\"BrtEndSXLocation\", f:parsenoop },\n\t0x013A: { n:\"BrtBeginSXLocation\", f:parsenoop },\n\t0x013B: { n:\"BrtEndSXView\", f:parsenoop },\n\t0x013C: { n:\"BrtBeginSXTHs\", f:parsenoop },\n\t0x013D: { n:\"BrtEndSXTHs\", f:parsenoop },\n\t0x013E: { n:\"BrtBeginSXTH\", f:parsenoop },\n\t0x013F: { n:\"BrtEndSXTH\", f:parsenoop },\n\t0x0140: { n:\"BrtBeginISXTHRws\", f:parsenoop },\n\t0x0141: { n:\"BrtEndISXTHRws\", f:parsenoop },\n\t0x0142: { n:\"BrtBeginISXTHCols\", f:parsenoop },\n\t0x0143: { n:\"BrtEndISXTHCols\", f:parsenoop },\n\t0x0144: { n:\"BrtBeginSXTDMPS\", f:parsenoop },\n\t0x0145: { n:\"BrtEndSXTDMPs\", f:parsenoop },\n\t0x0146: { n:\"BrtBeginSXTDMP\", f:parsenoop },\n\t0x0147: { n:\"BrtEndSXTDMP\", f:parsenoop },\n\t0x0148: { n:\"BrtBeginSXTHItems\", f:parsenoop },\n\t0x0149: { n:\"BrtEndSXTHItems\", f:parsenoop },\n\t0x014A: { n:\"BrtBeginSXTHItem\", f:parsenoop },\n\t0x014B: { n:\"BrtEndSXTHItem\", f:parsenoop },\n\t0x014C: { n:\"BrtBeginMetadata\", f:parsenoop },\n\t0x014D: { n:\"BrtEndMetadata\", f:parsenoop },\n\t0x014E: { n:\"BrtBeginEsmdtinfo\", f:parsenoop },\n\t0x014F: { n:\"BrtMdtinfo\", f:parsenoop },\n\t0x0150: { n:\"BrtEndEsmdtinfo\", f:parsenoop },\n\t0x0151: { n:\"BrtBeginEsmdb\", f:parsenoop },\n\t0x0152: { n:\"BrtEndEsmdb\", f:parsenoop },\n\t0x0153: { n:\"BrtBeginEsfmd\", f:parsenoop },\n\t0x0154: { n:\"BrtEndEsfmd\", f:parsenoop },\n\t0x0155: { n:\"BrtBeginSingleCells\", f:parsenoop },\n\t0x0156: { n:\"BrtEndSingleCells\", f:parsenoop },\n\t0x0157: { n:\"BrtBeginList\", f:parsenoop },\n\t0x0158: { n:\"BrtEndList\", f:parsenoop },\n\t0x0159: { n:\"BrtBeginListCols\", f:parsenoop },\n\t0x015A: { n:\"BrtEndListCols\", f:parsenoop },\n\t0x015B: { n:\"BrtBeginListCol\", f:parsenoop },\n\t0x015C: { n:\"BrtEndListCol\", f:parsenoop },\n\t0x015D: { n:\"BrtBeginListXmlCPr\", f:parsenoop },\n\t0x015E: { n:\"BrtEndListXmlCPr\", f:parsenoop },\n\t0x015F: { n:\"BrtListCCFmla\", f:parsenoop },\n\t0x0160: { n:\"BrtListTrFmla\", f:parsenoop },\n\t0x0161: { n:\"BrtBeginExternals\", f:parsenoop },\n\t0x0162: { n:\"BrtEndExternals\", f:parsenoop },\n\t0x0163: { n:\"BrtSupBookSrc\", f:parsenoop },\n\t0x0165: { n:\"BrtSupSelf\", f:parsenoop },\n\t0x0166: { n:\"BrtSupSame\", f:parsenoop },\n\t0x0167: { n:\"BrtSupTabs\", f:parsenoop },\n\t0x0168: { n:\"BrtBeginSupBook\", f:parsenoop },\n\t0x0169: { n:\"BrtPlaceholderName\", f:parsenoop },\n\t0x016A: { n:\"BrtExternSheet\", f:parsenoop },\n\t0x016B: { n:\"BrtExternTableStart\", f:parsenoop },\n\t0x016C: { n:\"BrtExternTableEnd\", f:parsenoop },\n\t0x016E: { n:\"BrtExternRowHdr\", f:parsenoop },\n\t0x016F: { n:\"BrtExternCellBlank\", f:parsenoop },\n\t0x0170: { n:\"BrtExternCellReal\", f:parsenoop },\n\t0x0171: { n:\"BrtExternCellBool\", f:parsenoop },\n\t0x0172: { n:\"BrtExternCellError\", f:parsenoop },\n\t0x0173: { n:\"BrtExternCellString\", f:parsenoop },\n\t0x0174: { n:\"BrtBeginEsmdx\", f:parsenoop },\n\t0x0175: { n:\"BrtEndEsmdx\", f:parsenoop },\n\t0x0176: { n:\"BrtBeginMdxSet\", f:parsenoop },\n\t0x0177: { n:\"BrtEndMdxSet\", f:parsenoop },\n\t0x0178: { n:\"BrtBeginMdxMbrProp\", f:parsenoop },\n\t0x0179: { n:\"BrtEndMdxMbrProp\", f:parsenoop },\n\t0x017A: { n:\"BrtBeginMdxKPI\", f:parsenoop },\n\t0x017B: { n:\"BrtEndMdxKPI\", f:parsenoop },\n\t0x017C: { n:\"BrtBeginEsstr\", f:parsenoop },\n\t0x017D: { n:\"BrtEndEsstr\", f:parsenoop },\n\t0x017E: { n:\"BrtBeginPRFItem\", f:parsenoop },\n\t0x017F: { n:\"BrtEndPRFItem\", f:parsenoop },\n\t0x0180: { n:\"BrtBeginPivotCacheIDs\", f:parsenoop },\n\t0x0181: { n:\"BrtEndPivotCacheIDs\", f:parsenoop },\n\t0x0182: { n:\"BrtBeginPivotCacheID\", f:parsenoop },\n\t0x0183: { n:\"BrtEndPivotCacheID\", f:parsenoop },\n\t0x0184: { n:\"BrtBeginISXVIs\", f:parsenoop },\n\t0x0185: { n:\"BrtEndISXVIs\", f:parsenoop },\n\t0x0186: { n:\"BrtBeginColInfos\", f:parsenoop },\n\t0x0187: { n:\"BrtEndColInfos\", f:parsenoop },\n\t0x0188: { n:\"BrtBeginRwBrk\", f:parsenoop },\n\t0x0189: { n:\"BrtEndRwBrk\", f:parsenoop },\n\t0x018A: { n:\"BrtBeginColBrk\", f:parsenoop },\n\t0x018B: { n:\"BrtEndColBrk\", f:parsenoop },\n\t0x018C: { n:\"BrtBrk\", f:parsenoop },\n\t0x018D: { n:\"BrtUserBookView\", f:parsenoop },\n\t0x018E: { n:\"BrtInfo\", f:parsenoop },\n\t0x018F: { n:\"BrtCUsr\", f:parsenoop },\n\t0x0190: { n:\"BrtUsr\", f:parsenoop },\n\t0x0191: { n:\"BrtBeginUsers\", f:parsenoop },\n\t0x0193: { n:\"BrtEOF\", f:parsenoop },\n\t0x0194: { n:\"BrtUCR\", f:parsenoop },\n\t0x0195: { n:\"BrtRRInsDel\", f:parsenoop },\n\t0x0196: { n:\"BrtRREndInsDel\", f:parsenoop },\n\t0x0197: { n:\"BrtRRMove\", f:parsenoop },\n\t0x0198: { n:\"BrtRREndMove\", f:parsenoop },\n\t0x0199: { n:\"BrtRRChgCell\", f:parsenoop },\n\t0x019A: { n:\"BrtRREndChgCell\", f:parsenoop },\n\t0x019B: { n:\"BrtRRHeader\", f:parsenoop },\n\t0x019C: { n:\"BrtRRUserView\", f:parsenoop },\n\t0x019D: { n:\"BrtRRRenSheet\", f:parsenoop },\n\t0x019E: { n:\"BrtRRInsertSh\", f:parsenoop },\n\t0x019F: { n:\"BrtRRDefName\", f:parsenoop },\n\t0x01A0: { n:\"BrtRRNote\", f:parsenoop },\n\t0x01A1: { n:\"BrtRRConflict\", f:parsenoop },\n\t0x01A2: { n:\"BrtRRTQSIF\", f:parsenoop },\n\t0x01A3: { n:\"BrtRRFormat\", f:parsenoop },\n\t0x01A4: { n:\"BrtRREndFormat\", f:parsenoop },\n\t0x01A5: { n:\"BrtRRAutoFmt\", f:parsenoop },\n\t0x01A6: { n:\"BrtBeginUserShViews\", f:parsenoop },\n\t0x01A7: { n:\"BrtBeginUserShView\", f:parsenoop },\n\t0x01A8: { n:\"BrtEndUserShView\", f:parsenoop },\n\t0x01A9: { n:\"BrtEndUserShViews\", f:parsenoop },\n\t0x01AA: { n:\"BrtArrFmla\", f:parsenoop },\n\t0x01AB: { n:\"BrtShrFmla\", f:parsenoop },\n\t0x01AC: { n:\"BrtTable\", f:parsenoop },\n\t0x01AD: { n:\"BrtBeginExtConnections\", f:parsenoop },\n\t0x01AE: { n:\"BrtEndExtConnections\", f:parsenoop },\n\t0x01AF: { n:\"BrtBeginPCDCalcMems\", f:parsenoop },\n\t0x01B0: { n:\"BrtEndPCDCalcMems\", f:parsenoop },\n\t0x01B1: { n:\"BrtBeginPCDCalcMem\", f:parsenoop },\n\t0x01B2: { n:\"BrtEndPCDCalcMem\", f:parsenoop },\n\t0x01B3: { n:\"BrtBeginPCDHGLevels\", f:parsenoop },\n\t0x01B4: { n:\"BrtEndPCDHGLevels\", f:parsenoop },\n\t0x01B5: { n:\"BrtBeginPCDHGLevel\", f:parsenoop },\n\t0x01B6: { n:\"BrtEndPCDHGLevel\", f:parsenoop },\n\t0x01B7: { n:\"BrtBeginPCDHGLGroups\", f:parsenoop },\n\t0x01B8: { n:\"BrtEndPCDHGLGroups\", f:parsenoop },\n\t0x01B9: { n:\"BrtBeginPCDHGLGroup\", f:parsenoop },\n\t0x01BA: { n:\"BrtEndPCDHGLGroup\", f:parsenoop },\n\t0x01BB: { n:\"BrtBeginPCDHGLGMembers\", f:parsenoop },\n\t0x01BC: { n:\"BrtEndPCDHGLGMembers\", f:parsenoop },\n\t0x01BD: { n:\"BrtBeginPCDHGLGMember\", f:parsenoop },\n\t0x01BE: { n:\"BrtEndPCDHGLGMember\", f:parsenoop },\n\t0x01BF: { n:\"BrtBeginQSI\", f:parsenoop },\n\t0x01C0: { n:\"BrtEndQSI\", f:parsenoop },\n\t0x01C1: { n:\"BrtBeginQSIR\", f:parsenoop },\n\t0x01C2: { n:\"BrtEndQSIR\", f:parsenoop },\n\t0x01C3: { n:\"BrtBeginDeletedNames\", f:parsenoop },\n\t0x01C4: { n:\"BrtEndDeletedNames\", f:parsenoop },\n\t0x01C5: { n:\"BrtBeginDeletedName\", f:parsenoop },\n\t0x01C6: { n:\"BrtEndDeletedName\", f:parsenoop },\n\t0x01C7: { n:\"BrtBeginQSIFs\", f:parsenoop },\n\t0x01C8: { n:\"BrtEndQSIFs\", f:parsenoop },\n\t0x01C9: { n:\"BrtBeginQSIF\", f:parsenoop },\n\t0x01CA: { n:\"BrtEndQSIF\", f:parsenoop },\n\t0x01CB: { n:\"BrtBeginAutoSortScope\", f:parsenoop },\n\t0x01CC: { n:\"BrtEndAutoSortScope\", f:parsenoop },\n\t0x01CD: { n:\"BrtBeginConditionalFormatting\", f:parsenoop },\n\t0x01CE: { n:\"BrtEndConditionalFormatting\", f:parsenoop },\n\t0x01CF: { n:\"BrtBeginCFRule\", f:parsenoop },\n\t0x01D0: { n:\"BrtEndCFRule\", f:parsenoop },\n\t0x01D1: { n:\"BrtBeginIconSet\", f:parsenoop },\n\t0x01D2: { n:\"BrtEndIconSet\", f:parsenoop },\n\t0x01D3: { n:\"BrtBeginDatabar\", f:parsenoop },\n\t0x01D4: { n:\"BrtEndDatabar\", f:parsenoop },\n\t0x01D5: { n:\"BrtBeginColorScale\", f:parsenoop },\n\t0x01D6: { n:\"BrtEndColorScale\", f:parsenoop },\n\t0x01D7: { n:\"BrtCFVO\", f:parsenoop },\n\t0x01D8: { n:\"BrtExternValueMeta\", f:parsenoop },\n\t0x01D9: { n:\"BrtBeginColorPalette\", f:parsenoop },\n\t0x01DA: { n:\"BrtEndColorPalette\", f:parsenoop },\n\t0x01DB: { n:\"BrtIndexedColor\", f:parsenoop },\n\t0x01DC: { n:\"BrtMargins\", f:parsenoop },\n\t0x01DD: { n:\"BrtPrintOptions\", f:parsenoop },\n\t0x01DE: { n:\"BrtPageSetup\", f:parsenoop },\n\t0x01DF: { n:\"BrtBeginHeaderFooter\", f:parsenoop },\n\t0x01E0: { n:\"BrtEndHeaderFooter\", f:parsenoop },\n\t0x01E1: { n:\"BrtBeginSXCrtFormat\", f:parsenoop },\n\t0x01E2: { n:\"BrtEndSXCrtFormat\", f:parsenoop },\n\t0x01E3: { n:\"BrtBeginSXCrtFormats\", f:parsenoop },\n\t0x01E4: { n:\"BrtEndSXCrtFormats\", f:parsenoop },\n\t0x01E5: { n:\"BrtWsFmtInfo\", f:parsenoop },\n\t0x01E6: { n:\"BrtBeginMgs\", f:parsenoop },\n\t0x01E7: { n:\"BrtEndMGs\", f:parsenoop },\n\t0x01E8: { n:\"BrtBeginMGMaps\", f:parsenoop },\n\t0x01E9: { n:\"BrtEndMGMaps\", f:parsenoop },\n\t0x01EA: { n:\"BrtBeginMG\", f:parsenoop },\n\t0x01EB: { n:\"BrtEndMG\", f:parsenoop },\n\t0x01EC: { n:\"BrtBeginMap\", f:parsenoop },\n\t0x01ED: { n:\"BrtEndMap\", f:parsenoop },\n\t0x01EE: { n:\"BrtHLink\", f:parse_BrtHLink },\n\t0x01EF: { n:\"BrtBeginDCon\", f:parsenoop },\n\t0x01F0: { n:\"BrtEndDCon\", f:parsenoop },\n\t0x01F1: { n:\"BrtBeginDRefs\", f:parsenoop },\n\t0x01F2: { n:\"BrtEndDRefs\", f:parsenoop },\n\t0x01F3: { n:\"BrtDRef\", f:parsenoop },\n\t0x01F4: { n:\"BrtBeginScenMan\", f:parsenoop },\n\t0x01F5: { n:\"BrtEndScenMan\", f:parsenoop },\n\t0x01F6: { n:\"BrtBeginSct\", f:parsenoop },\n\t0x01F7: { n:\"BrtEndSct\", f:parsenoop },\n\t0x01F8: { n:\"BrtSlc\", f:parsenoop },\n\t0x01F9: { n:\"BrtBeginDXFs\", f:parsenoop },\n\t0x01FA: { n:\"BrtEndDXFs\", f:parsenoop },\n\t0x01FB: { n:\"BrtDXF\", f:parsenoop },\n\t0x01FC: { n:\"BrtBeginTableStyles\", f:parsenoop },\n\t0x01FD: { n:\"BrtEndTableStyles\", f:parsenoop },\n\t0x01FE: { n:\"BrtBeginTableStyle\", f:parsenoop },\n\t0x01FF: { n:\"BrtEndTableStyle\", f:parsenoop },\n\t0x0200: { n:\"BrtTableStyleElement\", f:parsenoop },\n\t0x0201: { n:\"BrtTableStyleClient\", f:parsenoop },\n\t0x0202: { n:\"BrtBeginVolDeps\", f:parsenoop },\n\t0x0203: { n:\"BrtEndVolDeps\", f:parsenoop },\n\t0x0204: { n:\"BrtBeginVolType\", f:parsenoop },\n\t0x0205: { n:\"BrtEndVolType\", f:parsenoop },\n\t0x0206: { n:\"BrtBeginVolMain\", f:parsenoop },\n\t0x0207: { n:\"BrtEndVolMain\", f:parsenoop },\n\t0x0208: { n:\"BrtBeginVolTopic\", f:parsenoop },\n\t0x0209: { n:\"BrtEndVolTopic\", f:parsenoop },\n\t0x020A: { n:\"BrtVolSubtopic\", f:parsenoop },\n\t0x020B: { n:\"BrtVolRef\", f:parsenoop },\n\t0x020C: { n:\"BrtVolNum\", f:parsenoop },\n\t0x020D: { n:\"BrtVolErr\", f:parsenoop },\n\t0x020E: { n:\"BrtVolStr\", f:parsenoop },\n\t0x020F: { n:\"BrtVolBool\", f:parsenoop },\n\t0x0210: { n:\"BrtBeginCalcChain$\", f:parsenoop },\n\t0x0211: { n:\"BrtEndCalcChain$\", f:parsenoop },\n\t0x0212: { n:\"BrtBeginSortState\", f:parsenoop },\n\t0x0213: { n:\"BrtEndSortState\", f:parsenoop },\n\t0x0214: { n:\"BrtBeginSortCond\", f:parsenoop },\n\t0x0215: { n:\"BrtEndSortCond\", f:parsenoop },\n\t0x0216: { n:\"BrtBookProtection\", f:parsenoop },\n\t0x0217: { n:\"BrtSheetProtection\", f:parsenoop },\n\t0x0218: { n:\"BrtRangeProtection\", f:parsenoop },\n\t0x0219: { n:\"BrtPhoneticInfo\", f:parsenoop },\n\t0x021A: { n:\"BrtBeginECTxtWiz\", f:parsenoop },\n\t0x021B: { n:\"BrtEndECTxtWiz\", f:parsenoop },\n\t0x021C: { n:\"BrtBeginECTWFldInfoLst\", f:parsenoop },\n\t0x021D: { n:\"BrtEndECTWFldInfoLst\", f:parsenoop },\n\t0x021E: { n:\"BrtBeginECTwFldInfo\", f:parsenoop },\n\t0x0224: { n:\"BrtFileSharing\", f:parsenoop },\n\t0x0225: { n:\"BrtOleSize\", f:parsenoop },\n\t0x0226: { n:\"BrtDrawing\", f:parsenoop },\n\t0x0227: { n:\"BrtLegacyDrawing\", f:parsenoop },\n\t0x0228: { n:\"BrtLegacyDrawingHF\", f:parsenoop },\n\t0x0229: { n:\"BrtWebOpt\", f:parsenoop },\n\t0x022A: { n:\"BrtBeginWebPubItems\", f:parsenoop },\n\t0x022B: { n:\"BrtEndWebPubItems\", f:parsenoop },\n\t0x022C: { n:\"BrtBeginWebPubItem\", f:parsenoop },\n\t0x022D: { n:\"BrtEndWebPubItem\", f:parsenoop },\n\t0x022E: { n:\"BrtBeginSXCondFmt\", f:parsenoop },\n\t0x022F: { n:\"BrtEndSXCondFmt\", f:parsenoop },\n\t0x0230: { n:\"BrtBeginSXCondFmts\", f:parsenoop },\n\t0x0231: { n:\"BrtEndSXCondFmts\", f:parsenoop },\n\t0x0232: { n:\"BrtBkHim\", f:parsenoop },\n\t0x0234: { n:\"BrtColor\", f:parsenoop },\n\t0x0235: { n:\"BrtBeginIndexedColors\", f:parsenoop },\n\t0x0236: { n:\"BrtEndIndexedColors\", f:parsenoop },\n\t0x0239: { n:\"BrtBeginMRUColors\", f:parsenoop },\n\t0x023A: { n:\"BrtEndMRUColors\", f:parsenoop },\n\t0x023C: { n:\"BrtMRUColor\", f:parsenoop },\n\t0x023D: { n:\"BrtBeginDVals\", f:parsenoop },\n\t0x023E: { n:\"BrtEndDVals\", f:parsenoop },\n\t0x0241: { n:\"BrtSupNameStart\", f:parsenoop },\n\t0x0242: { n:\"BrtSupNameValueStart\", f:parsenoop },\n\t0x0243: { n:\"BrtSupNameValueEnd\", f:parsenoop },\n\t0x0244: { n:\"BrtSupNameNum\", f:parsenoop },\n\t0x0245: { n:\"BrtSupNameErr\", f:parsenoop },\n\t0x0246: { n:\"BrtSupNameSt\", f:parsenoop },\n\t0x0247: { n:\"BrtSupNameNil\", f:parsenoop },\n\t0x0248: { n:\"BrtSupNameBool\", f:parsenoop },\n\t0x0249: { n:\"BrtSupNameFmla\", f:parsenoop },\n\t0x024A: { n:\"BrtSupNameBits\", f:parsenoop },\n\t0x024B: { n:\"BrtSupNameEnd\", f:parsenoop },\n\t0x024C: { n:\"BrtEndSupBook\", f:parsenoop },\n\t0x024D: { n:\"BrtCellSmartTagProperty\", f:parsenoop },\n\t0x024E: { n:\"BrtBeginCellSmartTag\", f:parsenoop },\n\t0x024F: { n:\"BrtEndCellSmartTag\", f:parsenoop },\n\t0x0250: { n:\"BrtBeginCellSmartTags\", f:parsenoop },\n\t0x0251: { n:\"BrtEndCellSmartTags\", f:parsenoop },\n\t0x0252: { n:\"BrtBeginSmartTags\", f:parsenoop },\n\t0x0253: { n:\"BrtEndSmartTags\", f:parsenoop },\n\t0x0254: { n:\"BrtSmartTagType\", f:parsenoop },\n\t0x0255: { n:\"BrtBeginSmartTagTypes\", f:parsenoop },\n\t0x0256: { n:\"BrtEndSmartTagTypes\", f:parsenoop },\n\t0x0257: { n:\"BrtBeginSXFilters\", f:parsenoop },\n\t0x0258: { n:\"BrtEndSXFilters\", f:parsenoop },\n\t0x0259: { n:\"BrtBeginSXFILTER\", f:parsenoop },\n\t0x025A: { n:\"BrtEndSXFilter\", f:parsenoop },\n\t0x025B: { n:\"BrtBeginFills\", f:parsenoop },\n\t0x025C: { n:\"BrtEndFills\", f:parsenoop },\n\t0x025D: { n:\"BrtBeginCellWatches\", f:parsenoop },\n\t0x025E: { n:\"BrtEndCellWatches\", f:parsenoop },\n\t0x025F: { n:\"BrtCellWatch\", f:parsenoop },\n\t0x0260: { n:\"BrtBeginCRErrs\", f:parsenoop },\n\t0x0261: { n:\"BrtEndCRErrs\", f:parsenoop },\n\t0x0262: { n:\"BrtCrashRecErr\", f:parsenoop },\n\t0x0263: { n:\"BrtBeginFonts\", f:parsenoop },\n\t0x0264: { n:\"BrtEndFonts\", f:parsenoop },\n\t0x0265: { n:\"BrtBeginBorders\", f:parsenoop },\n\t0x0266: { n:\"BrtEndBorders\", f:parsenoop },\n\t0x0267: { n:\"BrtBeginFmts\", f:parsenoop },\n\t0x0268: { n:\"BrtEndFmts\", f:parsenoop },\n\t0x0269: { n:\"BrtBeginCellXFs\", f:parsenoop },\n\t0x026A: { n:\"BrtEndCellXFs\", f:parsenoop },\n\t0x026B: { n:\"BrtBeginStyles\", f:parsenoop },\n\t0x026C: { n:\"BrtEndStyles\", f:parsenoop },\n\t0x0271: { n:\"BrtBigName\", f:parsenoop },\n\t0x0272: { n:\"BrtBeginCellStyleXFs\", f:parsenoop },\n\t0x0273: { n:\"BrtEndCellStyleXFs\", f:parsenoop },\n\t0x0274: { n:\"BrtBeginComments\", f:parsenoop },\n\t0x0275: { n:\"BrtEndComments\", f:parsenoop },\n\t0x0276: { n:\"BrtBeginCommentAuthors\", f:parsenoop },\n\t0x0277: { n:\"BrtEndCommentAuthors\", f:parsenoop },\n\t0x0278: { n:\"BrtCommentAuthor\", f:parse_BrtCommentAuthor },\n\t0x0279: { n:\"BrtBeginCommentList\", f:parsenoop },\n\t0x027A: { n:\"BrtEndCommentList\", f:parsenoop },\n\t0x027B: { n:\"BrtBeginComment\", f:parse_BrtBeginComment},\n\t0x027C: { n:\"BrtEndComment\", f:parsenoop },\n\t0x027D: { n:\"BrtCommentText\", f:parse_BrtCommentText },\n\t0x027E: { n:\"BrtBeginOleObjects\", f:parsenoop },\n\t0x027F: { n:\"BrtOleObject\", f:parsenoop },\n\t0x0280: { n:\"BrtEndOleObjects\", f:parsenoop },\n\t0x0281: { n:\"BrtBeginSxrules\", f:parsenoop },\n\t0x0282: { n:\"BrtEndSxRules\", f:parsenoop },\n\t0x0283: { n:\"BrtBeginActiveXControls\", f:parsenoop },\n\t0x0284: { n:\"BrtActiveX\", f:parsenoop },\n\t0x0285: { n:\"BrtEndActiveXControls\", f:parsenoop },\n\t0x0286: { n:\"BrtBeginPCDSDTCEMembersSortBy\", f:parsenoop },\n\t0x0288: { n:\"BrtBeginCellIgnoreECs\", f:parsenoop },\n\t0x0289: { n:\"BrtCellIgnoreEC\", f:parsenoop },\n\t0x028A: { n:\"BrtEndCellIgnoreECs\", f:parsenoop },\n\t0x028B: { n:\"BrtCsProp\", f:parsenoop },\n\t0x028C: { n:\"BrtCsPageSetup\", f:parsenoop },\n\t0x028D: { n:\"BrtBeginUserCsViews\", f:parsenoop },\n\t0x028E: { n:\"BrtEndUserCsViews\", f:parsenoop },\n\t0x028F: { n:\"BrtBeginUserCsView\", f:parsenoop },\n\t0x0290: { n:\"BrtEndUserCsView\", f:parsenoop },\n\t0x0291: { n:\"BrtBeginPcdSFCIEntries\", f:parsenoop },\n\t0x0292: { n:\"BrtEndPCDSFCIEntries\", f:parsenoop },\n\t0x0293: { n:\"BrtPCDSFCIEntry\", f:parsenoop },\n\t0x0294: { n:\"BrtBeginListParts\", f:parsenoop },\n\t0x0295: { n:\"BrtListPart\", f:parsenoop },\n\t0x0296: { n:\"BrtEndListParts\", f:parsenoop },\n\t0x0297: { n:\"BrtSheetCalcProp\", f:parsenoop },\n\t0x0298: { n:\"BrtBeginFnGroup\", f:parsenoop },\n\t0x0299: { n:\"BrtFnGroup\", f:parsenoop },\n\t0x029A: { n:\"BrtEndFnGroup\", f:parsenoop },\n\t0x029B: { n:\"BrtSupAddin\", f:parsenoop },\n\t0x029C: { n:\"BrtSXTDMPOrder\", f:parsenoop },\n\t0x029D: { n:\"BrtCsProtection\", f:parsenoop },\n\t0x029F: { n:\"BrtBeginWsSortMap\", f:parsenoop },\n\t0x02A0: { n:\"BrtEndWsSortMap\", f:parsenoop },\n\t0x02A1: { n:\"BrtBeginRRSort\", f:parsenoop },\n\t0x02A2: { n:\"BrtEndRRSort\", f:parsenoop },\n\t0x02A3: { n:\"BrtRRSortItem\", f:parsenoop },\n\t0x02A4: { n:\"BrtFileSharingIso\", f:parsenoop },\n\t0x02A5: { n:\"BrtBookProtectionIso\", f:parsenoop },\n\t0x02A6: { n:\"BrtSheetProtectionIso\", f:parsenoop },\n\t0x02A7: { n:\"BrtCsProtectionIso\", f:parsenoop },\n\t0x02A8: { n:\"BrtRangeProtectionIso\", f:parsenoop },\n\t0x0400: { n:\"BrtRwDescent\", f:parsenoop },\n\t0x0401: { n:\"BrtKnownFonts\", f:parsenoop },\n\t0x0402: { n:\"BrtBeginSXTupleSet\", f:parsenoop },\n\t0x0403: { n:\"BrtEndSXTupleSet\", f:parsenoop },\n\t0x0404: { n:\"BrtBeginSXTupleSetHeader\", f:parsenoop },\n\t0x0405: { n:\"BrtEndSXTupleSetHeader\", f:parsenoop },\n\t0x0406: { n:\"BrtSXTupleSetHeaderItem\", f:parsenoop },\n\t0x0407: { n:\"BrtBeginSXTupleSetData\", f:parsenoop },\n\t0x0408: { n:\"BrtEndSXTupleSetData\", f:parsenoop },\n\t0x0409: { n:\"BrtBeginSXTupleSetRow\", f:parsenoop },\n\t0x040A: { n:\"BrtEndSXTupleSetRow\", f:parsenoop },\n\t0x040B: { n:\"BrtSXTupleSetRowItem\", f:parsenoop },\n\t0x040C: { n:\"BrtNameExt\", f:parsenoop },\n\t0x040D: { n:\"BrtPCDH14\", f:parsenoop },\n\t0x040E: { n:\"BrtBeginPCDCalcMem14\", f:parsenoop },\n\t0x040F: { n:\"BrtEndPCDCalcMem14\", f:parsenoop },\n\t0x0410: { n:\"BrtSXTH14\", f:parsenoop },\n\t0x0411: { n:\"BrtBeginSparklineGroup\", f:parsenoop },\n\t0x0412: { n:\"BrtEndSparklineGroup\", f:parsenoop },\n\t0x0413: { n:\"BrtSparkline\", f:parsenoop },\n\t0x0414: { n:\"BrtSXDI14\", f:parsenoop },\n\t0x0415: { n:\"BrtWsFmtInfoEx14\", f:parsenoop },\n\t0x0416: { n:\"BrtBeginConditionalFormatting14\", f:parsenoop },\n\t0x0417: { n:\"BrtEndConditionalFormatting14\", f:parsenoop },\n\t0x0418: { n:\"BrtBeginCFRule14\", f:parsenoop },\n\t0x0419: { n:\"BrtEndCFRule14\", f:parsenoop },\n\t0x041A: { n:\"BrtCFVO14\", f:parsenoop },\n\t0x041B: { n:\"BrtBeginDatabar14\", f:parsenoop },\n\t0x041C: { n:\"BrtBeginIconSet14\", f:parsenoop },\n\t0x041D: { n:\"BrtDVal14\", f:parsenoop },\n\t0x041E: { n:\"BrtBeginDVals14\", f:parsenoop },\n\t0x041F: { n:\"BrtColor14\", f:parsenoop },\n\t0x0420: { n:\"BrtBeginSparklines\", f:parsenoop },\n\t0x0421: { n:\"BrtEndSparklines\", f:parsenoop },\n\t0x0422: { n:\"BrtBeginSparklineGroups\", f:parsenoop },\n\t0x0423: { n:\"BrtEndSparklineGroups\", f:parsenoop },\n\t0x0425: { n:\"BrtSXVD14\", f:parsenoop },\n\t0x0426: { n:\"BrtBeginSxview14\", f:parsenoop },\n\t0x0427: { n:\"BrtEndSxview14\", f:parsenoop },\n\t0x042A: { n:\"BrtBeginPCD14\", f:parsenoop },\n\t0x042B: { n:\"BrtEndPCD14\", f:parsenoop },\n\t0x042C: { n:\"BrtBeginExtConn14\", f:parsenoop },\n\t0x042D: { n:\"BrtEndExtConn14\", f:parsenoop },\n\t0x042E: { n:\"BrtBeginSlicerCacheIDs\", f:parsenoop },\n\t0x042F: { n:\"BrtEndSlicerCacheIDs\", f:parsenoop },\n\t0x0430: { n:\"BrtBeginSlicerCacheID\", f:parsenoop },\n\t0x0431: { n:\"BrtEndSlicerCacheID\", f:parsenoop },\n\t0x0433: { n:\"BrtBeginSlicerCache\", f:parsenoop },\n\t0x0434: { n:\"BrtEndSlicerCache\", f:parsenoop },\n\t0x0435: { n:\"BrtBeginSlicerCacheDef\", f:parsenoop },\n\t0x0436: { n:\"BrtEndSlicerCacheDef\", f:parsenoop },\n\t0x0437: { n:\"BrtBeginSlicersEx\", f:parsenoop },\n\t0x0438: { n:\"BrtEndSlicersEx\", f:parsenoop },\n\t0x0439: { n:\"BrtBeginSlicerEx\", f:parsenoop },\n\t0x043A: { n:\"BrtEndSlicerEx\", f:parsenoop },\n\t0x043B: { n:\"BrtBeginSlicer\", f:parsenoop },\n\t0x043C: { n:\"BrtEndSlicer\", f:parsenoop },\n\t0x043D: { n:\"BrtSlicerCachePivotTables\", f:parsenoop },\n\t0x043E: { n:\"BrtBeginSlicerCacheOlapImpl\", f:parsenoop },\n\t0x043F: { n:\"BrtEndSlicerCacheOlapImpl\", f:parsenoop },\n\t0x0440: { n:\"BrtBeginSlicerCacheLevelsData\", f:parsenoop },\n\t0x0441: { n:\"BrtEndSlicerCacheLevelsData\", f:parsenoop },\n\t0x0442: { n:\"BrtBeginSlicerCacheLevelData\", f:parsenoop },\n\t0x0443: { n:\"BrtEndSlicerCacheLevelData\", f:parsenoop },\n\t0x0444: { n:\"BrtBeginSlicerCacheSiRanges\", f:parsenoop },\n\t0x0445: { n:\"BrtEndSlicerCacheSiRanges\", f:parsenoop },\n\t0x0446: { n:\"BrtBeginSlicerCacheSiRange\", f:parsenoop },\n\t0x0447: { n:\"BrtEndSlicerCacheSiRange\", f:parsenoop },\n\t0x0448: { n:\"BrtSlicerCacheOlapItem\", f:parsenoop },\n\t0x0449: { n:\"BrtBeginSlicerCacheSelections\", f:parsenoop },\n\t0x044A: { n:\"BrtSlicerCacheSelection\", f:parsenoop },\n\t0x044B: { n:\"BrtEndSlicerCacheSelections\", f:parsenoop },\n\t0x044C: { n:\"BrtBeginSlicerCacheNative\", f:parsenoop },\n\t0x044D: { n:\"BrtEndSlicerCacheNative\", f:parsenoop },\n\t0x044E: { n:\"BrtSlicerCacheNativeItem\", f:parsenoop },\n\t0x044F: { n:\"BrtRangeProtection14\", f:parsenoop },\n\t0x0450: { n:\"BrtRangeProtectionIso14\", f:parsenoop },\n\t0x0451: { n:\"BrtCellIgnoreEC14\", f:parsenoop },\n\t0x0457: { n:\"BrtList14\", f:parsenoop },\n\t0x0458: { n:\"BrtCFIcon\", f:parsenoop },\n\t0x0459: { n:\"BrtBeginSlicerCachesPivotCacheIDs\", f:parsenoop },\n\t0x045A: { n:\"BrtEndSlicerCachesPivotCacheIDs\", f:parsenoop },\n\t0x045B: { n:\"BrtBeginSlicers\", f:parsenoop },\n\t0x045C: { n:\"BrtEndSlicers\", f:parsenoop },\n\t0x045D: { n:\"BrtWbProp14\", f:parsenoop },\n\t0x045E: { n:\"BrtBeginSXEdit\", f:parsenoop },\n\t0x045F: { n:\"BrtEndSXEdit\", f:parsenoop },\n\t0x0460: { n:\"BrtBeginSXEdits\", f:parsenoop },\n\t0x0461: { n:\"BrtEndSXEdits\", f:parsenoop },\n\t0x0462: { n:\"BrtBeginSXChange\", f:parsenoop },\n\t0x0463: { n:\"BrtEndSXChange\", f:parsenoop },\n\t0x0464: { n:\"BrtBeginSXChanges\", f:parsenoop },\n\t0x0465: { n:\"BrtEndSXChanges\", f:parsenoop },\n\t0x0466: { n:\"BrtSXTupleItems\", f:parsenoop },\n\t0x0468: { n:\"BrtBeginSlicerStyle\", f:parsenoop },\n\t0x0469: { n:\"BrtEndSlicerStyle\", f:parsenoop },\n\t0x046A: { n:\"BrtSlicerStyleElement\", f:parsenoop },\n\t0x046B: { n:\"BrtBeginStyleSheetExt14\", f:parsenoop },\n\t0x046C: { n:\"BrtEndStyleSheetExt14\", f:parsenoop },\n\t0x046D: { n:\"BrtBeginSlicerCachesPivotCacheID\", f:parsenoop },\n\t0x046E: { n:\"BrtEndSlicerCachesPivotCacheID\", f:parsenoop },\n\t0x046F: { n:\"BrtBeginConditionalFormattings\", f:parsenoop },\n\t0x0470: { n:\"BrtEndConditionalFormattings\", f:parsenoop },\n\t0x0471: { n:\"BrtBeginPCDCalcMemExt\", f:parsenoop },\n\t0x0472: { n:\"BrtEndPCDCalcMemExt\", f:parsenoop },\n\t0x0473: { n:\"BrtBeginPCDCalcMemsExt\", f:parsenoop },\n\t0x0474: { n:\"BrtEndPCDCalcMemsExt\", f:parsenoop },\n\t0x0475: { n:\"BrtPCDField14\", f:parsenoop },\n\t0x0476: { n:\"BrtBeginSlicerStyles\", f:parsenoop },\n\t0x0477: { n:\"BrtEndSlicerStyles\", f:parsenoop },\n\t0x0478: { n:\"BrtBeginSlicerStyleElements\", f:parsenoop },\n\t0x0479: { n:\"BrtEndSlicerStyleElements\", f:parsenoop },\n\t0x047A: { n:\"BrtCFRuleExt\", f:parsenoop },\n\t0x047B: { n:\"BrtBeginSXCondFmt14\", f:parsenoop },\n\t0x047C: { n:\"BrtEndSXCondFmt14\", f:parsenoop },\n\t0x047D: { n:\"BrtBeginSXCondFmts14\", f:parsenoop },\n\t0x047E: { n:\"BrtEndSXCondFmts14\", f:parsenoop },\n\t0x0480: { n:\"BrtBeginSortCond14\", f:parsenoop },\n\t0x0481: { n:\"BrtEndSortCond14\", f:parsenoop },\n\t0x0482: { n:\"BrtEndDVals14\", f:parsenoop },\n\t0x0483: { n:\"BrtEndIconSet14\", f:parsenoop },\n\t0x0484: { n:\"BrtEndDatabar14\", f:parsenoop },\n\t0x0485: { n:\"BrtBeginColorScale14\", f:parsenoop },\n\t0x0486: { n:\"BrtEndColorScale14\", f:parsenoop },\n\t0x0487: { n:\"BrtBeginSxrules14\", f:parsenoop },\n\t0x0488: { n:\"BrtEndSxrules14\", f:parsenoop },\n\t0x0489: { n:\"BrtBeginPRule14\", f:parsenoop },\n\t0x048A: { n:\"BrtEndPRule14\", f:parsenoop },\n\t0x048B: { n:\"BrtBeginPRFilters14\", f:parsenoop },\n\t0x048C: { n:\"BrtEndPRFilters14\", f:parsenoop },\n\t0x048D: { n:\"BrtBeginPRFilter14\", f:parsenoop },\n\t0x048E: { n:\"BrtEndPRFilter14\", f:parsenoop },\n\t0x048F: { n:\"BrtBeginPRFItem14\", f:parsenoop },\n\t0x0490: { n:\"BrtEndPRFItem14\", f:parsenoop },\n\t0x0491: { n:\"BrtBeginCellIgnoreECs14\", f:parsenoop },\n\t0x0492: { n:\"BrtEndCellIgnoreECs14\", f:parsenoop },\n\t0x0493: { n:\"BrtDxf14\", f:parsenoop },\n\t0x0494: { n:\"BrtBeginDxF14s\", f:parsenoop },\n\t0x0495: { n:\"BrtEndDxf14s\", f:parsenoop },\n\t0x0499: { n:\"BrtFilter14\", f:parsenoop },\n\t0x049A: { n:\"BrtBeginCustomFilters14\", f:parsenoop },\n\t0x049C: { n:\"BrtCustomFilter14\", f:parsenoop },\n\t0x049D: { n:\"BrtIconFilter14\", f:parsenoop },\n\t0x049E: { n:\"BrtPivotCacheConnectionName\", f:parsenoop },\n\t0x0800: { n:\"BrtBeginDecoupledPivotCacheIDs\", f:parsenoop },\n\t0x0801: { n:\"BrtEndDecoupledPivotCacheIDs\", f:parsenoop },\n\t0x0802: { n:\"BrtDecoupledPivotCacheID\", f:parsenoop },\n\t0x0803: { n:\"BrtBeginPivotTableRefs\", f:parsenoop },\n\t0x0804: { n:\"BrtEndPivotTableRefs\", f:parsenoop },\n\t0x0805: { n:\"BrtPivotTableRef\", f:parsenoop },\n\t0x0806: { n:\"BrtSlicerCacheBookPivotTables\", f:parsenoop },\n\t0x0807: { n:\"BrtBeginSxvcells\", f:parsenoop },\n\t0x0808: { n:\"BrtEndSxvcells\", f:parsenoop },\n\t0x0809: { n:\"BrtBeginSxRow\", f:parsenoop },\n\t0x080A: { n:\"BrtEndSxRow\", f:parsenoop },\n\t0x080C: { n:\"BrtPcdCalcMem15\", f:parsenoop },\n\t0x0813: { n:\"BrtQsi15\", f:parsenoop },\n\t0x0814: { n:\"BrtBeginWebExtensions\", f:parsenoop },\n\t0x0815: { n:\"BrtEndWebExtensions\", f:parsenoop },\n\t0x0816: { n:\"BrtWebExtension\", f:parsenoop },\n\t0x0817: { n:\"BrtAbsPath15\", f:parsenoop },\n\t0x0818: { n:\"BrtBeginPivotTableUISettings\", f:parsenoop },\n\t0x0819: { n:\"BrtEndPivotTableUISettings\", f:parsenoop },\n\t0x081B: { n:\"BrtTableSlicerCacheIDs\", f:parsenoop },\n\t0x081C: { n:\"BrtTableSlicerCacheID\", f:parsenoop },\n\t0x081D: { n:\"BrtBeginTableSlicerCache\", f:parsenoop },\n\t0x081E: { n:\"BrtEndTableSlicerCache\", f:parsenoop },\n\t0x081F: { n:\"BrtSxFilter15\", f:parsenoop },\n\t0x0820: { n:\"BrtBeginTimelineCachePivotCacheIDs\", f:parsenoop },\n\t0x0821: { n:\"BrtEndTimelineCachePivotCacheIDs\", f:parsenoop },\n\t0x0822: { n:\"BrtTimelineCachePivotCacheID\", f:parsenoop },\n\t0x0823: { n:\"BrtBeginTimelineCacheIDs\", f:parsenoop },\n\t0x0824: { n:\"BrtEndTimelineCacheIDs\", f:parsenoop },\n\t0x0825: { n:\"BrtBeginTimelineCacheID\", f:parsenoop },\n\t0x0826: { n:\"BrtEndTimelineCacheID\", f:parsenoop },\n\t0x0827: { n:\"BrtBeginTimelinesEx\", f:parsenoop },\n\t0x0828: { n:\"BrtEndTimelinesEx\", f:parsenoop },\n\t0x0829: { n:\"BrtBeginTimelineEx\", f:parsenoop },\n\t0x082A: { n:\"BrtEndTimelineEx\", f:parsenoop },\n\t0x082B: { n:\"BrtWorkBookPr15\", f:parsenoop },\n\t0x082C: { n:\"BrtPCDH15\", f:parsenoop },\n\t0x082D: { n:\"BrtBeginTimelineStyle\", f:parsenoop },\n\t0x082E: { n:\"BrtEndTimelineStyle\", f:parsenoop },\n\t0x082F: { n:\"BrtTimelineStyleElement\", f:parsenoop },\n\t0x0830: { n:\"BrtBeginTimelineStylesheetExt15\", f:parsenoop },\n\t0x0831: { n:\"BrtEndTimelineStylesheetExt15\", f:parsenoop },\n\t0x0832: { n:\"BrtBeginTimelineStyles\", f:parsenoop },\n\t0x0833: { n:\"BrtEndTimelineStyles\", f:parsenoop },\n\t0x0834: { n:\"BrtBeginTimelineStyleElements\", f:parsenoop },\n\t0x0835: { n:\"BrtEndTimelineStyleElements\", f:parsenoop },\n\t0x0836: { n:\"BrtDxf15\", f:parsenoop },\n\t0x0837: { n:\"BrtBeginDxfs15\", f:parsenoop },\n\t0x0838: { n:\"brtEndDxfs15\", f:parsenoop },\n\t0x0839: { n:\"BrtSlicerCacheHideItemsWithNoData\", f:parsenoop },\n\t0x083A: { n:\"BrtBeginItemUniqueNames\", f:parsenoop },\n\t0x083B: { n:\"BrtEndItemUniqueNames\", f:parsenoop },\n\t0x083C: { n:\"BrtItemUniqueName\", f:parsenoop },\n\t0x083D: { n:\"BrtBeginExtConn15\", f:parsenoop },\n\t0x083E: { n:\"BrtEndExtConn15\", f:parsenoop },\n\t0x083F: { n:\"BrtBeginOledbPr15\", f:parsenoop },\n\t0x0840: { n:\"BrtEndOledbPr15\", f:parsenoop },\n\t0x0841: { n:\"BrtBeginDataFeedPr15\", f:parsenoop },\n\t0x0842: { n:\"BrtEndDataFeedPr15\", f:parsenoop },\n\t0x0843: { n:\"BrtTextPr15\", f:parsenoop },\n\t0x0844: { n:\"BrtRangePr15\", f:parsenoop },\n\t0x0845: { n:\"BrtDbCommand15\", f:parsenoop },\n\t0x0846: { n:\"BrtBeginDbTables15\", f:parsenoop },\n\t0x0847: { n:\"BrtEndDbTables15\", f:parsenoop },\n\t0x0848: { n:\"BrtDbTable15\", f:parsenoop },\n\t0x0849: { n:\"BrtBeginDataModel\", f:parsenoop },\n\t0x084A: { n:\"BrtEndDataModel\", f:parsenoop },\n\t0x084B: { n:\"BrtBeginModelTables\", f:parsenoop },\n\t0x084C: { n:\"BrtEndModelTables\", f:parsenoop },\n\t0x084D: { n:\"BrtModelTable\", f:parsenoop },\n\t0x084E: { n:\"BrtBeginModelRelationships\", f:parsenoop },\n\t0x084F: { n:\"BrtEndModelRelationships\", f:parsenoop },\n\t0x0850: { n:\"BrtModelRelationship\", f:parsenoop },\n\t0x0851: { n:\"BrtBeginECTxtWiz15\", f:parsenoop },\n\t0x0852: { n:\"BrtEndECTxtWiz15\", f:parsenoop },\n\t0x0853: { n:\"BrtBeginECTWFldInfoLst15\", f:parsenoop },\n\t0x0854: { n:\"BrtEndECTWFldInfoLst15\", f:parsenoop },\n\t0x0855: { n:\"BrtBeginECTWFldInfo15\", f:parsenoop },\n\t0x0856: { n:\"BrtFieldListActiveItem\", f:parsenoop },\n\t0x0857: { n:\"BrtPivotCacheIdVersion\", f:parsenoop },\n\t0x0858: { n:\"BrtSXDI15\", f:parsenoop },\n\t0xFFFF: { n:\"\", f:parsenoop }\n};\n\nvar evert_RE = evert_key(XLSBRecordEnum, 'n');\n\n/* [MS-XLS] 2.3 Record Enumeration */\nvar XLSRecordEnum = {\n\t0x0003: { n:\"BIFF2NUM\", f:parse_BIFF2NUM },\n\t0x0004: { n:\"BIFF2STR\", f:parse_BIFF2STR },\n\t0x0006: { n:\"Formula\", f:parse_Formula },\n\t0x0009: { n:'BOF', f:parse_BOF },\n\t0x000a: { n:'EOF', f:parse_EOF },\n\t0x000c: { n:\"CalcCount\", f:parse_CalcCount },\n\t0x000d: { n:\"CalcMode\", f:parse_CalcMode },\n\t0x000e: { n:\"CalcPrecision\", f:parse_CalcPrecision },\n\t0x000f: { n:\"CalcRefMode\", f:parse_CalcRefMode },\n\t0x0010: { n:\"CalcDelta\", f:parse_CalcDelta },\n\t0x0011: { n:\"CalcIter\", f:parse_CalcIter },\n\t0x0012: { n:\"Protect\", f:parse_Protect },\n\t0x0013: { n:\"Password\", f:parse_Password },\n\t0x0014: { n:\"Header\", f:parse_Header },\n\t0x0015: { n:\"Footer\", f:parse_Footer },\n\t0x0017: { n:\"ExternSheet\", f:parse_ExternSheet },\n\t0x0018: { n:\"Lbl\", f:parse_Lbl },\n\t0x0019: { n:\"WinProtect\", f:parse_WinProtect },\n\t0x001a: { n:\"VerticalPageBreaks\", f:parse_VerticalPageBreaks },\n\t0x001b: { n:\"HorizontalPageBreaks\", f:parse_HorizontalPageBreaks },\n\t0x001c: { n:\"Note\", f:parse_Note },\n\t0x001d: { n:\"Selection\", f:parse_Selection },\n\t0x0022: { n:\"Date1904\", f:parse_Date1904 },\n\t0x0023: { n:\"ExternName\", f:parse_ExternName },\n\t0x0026: { n:\"LeftMargin\", f:parse_LeftMargin },\n\t0x0027: { n:\"RightMargin\", f:parse_RightMargin },\n\t0x0028: { n:\"TopMargin\", f:parse_TopMargin },\n\t0x0029: { n:\"BottomMargin\", f:parse_BottomMargin },\n\t0x002a: { n:\"PrintRowCol\", f:parse_PrintRowCol },\n\t0x002b: { n:\"PrintGrid\", f:parse_PrintGrid },\n\t0x002f: { n:\"FilePass\", f:parse_FilePass },\n\t0x0031: { n:\"Font\", f:parse_Font },\n\t0x0033: { n:\"PrintSize\", f:parse_PrintSize },\n\t0x003c: { n:\"Continue\", f:parse_Continue },\n\t0x003d: { n:\"Window1\", f:parse_Window1 },\n\t0x0040: { n:\"Backup\", f:parse_Backup },\n\t0x0041: { n:\"Pane\", f:parse_Pane },\n\t0x0042: { n:'CodePage', f:parse_CodePage },\n\t0x004d: { n:\"Pls\", f:parse_Pls },\n\t0x0050: { n:\"DCon\", f:parse_DCon },\n\t0x0051: { n:\"DConRef\", f:parse_DConRef },\n\t0x0052: { n:\"DConName\", f:parse_DConName },\n\t0x0055: { n:\"DefColWidth\", f:parse_DefColWidth },\n\t0x0059: { n:\"XCT\", f:parse_XCT },\n\t0x005a: { n:\"CRN\", f:parse_CRN },\n\t0x005b: { n:\"FileSharing\", f:parse_FileSharing },\n\t0x005c: { n:'WriteAccess', f:parse_WriteAccess },\n\t0x005d: { n:\"Obj\", f:parse_Obj },\n\t0x005e: { n:\"Uncalced\", f:parse_Uncalced },\n\t0x005f: { n:\"CalcSaveRecalc\", f:parse_CalcSaveRecalc },\n\t0x0060: { n:\"Template\", f:parse_Template },\n\t0x0061: { n:\"Intl\", f:parse_Intl },\n\t0x0063: { n:\"ObjProtect\", f:parse_ObjProtect },\n\t0x007d: { n:\"ColInfo\", f:parse_ColInfo },\n\t0x0080: { n:\"Guts\", f:parse_Guts },\n\t0x0081: { n:\"WsBool\", f:parse_WsBool },\n\t0x0082: { n:\"GridSet\", f:parse_GridSet },\n\t0x0083: { n:\"HCenter\", f:parse_HCenter },\n\t0x0084: { n:\"VCenter\", f:parse_VCenter },\n\t0x0085: { n:'BoundSheet8', f:parse_BoundSheet8 },\n\t0x0086: { n:\"WriteProtect\", f:parse_WriteProtect },\n\t0x008c: { n:\"Country\", f:parse_Country },\n\t0x008d: { n:\"HideObj\", f:parse_HideObj },\n\t0x0090: { n:\"Sort\", f:parse_Sort },\n\t0x0092: { n:\"Palette\", f:parse_Palette },\n\t0x0097: { n:\"Sync\", f:parse_Sync },\n\t0x0098: { n:\"LPr\", f:parse_LPr },\n\t0x0099: { n:\"DxGCol\", f:parse_DxGCol },\n\t0x009a: { n:\"FnGroupName\", f:parse_FnGroupName },\n\t0x009b: { n:\"FilterMode\", f:parse_FilterMode },\n\t0x009c: { n:\"BuiltInFnGroupCount\", f:parse_BuiltInFnGroupCount },\n\t0x009d: { n:\"AutoFilterInfo\", f:parse_AutoFilterInfo },\n\t0x009e: { n:\"AutoFilter\", f:parse_AutoFilter },\n\t0x00a0: { n:\"Scl\", f:parse_Scl },\n\t0x00a1: { n:\"Setup\", f:parse_Setup },\n\t0x00ae: { n:\"ScenMan\", f:parse_ScenMan },\n\t0x00af: { n:\"SCENARIO\", f:parse_SCENARIO },\n\t0x00b0: { n:\"SxView\", f:parse_SxView },\n\t0x00b1: { n:\"Sxvd\", f:parse_Sxvd },\n\t0x00b2: { n:\"SXVI\", f:parse_SXVI },\n\t0x00b4: { n:\"SxIvd\", f:parse_SxIvd },\n\t0x00b5: { n:\"SXLI\", f:parse_SXLI },\n\t0x00b6: { n:\"SXPI\", f:parse_SXPI },\n\t0x00b8: { n:\"DocRoute\", f:parse_DocRoute },\n\t0x00b9: { n:\"RecipName\", f:parse_RecipName },\n\t0x00bd: { n:\"MulRk\", f:parse_MulRk },\n\t0x00be: { n:\"MulBlank\", f:parse_MulBlank },\n\t0x00c1: { n:'Mms', f:parse_Mms },\n\t0x00c5: { n:\"SXDI\", f:parse_SXDI },\n\t0x00c6: { n:\"SXDB\", f:parse_SXDB },\n\t0x00c7: { n:\"SXFDB\", f:parse_SXFDB },\n\t0x00c8: { n:\"SXDBB\", f:parse_SXDBB },\n\t0x00c9: { n:\"SXNum\", f:parse_SXNum },\n\t0x00ca: { n:\"SxBool\", f:parse_SxBool },\n\t0x00cb: { n:\"SxErr\", f:parse_SxErr },\n\t0x00cc: { n:\"SXInt\", f:parse_SXInt },\n\t0x00cd: { n:\"SXString\", f:parse_SXString },\n\t0x00ce: { n:\"SXDtr\", f:parse_SXDtr },\n\t0x00cf: { n:\"SxNil\", f:parse_SxNil },\n\t0x00d0: { n:\"SXTbl\", f:parse_SXTbl },\n\t0x00d1: { n:\"SXTBRGIITM\", f:parse_SXTBRGIITM },\n\t0x00d2: { n:\"SxTbpg\", f:parse_SxTbpg },\n\t0x00d3: { n:\"ObProj\", f:parse_ObProj },\n\t0x00d5: { n:\"SXStreamID\", f:parse_SXStreamID },\n\t0x00d7: { n:\"DBCell\", f:parse_DBCell },\n\t0x00d8: { n:\"SXRng\", f:parse_SXRng },\n\t0x00d9: { n:\"SxIsxoper\", f:parse_SxIsxoper },\n\t0x00da: { n:\"BookBool\", f:parse_BookBool },\n\t0x00dc: { n:\"DbOrParamQry\", f:parse_DbOrParamQry },\n\t0x00dd: { n:\"ScenarioProtect\", f:parse_ScenarioProtect },\n\t0x00de: { n:\"OleObjectSize\", f:parse_OleObjectSize },\n\t0x00e0: { n:\"XF\", f:parse_XF },\n\t0x00e1: { n:'InterfaceHdr', f:parse_InterfaceHdr },\n\t0x00e2: { n:'InterfaceEnd', f:parse_InterfaceEnd },\n\t0x00e3: { n:\"SXVS\", f:parse_SXVS },\n\t0x00e5: { n:\"MergeCells\", f:parse_MergeCells },\n\t0x00e9: { n:\"BkHim\", f:parse_BkHim },\n\t0x00eb: { n:\"MsoDrawingGroup\", f:parse_MsoDrawingGroup },\n\t0x00ec: { n:\"MsoDrawing\", f:parse_MsoDrawing },\n\t0x00ed: { n:\"MsoDrawingSelection\", f:parse_MsoDrawingSelection },\n\t0x00ef: { n:\"PhoneticInfo\", f:parse_PhoneticInfo },\n\t0x00f0: { n:\"SxRule\", f:parse_SxRule },\n\t0x00f1: { n:\"SXEx\", f:parse_SXEx },\n\t0x00f2: { n:\"SxFilt\", f:parse_SxFilt },\n\t0x00f4: { n:\"SxDXF\", f:parse_SxDXF },\n\t0x00f5: { n:\"SxItm\", f:parse_SxItm },\n\t0x00f6: { n:\"SxName\", f:parse_SxName },\n\t0x00f7: { n:\"SxSelect\", f:parse_SxSelect },\n\t0x00f8: { n:\"SXPair\", f:parse_SXPair },\n\t0x00f9: { n:\"SxFmla\", f:parse_SxFmla },\n\t0x00fb: { n:\"SxFormat\", f:parse_SxFormat },\n\t0x00fc: { n:\"SST\", f:parse_SST },\n\t0x00fd: { n:\"LabelSst\", f:parse_LabelSst },\n\t0x00ff: { n:\"ExtSST\", f:parse_ExtSST },\n\t0x0100: { n:\"SXVDEx\", f:parse_SXVDEx },\n\t0x0103: { n:\"SXFormula\", f:parse_SXFormula },\n\t0x0122: { n:\"SXDBEx\", f:parse_SXDBEx },\n\t0x0137: { n:\"RRDInsDel\", f:parse_RRDInsDel },\n\t0x0138: { n:\"RRDHead\", f:parse_RRDHead },\n\t0x013b: { n:\"RRDChgCell\", f:parse_RRDChgCell },\n\t0x013d: { n:\"RRTabId\", f:parse_RRTabId },\n\t0x013e: { n:\"RRDRenSheet\", f:parse_RRDRenSheet },\n\t0x013f: { n:\"RRSort\", f:parse_RRSort },\n\t0x0140: { n:\"RRDMove\", f:parse_RRDMove },\n\t0x014a: { n:\"RRFormat\", f:parse_RRFormat },\n\t0x014b: { n:\"RRAutoFmt\", f:parse_RRAutoFmt },\n\t0x014d: { n:\"RRInsertSh\", f:parse_RRInsertSh },\n\t0x014e: { n:\"RRDMoveBegin\", f:parse_RRDMoveBegin },\n\t0x014f: { n:\"RRDMoveEnd\", f:parse_RRDMoveEnd },\n\t0x0150: { n:\"RRDInsDelBegin\", f:parse_RRDInsDelBegin },\n\t0x0151: { n:\"RRDInsDelEnd\", f:parse_RRDInsDelEnd },\n\t0x0152: { n:\"RRDConflict\", f:parse_RRDConflict },\n\t0x0153: { n:\"RRDDefName\", f:parse_RRDDefName },\n\t0x0154: { n:\"RRDRstEtxp\", f:parse_RRDRstEtxp },\n\t0x015f: { n:\"LRng\", f:parse_LRng },\n\t0x0160: { n:\"UsesELFs\", f:parse_UsesELFs },\n\t0x0161: { n:\"DSF\", f:parse_DSF },\n\t0x0191: { n:\"CUsr\", f:parse_CUsr },\n\t0x0192: { n:\"CbUsr\", f:parse_CbUsr },\n\t0x0193: { n:\"UsrInfo\", f:parse_UsrInfo },\n\t0x0194: { n:\"UsrExcl\", f:parse_UsrExcl },\n\t0x0195: { n:\"FileLock\", f:parse_FileLock },\n\t0x0196: { n:\"RRDInfo\", f:parse_RRDInfo },\n\t0x0197: { n:\"BCUsrs\", f:parse_BCUsrs },\n\t0x0198: { n:\"UsrChk\", f:parse_UsrChk },\n\t0x01a9: { n:\"UserBView\", f:parse_UserBView },\n\t0x01aa: { n:\"UserSViewBegin\", f:parse_UserSViewBegin },\n\t0x01ab: { n:\"UserSViewEnd\", f:parse_UserSViewEnd },\n\t0x01ac: { n:\"RRDUserView\", f:parse_RRDUserView },\n\t0x01ad: { n:\"Qsi\", f:parse_Qsi },\n\t0x01ae: { n:\"SupBook\", f:parse_SupBook },\n\t0x01af: { n:\"Prot4Rev\", f:parse_Prot4Rev },\n\t0x01b0: { n:\"CondFmt\", f:parse_CondFmt },\n\t0x01b1: { n:\"CF\", f:parse_CF },\n\t0x01b2: { n:\"DVal\", f:parse_DVal },\n\t0x01b5: { n:\"DConBin\", f:parse_DConBin },\n\t0x01b6: { n:\"TxO\", f:parse_TxO },\n\t0x01b7: { n:\"RefreshAll\", f:parse_RefreshAll },\n\t0x01b8: { n:\"HLink\", f:parse_HLink },\n\t0x01b9: { n:\"Lel\", f:parse_Lel },\n\t0x01ba: { n:\"CodeName\", f:parse_XLSCodeName },\n\t0x01bb: { n:\"SXFDBType\", f:parse_SXFDBType },\n\t0x01bc: { n:\"Prot4RevPass\", f:parse_Prot4RevPass },\n\t0x01bd: { n:\"ObNoMacros\", f:parse_ObNoMacros },\n\t0x01be: { n:\"Dv\", f:parse_Dv },\n\t0x01c0: { n:\"Excel9File\", f:parse_Excel9File },\n\t0x01c1: { n:\"RecalcId\", f:parse_RecalcId, r:2},\n\t0x01c2: { n:\"EntExU2\", f:parse_EntExU2 },\n\t0x0200: { n:\"Dimensions\", f:parse_Dimensions },\n\t0x0201: { n:\"Blank\", f:parse_Blank },\n\t0x0203: { n:\"Number\", f:parse_Number },\n\t0x0204: { n:\"Label\", f:parse_Label },\n\t0x0205: { n:\"BoolErr\", f:parse_BoolErr },\n\t0x0207: { n:\"String\", f:parse_String },\n\t0x0208: { n:'Row', f:parse_Row },\n\t0x020b: { n:\"Index\", f:parse_Index },\n\t0x0221: { n:\"Array\", f:parse_Array },\n\t0x0225: { n:\"DefaultRowHeight\", f:parse_DefaultRowHeight },\n\t0x0236: { n:\"Table\", f:parse_Table },\n\t0x023e: { n:\"Window2\", f:parse_Window2 },\n\t0x027e: { n:\"RK\", f:parse_RK },\n\t0x0293: { n:\"Style\", f:parse_Style },\n\t0x0418: { n:\"BigName\", f:parse_BigName },\n\t0x041e: { n:\"Format\", f:parse_Format },\n\t0x043c: { n:\"ContinueBigName\", f:parse_ContinueBigName },\n\t0x04bc: { n:\"ShrFmla\", f:parse_ShrFmla },\n\t0x0800: { n:\"HLinkTooltip\", f:parse_HLinkTooltip },\n\t0x0801: { n:\"WebPub\", f:parse_WebPub },\n\t0x0802: { n:\"QsiSXTag\", f:parse_QsiSXTag },\n\t0x0803: { n:\"DBQueryExt\", f:parse_DBQueryExt },\n\t0x0804: { n:\"ExtString\", f:parse_ExtString },\n\t0x0805: { n:\"TxtQry\", f:parse_TxtQry },\n\t0x0806: { n:\"Qsir\", f:parse_Qsir },\n\t0x0807: { n:\"Qsif\", f:parse_Qsif },\n\t0x0808: { n:\"RRDTQSIF\", f:parse_RRDTQSIF },\n\t0x0809: { n:'BOF', f:parse_BOF },\n\t0x080a: { n:\"OleDbConn\", f:parse_OleDbConn },\n\t0x080b: { n:\"WOpt\", f:parse_WOpt },\n\t0x080c: { n:\"SXViewEx\", f:parse_SXViewEx },\n\t0x080d: { n:\"SXTH\", f:parse_SXTH },\n\t0x080e: { n:\"SXPIEx\", f:parse_SXPIEx },\n\t0x080f: { n:\"SXVDTEx\", f:parse_SXVDTEx },\n\t0x0810: { n:\"SXViewEx9\", f:parse_SXViewEx9 },\n\t0x0812: { n:\"ContinueFrt\", f:parse_ContinueFrt },\n\t0x0813: { n:\"RealTimeData\", f:parse_RealTimeData },\n\t0x0850: { n:\"ChartFrtInfo\", f:parse_ChartFrtInfo },\n\t0x0851: { n:\"FrtWrapper\", f:parse_FrtWrapper },\n\t0x0852: { n:\"StartBlock\", f:parse_StartBlock },\n\t0x0853: { n:\"EndBlock\", f:parse_EndBlock },\n\t0x0854: { n:\"StartObject\", f:parse_StartObject },\n\t0x0855: { n:\"EndObject\", f:parse_EndObject },\n\t0x0856: { n:\"CatLab\", f:parse_CatLab },\n\t0x0857: { n:\"YMult\", f:parse_YMult },\n\t0x0858: { n:\"SXViewLink\", f:parse_SXViewLink },\n\t0x0859: { n:\"PivotChartBits\", f:parse_PivotChartBits },\n\t0x085a: { n:\"FrtFontList\", f:parse_FrtFontList },\n\t0x0862: { n:\"SheetExt\", f:parse_SheetExt },\n\t0x0863: { n:\"BookExt\", f:parse_BookExt, r:12},\n\t0x0864: { n:\"SXAddl\", f:parse_SXAddl },\n\t0x0865: { n:\"CrErr\", f:parse_CrErr },\n\t0x0866: { n:\"HFPicture\", f:parse_HFPicture },\n\t0x0867: { n:'FeatHdr', f:parse_FeatHdr },\n\t0x0868: { n:\"Feat\", f:parse_Feat },\n\t0x086a: { n:\"DataLabExt\", f:parse_DataLabExt },\n\t0x086b: { n:\"DataLabExtContents\", f:parse_DataLabExtContents },\n\t0x086c: { n:\"CellWatch\", f:parse_CellWatch },\n\t0x0871: { n:\"FeatHdr11\", f:parse_FeatHdr11 },\n\t0x0872: { n:\"Feature11\", f:parse_Feature11 },\n\t0x0874: { n:\"DropDownObjIds\", f:parse_DropDownObjIds },\n\t0x0875: { n:\"ContinueFrt11\", f:parse_ContinueFrt11 },\n\t0x0876: { n:\"DConn\", f:parse_DConn },\n\t0x0877: { n:\"List12\", f:parse_List12 },\n\t0x0878: { n:\"Feature12\", f:parse_Feature12 },\n\t0x0879: { n:\"CondFmt12\", f:parse_CondFmt12 },\n\t0x087a: { n:\"CF12\", f:parse_CF12 },\n\t0x087b: { n:\"CFEx\", f:parse_CFEx },\n\t0x087c: { n:\"XFCRC\", f:parse_XFCRC, r:12 },\n\t0x087d: { n:\"XFExt\", f:parse_XFExt, r:12 },\n\t0x087e: { n:\"AutoFilter12\", f:parse_AutoFilter12 },\n\t0x087f: { n:\"ContinueFrt12\", f:parse_ContinueFrt12 },\n\t0x0884: { n:\"MDTInfo\", f:parse_MDTInfo },\n\t0x0885: { n:\"MDXStr\", f:parse_MDXStr },\n\t0x0886: { n:\"MDXTuple\", f:parse_MDXTuple },\n\t0x0887: { n:\"MDXSet\", f:parse_MDXSet },\n\t0x0888: { n:\"MDXProp\", f:parse_MDXProp },\n\t0x0889: { n:\"MDXKPI\", f:parse_MDXKPI },\n\t0x088a: { n:\"MDB\", f:parse_MDB },\n\t0x088b: { n:\"PLV\", f:parse_PLV },\n\t0x088c: { n:\"Compat12\", f:parse_Compat12, r:12 },\n\t0x088d: { n:\"DXF\", f:parse_DXF },\n\t0x088e: { n:\"TableStyles\", f:parse_TableStyles, r:12 },\n\t0x088f: { n:\"TableStyle\", f:parse_TableStyle },\n\t0x0890: { n:\"TableStyleElement\", f:parse_TableStyleElement },\n\t0x0892: { n:\"StyleExt\", f:parse_StyleExt },\n\t0x0893: { n:\"NamePublish\", f:parse_NamePublish },\n\t0x0894: { n:\"NameCmt\", f:parse_NameCmt },\n\t0x0895: { n:\"SortData\", f:parse_SortData },\n\t0x0896: { n:\"Theme\", f:parse_Theme, r:12 },\n\t0x0897: { n:\"GUIDTypeLib\", f:parse_GUIDTypeLib },\n\t0x0898: { n:\"FnGrp12\", f:parse_FnGrp12 },\n\t0x0899: { n:\"NameFnGrp12\", f:parse_NameFnGrp12 },\n\t0x089a: { n:\"MTRSettings\", f:parse_MTRSettings, r:12 },\n\t0x089b: { n:\"CompressPictures\", f:parse_CompressPictures },\n\t0x089c: { n:\"HeaderFooter\", f:parse_HeaderFooter },\n\t0x089d: { n:\"CrtLayout12\", f:parse_CrtLayout12 },\n\t0x089e: { n:\"CrtMlFrt\", f:parse_CrtMlFrt },\n\t0x089f: { n:\"CrtMlFrtContinue\", f:parse_CrtMlFrtContinue },\n\t0x08a3: { n:\"ForceFullCalculation\", f:parse_ForceFullCalculation },\n\t0x08a4: { n:\"ShapePropsStream\", f:parse_ShapePropsStream },\n\t0x08a5: { n:\"TextPropsStream\", f:parse_TextPropsStream },\n\t0x08a6: { n:\"RichTextStream\", f:parse_RichTextStream },\n\t0x08a7: { n:\"CrtLayout12A\", f:parse_CrtLayout12A },\n\t0x1001: { n:\"Units\", f:parse_Units },\n\t0x1002: { n:\"Chart\", f:parse_Chart },\n\t0x1003: { n:\"Series\", f:parse_Series },\n\t0x1006: { n:\"DataFormat\", f:parse_DataFormat },\n\t0x1007: { n:\"LineFormat\", f:parse_LineFormat },\n\t0x1009: { n:\"MarkerFormat\", f:parse_MarkerFormat },\n\t0x100a: { n:\"AreaFormat\", f:parse_AreaFormat },\n\t0x100b: { n:\"PieFormat\", f:parse_PieFormat },\n\t0x100c: { n:\"AttachedLabel\", f:parse_AttachedLabel },\n\t0x100d: { n:\"SeriesText\", f:parse_SeriesText },\n\t0x1014: { n:\"ChartFormat\", f:parse_ChartFormat },\n\t0x1015: { n:\"Legend\", f:parse_Legend },\n\t0x1016: { n:\"SeriesList\", f:parse_SeriesList },\n\t0x1017: { n:\"Bar\", f:parse_Bar },\n\t0x1018: { n:\"Line\", f:parse_Line },\n\t0x1019: { n:\"Pie\", f:parse_Pie },\n\t0x101a: { n:\"Area\", f:parse_Area },\n\t0x101b: { n:\"Scatter\", f:parse_Scatter },\n\t0x101c: { n:\"CrtLine\", f:parse_CrtLine },\n\t0x101d: { n:\"Axis\", f:parse_Axis },\n\t0x101e: { n:\"Tick\", f:parse_Tick },\n\t0x101f: { n:\"ValueRange\", f:parse_ValueRange },\n\t0x1020: { n:\"CatSerRange\", f:parse_CatSerRange },\n\t0x1021: { n:\"AxisLine\", f:parse_AxisLine },\n\t0x1022: { n:\"CrtLink\", f:parse_CrtLink },\n\t0x1024: { n:\"DefaultText\", f:parse_DefaultText },\n\t0x1025: { n:\"Text\", f:parse_Text },\n\t0x1026: { n:\"FontX\", f:parse_FontX },\n\t0x1027: { n:\"ObjectLink\", f:parse_ObjectLink },\n\t0x1032: { n:\"Frame\", f:parse_Frame },\n\t0x1033: { n:\"Begin\", f:parse_Begin },\n\t0x1034: { n:\"End\", f:parse_End },\n\t0x1035: { n:\"PlotArea\", f:parse_PlotArea },\n\t0x103a: { n:\"Chart3d\", f:parse_Chart3d },\n\t0x103c: { n:\"PicF\", f:parse_PicF },\n\t0x103d: { n:\"DropBar\", f:parse_DropBar },\n\t0x103e: { n:\"Radar\", f:parse_Radar },\n\t0x103f: { n:\"Surf\", f:parse_Surf },\n\t0x1040: { n:\"RadarArea\", f:parse_RadarArea },\n\t0x1041: { n:\"AxisParent\", f:parse_AxisParent },\n\t0x1043: { n:\"LegendException\", f:parse_LegendException },\n\t0x1044: { n:\"ShtProps\", f:parse_ShtProps },\n\t0x1045: { n:\"SerToCrt\", f:parse_SerToCrt },\n\t0x1046: { n:\"AxesUsed\", f:parse_AxesUsed },\n\t0x1048: { n:\"SBaseRef\", f:parse_SBaseRef },\n\t0x104a: { n:\"SerParent\", f:parse_SerParent },\n\t0x104b: { n:\"SerAuxTrend\", f:parse_SerAuxTrend },\n\t0x104e: { n:\"IFmtRecord\", f:parse_IFmtRecord },\n\t0x104f: { n:\"Pos\", f:parse_Pos },\n\t0x1050: { n:\"AlRuns\", f:parse_AlRuns },\n\t0x1051: { n:\"BRAI\", f:parse_BRAI },\n\t0x105b: { n:\"SerAuxErrBar\", f:parse_SerAuxErrBar },\n\t0x105c: { n:\"ClrtClient\", f:parse_ClrtClient },\n\t0x105d: { n:\"SerFmt\", f:parse_SerFmt },\n\t0x105f: { n:\"Chart3DBarShape\", f:parse_Chart3DBarShape },\n\t0x1060: { n:\"Fbi\", f:parse_Fbi },\n\t0x1061: { n:\"BopPop\", f:parse_BopPop },\n\t0x1062: { n:\"AxcExt\", f:parse_AxcExt },\n\t0x1063: { n:\"Dat\", f:parse_Dat },\n\t0x1064: { n:\"PlotGrowth\", f:parse_PlotGrowth },\n\t0x1065: { n:\"SIIndex\", f:parse_SIIndex },\n\t0x1066: { n:\"GelFrame\", f:parse_GelFrame },\n\t0x1067: { n:\"BopPopCustom\", f:parse_BopPopCustom },\n\t0x1068: { n:\"Fbi2\", f:parse_Fbi2 },\n\n\t/* These are specified in an older version of the spec */\n\t0x0016: { n:\"ExternCount\", f:parsenoop },\n\t0x007e: { n:\"RK\", f:parsenoop }, /* Not necessarily same as 0x027e */\n\t0x007f: { n:\"ImData\", f:parsenoop },\n\t0x0087: { n:\"Addin\", f:parsenoop },\n\t0x0088: { n:\"Edg\", f:parsenoop },\n\t0x0089: { n:\"Pub\", f:parsenoop },\n\t0x0091: { n:\"Sub\", f:parsenoop },\n\t0x0094: { n:\"LHRecord\", f:parsenoop },\n\t0x0095: { n:\"LHNGraph\", f:parsenoop },\n\t0x0096: { n:\"Sound\", f:parsenoop },\n\t0x00a9: { n:\"CoordList\", f:parsenoop },\n\t0x00ab: { n:\"GCW\", f:parsenoop },\n\t0x00bc: { n:\"ShrFmla\", f:parsenoop }, /* Not necessarily same as 0x04bc */\n\t0x00c2: { n:\"AddMenu\", f:parsenoop },\n\t0x00c3: { n:\"DelMenu\", f:parsenoop },\n\t0x00d6: { n:\"RString\", f:parsenoop },\n\t0x00df: { n:\"UDDesc\", f:parsenoop },\n\t0x00ea: { n:\"TabIdConf\", f:parsenoop },\n\t0x0162: { n:\"XL5Modify\", f:parsenoop },\n\t0x01a5: { n:\"FileSharing2\", f:parsenoop },\n\t0x0218: { n:\"Name\", f:parsenoop },\n\t0x0223: { n:\"ExternName\", f:parse_ExternName },\n\t0x0231: { n:\"Font\", f:parsenoop },\n\t0x0406: { n:\"Formula\", f:parse_Formula },\n\t0x086d: { n:\"FeatInfo\", f:parsenoop },\n\t0x0873: { n:\"FeatInfo11\", f:parsenoop },\n\t0x0881: { n:\"SXAddl12\", f:parsenoop },\n\t0x08c0: { n:\"AutoWebPub\", f:parsenoop },\n\t0x08c1: { n:\"ListObj\", f:parsenoop },\n\t0x08c2: { n:\"ListField\", f:parsenoop },\n\t0x08c3: { n:\"ListDV\", f:parsenoop },\n\t0x08c4: { n:\"ListCondFmt\", f:parsenoop },\n\t0x08c5: { n:\"ListCF\", f:parsenoop },\n\t0x08c6: { n:\"FMQry\", f:parsenoop },\n\t0x08c7: { n:\"FMSQry\", f:parsenoop },\n\t0x08c8: { n:\"PLV\", f:parsenoop }, /* supposedly PLV for Excel 11 */\n\t0x08c9: { n:\"LnExt\", f:parsenoop },\n\t0x08ca: { n:\"MkrExt\", f:parsenoop },\n\t0x08cb: { n:\"CrtCoopt\", f:parsenoop },\n\n\t0x0000: {}\n};\n\n\n/* Helper function to call out to ODS parser */\nfunction parse_ods(zip, opts) {\n\tif(typeof module !== \"undefined\" && typeof require !== 'undefined' && typeof ODS === 'undefined') ODS = require('./od' + 's');\n\tif(typeof ODS === 'undefined' || !ODS.parse_ods) throw new Error(\"Unsupported ODS\");\n\treturn ODS.parse_ods(zip, opts);\n}\nfunction fix_opts_func(defaults) {\n\treturn function fix_opts(opts) {\n\t\tfor(var i = 0; i != defaults.length; ++i) {\n\t\t\tvar d = defaults[i];\n\t\t\tif(opts[d[0]] === undefined) opts[d[0]] = d[1];\n\t\t\tif(d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n\t\t}\n\t};\n}\n\nvar fix_read_opts = fix_opts_func([\n\t['cellNF', false], /* emit cell number format string as .z */\n\t['cellHTML', true], /* emit html string as .h */\n\t['cellFormula', true], /* emit formulae as .f */\n\t['cellStyles', false], /* emits style/theme as .s */\n\t['cellDates', false], /* emit date cells with type `d` */\n\n\t['sheetStubs', false], /* emit empty cells */\n\t['sheetRows', 0, 'n'], /* read n rows (0 = read all rows) */\n\n\t['bookDeps', false], /* parse calculation chains */\n\t['bookSheets', false], /* only try to get sheet names (no Sheets) */\n\t['bookProps', false], /* only try to get properties (no Sheets) */\n\t['bookFiles', false], /* include raw file structure (keys, files, cfb) */\n\t['bookVBA', false], /* include vba raw data (vbaraw) */\n\n\t['password',''], /* password */\n\t['WTF', false] /* WTF mode (throws errors) */\n]);\n\n\nvar fix_write_opts = fix_opts_func([\n\t['cellDates', false], /* write date cells with type `d` */\n\n\t['bookSST', false], /* Generate Shared String Table */\n\n\t['bookType', 'xlsx'], /* Type of workbook (xlsx/m/b) */\n\n\t['WTF', false] /* WTF mode (throws errors) */\n]);\nfunction safe_parse_wbrels(wbrels, sheets) {\n\tif(!wbrels) return 0;\n\ttry {\n\t\twbrels = sheets.map(function pwbr(w) { return [w.name, wbrels['!id'][w.id].Target]; });\n\t} catch(e) { return null; }\n\treturn !wbrels || wbrels.length === 0 ? null : wbrels;\n}\n\nfunction safe_parse_ws(zip, path, relsPath, sheet, sheetRels, sheets, opts) {\n\ttry {\n\t\tsheetRels[sheet]=parse_rels(getzipdata(zip, relsPath, true), path);\n\t\tsheets[sheet]=parse_ws(getzipdata(zip, path),path,opts,sheetRels[sheet]);\n\t} catch(e) { if(opts.WTF) throw e; }\n}\n\nvar nodirs = function nodirs(x){return x.substr(-1) != '/';};\nfunction parse_zip(zip, opts) {\n\tmake_ssf(SSF);\n\topts = opts || {};\n\tfix_read_opts(opts);\n\treset_cp();\n\n\t/* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\n\tif(safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\n\n\tvar entries = keys(zip.files).filter(nodirs).sort();\n\tvar dir = parse_ct(getzipdata(zip, '[Content_Types].xml'), opts);\n\tvar xlsb = false;\n\tvar sheets, binname;\n\tif(dir.workbooks.length === 0) {\n\t\tbinname = \"xl/workbook.xml\";\n\t\tif(getzipdata(zip,binname, true)) dir.workbooks.push(binname);\n\t}\n\tif(dir.workbooks.length === 0) {\n\t\tbinname = \"xl/workbook.bin\";\n\t\tif(!getzipfile(zip,binname,true)) throw new Error(\"Could not find workbook\");\n\t\tdir.workbooks.push(binname);\n\t\txlsb = true;\n\t}\n\tif(dir.workbooks[0].substr(-3) == \"bin\") xlsb = true;\n\tif(xlsb) set_cp(1200);\n\n\tif(!opts.bookSheets && !opts.bookProps) {\n\t\tstrs = [];\n\t\tif(dir.sst) strs=parse_sst(getzipdata(zip, dir.sst.replace(/^\\//,'')), dir.sst, opts);\n\n    // parse themes before styles so that we can reliably decode theme/tint into rgb when parsing styles\n    themes = {};\n    if(opts.cellStyles && dir.themes.length) themes = parse_theme(getzipdata(zip, dir.themes[0].replace(/^\\//,''), true),dir.themes[0], opts);\n\n    styles = {};\n\t\tif(dir.style) styles = parse_sty(getzipdata(zip, dir.style.replace(/^\\//,'')),dir.style, opts);\n\n\t}\n\n\tvar wb = parse_wb(getzipdata(zip, dir.workbooks[0].replace(/^\\//,'')), dir.workbooks[0], opts);\n\n\tvar props = {}, propdata = \"\";\n\n\tif(dir.coreprops.length !== 0) {\n\t\tpropdata = getzipdata(zip, dir.coreprops[0].replace(/^\\//,''), true);\n\t\tif(propdata) props = parse_core_props(propdata);\n\t\tif(dir.extprops.length !== 0) {\n\t\t\tpropdata = getzipdata(zip, dir.extprops[0].replace(/^\\//,''), true);\n\t\t\tif(propdata) parse_ext_props(propdata, props);\n\t\t}\n\t}\n\n\tvar custprops = {};\n\tif(!opts.bookSheets || opts.bookProps) {\n\t\tif (dir.custprops.length !== 0) {\n\t\t\tpropdata = getzipdata(zip, dir.custprops[0].replace(/^\\//,''), true);\n\t\t\tif(propdata) custprops = parse_cust_props(propdata, opts);\n\t\t}\n\t}\n\n\tvar out = {};\n\tif(opts.bookSheets || opts.bookProps) {\n\t\tif(props.Worksheets && props.SheetNames.length > 0) sheets=props.SheetNames;\n\t\telse if(wb.Sheets) sheets = wb.Sheets.map(function pluck(x){ return x.name; });\n\t\tif(opts.bookProps) { out.Props = props; out.Custprops = custprops; }\n\t\tif(typeof sheets !== 'undefined') out.SheetNames = sheets;\n\t\tif(opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\n\t}\n\tsheets = {};\n\n\tvar deps = {};\n\tif(opts.bookDeps && dir.calcchain) deps=parse_cc(getzipdata(zip, dir.calcchain.replace(/^\\//,'')),dir.calcchain,opts);\n\n\tvar i=0;\n\tvar sheetRels = {};\n\tvar path, relsPath;\n\tif(!props.Worksheets) {\n\t\tvar wbsheets = wb.Sheets;\n\t\tprops.Worksheets = wbsheets.length;\n\t\tprops.SheetNames = [];\n\t\tfor(var j = 0; j != wbsheets.length; ++j) {\n\t\t\tprops.SheetNames[j] = wbsheets[j].name;\n\t\t}\n\t}\n\n\tvar wbext = xlsb ? \"bin\" : \"xml\";\n\tvar wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\n\tvar wbrels = parse_rels(getzipdata(zip, wbrelsfile, true), wbrelsfile);\n\tif(wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\n\t/* Numbers iOS hack */\n\tvar nmode = (getzipdata(zip,\"xl/worksheets/sheet.xml\",true))?1:0;\n\tfor(i = 0; i != props.Worksheets; ++i) {\n\t\tif(wbrels) path = 'xl/' + (wbrels[i][1]).replace(/[\\/]?xl\\//, \"\");\n\t\telse {\n\t\t\tpath = 'xl/worksheets/sheet'+(i+1-nmode)+\".\" + wbext;\n\t\t\tpath = path.replace(/sheet0\\./,\"sheet.\");\n\t\t}\n\t\trelsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\n\t\tsafe_parse_ws(zip, path, relsPath, props.SheetNames[i], sheetRels, sheets, opts);\n\t}\n\n\tif(dir.comments) parse_comments(zip, dir.comments, sheets, sheetRels, opts);\n\n\tout = {\n\t\tDirectory: dir,\n\t\tWorkbook: wb,\n\t\tProps: props,\n\t\tCustprops: custprops,\n\t\tDeps: deps,\n\t\tSheets: sheets,\n\t\tSheetNames: props.SheetNames,\n\t\tStrings: strs,\n\t\tStyles: styles,\n\t\tThemes: themes,\n\t\tSSF: SSF.get_table()\n\t};\n\tif(opts.bookFiles) {\n\t\tout.keys = entries;\n\t\tout.files = zip.files;\n\t}\n\tif(opts.bookVBA) {\n\t\tif(dir.vba.length > 0) out.vbaraw = getzipdata(zip,dir.vba[0],true);\n\t\telse if(dir.defaults.bin === 'application/vnd.ms-office.vbaProject') out.vbaraw = getzipdata(zip,'xl/vbaProject.bin',true);\n\t}\n\treturn out;\n}\nfunction add_rels(rels, rId, f, type, relobj) {\n\tif(!relobj) relobj = {};\n\tif(!rels['!id']) rels['!id'] = {};\n\trelobj.Id = 'rId' + rId;\n\trelobj.Type = type;\n\trelobj.Target = f;\n\tif(rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\n\trels['!id'][relobj.Id] = relobj;\n\trels[('/' + relobj.Target).replace(\"//\",\"/\")] = relobj;\n}\n\nfunction write_zip(wb, opts) {\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = SSF.get_table();\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(SSF); SSF.load_table(wb.SSF);\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t}\n\topts.rels = {}; opts.wbrels = {};\n\topts.Strings = []; opts.Strings.Count = 0; opts.Strings.Unique = 0;\n\tvar wbext = opts.bookType == \"xlsb\" ? \"bin\" : \"xml\";\n\tvar ct = { workbooks: [], sheets: [], calcchains: [], themes: [], styles: [],\n\t\tcoreprops: [], extprops: [], custprops: [], strs:[], comments: [], vba: [],\n\t\tTODO:[], rels:[], xmlns: \"\" };\n\tfix_write_opts(opts = opts || {});\n\tif(typeof jszip === 'undefined') jszip = require('js'+'zip');\n\tvar zip = new jszip();\n\tvar f = \"\", rId = 0;\n\n\topts.cellXfs = [];\n\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tf = \"docProps/core.xml\";\n\tzip.file(f, write_core_props(wb.Props, opts));\n\tct.coreprops.push(f);\n\tadd_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n\n\tf = \"docProps/app.xml\";\n\tif(!wb.Props) wb.Props = {};\n\twb.Props.SheetNames = wb.SheetNames;\n\twb.Props.Worksheets = wb.SheetNames.length;\n\tzip.file(f, write_ext_props(wb.Props, opts));\n\tct.extprops.push(f);\n\tadd_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n\tif(wb.Custprops !== wb.Props && keys(wb.Custprops||{}).length > 0) {\n\t\tf = \"docProps/custom.xml\";\n\t\tzip.file(f, write_cust_props(wb.Custprops, opts));\n\t\tct.custprops.push(f);\n\t\tadd_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n\t}\n\n\tf = \"xl/workbook.\" + wbext;\n\tzip.file(f, write_wb(wb, f, opts));\n\tct.workbooks.push(f);\n\tadd_rels(opts.rels, 1, f, RELS.WB);\n\n\tfor(rId=1;rId <= wb.SheetNames.length; ++rId) {\n\t\tf = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n\t\tzip.file(f, write_ws(rId-1, f, opts, wb));\n\t\tct.sheets.push(f);\n\t\tadd_rels(opts.wbrels, rId, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS);\n\t}\n\n\tif(opts.Strings != null && opts.Strings.length > 0) {\n\t\tf = \"xl/sharedStrings.\" + wbext;\n\t\tzip.file(f, write_sst(opts.Strings, f, opts));\n\t\tct.strs.push(f);\n\t\tadd_rels(opts.wbrels, ++rId, \"sharedStrings.\" + wbext, RELS.SST);\n\t}\n\n\t/* TODO: something more intelligent with themes */\n\n\tf = \"xl/theme/theme1.xml\";\n  zip.file(f, write_theme(opts));\n\tct.themes.push(f);\n\tadd_rels(opts.wbrels, ++rId, \"theme/theme1.xml\", RELS.THEME);\n\n\t/* TODO: something more intelligent with styles */\n\n\tf = \"xl/styles.\" + wbext;\n\tzip.file(f, write_sty(wb, f, opts));\n\tct.styles.push(f);\n\tadd_rels(opts.wbrels, ++rId, \"styles.\" + wbext, RELS.STY);\n\n\tzip.file(\"[Content_Types].xml\", write_ct(ct, opts));\n\tzip.file('_rels/.rels', write_rels(opts.rels));\n\tzip.file('xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n\treturn zip;\n}\nfunction firstbyte(f,o) {\n\tswitch((o||{}).type || \"base64\") {\n\t\tcase 'buffer': return f[0];\n\t\tcase 'base64': return Base64.decode(f.substr(0,12)).charCodeAt(0);\n\t\tcase 'binary': return f.charCodeAt(0);\n\t\tcase 'array': return f[0];\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n}\n\nfunction read_zip(data, opts) {\n\tvar zip, d = data;\n\tvar o = opts||{};\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\n\tswitch(o.type) {\n\t\tcase \"base64\": zip = new jszip(d, { base64:true }); break;\n\t\tcase \"binary\": case \"array\": zip = new jszip(d, { base64:false }); break;\n\t\tcase \"buffer\": zip = new jszip(d); break;\n\t\tcase \"file\": zip=new jszip(d=_fs.readFileSync(data)); break;\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\treturn parse_zip(zip, o);\n}\n\nfunction readSync(data, opts) {\n\tvar zip, d = data, isfile = false, n;\n\tvar o = opts||{};\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\n\tif(o.type == \"file\") { isfile = true; o.type = \"buffer\"; d = _fs.readFileSync(data); }\n\tswitch((n = firstbyte(d, o))) {\n\t\tcase 0xD0:\n\t\t\tif(isfile) o.type = \"file\";\n\t\t\treturn parse_xlscfb(CFB.read(data, o), o);\n\t\tcase 0x09: return parse_xlscfb(s2a(o.type === 'base64' ? Base64.decode(data) : data), o);\n\t\tcase 0x3C: return parse_xlml(d, o);\n\t\tcase 0x50:\n\t\t\tif(isfile) o.type = \"file\";\n\t\t\treturn read_zip(data, opts);\n\t\tdefault: throw new Error(\"Unsupported file \" + n);\n\t}\n}\n\nfunction readFileSync(data, opts) {\n\tvar o = opts||{}; o.type = 'file'\n  var wb = readSync(data, o);\n  wb.FILENAME = data;\n\treturn wb;\n}\nfunction write_zip_type(wb, opts) {\n\tvar o = opts||{};\n  style_builder  = new StyleBuilder(opts);\n\n  var z = write_zip(wb, o);\n\tswitch(o.type) {\n\t\tcase \"base64\": return z.generate({type:\"base64\"});\n\t\tcase \"binary\": return z.generate({type:\"string\"});\n\t\tcase \"buffer\": return z.generate({type:\"nodebuffer\"});\n\t\tcase \"file\": return _fs.writeFileSync(o.file, z.generate({type:\"nodebuffer\"}));\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n}\n\nfunction writeSync(wb, opts) {\n\tvar o = opts||{};\n\tswitch(o.bookType) {\n\t\tcase 'xml': return write_xlml(wb, o);\n\t\tdefault: return write_zip_type(wb, o);\n\t}\n}\n\nfunction writeFileSync(wb, filename, opts) {\n\tvar o = opts||{}; o.type = 'file';\n\n\to.file = filename;\n\tswitch(o.file.substr(-5).toLowerCase()) {\n\t\tcase '.xlsx': o.bookType = 'xlsx'; break;\n\t\tcase '.xlsm': o.bookType = 'xlsm'; break;\n\t\tcase '.xlsb': o.bookType = 'xlsb'; break;\n\tdefault: switch(o.file.substr(-4).toLowerCase()) {\n\t\tcase '.xls': o.bookType = 'xls'; break;\n\t\tcase '.xml': o.bookType = 'xml'; break;\n\t}}\n\treturn writeSync(wb, o);\n}\n\nfunction decode_row(rowstr) { return parseInt(unfix_row(rowstr),10) - 1; }\nfunction encode_row(row) { return \"\" + (row + 1); }\nfunction fix_row(cstr) { return cstr.replace(/([A-Z]|^)(\\d+)$/,\"$1$$$2\"); }\nfunction unfix_row(cstr) { return cstr.replace(/\\$(\\d+)$/,\"$1\"); }\n\nfunction decode_col(colstr) { var c = unfix_col(colstr), d = 0, i = 0; for(; i !== c.length; ++i) d = 26*d + c.charCodeAt(i) - 64; return d - 1; }\nfunction encode_col(col) { var s=\"\"; for(++col; col; col=Math.floor((col-1)/26)) s = String.fromCharCode(((col-1)%26) + 65) + s; return s; }\nfunction fix_col(cstr) { return cstr.replace(/^([A-Z])/,\"$$$1\"); }\nfunction unfix_col(cstr) { return cstr.replace(/^\\$([A-Z])/,\"$1\"); }\n\nfunction split_cell(cstr) { return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/,\"$1,$2\").split(\",\"); }\nfunction decode_cell(cstr) { var splt = split_cell(cstr); return { c:decode_col(splt[0]), r:decode_row(splt[1]) }; }\nfunction encode_cell(cell) { return encode_col(cell.c) + encode_row(cell.r); }\nfunction fix_cell(cstr) { return fix_col(fix_row(cstr)); }\nfunction unfix_cell(cstr) { return unfix_col(unfix_row(cstr)); }\nfunction decode_range(range) { var x =range.split(\":\").map(decode_cell); return {s:x[0],e:x[x.length-1]}; }\nfunction encode_range(cs,ce) {\n\tif(ce === undefined || typeof ce === 'number') return encode_range(cs.s, cs.e);\n\tif(typeof cs !== 'string') cs = encode_cell(cs); if(typeof ce !== 'string') ce = encode_cell(ce);\n\treturn cs == ce ? cs : cs + \":\" + ce;\n}\n\nfunction safe_decode_range(range) {\n\tvar o = {s:{c:0,r:0},e:{c:0,r:0}};\n\tvar idx = 0, i = 0, cc = 0;\n\tvar len = range.length;\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.s.c = --idx;\n\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.s.r = --idx;\n\n\tif(i === len || range.charCodeAt(++i) === 58) { o.e.c=o.s.c; o.e.r=o.s.r; return o; }\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.e.c = --idx;\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.e.r = --idx;\n\treturn o;\n}\n\nfunction safe_format_cell(cell, v) {\n\tif(cell.z !== undefined) try { return (cell.w = SSF.format(cell.z, v)); } catch(e) { }\n\tif(!cell.XF) return v;\n\ttry { return (cell.w = SSF.format(cell.XF.ifmt||0, v)); } catch(e) { return ''+v; }\n}\n\nfunction format_cell(cell, v) {\n\tif(cell == null || cell.t == null) return \"\";\n\tif(cell.w !== undefined) return cell.w;\n\tif(v === undefined) return safe_format_cell(cell, cell.v);\n\treturn safe_format_cell(cell, v);\n}\n\nfunction sheet_to_json(sheet, opts){\n\tvar val, row, range, header = 0, offset = 1, r, hdr = [], isempty, R, C, v;\n\tvar o = opts != null ? opts : {};\n\tvar raw = o.raw;\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\n\trange = o.range !== undefined ? o.range : sheet[\"!ref\"];\n\tif(o.header === 1) header = 1;\n\telse if(o.header === \"A\") header = 2;\n\telse if(Array.isArray(o.header)) header = 3;\n\tswitch(typeof range) {\n\t\tcase 'string': r = safe_decode_range(range); break;\n\t\tcase 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\n\t\tdefault: r = range;\n\t}\n\tif(header > 0) offset = 0;\n\tvar rr = encode_row(r.s.r);\n\tvar cols = new Array(r.e.c-r.s.c+1);\n\tvar out = new Array(r.e.r-r.s.r-offset+1);\n\tvar outi = 0;\n\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\tcols[C] = encode_col(C);\n\t\tval = sheet[cols[C] + rr];\n\t\tswitch(header) {\n\t\t\tcase 1: hdr[C] = C; break;\n\t\t\tcase 2: hdr[C] = cols[C]; break;\n\t\t\tcase 3: hdr[C] = o.header[C - r.s.c]; break;\n\t\t\tdefault:\n\t\t\t\tif(val === undefined) continue;\n\t\t\t\thdr[C] = format_cell(val);\n\t\t}\n\t}\n\n\tfor (R = r.s.r + offset; R <= r.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tisempty = true;\n\t\tif(header === 1) row = [];\n\t\telse {\n\t\t\trow = {};\n\t\t\tif(Object.defineProperty) Object.defineProperty(row, '__rowNum__', {value:R, enumerable:false});\n\t\t\telse row.__rowNum__ = R;\n\t\t}\n\t\tfor (C = r.s.c; C <= r.e.c; ++C) {\n\t\t\tval = sheet[cols[C] + rr];\n\t\t\tif(val === undefined || val.t === undefined) continue;\n\t\t\tv = val.v;\n\t\t\tswitch(val.t){\n\t\t\t\tcase 'e': continue;\n\t\t\t\tcase 's': break;\n\t\t\t\tcase 'b': case 'n': break;\n\t\t\t\tdefault: throw 'unrecognized type ' + val.t;\n\t\t\t}\n\t\t\tif(v !== undefined) {\n\t\t\t\trow[hdr[C]] = raw ? v : format_cell(val,v);\n\t\t\t\tisempty = false;\n\t\t\t}\n\t\t}\n\t\tif(isempty === false || header === 1) out[outi++] = row;\n\t}\n\tout.length = outi;\n\treturn out;\n}\n\nfunction sheet_to_row_object_array(sheet, opts) { return sheet_to_json(sheet, opts != null ? opts : {}); }\n\nfunction sheet_to_csv(sheet, opts) {\n\tvar out = \"\", txt = \"\", qreg = /\"/g;\n\tvar o = opts == null ? {} : opts;\n\tif(sheet == null || sheet[\"!ref\"] == null) return \"\";\n\tvar r = safe_decode_range(sheet[\"!ref\"]);\n\tvar FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\n\tvar RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\n\tvar row = \"\", rr = \"\", cols = [];\n\tvar i = 0, cc = 0, val;\n\tvar R = 0, C = 0;\n\tfor(C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\tfor(R = r.s.r; R <= r.e.r; ++R) {\n\t\trow = \"\";\n\t\trr = encode_row(R);\n\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\tval = sheet[cols[C] + rr];\n\t\t\ttxt = val !== undefined ? ''+format_cell(val) : \"\";\n\t\t\tfor(i = 0, cc = 0; i !== txt.length; ++i) if((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34) {\n\t\t\t\ttxt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\"; break; }\n\t\t\trow += (C === r.s.c ? \"\" : FS) + txt;\n\t\t}\n\t\tout += row + RS;\n\t}\n\treturn out;\n}\nvar make_csv = sheet_to_csv;\n\nfunction sheet_to_formulae(sheet) {\n\tvar cmds, y = \"\", x, val=\"\";\n\tif(sheet == null || sheet[\"!ref\"] == null) return \"\";\n\tvar r = safe_decode_range(sheet['!ref']), rr = \"\", cols = [], C;\n\tcmds = new Array((r.e.r-r.s.r+1)*(r.e.c-r.s.c+1));\n\tvar i = 0;\n\tfor(C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\ty = cols[C] + rr;\n\t\t\tx = sheet[y];\n\t\t\tval = \"\";\n\t\t\tif(x === undefined) continue;\n\t\t\tif(x.f != null) val = x.f;\n\t\t\telse if(x.w !== undefined) val = \"'\" + x.w;\n\t\t\telse if(x.v === undefined) continue;\n\t\t\telse val = \"\"+x.v;\n\t\t\tcmds[i++] = y + \"=\" + val;\n\t\t}\n\t}\n\tcmds.length = i;\n\treturn cmds;\n}\n\nvar utils = {\n\tencode_col: encode_col,\n\tencode_row: encode_row,\n\tencode_cell: encode_cell,\n\tencode_range: encode_range,\n\tdecode_col: decode_col,\n\tdecode_row: decode_row,\n\tsplit_cell: split_cell,\n\tdecode_cell: decode_cell,\n\tdecode_range: decode_range,\n\tformat_cell: format_cell,\n\tget_formulae: sheet_to_formulae,\n\tmake_csv: sheet_to_csv,\n\tmake_json: sheet_to_json,\n\tmake_formulae: sheet_to_formulae,\n\tsheet_to_csv: sheet_to_csv,\n\tsheet_to_json: sheet_to_json,\n\tsheet_to_formulae: sheet_to_formulae,\n\tsheet_to_row_object_array: sheet_to_row_object_array\n};\n\n\n\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////\nvar XmlNode = (function () {\n  function XmlNode(tagName, attributes, children) {\n\n    if (!(this instanceof XmlNode)) {\n      return new XmlNode(tagName, attributes, children);\n    }\n    this.tagName = tagName;\n    this._attributes = attributes || {};\n    this._children = children || [];\n    this._prefix = '';\n    return this;\n  }\n\n  XmlNode.prototype.createElement = function () {\n    return new XmlNode(arguments)\n  }\n\n  XmlNode.prototype.children = function() {\n    return this._children;\n  }\n\n  XmlNode.prototype.append = function (node) {\n    this._children.push(node);\n    return this;\n  }\n\n  XmlNode.prototype.prefix = function (prefix) {\n    if (arguments.length==0) { return this._prefix;}\n    this._prefix = prefix;\n    return this;\n  }\n\n  XmlNode.prototype.attr = function (attr, value) {\n    if (value == undefined) {\n      delete this._attributes[attr];\n      return this;\n    }\n    if (arguments.length == 0) {\n      return this._attributes;\n    }\n    else if (typeof attr == 'string' && arguments.length == 1) {\n      return this._attributes.attr[attr];\n    }\n    if (typeof attr == 'object' && arguments.length == 1) {\n      for (var key in attr) {\n        this._attributes[key] = attr[key];\n      }\n    }\n    else if (arguments.length == 2 && typeof attr == 'string') {\n      this._attributes[attr] = value;\n    }\n    return this;\n  }\n\n  var APOS = \"'\"; QUOTE = '\"'\n  var ESCAPED_QUOTE = {  }\n  ESCAPED_QUOTE[QUOTE] = '&quot;'\n  ESCAPED_QUOTE[APOS] = '&apos;'\n\n  XmlNode.prototype.escapeAttributeValue = function(att_value) {\n    return '\"' + att_value.replace(/\\\"/g,'&quot;') + '\"';// TODO Extend with four other codes\n\n  }\n\n  XmlNode.prototype.toXml = function (node) {\n    if (!node) node = this;\n    var xml = node._prefix;\n    xml += '<' + node.tagName;\n    if (node._attributes) {\n      for (var key in node._attributes) {\n        xml += ' ' + key + '=' + this.escapeAttributeValue(''+node._attributes[key]) + ''\n      }\n    }\n    if (node._children && node._children.length > 0) {\n      xml += \">\";\n      for (var i = 0; i < node._children.length; i++) {\n        xml += this.toXml(node._children[i]);\n      }\n      xml += '</' + node.tagName + '>';\n    }\n    else {\n      xml += '/>';\n    }\n    return xml;\n  }\n  return XmlNode;\n})();\n/////////////////////////////////////////////////////////////////////////////////////////////////////\n\n  var StyleBuilder = function (options) {\n\n    var customNumFmtId = 164;\n\n\n\n    var table_fmt = {\n      0:  'General',\n      1:  '0',\n      2:  '0.00',\n      3:  '#,##0',\n      4:  '#,##0.00',\n      9:  '0%',\n      10: '0.00%',\n      11: '0.00E+00',\n      12: '# ?/?',\n      13: '# ??/??',\n      14: 'm/d/yy',\n      15: 'd-mmm-yy',\n      16: 'd-mmm',\n      17: 'mmm-yy',\n      18: 'h:mm AM/PM',\n      19: 'h:mm:ss AM/PM',\n      20: 'h:mm',\n      21: 'h:mm:ss',\n      22: 'm/d/yy h:mm',\n      37: '#,##0 ;(#,##0)',\n      38: '#,##0 ;[Red](#,##0)',\n      39: '#,##0.00;(#,##0.00)',\n      40: '#,##0.00;[Red](#,##0.00)',\n      45: 'mm:ss',\n      46: '[h]:mm:ss',\n      47: 'mmss.0',\n      48: '##0.0E+0',\n      49: '@',\n      56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'    };\n    var fmt_table = {};\n\n    for (var idx in table_fmt) {\n      fmt_table[table_fmt[idx]] = idx;\n    }\n\n\n    // cache style specs to avoid excessive duplication\n    _hashIndex = {};\n    _listIndex = [];\n\n    return {\n\n      initialize: function (options) {\n\n        this.$fonts = XmlNode('fonts').attr('count',0).attr(\"x14ac:knownFonts\",\"1\");\n        this.$fills = XmlNode('fills').attr('count',0);\n        this.$borders = XmlNode('borders').attr('count',0);\n        this.$numFmts = XmlNode('numFmts').attr('count',0);\n        this.$cellStyleXfs = XmlNode('cellStyleXfs');\n        this.$xf = XmlNode('xf')\n            .attr('numFmtId', 0)\n            .attr('fontId', 0)\n            .attr('fillId', 0)\n            .attr('borderId', 0);\n\n        this.$cellXfs = XmlNode('cellXfs').attr('count',0);\n        this.$cellStyles = XmlNode('cellStyles')\n            .append(XmlNode('cellStyle')\n                .attr('name', 'Normal')\n                .attr('xfId',0)\n                .attr('builtinId',0)\n            );\n        this.$dxfs = XmlNode('dxfs').attr('count', \"0\");\n        this.$tableStyles = XmlNode('tableStyles')\n            .attr('count','0')\n            .attr('defaultTableStyle','TableStyleMedium9')\n            .attr('defaultPivotStyle','PivotStyleMedium4')\n\n\n        this.$styles = XmlNode('styleSheet')\n            .attr('xmlns:mc','http://schemas.openxmlformats.org/markup-compatibility/2006')\n            .attr('xmlns:x14ac','http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac')\n            .attr('xmlns','http://schemas.openxmlformats.org/spreadsheetml/2006/main')\n            .attr('mc:Ignorable','x14ac')\n            .prefix('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>')\n            .append(this.$numFmts)\n            .append(this.$fonts)\n            .append(this.$fills)\n            .append(this.$borders)\n            .append(this.$cellStyleXfs.append(this.$xf))\n            .append(this.$cellXfs)\n            .append(this.$cellStyles)\n            .append(this.$dxfs)\n            .append(this.$tableStyles);\n\n\n        // need to specify styles at index 0 and 1.\n        // the second style MUST be gray125 for some reason\n\n        var defaultStyle = options.defaultCellStyle || {};\n        if (!defaultStyle.font) defaultStyle.font = {name: 'Calibri', sz: '12'};\n        if (!defaultStyle.font.name) defaultStyle.font.name = 'Calibri';\n        if (!defaultStyle.font.sz) defaultStyle.font.sz = 11;\n        if (!defaultStyle.fill) defaultStyle.fill = {  patternType: \"none\", fgColor: {}};\n        if (!defaultStyle.border) defaultStyle.border = {};\n        if (!defaultStyle.numFmt) defaultStyle.numFmt = 0;\n\n        this.defaultStyle = defaultStyle;\n\n        var gray125Style = JSON.parse(JSON.stringify(defaultStyle));\n        gray125Style.fill = {patternType: \"gray125\", fgColor: { }}\n\n        this.addStyles([defaultStyle, gray125Style]);\n        return this;\n      },\n\n      // create a style entry and returns an integer index that can be used in the cell .s property\n      // these format of this object follows the emerging Common Spreadsheet Format\n      addStyle: function (attributes) {\n\n        var hashKey = JSON.stringify(attributes);\n        var index = _hashIndex[hashKey];\n        if (index == undefined) {\n\n          index = this._addXf(attributes); //_listIndex.push(attributes) -1;\n          _hashIndex[hashKey] = index;\n        }\n        else {\n          index = _hashIndex[hashKey];\n        }\n        return index;\n      },\n\n      // create style entries and returns array of integer indexes that can be used in cell .s property\n      addStyles: function (styles) {\n        var self = this;\n        return styles.map(function (style) {\n          return self.addStyle(style);\n        })\n      },\n\n      _duckTypeStyle: function(attributes) {\n\n        if (typeof attributes == 'object' && (attributes.patternFill || attributes.fgColor)) {\n          return {fill: attributes }; // this must be read via XLSX.parseFile(...)\n        }\n        else if (attributes.font || attributes.numFmt || attributes.border || attributes.fill) {\n          return attributes;\n        }\n        else {\n          return this._getStyleCSS(attributes)\n        }\n      },\n\n      _getStyleCSS: function(css) {\n        return css; //TODO\n      },\n\n      // Create an <xf> record for the style as well as corresponding <font>, <fill>, <border>, <numfmts>\n      // Right now this is simple and creates a <font>, <fill>, <border>, <numfmts> for every <xf>\n      // We could perhaps get fancier and avoid duplicating  auxiliary entries as Excel presumably intended, but bother.\n      _addXf: function (attributes) {\n\n\n        var fontId = this._addFont(attributes.font);\n        var fillId = this._addFill(attributes.fill);\n        var borderId = this._addBorder(attributes.border);\n        var numFmtId = this._addNumFmt(attributes.numFmt);\n\n        var $xf = XmlNode('xf')\n            .attr(\"numFmtId\", numFmtId)\n            .attr(\"fontId\", fontId)\n            .attr(\"fillId\", fillId)\n            .attr(\"borderId\", borderId)\n            .attr(\"xfId\", \"0\");\n\n        if (fontId > 0) {\n          $xf.attr('applyFont', \"1\");\n        }\n        if (fillId > 0) {\n          $xf.attr('applyFill', \"1\");\n        }\n        if (borderId > 0) {\n          $xf.attr('applyBorder', \"1\");\n        }\n        if (numFmtId > 0) {\n          $xf.attr('applyNumberFormat', \"1\");\n        }\n\n        if (attributes.alignment) {\n          var $alignment = XmlNode('alignment');\n          if (attributes.alignment.horizontal) { $alignment.attr('horizontal', attributes.alignment.horizontal);}\n          if (attributes.alignment.vertical)  { $alignment.attr('vertical', attributes.alignment.vertical);}\n          if (attributes.alignment.indent)  { $alignment.attr('indent', attributes.alignment.indent);}\n          if (attributes.alignment.readingOrder)  { $alignment.attr('readingOrder', attributes.alignment.readingOrder);}\n          if (attributes.alignment.wrapText)  { $alignment.attr('wrapText', attributes.alignment.wrapText);}\n          if (attributes.alignment.textRotation!=undefined)  { $alignment.attr('textRotation', attributes.alignment.textRotation);}\n\n          $xf.append($alignment).attr('applyAlignment',1)\n\n        }\n        this.$cellXfs.append($xf);\n        var count = +this.$cellXfs.children().length;\n\n        this.$cellXfs.attr('count', count);\n        return count - 1;\n      },\n\n      _addFont: function (attributes) {\n\n        if (!attributes) {  return 0; }\n\n        var $font = XmlNode('font')\n            .append(XmlNode('sz').attr('val', attributes.sz || this.defaultStyle.font.sz))\n            .append(XmlNode('name').attr('val', attributes.name || this.defaultStyle.font.name))\n\n        if (attributes.bold) $font.append(XmlNode('b'));\n        if (attributes.underline)  $font.append(XmlNode('u'));\n        if (attributes.italic)  $font.append(XmlNode('i'));\n        if (attributes.strike)  $font.append(XmlNode('strike'));\n        if (attributes.outline)  $font.append(XmlNode('outline'));\n        if (attributes.shadow)  $font.append(XmlNode('shadow'));\n\n        if (attributes.vertAlign) {\n          $font.append(XmlNode('vertAlign').attr('val', attributes.vertAlign))\n        }\n\n\n        if (attributes.color) {\n          if (attributes.color.theme) {\n            $font.append(XmlNode('color').attr('theme', attributes.color.theme))\n\n            if (attributes.color.tint) { //tint only if theme\n              $font.append(XmlNode('tint').attr('theme', attributes.color.tint))\n            }\n\n          } else if (attributes.color.rgb) { // not both rgb and theme\n            $font.append(XmlNode('color').attr('rgb', attributes.color.rgb))\n          }\n        }\n\n        this.$fonts.append($font);\n\n        var count = this.$fonts.children().length;\n        this.$fonts.attr('count', count);\n        return count - 1;\n      },\n\n        _addNumFmt: function (numFmt) {\n        if (!numFmt) { return 0; }\n\n        if (typeof numFmt == 'string') {\n          var numFmtIdx = fmt_table[numFmt];\n          if (numFmtIdx >= 0) {\n            return numFmtIdx; // we found a match against built in formats\n          }\n        }\n\n        if (/^[0-9]+$/.exec(numFmt)) {\n          return numFmt; // we're matching an integer against some known code\n        }\n        numFmt = numFmt\n            .replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;')\n            .replace(/\"/g, '&quot;')\n            .replace(/'/g, '&apos;');\n\n        var $numFmt = XmlNode('numFmt')\n            .attr('numFmtId', (++customNumFmtId))\n            .attr('formatCode', numFmt);\n\n        this.$numFmts.append($numFmt);\n\n        var count = this.$numFmts.children().length;\n        this.$numFmts.attr('count', count);\n        return customNumFmtId ;\n      },\n\n      _addFill: function (attributes) {\n\n        if (!attributes) { return 0; }\n\n        var $patternFill = XmlNode('patternFill')\n            .attr('patternType', attributes.patternType || 'solid');\n\n        if (attributes.fgColor) {\n          var $fgColor = XmlNode('fgColor');\n\n          //Excel doesn't like it when we set both rgb and theme+tint, but xlsx.parseFile() sets both\n          //var $fgColor = createElement('<fgColor/>', null, null, {xmlMode: true}).attr(attributes.fgColor)\n          if (attributes.fgColor.rgb) {\n\n            if (attributes.fgColor.rgb.length == 6) {\n              attributes.fgColor.rgb = \"FF\" + attributes.fgColor.rgb /// add alpha to an RGB as Excel expects aRGB\n            }\n\n            $fgColor.attr('rgb', attributes.fgColor.rgb);\n            $patternFill.append($fgColor);\n          }\n          else if (attributes.fgColor.theme) {\n            $fgColor.attr('theme', attributes.fgColor.theme);\n            if (attributes.fgColor.tint) {\n              $fgColor.attr('tint', attributes.fgColor.tint);\n            }\n            $patternFill.append($fgColor);\n          }\n\n          if (!attributes.bgColor) {\n            attributes.bgColor = { \"indexed\": \"64\"}\n          }\n        }\n\n        if (attributes.bgColor) {\n          var $bgColor = XmlNode('bgColor').attr(attributes.bgColor);\n          $patternFill.append($bgColor);\n        }\n\n        var $fill = XmlNode('fill')\n            .append($patternFill);\n\n        this.$fills.append($fill);\n\n        var count = this.$fills.children().length;\n        this.$fills.attr('count', count);\n        return count - 1;\n      },\n\n      _getSubBorder: function(direction, spec) {\n\n        var $direction = XmlNode(direction);\n        if (spec){\n          if (spec.style) $direction.attr('style', spec.style);\n          if (spec.color) {\n            var $color = XmlNode('color');\n            if (spec.color.auto) {\n              $color.attr('auto', spec.color.auto);\n            }\n            else if (spec.color.rgb) {\n              $color.attr('rgb', spec.color.rgb);\n            }\n            else if (spec.color.theme || spec.color.tint) {\n              $color.attr('theme', spec.color.theme || \"1\");\n              $color.attr('tint', spec.color.tint || \"0\");\n            }\n            $direction.append($color)\n          }\n        }\n        return $direction;\n      },\n\n      _addBorder: function (attributes) {\n        if (!attributes) { return 0; }\n\n        var self = this;\n\n        var $border = XmlNode('border')\n            .attr(\"diagonalUp\",attributes.diagonalUp)\n            .attr(\"diagonalDown\",attributes.diagonalDown);\n\n        var directions = [\"left\",\"right\",\"top\",\"bottom\",\"diagonal\"];\n\n        directions.forEach(function(direction) {\n          $border.append(self._getSubBorder(direction, attributes[direction]))\n        });\n        this.$borders.append($border);\n\n        var count = this.$borders.children().length;\n        this.$borders.attr('count', count);\n        return count -1;\n      },\n\n      toXml: function () {\n        return this.$styles.toXml();\n      }\n    }.initialize(options||{});\n  }\n\n\nXLSX.parse_xlscfb = parse_xlscfb;\nXLSX.parse_zip = parse_zip;\nXLSX.read = readSync; //xlsread\nXLSX.readFile = readFileSync; //readFile\nXLSX.readFileSync = readFileSync;\nXLSX.write = writeSync;\nXLSX.writeFile = writeFileSync;\nXLSX.writeFileSync = writeFileSync;\nXLSX.utils = utils;\nXLSX.CFB = CFB;\nXLSX.SSF = SSF;\n})(typeof exports !== 'undefined' ? exports : XLSX);\nvar XLS = XLSX;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}